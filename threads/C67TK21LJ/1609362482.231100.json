[{"client_msg_id":"83FD14DF-A9E5-42E6-912F-54B11DA29B25","type":"message","text":"Is this an actual problem for you in practice? Like, is the loop a performance hotspot? ","user":"U8D9768Q6","ts":"1609362482.231100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Kb1nG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is this an actual problem for you in practice? Like, is the loop a performance hotspot? "}]}]}],"thread_ts":"1609362482.231100","reply_count":7,"reply_users_count":2,"latest_reply":"1609366179.234900","reply_users":["U01FAHWCMFF","U8D9768Q6"],"subscribed":false},{"client_msg_id":"a06f51bf-98af-4d01-914c-0e2969d73393","type":"message","text":"Yes","user":"U01FAHWCMFF","ts":"1609362516.231600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ehf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes"}]}]}],"thread_ts":"1609362482.231100","parent_user_id":"U8D9768Q6"},{"client_msg_id":"9ba74bfa-26ab-46df-9a90-e3a243db0db8","type":"message","text":"3 nested for loops is vastly superior to 2 forloops + map for the final loop","user":"U01FAHWCMFF","ts":"1609362568.231800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tgY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"3 nested for loops is vastly superior to 2 forloops + map for the final loop"}]}]}],"thread_ts":"1609362482.231100","parent_user_id":"U8D9768Q6"},{"client_msg_id":"902bb810-8810-4e83-9dac-36b8799c32c2","type":"message","text":"For that, you may want to use Transducers.jl if you like maps and reductions. It's quite clever about optimizing nested maps and reductions and such.","user":"U8D9768Q6","ts":"1609362647.232000","team":"T68168MUP","edited":{"user":"U8D9768Q6","ts":"1609362741.000000"},"blocks":[{"type":"rich_text","block_id":"COh7y","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For that, you may want to use Transducers.jl if you like maps and reductions. It's quite clever about optimizing nested maps and reductions and such."}]}]}],"thread_ts":"1609362482.231100","parent_user_id":"U8D9768Q6"},{"client_msg_id":"8b27a99d-a9f8-4a59-800d-4a5873ff2e0e","type":"message","text":"tried it, still not faster. This library doesn't seem suitable for my usecase (mapping 2 arrays to a function; map(f, arr1, arr2))","user":"U01FAHWCMFF","ts":"1609364594.232700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NPcM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"tried it, still not faster. This library doesn't seem suitable for my usecase (mapping 2 arrays to a function; map(f, arr1, arr2))"}]}]}],"thread_ts":"1609362482.231100","parent_user_id":"U8D9768Q6","reactions":[{"name":"man-shrugging","users":["U8D9768Q6"],"count":1}]},{"client_msg_id":"555F4E1F-E9CF-40BA-8DF4-B4C71F6F8B55","type":"message","text":"Hard to help without any more information or an mwe","user":"U8D9768Q6","ts":"1609365865.233500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=3ld","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hard to help without any more information or an mwe"}]}]}],"thread_ts":"1609362482.231100","parent_user_id":"U8D9768Q6"},{"client_msg_id":"0F4E50D1-D904-4C44-88AE-E62DA9F4FCA9","type":"message","text":"But I recognize this is <#C67TK21LJ|gripes>, not <#C6A044SQH|helpdesk> so carry on I guess :stuck_out_tongue:","user":"U8D9768Q6","ts":"1609365896.234500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"C6Ta","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But I recognize this is "},{"type":"channel","channel_id":"C67TK21LJ"},{"type":"text","text":", not "},{"type":"channel","channel_id":"C6A044SQH"},{"type":"text","text":" so carry on I guess "},{"type":"emoji","name":"stuck_out_tongue"}]}]}],"thread_ts":"1609362482.231100","parent_user_id":"U8D9768Q6"},{"client_msg_id":"c2afb46e-e4c0-4f5a-8e03-e2654a549d05","type":"message","text":"If anyone manages to get rid of the last forloop with mapping, without using `MappedArrays.jl`  or any library that doesn't come shipped with Julia (e.g. Statistics.jl is allowed, GLM.jl isnt), *with the same performance*, I will give you a $10 starbucks gift card. First person to do so wins. Have fun all :slightly_smiling_face:\n```function pairwise_analysis2(x::Array{Int16, 2})\n    m, n = size(x)\n    mean_matrix = Matrix{Float64}(undef, (n, n))\n    @views @inbounds for i = 1:n\n        for j = 1:n\n            total::Int16 = 0\n            for k = 1:m\n                total += x[k, i] == x[k, j]\n            end\n            mean_matrix[i, j] = total / m\n        end\n    end\n    return mean_matrix\nend\n\nX = Array{Int16}(rand(0:1, (1000, 1000)));\n@btime pairwise_analysis(X)```","user":"U01FAHWCMFF","ts":"1609366179.234900","team":"T68168MUP","edited":{"user":"U01FAHWCMFF","ts":"1609366493.000000"},"blocks":[{"type":"rich_text","block_id":"yRSjf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If anyone manages to get rid of the last forloop with mapping, without using "},{"type":"text","text":"MappedArrays.jl","style":{"code":true}},{"type":"text","text":"  or any library that doesn't come shipped with Julia (e.g. Statistics.jl is allowed, GLM.jl isnt),"},{"type":"text","text":" with the same performance","style":{"bold":true}},{"type":"text","text":", I will give you a $10 starbucks gift card. First person to do so wins. Have fun all "},{"type":"emoji","name":"slightly_smiling_face"},{"type":"text","text":"\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function pairwise_analysis2(x::Array{Int16, 2})\n    m, n = size(x)\n    mean_matrix = Matrix{Float64}(undef, (n, n))\n    @views @inbounds for i = 1:n\n        for j = 1:n\n            total::Int16 = 0\n            for k = 1:m\n                total += x[k, i] == x[k, j]\n            end\n            mean_matrix[i, j] = total / m\n        end\n    end\n    return mean_matrix\nend\n\nX = Array{Int16}(rand(0:1, (1000, 1000)));\n@btime pairwise_analysis(X)"}]}]}],"thread_ts":"1609362482.231100","parent_user_id":"U8D9768Q6"}]