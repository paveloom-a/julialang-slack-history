[{"client_msg_id":"f58a8d82-47ee-4115-a207-be9137765295","type":"message","text":"I'm getting a weird error with Flux/DiffEqFlux with a simple loss function when I try to train. I'm not sure why it's giving me a `ERROR: LoadError: MethodError: no method matching +(::Float64, ::Array{Float64,2}` . Loss function works when I evaluate it myself. Could anyone help me with suggestions for how to debug or better code it? Simplified code below. (It'll be part of a slightly bigger SciML problem, which is why I'd like to use DiffEqFlux) EDIT: Solved!\n\n```U = FastChain(FastDense(1, 10, sigmoid), FastDense(10, 1))\nfunction loss(θ)\n    # Evaluate U neural network at y and return scalar\n    nn_windspeed = y -&gt; U(y, θ)[1]\n    \n    y = -5:0.1:5\n    windspeeds = nn_windspeed.(y)\n    truewinds = y.^2\n\n    return sum(abs2, (windspeeds .- truewinds))\nend\nDiffEqFlux.sciml_train(loss, initial_params(U), ADAM(1.0e-2), maxiters = 200)```","user":"U0138UTB7A4","ts":"1616788506.177700","team":"T68168MUP","edited":{"user":"U0138UTB7A4","ts":"1616811782.000000"},"blocks":[{"type":"rich_text","block_id":"1Uj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm getting a weird error with Flux/DiffEqFlux with a simple loss function when I try to train. I'm not sure why it's giving me a "},{"type":"text","text":"ERROR: LoadError: MethodError: no method matching +(::Float64, ::Array{Float64,2}","style":{"code":true}},{"type":"text","text":" . Loss function works when I evaluate it myself. Could anyone help me with suggestions for how to debug or better code it? Simplified code below. (It'll be part of a slightly bigger SciML problem, which is why I'd like to use DiffEqFlux) EDIT: Solved!\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"U = FastChain(FastDense(1, 10, sigmoid), FastDense(10, 1))\nfunction loss(θ)\n    # Evaluate U neural network at y and return scalar\n    nn_windspeed = y -> U(y, θ)[1]\n    \n    y = -5:0.1:5\n    windspeeds = nn_windspeed.(y)\n    truewinds = y.^2\n\n    return sum(abs2, (windspeeds .- truewinds))\nend\nDiffEqFlux.sciml_train(loss, initial_params(U), ADAM(1.0e-2), maxiters = 200)"}]}]}],"thread_ts":"1616788506.177700","reply_count":1,"reply_users_count":1,"latest_reply":"1616811793.178500","reply_users":["U0138UTB7A4"],"is_locked":false,"subscribed":false},{"client_msg_id":"76e5bf07-b719-436a-9981-0082cc698167","type":"message","text":"Solved! <https://discourse.julialang.org/t/training-on-simple-loss-gives-error-no-method-matching-float64-array-float64-2/|https://discourse.julialang.org/t/training-on-simple-loss-gives-error-no-method-matching-float64-array-float64-2/>","user":"U0138UTB7A4","ts":"1616811793.178500","team":"T68168MUP","attachments":[{"service_name":"JuliaLang","title":"Training on Simple Loss gives error: No method matching +(::Float64, ::Array{Float64, 2})","title_link":"https://discourse.julialang.org/t/training-on-simple-loss-gives-error-no-method-matching-float64-array-float64-2/","text":"Hello everyone! I’m getting a weird error with Flux/DiffEqFlux with a simple loss function when I try to train. I’m not sure why it’s giving me a ERROR: LoadError: MethodError: no method matching +(::Float64, ::Array{Float64,2} . Loss function works when I evaluate it myself. Could anyone help me with suggestions for how to debug or better code it? (It’ll be part of a slightly bigger SciML problem, which is why I’d like to use DiffEqFlux) Simplified code and runnable example below to see err...","fallback":"JuliaLang: Training on Simple Loss gives error: No method matching +(::Float64, ::Array{Float64, 2})","thumb_url":"https://aws1.discourse-cdn.com/business5/uploads/julialang/original/2X/1/12829a7ba92b924d4ce81099cbf99785bee9b405.png","fields":[{"title":"Reading time","value":"2 mins :clock2:","short":true},{"title":"Likes","value":"3 :heart:","short":true}],"ts":1616789972,"from_url":"https://discourse.julialang.org/t/training-on-simple-loss-gives-error-no-method-matching-float64-array-float64-2/","thumb_width":408,"thumb_height":263,"service_icon":"https://aws1.discourse-cdn.com/business5/uploads/julialang/optimized/2X/6/6ca888e296f59ca2a599807f7d5edd489e3d1829_2_180x180.png","id":1,"original_url":"https://discourse.julialang.org/t/training-on-simple-loss-gives-error-no-method-matching-float64-array-float64-2/"}],"blocks":[{"type":"rich_text","block_id":"QlhnN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Solved! "},{"type":"link","url":"https://discourse.julialang.org/t/training-on-simple-loss-gives-error-no-method-matching-float64-array-float64-2/","text":"https://discourse.julialang.org/t/training-on-simple-loss-gives-error-no-method-matching-float64-array-float64-2/"}]}]}],"thread_ts":"1616788506.177700","parent_user_id":"U0138UTB7A4"}]