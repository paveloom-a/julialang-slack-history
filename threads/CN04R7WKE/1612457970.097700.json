[{"client_msg_id":"3e9f3710-77f3-4a67-9c6f-4f5310b1d812","type":"message","text":"high-level question: Is there any issues with backprop through SDE solvers?\nIs that all working these days?\n(cc <@U01LU1QSRGW> )","user":"U6A936746","ts":"1612457970.097700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"mQOTR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"high-level question: Is there any issues with backprop through SDE solvers?\nIs that all working these days?\n(cc "},{"type":"user","user_id":"U01LU1QSRGW"},{"type":"text","text":" )"}]}]}],"thread_ts":"1612457970.097700","reply_count":27,"reply_users_count":3,"latest_reply":"1612525596.110900","reply_users":["U69BL50BF","U6A936746","UR75SQMCZ"],"subscribed":false},{"client_msg_id":"4fdd172b-7822-4435-a937-1cf9d2bff211","type":"message","text":"It's mostly all good. <https://github.com/SciML/DiffEqSensitivity.jl/issues/385> will be fixed by Diffractor (and is a specific adjoint choice), while <https://github.com/SciML/DiffEqSensitivity.jl/issues/384> is upstream regression in the last few weeks but should get a good fix.","user":"U69BL50BF","ts":"1612458112.098000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"eBE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It's mostly all good. "},{"type":"link","url":"https://github.com/SciML/DiffEqSensitivity.jl/issues/385"},{"type":"text","text":" will be fixed by Diffractor (and is a specific adjoint choice), while "},{"type":"link","url":"https://github.com/SciML/DiffEqSensitivity.jl/issues/384"},{"type":"text","text":" is upstream regression in the last few weeks but should get a good fix."}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"5be621b7-67c8-4d1f-a718-2c666a97f28e","type":"message","text":"Most things just work though","user":"U69BL50BF","ts":"1612458119.098200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lJ1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Most things just work though"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746","reactions":[{"name":"+1","users":["U6A936746"],"count":1}]},{"client_msg_id":"06f080c8-0234-494b-ac11-8eac583d9890","type":"message","text":"what is the competition like in other languages/libraries?\nAnyone doing anything better?","user":"U6A936746","ts":"1612458148.098500","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1612458157.000000"},"blocks":[{"type":"rich_text","block_id":"pTA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what is the competition like in other languages/libraries?\nAnyone doing anything better?"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"29903663-73bc-422c-b4cf-4ae718996b67","type":"message","text":"torchsde is the closest but its like 100x slower. It's so slow that I can't even run the actual benchmarks I wanted to :rolling_on_the_floor_laughing:","user":"U69BL50BF","ts":"1612458188.098800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QiozM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"torchsde is the closest but its like 100x slower. It's so slow that I can't even run the actual benchmarks I wanted to "},{"type":"emoji","name":"rolling_on_the_floor_laughing"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746","reactions":[{"name":"ty","users":["U6A936746"],"count":1},{"name":"eyes","users":["UM6JW2SF9"],"count":1},{"name":"juliaspinner","users":["UMQME35EV"],"count":1}]},{"client_msg_id":"0e2a5d25-8c04-4cac-b523-b01693ce9b74","type":"message","text":"I still like one of the R libraries, but it doesn't have much of a focus on performance","user":"U69BL50BF","ts":"1612458301.099100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EQ33J","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I still like one of the R libraries, but it doesn't have much of a focus on performance"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"7542f160-d979-4772-aaa7-cf027e995c8e","type":"message","text":"how about on problems with high dimensionality (~2000 variables)?","user":"U6A936746","ts":"1612458305.099300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wBM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"how about on problems with high dimensionality (~2000 variables)?"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"bf0f2afb-460f-451d-9c70-aabae776e89e","type":"message","text":"in what way?","user":"U69BL50BF","ts":"1612458311.099500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sLT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"in what way?"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"37ef88f4-a566-43d2-8ff4-419de8ac3494","type":"message","text":"SPDE semi-discretization?","user":"U69BL50BF","ts":"1612458327.099700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"l1T","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"SPDE semi-discretization?"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"b54eb0b1-770d-47da-9b9c-8019511719e2","type":"message","text":"I don’t think so.\nWe have some interested in modelling dynamics of the power grid,\nso looking at power at 2000 nodes (locations in grid), and how that changes over time.","user":"U6A936746","ts":"1612458368.099900","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1612458423.000000"},"blocks":[{"type":"rich_text","block_id":"92k","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don’t think so.\nWe have some interested in modelling dynamics of the power grid,\nso looking at power at 2000 nodes (locations in grid), and how that changes over time."}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"71af5d8f-37e0-41e7-a00a-87d1100f3e43","type":"message","text":"so would you like do a stochastic Fokker-Plank or something?","user":"U69BL50BF","ts":"1612458422.100100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"rirCe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so would you like do a stochastic Fokker-Plank or something?"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"28e089a2-d0fd-4a24-9026-5eaf2d691b47","type":"message","text":"yeah something like that would make sense.","user":"U6A936746","ts":"1612458473.100400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zdW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah something like that would make sense."}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"0dda2ac8-7faa-40bd-9faa-4fa3db1db3a9","type":"message","text":"If it's dense the difference does tend to fall off some if you're talking about the same exact solver because things start to become kernel costs","user":"U69BL50BF","ts":"1612458478.100600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7OVqp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If it's dense the difference does tend to fall off some if you're talking about the same exact solver because things start to become kernel costs"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"54be9646-c29a-45d4-b5f4-e35a2b4b3cd6","type":"message","text":"but for things like stochastic Fokker-Plank it'll come down to different solvers","user":"U69BL50BF","ts":"1612458493.100800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XQcn3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but for things like stochastic Fokker-Plank it'll come down to different solvers"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"938cce3b-a626-432b-b6b0-1e6472b970cc","type":"message","text":"It is probably very sparse, since power grid, each node is connect to only a couple of others. Physical wires run between them at the end of the day","user":"U6A936746","ts":"1612458507.101000","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1612458522.000000"},"blocks":[{"type":"rich_text","block_id":"mWG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It is probably very sparse, since power grid, each node is connect to only a couple of others. Physical wires run between them at the end of the day"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"7ef21cf4-9f8f-4851-98b3-6da90c2b15a3","type":"message","text":"and the story there is... muddied. We probably still have around an order of magnitude in some cases with SPDE semi-discretizations, in other cases less","user":"U69BL50BF","ts":"1612458551.101300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ILd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and the story there is... muddied. We probably still have around an order of magnitude in some cases with SPDE semi-discretizations, in other cases less"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"3e062762-1cd0-4e29-845b-90ef558c61fc","type":"message","text":"<https://chrisrackauckas.com/assets/Papers/ChrisRackauckas-Stability_Optimized_IEEE.pdf> has some updates, and there's the SROCK methods which have no other implementation that I know of","user":"U69BL50BF","ts":"1612458563.101500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UoI","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://chrisrackauckas.com/assets/Papers/ChrisRackauckas-Stability_Optimized_IEEE.pdf"},{"type":"text","text":" has some updates, and there's the SROCK methods which have no other implementation that I know of"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746","reactions":[{"name":"+1","users":["U6A936746"],"count":1}]},{"client_msg_id":"31edbc0d-bbcd-44b7-b81a-ed2c697a8faf","type":"message","text":"there's also a lot of nice high weak order methods which is likely what you want.","user":"U69BL50BF","ts":"1612458580.101700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2Bhx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"there's also a lot of nice high weak order methods which is likely what you want."}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"e4fc704b-32c5-4bc2-b38a-610b9200775e","type":"message","text":"it's muddied because stability can be diffusion-dependent (as I show in that paper), and diffusion-domainated problems have really no good method if they have transient stiffness","user":"U69BL50BF","ts":"1612458632.102000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7TR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it's muddied because stability can be diffusion-dependent (as I show in that paper), and diffusion-domainated problems have really no good method if they have transient stiffness"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"d5258bee-f0d1-4287-a8ee-aad314d5d03f","type":"message","text":"but that's not just us, I don't know of a single good method in the literature for that","user":"U69BL50BF","ts":"1612458649.102200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Z+cvr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but that's not just us, I don't know of a single good method in the literature for that"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"933eaf92-d2e0-4d6a-a2d7-1f60a7743297","type":"message","text":"but SDEs are a case where differentiating the solver is super important compared to using adjoint rules","user":"U69BL50BF","ts":"1612458716.102400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Axwu7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but SDEs are a case where differentiating the solver is super important compared to using adjoint rules"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"9cc79890-25e6-410a-a9a0-d86b0560eebe","type":"message","text":"on high order methods at least","user":"U69BL50BF","ts":"1612458733.102600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VkD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"on high order methods at least"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"85e25f68-a012-45ee-a4fb-e5cf0e14b8aa","type":"message","text":"so there are some weird odds and ends where we gain a few places","user":"U69BL50BF","ts":"1612458760.102800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HsV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so there are some weird odds and ends where we gain a few places"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746","reactions":[{"name":"+1","users":["U6A936746"],"count":1}]},{"client_msg_id":"91c42d39-4949-41b6-a406-2950573fad9c","type":"message","text":"it's a very difficult thing to summarize :rolling_on_the_floor_laughing:","user":"U69BL50BF","ts":"1612458770.103000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"58k","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it's a very difficult thing to summarize "},{"type":"emoji","name":"rolling_on_the_floor_laughing"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"7d90fc25-8899-4283-a285-49377a63b2ae","type":"message","text":"Cool, thanks.\nRecommended reading for someone new to Julia wanted to get started on backprop through SDEs?\nIs there a tutorial on these? Or a good pair of tuitorials?\n<@U01LU1QSRGW> is interning at :invenia:  and wants to look into this.","user":"U6A936746","ts":"1612458839.103300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hgq9T","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Cool, thanks.\nRecommended reading for someone new to Julia wanted to get started on backprop through SDEs?\nIs there a tutorial on these? Or a good pair of tuitorials?\n"},{"type":"user","user_id":"U01LU1QSRGW"},{"type":"text","text":" is interning at "},{"type":"emoji","name":"invenia"},{"type":"text","text":"  and wants to look into this."}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746"},{"client_msg_id":"e535f70b-2250-425e-b2d3-8f51251a26c5","type":"message","text":"I guess\n<https://diffeq.sciml.ai/stable/tutorials/sde_example/>\nand\n<https://diffeq.sciml.ai/stable/analysis/sensitivity/>\n?","user":"U6A936746","ts":"1612459287.103500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Tzr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I guess\n"},{"type":"link","url":"https://diffeq.sciml.ai/stable/tutorials/sde_example/"},{"type":"text","text":"\nand\n"},{"type":"link","url":"https://diffeq.sciml.ai/stable/analysis/sensitivity/"},{"type":"text","text":"\n?"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746","reactions":[{"name":"+1","users":["U01LU1QSRGW"],"count":1}]},{"client_msg_id":"04640fe9-324d-4a32-ab3f-d2deba1fd39e","type":"message","text":"I am planning to write a further blog post/tutorial about the adjoint methods for SDEs. Specifically, about the stochastic optimal control example from our preprint: <https://arxiv.org/abs/2101.01190> . I didn’t do it so far because I’d like to demonstrate the “piece-wise constant”  control case by using callbacks (.. and using callbacks still has some issues that need to be fixed).\nExamples for parameter estimation based on moment matching or NSDEs are also in  <https://diffeqflux.sciml.ai/dev/examples/optimization_sde/> and <https://diffeqflux.sciml.ai/dev/examples/neural_sde/>, respectively.","user":"UR75SQMCZ","ts":"1612515796.110500","team":"T68168MUP","attachments":[{"service_name":"arXiv.org","title":"Control of Stochastic Quantum Dynamics with Differentiable Programming","title_link":"https://arxiv.org/abs/2101.01190","text":"Controlling stochastic dynamics of a quantum system is an indispensable task in fields such as quantum information processing and metrology. Yet, there is no general ready-made approach to design...","fallback":"arXiv.org: Control of Stochastic Quantum Dynamics with Differentiable Programming","from_url":"https://arxiv.org/abs/2101.01190","service_icon":"https://static.arxiv.org/static/browse/0.3.2.6/images/icons/favicon.ico","id":1,"original_url":"https://arxiv.org/abs/2101.01190"}],"blocks":[{"type":"rich_text","block_id":"UZ0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I am planning to write a further blog post/tutorial about the adjoint methods for SDEs. Specifically, about the stochastic optimal control example from our preprint: "},{"type":"link","url":"https://arxiv.org/abs/2101.01190"},{"type":"text","text":" . I didn’t do it so far because I’d like to demonstrate the “piece-wise constant”  control case by using callbacks (.. and using callbacks still has some issues that need to be fixed).\nExamples for parameter estimation based on moment matching or NSDEs are also in  "},{"type":"link","url":"https://diffeqflux.sciml.ai/dev/examples/optimization_sde/"},{"type":"text","text":" and "},{"type":"link","url":"https://diffeqflux.sciml.ai/dev/examples/neural_sde/"},{"type":"text","text":", respectively."}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746","reactions":[{"name":"heart_eyes","users":["U6A936746","UM6JW2SF9","U01LU1QSRGW"],"count":3}]},{"client_msg_id":"c7847ad3-1f1a-4750-a41e-ed2e4bb8d503","type":"message","text":"also <https://frankschae.github.io/post/gsoc2020-high-weak-order-solvers-sde-adjoints/>","user":"U69BL50BF","ts":"1612525596.110900","team":"T68168MUP","attachments":[{"service_name":"FS","title":"GSoC 2020: High weak order SDE solvers and their utility in neural SDEs | FS","title_link":"https://frankschae.github.io/post/gsoc2020-high-weak-order-solvers-sde-adjoints/","text":"First and foremost, I would like to thank my mentors Chris Rackauckas, Moritz Schauer, and Yingbo Ma for their willingness to supervise me in this Google Summer of Code project. Although we are still at the very beginning of the project, we already had plenty of very inspiring discussion.","fallback":"FS: GSoC 2020: High weak order SDE solvers and their utility in neural SDEs | FS","thumb_url":"https://frankschae.github.io/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png","ts":1590844233,"from_url":"https://frankschae.github.io/post/gsoc2020-high-weak-order-solvers-sde-adjoints/","thumb_width":512,"thumb_height":512,"service_icon":"https://frankschae.github.io/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_192x192_fill_lanczos_center_2.png","id":1,"original_url":"https://frankschae.github.io/post/gsoc2020-high-weak-order-solvers-sde-adjoints/"}],"blocks":[{"type":"rich_text","block_id":"b7PTk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"also "},{"type":"link","url":"https://frankschae.github.io/post/gsoc2020-high-weak-order-solvers-sde-adjoints/"}]}]}],"thread_ts":"1612457970.097700","parent_user_id":"U6A936746","reactions":[{"name":"+1","users":["U6A936746","UR75SQMCZ","UM6JW2SF9","U01LU1QSRGW"],"count":4}]}]