[{"client_msg_id":"06556302-0a50-4713-8959-6e9e9d4b7df3","type":"message","text":"I‚Äôm trying to optimize initial conditions for a 2nd order ODE:\n```pÃÑ‚Çì‚Çì(pÃÑ‚Çì, pÃÑ, Œ∏, x) = -k^2 * pÃÑ\n\nfunction loss(Œ∏)\n  ùí´ = SecondOrderODEProblem{false}(pÃÑ‚Çì‚Çì, Œ∏[1], Œ∏[2], (0.5f0, 1.0f0))\n  sol = solve(ùí´, Tsit5(); saveat=train_x)\n  mean(abs2, [abs(u[2])  for u ‚àà sol.u] .- train_y)\nend\n\nres = DiffEqFlux.sciml_train(loss, [1.0f0, 0.0f0], ADAM(0.1); maxiters=100)```\nThe `loss()` function can be evaluated manually and it works just fine, but when I run it using `sciml_train()`, I get a:\n```ERROR: MethodError: no method matching similar(::Float32, ::Type{Float32})```\nwhich seems to be occurring during the pullback evaluation while accessing `sol.u` which is a `Vector{ArrayPartition{Float32, Tuple{Float32, Float32}}}`. In the forward pass, there is no problem, however. Any advise would be appreciated.","user":"U017AJ68PFZ","ts":"1613898998.027800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/3y9M","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I‚Äôm trying to optimize initial conditions for a 2nd order ODE:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"pÃÑ‚Çì‚Çì(pÃÑ‚Çì, pÃÑ, Œ∏, x) = -k^2 * pÃÑ\n\nfunction loss(Œ∏)\n  ùí´ = SecondOrderODEProblem{false}(pÃÑ‚Çì‚Çì, Œ∏[1], Œ∏[2], (0.5f0, 1.0f0))\n  sol = solve(ùí´, Tsit5(); saveat=train_x)\n  mean(abs2, [abs(u[2])  for u ‚àà sol.u] .- train_y)\nend\n\nres = DiffEqFlux.sciml_train(loss, [1.0f0, 0.0f0], ADAM(0.1); maxiters=100)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"The "},{"type":"text","text":"loss()","style":{"code":true}},{"type":"text","text":" function can be evaluated manually and it works just fine, but when I run it using "},{"type":"text","text":"sciml_train()","style":{"code":true}},{"type":"text","text":", I get a:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: MethodError: no method matching similar(::Float32, ::Type{Float32})"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"which seems to be occurring during the pullback evaluation while accessing "},{"type":"text","text":"sol.u","style":{"code":true}},{"type":"text","text":" which is a "},{"type":"text","text":"Vector{ArrayPartition{Float32, Tuple{Float32, Float32}}}","style":{"code":true}},{"type":"text","text":". In the forward pass, there is no problem, however. Any advise would be appreciated."}]}]}],"thread_ts":"1613898998.027800","reply_count":4,"reply_users_count":2,"latest_reply":"1613906455.028900","reply_users":["U69BL50BF","U017AJ68PFZ"],"subscribed":false},{"client_msg_id":"1c9e395f-2ad2-4d69-815a-64e1e9646bbb","type":"message","text":"scalar equations are going to be hard for the reverse mode AD. Make that `\n```ùí´ = SecondOrderODEProblem{false}(pÃÑ‚Çì‚Çì, [Œ∏[1]], [Œ∏[2]], (0.5f0, 1.0f0))\n  sol = solve(ùí´, Tsit5(); saveat=train_x)```\nand you should be good","user":"U69BL50BF","ts":"1613903497.028000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"J97","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"scalar equations are going to be hard for the reverse mode AD. Make that `\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ùí´ = SecondOrderODEProblem{false}(pÃÑ‚Çì‚Çì, [Œ∏[1]], [Œ∏[2]], (0.5f0, 1.0f0))\n  sol = solve(ùí´, Tsit5(); saveat=train_x)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"and you should be good"}]}]}],"thread_ts":"1613898998.027800","parent_user_id":"U017AJ68PFZ"},{"client_msg_id":"0CA2E1D9-FABB-4FAA-A270-1B31898F845D","type":"message","text":"Ah! Will try that!! Thanks!","user":"U017AJ68PFZ","ts":"1613904071.028500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YvZ94","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah! Will try that!! Thanks!"}]}]}],"thread_ts":"1613898998.027800","parent_user_id":"U017AJ68PFZ"},{"client_msg_id":"ca548f81-63e5-4617-becb-86f1bb938221","type":"message","text":"Works, thanks! :slightly_smiling_face:","user":"U017AJ68PFZ","ts":"1613904749.028700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DLnH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Works, thanks! "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1613898998.027800","parent_user_id":"U017AJ68PFZ"},{"client_msg_id":"b5d6686d-c977-424a-a583-2dbda573bb36","type":"message","text":"no problem","user":"U69BL50BF","ts":"1613906455.028900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4zf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"no problem"}]}]}],"thread_ts":"1613898998.027800","parent_user_id":"U017AJ68PFZ"}]