[{"client_msg_id":"5de9bc49-8a3b-42ff-a383-80c75ca4ca00","type":"message","text":"But if you manage to not have your private registry available, then it would still download the bad one?","user":"U67D54KS8","ts":"1613029988.153500","team":"T68168MUP","edited":{"user":"U67D54KS8","ts":"1613030015.000000"},"blocks":[{"type":"rich_text","block_id":"OMRps","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But if you manage to not have your private registry available, then it would still download the bad one?"}]}]}],"thread_ts":"1613029988.153500","reply_count":9,"reply_users_count":4,"latest_reply":"1613078838.174400","reply_users":["UBVE598BC","U67D54KS8","UCZ7VBGUD","U01537M2E9W"],"subscribed":false,"reactions":[{"name":"point_up","users":["UH24GRBLL","U82LX4ACB","U7THT3TM3"],"count":3}]},{"client_msg_id":"686c0b9d-d067-44e1-9f84-3a433caa2cab","type":"message","text":"I don't see any way to protect against that scenario short of a blacklisting feature for General. But let's break down this (missing private registry) into cases:\n• Install of package by name only: You get the wrong thing just from a name collision in General, regardless whether UUID matches.\n• Instantiating a manifest: Will just fail to find the specified tree hash.\n• Upgrade of packages: Here you could be fooled by a counterfeit package in General with both name and UUID matching.","user":"UBVE598BC","ts":"1613030921.157100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yXGB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don't see any way to protect against that scenario short of a blacklisting feature for General. But let's break down this (missing private registry) into cases:\n"}]},{"type":"rich_text_list","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Install of package by name only: You get the wrong thing just from a name collision in General, regardless whether UUID matches."}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Instantiating a manifest: Will just fail to find the specified tree hash."}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Upgrade of packages: Here you could be fooled by a counterfeit package in General with both name and UUID matching."}]}],"style":"bullet","indent":0}]}],"thread_ts":"1613029988.153500","parent_user_id":"U67D54KS8","reactions":[{"name":"100","users":["UH24GRBLL"],"count":1}]},{"client_msg_id":"dc17690f-0307-4956-a4d3-4ffd14f3d6a5","type":"message","text":"Regarding not having your private registry available I can add that you run into all kinds of weird errors when you try to work with a project that makes use of it, so it's not like you won't notice that something is amiss.","user":"UBVE598BC","ts":"1613031750.158000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xNZzi","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Regarding not having your private registry available I can add that you run into all kinds of weird errors when you try to work with a project that makes use of it, so it's not like you won't notice that something is amiss."}]}]}],"thread_ts":"1613029988.153500","parent_user_id":"U67D54KS8"},{"client_msg_id":"c63194b0-a386-4a06-85e8-f500089f006d","type":"message","text":"Unless you e.g. only have one local package that now exists in General","user":"U67D54KS8","ts":"1613033636.158400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ajFS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Unless you e.g. only have one local package that now exists in General"}]}]}],"thread_ts":"1613029988.153500","parent_user_id":"U67D54KS8"},{"client_msg_id":"f7347f47-97c3-4315-9a8a-bc11066ec99e","type":"message","text":"Yes, there are edge cases but at least registries don't come and go on a whim so chances are that even in the one package scenario you would be alerted when you fail to instantiate your environment. Sure, the attacker might have access to your existing versions as well or you may deliberately remove your private registry after having worked with your depot for a while but we're getting into territory where there has at least been a major risk mitigation.","user":"UBVE598BC","ts":"1613034882.158600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pR=f9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes, there are edge cases but at least registries don't come and go on a whim so chances are that even in the one package scenario you would be alerted when you fail to instantiate your environment. Sure, the attacker might have access to your existing versions as well or you may deliberately remove your private registry after having worked with your depot for a while but we're getting into territory where there has at least been a major risk mitigation."}]}]}],"thread_ts":"1613029988.153500","parent_user_id":"U67D54KS8","reactions":[{"name":"+1","users":["UCZ7VBGUD"],"count":1}]},{"client_msg_id":"F88FC884-6CA1-43E8-B262-F27D3388114A","type":"message","text":"Yeah, presumably if there is a malicious package in General, and you’ve learned about it from the shadowable mechanism or similar erroring, then that could get dealt with pretty quickly? So then the worry is that at the same time the attacker registers the malicious package, you have a transient failure and can’t access your registry. Definitely can happen but it seems much less likely.","user":"UCZ7VBGUD","ts":"1613038645.162400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"40b","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, presumably if there is a malicious package in General, and you’ve learned about it from the shadowable mechanism or similar erroring, then that could get dealt with pretty quickly? So then the worry is that at the same time the attacker registers the malicious package, you have a transient failure and can’t access your registry. Definitely can happen but it seems much less likely."}]}]}],"thread_ts":"1613029988.153500","parent_user_id":"U67D54KS8"},{"client_msg_id":"6550eab4-eed3-4c21-b86f-cb4e99f5bb07","type":"message","text":"You don't lose your registry from transient failures. Once you have installed it it remains in your depot unless you explicitly remove it. You might fail to update it due to transient problems, but it's still there.","user":"UBVE598BC","ts":"1613042173.162600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"g9l9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You don't lose your registry from transient failures. Once you have installed it it remains in your depot unless you explicitly remove it. You might fail to update it due to transient problems, but it's still there."}]}]}],"thread_ts":"1613029988.153500","parent_user_id":"U67D54KS8"},{"client_msg_id":"a58d9280-6e10-4fa3-b230-dd4a95d9a6cf","type":"message","text":"I meant on CI or such, where you might be installing Julia + custom registries from a fresh start frequently","user":"UCZ7VBGUD","ts":"1613042413.162800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"C4f2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I meant on CI or such, where you might be installing Julia + custom registries from a fresh start frequently"}]}]}],"thread_ts":"1613029988.153500","parent_user_id":"U67D54KS8","reactions":[{"name":"+1","users":["U7THT3TM3"],"count":1}]},{"client_msg_id":"aaeb9146-e3f1-4565-87aa-b791358575dd","type":"message","text":"Yes, that's a relevant scenario. My best advice would be not to ignore a failure from `registry add` in your build scripts.","user":"UBVE598BC","ts":"1613043712.163000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=eQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes, that's a relevant scenario. My best advice would be not to ignore a failure from "},{"type":"text","text":"registry add","style":{"code":true}},{"type":"text","text":" in your build scripts."}]}]}],"thread_ts":"1613029988.153500","parent_user_id":"U67D54KS8","reactions":[{"name":"+1","users":["U6A936746"],"count":1}]},{"client_msg_id":"3b6f5dff-efb2-4770-8f87-631c7232c40f","type":"message","text":"Personally, I would be okay with having to specify what registry I intend a package to come from for every dependency I have. It could be an opt-in feature.","user":"U01537M2E9W","ts":"1613078838.174400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"v+6w","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Personally, I would be okay with having to specify what registry I intend a package to come from for every dependency I have. It could be an opt-in feature."}]}]}],"thread_ts":"1613029988.153500","parent_user_id":"U67D54KS8"}]