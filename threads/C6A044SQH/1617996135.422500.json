[{"client_msg_id":"c17850c9-84f2-4545-9c8b-ef491a3567e0","type":"message","text":"Hi, I implemented a custom Flux layer and get the following error when trying to optimize with a gradient-based optimizer\n```UndefRefError: access to undefined reference\nin eval at base/boot.jl:360 \nin top-level scope at ncp-sine.jl:91\nin train at ncp-sine.jl:84\nin  at Flux/qp1gc/src/optimise/train.jl:97\nin var\"#train!#36\" at Flux/qp1gc/src/optimise/train.jl:99\nin macro expansion at Juno/n6wyj/src/progress.jl:119 \nin macro expansion at Flux/qp1gc/src/optimise/train.jl:101 \nin gradient at Zygote/lwmfx/src/compiler/interface.jl:59\nin  at Zygote/lwmfx/src/compiler/interface.jl:252\nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at Flux/qp1gc/src/optimise/train.jl:102 \nin #1686#back at ZygoteRules/OjfTt/src/adjoint.jl:59 \nin #178 at Zygote/lwmfx/src/lib/lib.jl:194 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at ncp-sine.jl:84 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at ncp-sine.jl:17 \nin  at ZygoteRules/OjfTt/src/adjoint.jl:59\nin  at Zygote/lwmfx/src/lib/array.jl:207\nin map at base/abstractarray.jl:2383 \nin collect at base/array.jl:678\nin iterate at base/generator.jl:47 \nin #4 at base/generator.jl:36 \nin #551 at Zygote/lwmfx/src/lib/array.jl:207 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at Flux/qp1gc/src/layers/recurrent.jl:34 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at ltc-modelcleanup.jl:195 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at DiffEqBase/qntkj/src/solve.jl:68 \nin  at ZygoteRules/OjfTt/src/adjoint.jl:59\nin  at Zygote/lwmfx/src/lib/lib.jl:194\nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at DiffEqBase/qntkj/src/solve.jl:70 \nin  at ZygoteRules/OjfTt/src/adjoint.jl:59\nin #178 at Zygote/lwmfx/src/lib/lib.jl:194 \nin #93#back at ZygoteRules/OjfTt/src/adjoint.jl:59 \nin  at DiffEqSensitivity/agdxc/src/concrete_solve.jl:179\nin  at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:6\nin var\"#adjoint_sensitivities#42\" at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:6\nin  at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:16\nin  at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:16\nin var\"#_adjoint_sensitivities#43\" at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:22\nin ODEAdjointProblem##kw at DiffEqSensitivity/agdxc/src/backsolve_adjoint.jl:90 \nin var\"#ODEAdjointProblem#108\" at DiffEqSensitivity/agdxc/src/backsolve_adjoint.jl:98\nin materialize at base/broadcast.jl:883 \nin copy at base/broadcast.jl:922 \nin getindex at base/broadcast.jl:575 \nin _broadcast_getindex at base/broadcast.jl:620 \nin _getindex at base/broadcast.jl:644 \nin _getindex at base/broadcast.jl:645 \nin _broadcast_getindex at base/broadcast.jl:614 \nin getindex at base/array.jl:801  ```\nDoes this stacktrace look to you like a known issue?","user":"UU7P28MDY","ts":"1617996135.422500","team":"T68168MUP","edited":{"user":"UU7P28MDY","ts":"1617996194.000000"},"blocks":[{"type":"rich_text","block_id":"ifO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi, I implemented a custom Flux layer and get the following error when trying to optimize with a gradient-based optimizer\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"UndefRefError: access to undefined reference\nin eval at base/boot.jl:360 \nin top-level scope at ncp-sine.jl:91\nin train at ncp-sine.jl:84\nin  at Flux/qp1gc/src/optimise/train.jl:97\nin var\"#train!#36\" at Flux/qp1gc/src/optimise/train.jl:99\nin macro expansion at Juno/n6wyj/src/progress.jl:119 \nin macro expansion at Flux/qp1gc/src/optimise/train.jl:101 \nin gradient at Zygote/lwmfx/src/compiler/interface.jl:59\nin  at Zygote/lwmfx/src/compiler/interface.jl:252\nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at Flux/qp1gc/src/optimise/train.jl:102 \nin #1686#back at ZygoteRules/OjfTt/src/adjoint.jl:59 \nin #178 at Zygote/lwmfx/src/lib/lib.jl:194 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at ncp-sine.jl:84 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at ncp-sine.jl:17 \nin  at ZygoteRules/OjfTt/src/adjoint.jl:59\nin  at Zygote/lwmfx/src/lib/array.jl:207\nin map at base/abstractarray.jl:2383 \nin collect at base/array.jl:678\nin iterate at base/generator.jl:47 \nin #4 at base/generator.jl:36 \nin #551 at Zygote/lwmfx/src/lib/array.jl:207 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at Flux/qp1gc/src/layers/recurrent.jl:34 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at ltc-modelcleanup.jl:195 \nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at DiffEqBase/qntkj/src/solve.jl:68 \nin  at ZygoteRules/OjfTt/src/adjoint.jl:59\nin  at Zygote/lwmfx/src/lib/lib.jl:194\nin  at Zygote/lwmfx/src/compiler/interface2.jl\nin Pullback at DiffEqBase/qntkj/src/solve.jl:70 \nin  at ZygoteRules/OjfTt/src/adjoint.jl:59\nin #178 at Zygote/lwmfx/src/lib/lib.jl:194 \nin #93#back at ZygoteRules/OjfTt/src/adjoint.jl:59 \nin  at DiffEqSensitivity/agdxc/src/concrete_solve.jl:179\nin  at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:6\nin var\"#adjoint_sensitivities#42\" at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:6\nin  at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:16\nin  at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:16\nin var\"#_adjoint_sensitivities#43\" at DiffEqSensitivity/agdxc/src/sensitivity_interface.jl:22\nin ODEAdjointProblem##kw at DiffEqSensitivity/agdxc/src/backsolve_adjoint.jl:90 \nin var\"#ODEAdjointProblem#108\" at DiffEqSensitivity/agdxc/src/backsolve_adjoint.jl:98\nin materialize at base/broadcast.jl:883 \nin copy at base/broadcast.jl:922 \nin getindex at base/broadcast.jl:575 \nin _broadcast_getindex at base/broadcast.jl:620 \nin _getindex at base/broadcast.jl:644 \nin _getindex at base/broadcast.jl:645 \nin _broadcast_getindex at base/broadcast.jl:614 \nin getindex at base/array.jl:801  "}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Does this stacktrace look to you like a known issue?"}]}]}],"thread_ts":"1617996135.422500","reply_count":1,"reply_users_count":1,"latest_reply":"1617996325.424400","reply_users":["UU7P28MDY"],"is_locked":false,"subscribed":false},{"client_msg_id":"b9a3eada-32c3-4e43-8599-dab09c898c1c","type":"message","text":"<https://github.com/lungd/julia-code/blob/master/ltc/>","user":"UU7P28MDY","ts":"1617996325.424400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/FMin","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/lungd/julia-code/blob/master/ltc/"}]}]}],"thread_ts":"1617996135.422500","parent_user_id":"UU7P28MDY"}]