[{"client_msg_id":"9feefbbb-e63b-4bf5-88ef-ae3e380ca1a4","type":"message","text":"Is there an intermediate between `@elapsed` (easy, fast, inaccurate) and `@belapsed` (slow, high overhead, accurate)? E.g. I was just timing something where `@belapsed myfun() seconds=2` took 16 seconds, which is enough to get bored staring at the terminal :confused: I want a macro which is sort of like `@belapsed_with_hard_time_limit myfun() hard_limit_seconds=2`, does that exist?","user":"U73ACR3TQ","ts":"1610665457.042900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vjyf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there an intermediate between "},{"type":"text","text":"@elapsed","style":{"code":true}},{"type":"text","text":" (easy, fast, inaccurate) and "},{"type":"text","text":"@belapsed","style":{"code":true}},{"type":"text","text":" (slow, high overhead, accurate)? E.g. I was just timing something where "},{"type":"text","text":"@belapsed myfun() seconds=2","style":{"code":true}},{"type":"text","text":" took 16 seconds, which is enough to get bored staring at the terminal "},{"type":"emoji","name":"confused"},{"type":"text","text":" I want a macro which is sort of like "},{"type":"text","text":"@belapsed_with_hard_time_limit myfun() hard_limit_seconds=2","style":{"code":true}},{"type":"text","text":", does that exist?"}]}]}],"thread_ts":"1610665457.042900","reply_count":25,"reply_users_count":4,"latest_reply":"1610669686.055300","reply_users":["UD0NS8PDF","UH24GRBLL","U73ACR3TQ","U8MPCDJAY"],"subscribed":false},{"client_msg_id":"e9e2386e-930a-40e3-8289-46fac7fc8762","type":"message","text":"You can pass options to BenchmarkTools, or I think set them globally in your startup file","user":"UD0NS8PDF","ts":"1610665962.043500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4AO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You can pass options to BenchmarkTools, or I think set them globally in your startup file"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"5fa46067-8600-4382-b715-89f9a15aae76","type":"message","text":"IIRC, BenchmarkTools does some tuning to make sure a run takes 5s (or the length of one run, if it's slower than that)","user":"UH24GRBLL","ts":"1610666017.043700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"emtu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"IIRC, BenchmarkTools does some tuning to make sure a run takes 5s (or the length of one run, if it's slower than that)"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"03fbb09b-ea23-4031-ae7a-256d2f656a85","type":"message","text":"I really wish there were some more output while this was happening though","user":"UH24GRBLL","ts":"1610666029.044100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0Ka","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I really wish there were some more output while this was happening though"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"c134eaeb-2055-4ce8-afea-d499bb1165b7","type":"message","text":"That would be nice to have, goes with the 1.6 theme…","user":"UD0NS8PDF","ts":"1610666078.044500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EH=Q","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That would be nice to have, goes with the 1.6 theme…"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"e4e50519-50da-4903-88a2-caa8fefb9e0b","type":"message","text":"I am super not a BenchmarkTools expert but it seems like it does some setup, then runs your code in a loop until a set amount of time has elapsed (default 5 seconds). But if that setup is really slow, the whole `@belapsed`  can also be slow.\n\nE.g. in my case `@belapsed myfun() seconds=2` took 16 seconds, but with `seconds=5` it took 19 seconds =&gt; suggest 14 seconds of setup overhead","user":"U73ACR3TQ","ts":"1610666153.044700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lU11P","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I am super not a BenchmarkTools expert but it seems like it does some setup, then runs your code in a loop until a set amount of time has elapsed (default 5 seconds). But if that setup is really slow, the whole "},{"type":"text","text":"@belapsed ","style":{"code":true}},{"type":"text","text":" can also be slow.\n\nE.g. in my case "},{"type":"text","text":"@belapsed myfun() seconds=2","style":{"code":true}},{"type":"text","text":" took 16 seconds, but with "},{"type":"text","text":"seconds=5","style":{"code":true}},{"type":"text","text":" it took 19 seconds => suggest 14 seconds of setup overhead"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"fa342746-62ec-48c1-83c8-8d15146fc872","type":"message","text":"yes, that's the tuning","user":"UH24GRBLL","ts":"1610666282.045000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CY6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes, that's the tuning"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"f1479ebf-51cf-4dc5-bd02-f176c7211739","type":"message","text":"the tuning is just running it a few times to get a feel for how long each run takes, how many evaluations per run should be done etc.","user":"UH24GRBLL","ts":"1610666306.045200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LtIg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the tuning is just running it a few times to get a feel for how long each run takes, how many evaluations per run should be done etc."}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"52a86ee9-1136-4077-9b86-aa88e1949eca","type":"message","text":"`cargo bench` does something similar for Rust benchmarking, but it tells you that it's done","user":"UH24GRBLL","ts":"1610666325.045400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tCJB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"cargo bench","style":{"code":true}},{"type":"text","text":" does something similar for Rust benchmarking, but it tells you that it's done"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"dceba718-3d2c-4f20-83bd-83c77fe28ff4","type":"message","text":"I feel if BenchmarkTools would have a similar display (or similar to how Pkg shows what is being precompiled in 1.6), it would at least feel quicker because you know that something is going on","user":"UH24GRBLL","ts":"1610666365.045600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E3eX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I feel if BenchmarkTools would have a similar display (or similar to how Pkg shows what is being precompiled in 1.6), it would at least feel quicker because you know that something is going on"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"d5775d44-6af6-4c91-9a9a-8d346f4c7d58","type":"message","text":"There is <https://github.com/JuliaCI/BenchmarkTools.jl/pull/153>","user":"UD0NS8PDF","ts":"1610666452.045800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xn4M","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"There is "},{"type":"link","url":"https://github.com/JuliaCI/BenchmarkTools.jl/pull/153"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"c3ae5535-6d3b-49a6-87be-776cb937b46d","type":"message","text":"yeah, but that hinges on using BenchmarkGroups and ProgressLogging","user":"UH24GRBLL","ts":"1610666530.046000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1xNQ2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah, but that hinges on using BenchmarkGroups and ProgressLogging"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"aa68b098-f8e2-46e6-aab1-b10a4d15ed05","type":"message","text":"Yes I haven’t actually decoded what it does, nor tried it…","user":"UD0NS8PDF","ts":"1610666548.046200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=I=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes I haven’t actually decoded what it does, nor tried it…"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"69af479b-3bc0-481a-acb4-51fc5a7dd7a2","type":"message","text":"if you use BenchmarkGroups for benchmarking a lot of different things and wrap it in one of the progress loggers, those displays will just magically happen","user":"UH24GRBLL","ts":"1610666585.046400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"rsP0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"if you use BenchmarkGroups for benchmarking a lot of different things and wrap it in one of the progress loggers, those displays will just magically happen"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"587c7b8b-7b3e-45df-935c-7b17f6be4a0e","type":"message","text":"the thing is that the continous output really only has to show what's happening right now, as well as what's done - similar to what Pkg does now :)","user":"UH24GRBLL","ts":"1610666618.046600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"eAd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the thing is that the continous output really only has to show what's happening right now, as well as what's done - similar to what Pkg does now :)"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"89662a6e-697b-4e96-8b33-767de66fc781","type":"message","text":"And that PR looks like it doesn’t touch the code for just one `@btime`?","user":"UD0NS8PDF","ts":"1610666776.046800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e1V+E","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And that PR looks like it doesn’t touch the code for just one "},{"type":"text","text":"@btime","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"6a8da482-d9bd-4392-abe8-874593ca529c","type":"message","text":"don't think so, no","user":"UH24GRBLL","ts":"1610666963.047000","team":"T68168MUP","edited":{"user":"UH24GRBLL","ts":"1610666965.000000"},"blocks":[{"type":"rich_text","block_id":"Y5cm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"don't think so, no"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"920136B7-D674-4C29-85FD-A0BD720D60BE","type":"message","text":"That reminds me of a question.. does `@btime` reject the time taken in the first run from the stats? With the new `@time` compile timing in 1.6, it should be able to intelligently determine if that run contained any compilation and include it if not","user":"U8MPCDJAY","ts":"1610669360.050700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7y8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That reminds me of a question.. does "},{"type":"text","text":"@btime","style":{"code":true}},{"type":"text","text":" reject the time taken in the first run from the stats? With the new "},{"type":"text","text":"@time","style":{"code":true}},{"type":"text","text":" compile timing in 1.6, it should be able to intelligently determine if that run contained any compilation and include it if not"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"B0A01A39-3661-471F-AD83-59BD6D0EBF2F","type":"message","text":"... which might be able to reduce time to a statistically meaningful answer??","user":"U8MPCDJAY","ts":"1610669423.051600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zTrUP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"... which might be able to reduce time to a statistically meaningful answer??"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"e00aa671-6d63-41ca-a99b-8d6d1b625bb1","type":"message","text":"I think it excludes extreme outliers","user":"UH24GRBLL","ts":"1610669453.051800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1gP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think it excludes extreme outliers"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"A3C317C6-F027-4796-B58E-4CB73D3F0C77","type":"message","text":"Ok. Maybe it’s smarter/more accurate to just reject runs that included compilation","user":"U8MPCDJAY","ts":"1610669483.052600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xmB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ok. Maybe it’s smarter/more accurate to just reject runs that included compilation"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"82973a33-d946-4a33-8f63-b44aaf230625","type":"message","text":"the compilation time was never a factor for the real runs of `@btime` anyway, since the first run will happen during/before tuning anyway","user":"UH24GRBLL","ts":"1610669501.053400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dvJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the compilation time was never a factor for the real runs of "},{"type":"text","text":"@btime","style":{"code":true}},{"type":"text","text":" anyway, since the first run will happen during/before tuning anyway"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"9BD5EE53-0A1C-43EF-809C-75C60005AE8A","type":"message","text":"Or specifically the first run.. I guess there is the chance that each run could include some comp ","user":"U8MPCDJAY","ts":"1610669512.054100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8DA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Or specifically the first run.. I guess there is the chance that each run could include some comp "}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"BA51F2D5-72FD-44E0-8EB3-EF4E4EA4D9B8","type":"message","text":"Ah ok","user":"U8MPCDJAY","ts":"1610669526.054400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nfH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah ok"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"310fb13c-4194-497f-bc8c-523341e26267","type":"message","text":"if each run has compilation time, it's only fair to measure that as well","user":"UH24GRBLL","ts":"1610669674.055000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LvW8Y","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"if each run has compilation time, it's only fair to measure that as well"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"95E9BAE8-6EF8-438B-A96B-0BD7444304DA","type":"message","text":"Yeah","user":"U8MPCDJAY","ts":"1610669686.055300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vRgUQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah"}]}]}],"thread_ts":"1610665457.042900","parent_user_id":"U73ACR3TQ"}]