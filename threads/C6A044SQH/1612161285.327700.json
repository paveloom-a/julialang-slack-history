[{"client_msg_id":"f0830999-4d8a-4cc6-bb29-bbba7c513c9f","type":"message","text":"Setting `JULIA_HISTORY` from within Julia doesn't have an effect - the new history file is not created. Setting it as an env variable from command line does work. Is this a bug?\n```~ via C base ❯ julia --startup-file=no\n               _\n   _       _ _(_)_     |  Documentation: <https://docs.julialang.org>\n  (_)     | (_) (_)    |\n   _ _   _| |_  __ _   |  Type \"?\" for help, \"]?\" for Pkg help.\n  | | | | | | |/ _` |  |\n  | | |_| | | | (_| |  |  Version 1.6.0-beta1 (2021-01-08)\n _/ |\\__'_|_|_|\\__'_|  |  Official <https://julialang.org/> release\n|__/                   |\n\njulia&gt; ENV[\"JULIA_HISTORY\"] = \"/tmp/history.jl\"\n\"/tmp/history.jl\"\n\njulia&gt; using REPL\n\njulia&gt; REPL.find_hist_file()\n\"/tmp/history.jl\"\n\njulia&gt; 1+1\n2\n\njulia&gt;\n\n~ via C base took 28s ❯ ls /tmp | grep his\n\n~ via C base ❯```","user":"U7HAYKY9X","ts":"1612161285.327700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vjfSo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Setting "},{"type":"text","text":"JULIA_HISTORY","style":{"code":true}},{"type":"text","text":" from within Julia doesn't have an effect - the new history file is not created. Setting it as an env variable from command line does work. Is this a bug?\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"~ via C base ❯ julia --startup-file=no\n               _\n   _       _ _(_)_     |  Documentation: "},{"type":"link","url":"https://docs.julialang.org"},{"type":"text","text":"\n  (_)     | (_) (_)    |\n   _ _   _| |_  __ _   |  Type \"?\" for help, \"]?\" for Pkg help.\n  | | | | | | |/ _` |  |\n  | | |_| | | | (_| |  |  Version 1.6.0-beta1 (2021-01-08)\n _/ |\\__'_|_|_|\\__'_|  |  Official "},{"type":"link","url":"https://julialang.org/"},{"type":"text","text":" release\n|__/                   |\n\njulia> ENV[\"JULIA_HISTORY\"] = \"/tmp/history.jl\"\n\"/tmp/history.jl\"\n\njulia> using REPL\n\njulia> REPL.find_hist_file()\n\"/tmp/history.jl\"\n\njulia> 1+1\n2\n\njulia>\n\n~ via C base took 28s ❯ ls /tmp | grep his\n\n~ via C base ❯"}]}]}],"thread_ts":"1612161285.327700","reply_count":13,"reply_users_count":4,"latest_reply":"1612180421.342600","reply_users":["B01J9QZ4SP8","UH24GRBLL","U7HAYKY9X","U69LK3CRJ"],"subscribed":false},{"type":"message","subtype":"bot_message","text":"Can we cross post this publicly to <https://discourse.julialang.org|Discourse> for further visibility? React with :bridge: on the message above to approve. <https://github.com/JuliaCommunity/SlackBridge/blob/main/README.md#faq|More info here>","ts":"1612161286.327800","username":"HelpDeskBot","bot_id":"B01J9QZ4SP8","thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X","reactions":[{"name":"bridge","users":["U7HAYKY9X"],"count":1}]},{"type":"message","subtype":"bot_message","text":"Success, it has been cross posted <https://discourse.julialang.org/t/setting-julia-history-from-within-julia-doesnt-have-an-effect-the-new-history|to Discourse>. Keep and eye out on Discourse for responses and please add an answer there once you are satisfied with the solution so others can benefit as well. Happy debugging!","ts":"1612161306.328100","username":"HelpDeskBot","bot_id":"B01J9QZ4SP8","thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"93b5ca1b-750d-4b24-96f3-e6fed2961f02","type":"message","text":"I think the way it currently works is that it opens the file at REPL startup and doesn't check the `ENV` for changes","user":"UH24GRBLL","ts":"1612164127.328300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"I1I","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think the way it currently works is that it opens the file at REPL startup and doesn't check the "},{"type":"text","text":"ENV","style":{"code":true}},{"type":"text","text":" for changes"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"79f7defa-5640-47ee-9b64-68786f28e949","type":"message","text":"that's why it works when you set it on the command line but doesn't work when you set it inside the REPL","user":"UH24GRBLL","ts":"1612164144.328500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E5oyY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that's why it works when you set it on the command line but doesn't work when you set it inside the REPL"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"d2108613-9d05-45ec-a061-d382c8d774a4","type":"message","text":"does it work if you set it in `startup.jl`?","user":"UH24GRBLL","ts":"1612164156.328700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+lv5e","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"does it work if you set it in "},{"type":"text","text":"startup.jl","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"785b9655-65d8-456b-9ae1-2316950c16ec","type":"message","text":"Aha, I see. Nope, it doesn't work if I put it in the startup file","user":"U7HAYKY9X","ts":"1612164544.329000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IDcHO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Aha, I see. Nope, it doesn't work if I put it in the startup file"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"f6d3dd2e-dd93-485e-aba9-5d3f831b4fde","type":"message","text":"I'm trying to get Diary.jl to work. It works on the author's computer. Maybe it's a recent change in Julia?","user":"U7HAYKY9X","ts":"1612164581.329500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IKG0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm trying to get Diary.jl to work. It works on the author's computer. Maybe it's a recent change in Julia?"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"e6298cfb-e676-423d-8b17-59527de73fd2","type":"message","text":"what version is the author using?","user":"UH24GRBLL","ts":"1612164631.330200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xcv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what version is the author using?"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"1812096b-d4b9-4e98-986d-f121aa3841bb","type":"message","text":"No idea. Pinging <@U69LK3CRJ>","user":"U7HAYKY9X","ts":"1612164820.333300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nCHRB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No idea. Pinging "},{"type":"user","user_id":"U69LK3CRJ"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"b7d93643-a2cf-4c5d-ac2d-ebfb57ae6767","type":"message","text":"1.5.3","user":"U69LK3CRJ","ts":"1612166644.336500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6GBM9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"1.5.3"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"642689c5-e97c-471d-ab6e-8b642e26c653","type":"message","text":"It also works on older versions for me, and I've personally tested it on three different machines (all running Manjaro/Linux). However, just glancing through the REPL code in stdlib again now, and I am a bit surprised that it actually does work. It seems to only read it once. I must be missing something, though, or it wouldn't work. :sweat_smile:","user":"U69LK3CRJ","ts":"1612169087.339100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E=u","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It also works on older versions for me, and I've personally tested it on three different machines (all running Manjaro/Linux). However, just glancing through the REPL code in stdlib again now, and I am a bit surprised that it actually does work. It seems to only read it once. I must be missing something, though, or it wouldn't work. "},{"type":"emoji","name":"sweat_smile"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"b93594b1-e296-415b-8d27-654c7a850fc2","type":"message","text":"Alright, setting it in a running session actually doesn't work for me either.  Odd, fairly certain that it used to.  It does work when set in startup.jl for me, though.","user":"U69LK3CRJ","ts":"1612171709.339500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"p46ik","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Alright, setting it in a running session actually doesn't work for me either.  Odd, fairly certain that it used to.  It does work when set in startup.jl for me, though."}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"72822a80-f1b6-4109-8986-851934fcdc45","type":"message","text":"startup.jl runs before the REPL does, so that's probably why","user":"UH24GRBLL","ts":"1612180421.342600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RG7c1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"startup.jl runs before the REPL does, so that's probably why"}]}]}],"thread_ts":"1612161285.327700","parent_user_id":"U7HAYKY9X"}]