[{"client_msg_id":"2046ac8d-b274-4dc9-aa21-53a32def278d","type":"message","text":"Benchmarking question:\n<https://discourse.julialang.org/t/benchmarking-with-time-btime-and-subsequent-runs-return-shorter-execution-time/52580>","user":"UEL5R98P5","ts":"1609264092.284900","team":"T68168MUP","attachments":[{"service_name":"JuliaLang","title":"Benchmarking with @time @btime and subsequent runs return shorter execution time","title_link":"https://discourse.julialang.org/t/benchmarking-with-time-btime-and-subsequent-runs-return-shorter-execution-time/52580","text":"I am using @time and @btime macros to determine how my function preforms on different number of threads. I am mostly interested not in specific time but relative values. Threads aside, I noticed that the more times I run tests the faster the function gets. Below with @time: julia&gt; @time modeltest(mdl_init); 20.720889 seconds (214.16 M allocations: 7.629 GiB, 31.47% gc time) julia&gt; @time modeltest(mdl_init); 2.384151 seconds (174.74 M allocations: 5.730 GiB, 55.80% gc time) julia&gt; @time mode...","fallback":"JuliaLang: Benchmarking with @time @btime and subsequent runs return shorter execution time","thumb_url":"https://aws1.discourse-cdn.com/business5/uploads/julialang/original/2X/1/12829a7ba92b924d4ce81099cbf99785bee9b405.png","ts":1609264047,"from_url":"https://discourse.julialang.org/t/benchmarking-with-time-btime-and-subsequent-runs-return-shorter-execution-time/52580","thumb_width":408,"thumb_height":263,"service_icon":"https://aws1.discourse-cdn.com/business5/uploads/julialang/optimized/2X/6/6ca888e296f59ca2a599807f7d5edd489e3d1829_2_180x180.png","id":1,"original_url":"https://discourse.julialang.org/t/benchmarking-with-time-btime-and-subsequent-runs-return-shorter-execution-time/52580"}],"blocks":[{"type":"rich_text","block_id":"hZwS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Benchmarking question:\n"},{"type":"link","url":"https://discourse.julialang.org/t/benchmarking-with-time-btime-and-subsequent-runs-return-shorter-execution-time/52580"}]}]}],"thread_ts":"1609264092.284900","reply_count":9,"reply_users_count":3,"latest_reply":"1609266604.287900","reply_users":["UEN48T0BT","UEL5R98P5","U7HAYKY9X"],"subscribed":false},{"client_msg_id":"fa5630b8-4732-4f1d-bc8e-56025dbda55d","type":"message","text":"The method is compiled on the first call: <https://docs.julialang.org/en/v1/manual/performance-tips/#Measure-performance-with-[@time](@ref)-and-pay-attention-to-memory-allocation>","user":"UEN48T0BT","ts":"1609264398.285300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"52ax","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The method is compiled on the first call: "},{"type":"link","url":"https://docs.julialang.org/en/v1/manual/performance-tips/#Measure-performance-with-[@time](@ref)-and-pay-attention-to-memory-allocation"}]}]}],"thread_ts":"1609264092.284900","parent_user_id":"UEL5R98P5"},{"client_msg_id":"d43a10b3-03e1-4f7b-8bb9-bb7f72b59ede","type":"message","text":"That explains difference between first and second run. What about second and third?","user":"UEL5R98P5","ts":"1609264569.285800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ex8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That explains difference between first and second run. What about second and third?"}]}]}],"thread_ts":"1609264092.284900","parent_user_id":"UEL5R98P5"},{"client_msg_id":"152743a7-a309-4d1e-92fd-69f36d70c5db","type":"message","text":"The second and third are not far off. If `modeltest` is expensive, BenchmarkTools may be taking a sample size of 1 and it could just be expected variation","user":"UEN48T0BT","ts":"1609264905.286300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aQl+P","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The second and third are not far off. If "},{"type":"text","text":"modeltest","style":{"code":true}},{"type":"text","text":" is expensive, BenchmarkTools may be taking a sample size of 1 and it could just be expected variation"}]}]}],"thread_ts":"1609264092.284900","parent_user_id":"UEL5R98P5"},{"client_msg_id":"4be62c77-20de-4ccc-9f9d-07066e9bb95a","type":"message","text":"Yes, that's the case. Thank you","user":"UEL5R98P5","ts":"1609265047.286500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tTnq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes, that's the case. Thank you"}]}]}],"thread_ts":"1609264092.284900","parent_user_id":"UEL5R98P5","reactions":[{"name":"+1","users":["UEN48T0BT"],"count":1}]},{"client_msg_id":"67408e23-4358-4736-b71e-f049dbb80544","type":"message","text":"BTW, can I determine number of runs? sth like @btime myfunction() 10","user":"UEL5R98P5","ts":"1609265442.286700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0C+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"BTW, can I determine number of runs? sth like @btime myfunction() 10"}]}]}],"thread_ts":"1609264092.284900","parent_user_id":"UEL5R98P5"},{"client_msg_id":"e57048e2-882b-4548-afce-1555e7ddeafc","type":"message","text":"Coma is missing, it works now","user":"UEL5R98P5","ts":"1609265622.287200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Nyiim","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Coma is missing, it works now"}]}]}],"thread_ts":"1609264092.284900","parent_user_id":"UEL5R98P5"},{"client_msg_id":"a51896da-feb4-497d-837f-dd8b8e72dbd0","type":"message","text":"I think `@benchmark` gives more info: <https://github.com/JuliaCI/BenchmarkTools.jl#quick-start>","user":"UEN48T0BT","ts":"1609265638.287400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LRawV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think "},{"type":"text","text":"@benchmark","style":{"code":true}},{"type":"text","text":" gives more info: "},{"type":"link","url":"https://github.com/JuliaCI/BenchmarkTools.jl#quick-start"}]}]}],"thread_ts":"1609264092.284900","parent_user_id":"UEL5R98P5"},{"client_msg_id":"a4081652-d5ff-4715-ba01-df75e134e6b9","type":"message","text":"Also, as someone else noted in discourse, interpolating values is important for timing.","user":"UEN48T0BT","ts":"1609265680.287700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hhKL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also, as someone else noted in discourse, interpolating values is important for timing."}]}]}],"thread_ts":"1609264092.284900","parent_user_id":"UEL5R98P5"},{"client_msg_id":"6f4f4917-e297-40c8-a4c6-fc77e32e9f62","type":"message","text":"it could also be issues with file caches, CPU caches, or the branch predictor. That's hard to test though","user":"U7HAYKY9X","ts":"1609266604.287900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"utht0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it could also be issues with file caches, CPU caches, or the branch predictor. That's hard to test though"}]}]}],"thread_ts":"1609264092.284900","parent_user_id":"UEL5R98P5","reactions":[{"name":"+1","users":["UEN48T0BT"],"count":1}]}]