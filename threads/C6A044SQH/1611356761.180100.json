[{"client_msg_id":"8d802dbe-d21b-4cb9-9b48-7b00cfc0868c","type":"message","text":"Hey! Running into some issues defining a specific type dependency. I’m looking to do something like this:\n```abstract type Abstract{T} end\n\nstruct Foo{T} &lt;: Abstract{T}\n    x::T\nend```\nThis works fine, I can run `Foo(1.0)` and get a `Foo{Float64}`\nHowever, I also want to create a wrapper-type\n\n```struct Bar{T, C} &lt;: Abstract{T} where {C &lt;: Abstract{T}}\n   x::C\nend```\nDefining the struct above works fine, but errors when I try to construct it\n```julia&gt; Bar(Foo(1.0))\nERROR: MethodError: no method matching Bar(::Foo{Float64})```\nand if I try to see what constructors where defined for `Bar`, I see that\n```julia&gt; methods(Bar)\n# 0 methods for generic function \"(::Type)\":```","user":"UGKHXS9J6","ts":"1611356761.180100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RM2vz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hey! Running into some issues defining a specific type dependency. I’m looking to do something like this:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"abstract type Abstract{T} end\n\nstruct Foo{T} <: Abstract{T}\n    x::T\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nThis works fine, I can run "},{"type":"text","text":"Foo(1.0)","style":{"code":true}},{"type":"text","text":" and get a "},{"type":"text","text":"Foo{Float64}","style":{"code":true}},{"type":"text","text":"\nHowever, I also want to create a wrapper-type\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"struct Bar{T, C} <: Abstract{T} where {C <: Abstract{T}}\n   x::C\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nDefining the struct above works fine, but errors when I try to construct it\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> Bar(Foo(1.0))\nERROR: MethodError: no method matching Bar(::Foo{Float64})"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"and if I try to see what constructors where defined for "},{"type":"text","text":"Bar","style":{"code":true}},{"type":"text","text":", I see that\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> methods(Bar)\n# 0 methods for generic function \"(::Type)\":"}]}]}],"thread_ts":"1611356761.180100","reply_count":13,"reply_users_count":2,"latest_reply":"1611358768.184100","reply_users":["UH8A351DJ","UGKHXS9J6"],"subscribed":false},{"client_msg_id":"6334a95e-d846-4cb9-8438-8e01edf06cf3","type":"message","text":"in `Bar{T, C} &lt;: Abstract{T} where {C &lt;: Abstract{T}}` the information `T` is contained in `C` right? why would you need both","user":"UH8A351DJ","ts":"1611356960.180800","team":"T68168MUP","edited":{"user":"UH8A351DJ","ts":"1611356971.000000"},"blocks":[{"type":"rich_text","block_id":"HjBDG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"in "},{"type":"text","text":"Bar{T, C} <: Abstract{T} where {C <: Abstract{T}}","style":{"code":true}},{"type":"text","text":" the information "},{"type":"text","text":"T","style":{"code":true}},{"type":"text","text":" is contained in "},{"type":"text","text":"C","style":{"code":true}},{"type":"text","text":" right? why would you need both"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"aaa313eb-4bd2-4ec4-8a3e-cd770569fb0f","type":"message","text":"for example, when `x=Foo(1.0)`, `T` is `Float64` but it's already embedded in `C=Foo{Float64}`","user":"UH8A351DJ","ts":"1611357020.181100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"n6d7l","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"for example, when "},{"type":"text","text":"x=Foo(1.0)","style":{"code":true}},{"type":"text","text":", "},{"type":"text","text":"T","style":{"code":true}},{"type":"text","text":" is "},{"type":"text","text":"Float64","style":{"code":true}},{"type":"text","text":" but it's already embedded in "},{"type":"text","text":"C=Foo{Float64}","style":{"code":true}}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"647b4cef-6910-47a3-bb36-aea7946d7446","type":"message","text":"Yeah, but if you remove the `T` from `Bar`s signature, then you get another error:\n```ERROR: UndefVarError: T not defined```","user":"UGKHXS9J6","ts":"1611357125.181300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"l17L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, but if you remove the "},{"type":"text","text":"T","style":{"code":true}},{"type":"text","text":" from "},{"type":"text","text":"Bar","style":{"code":true}},{"type":"text","text":"s signature, then you get another error:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: UndefVarError: T not defined"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"325ab207-b751-4d45-a8fb-be5fb0390f4b","type":"message","text":"That was my original idea too","user":"UGKHXS9J6","ts":"1611357152.181600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jbwp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That was my original idea too"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"32eb991f-bcbe-4ebe-87ba-01ecc6a6a14b","type":"message","text":"ah I see the problem, another question then, is it reasonable for a wrapper type of `X` to be a subtype of `X`?","user":"UH8A351DJ","ts":"1611357407.181800","team":"T68168MUP","edited":{"user":"UH8A351DJ","ts":"1611357439.000000"},"blocks":[{"type":"rich_text","block_id":"26c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ah I see the problem, another question then, is it reasonable for a wrapper type of "},{"type":"text","text":"X","style":{"code":true}},{"type":"text","text":" to be a subtype of "},{"type":"text","text":"X","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"56add05c-0154-4afe-8084-74e9204f0de5","type":"message","text":"Hm, well type being wrapped is a subtype of `Abstract`, but not `Abstract` itself, right? So I feel like it should be doable.\n\nKinda like how you can have an `Adjoint` be a “wrapper” type around an `Array`  even though they both are subtypes of `AbstractArray`","user":"UGKHXS9J6","ts":"1611357615.182100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/Dm3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hm, well type being wrapped is a subtype of "},{"type":"text","text":"Abstract","style":{"code":true}},{"type":"text","text":", but not "},{"type":"text","text":"Abstract","style":{"code":true}},{"type":"text","text":" itself, right? So I feel like it should be doable.\n\nKinda like how you can have an "},{"type":"text","text":"Adjoint","style":{"code":true}},{"type":"text","text":" be a “wrapper” type around an "},{"type":"text","text":"Array","style":{"code":true}},{"type":"text","text":"  even though they both are subtypes of "},{"type":"text","text":"AbstractArray","style":{"code":true}}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"64d45980-f507-46ba-b1ad-0cea3e852878","type":"message","text":"(that example might be completely off, I know very little about the array definitions haha)","user":"UGKHXS9J6","ts":"1611357644.182300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dAk+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(that example might be completely off, I know very little about the array definitions haha)"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"b92bf163-50bb-4a1d-a2fe-de7480dcb37c","type":"message","text":"I think you're right, so, the solution to your original question is to add this constructor:\n```Bar(x::Abstract{T}) where T= Bar{T, Abstract{T}}(x)```","user":"UH8A351DJ","ts":"1611357895.182500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"urH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think you're right, so, the solution to your original question is to add this constructor:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"Bar(x::Abstract{T}) where T= Bar{T, Abstract{T}}(x)"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"63808ada-fca3-4b44-af6a-bee58560db9d","type":"message","text":"that looks like an outer constructor syntax, but will that work if there’s no inner constructor defined?","user":"UGKHXS9J6","ts":"1611358548.183300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NjnJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that looks like an outer constructor syntax, but will that work if there’s no inner constructor defined?"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"fc928833-171f-4120-b084-6f634d5bea22","type":"message","text":"ah, looks like it might!","user":"UGKHXS9J6","ts":"1611358666.183500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/Sx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ah, looks like it might!"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"2a2b7407-8894-4898-9e14-fda8570ba9f7","type":"message","text":"the default inner constructor is always `Bar{C, T}(x) = new{C, T}(x)`","user":"UH8A351DJ","ts":"1611358694.183700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1/i=Z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the default inner constructor is always "},{"type":"text","text":"Bar{C, T}(x) = new{C, T}(x)","style":{"code":true}}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"4b9254c8-ea7e-4440-bd0e-64d9130b8130","type":"message","text":"gotcha, I thought it got nuked somehow since running `methods(Bar)` returned 0 methods and I couldn’t construct anything with the default constructor","user":"UGKHXS9J6","ts":"1611358762.183900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dEm9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"gotcha, I thought it got nuked somehow since running "},{"type":"text","text":"methods(Bar)","style":{"code":true}},{"type":"text","text":" returned 0 methods and I couldn’t construct anything with the default constructor"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"},{"client_msg_id":"b2e3ee01-2ff2-4456-a926-6b4a0c4ce4a3","type":"message","text":"but your solution worked, thank you!","user":"UGKHXS9J6","ts":"1611358768.184100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Q+4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but your solution worked, thank you!"}]}]}],"thread_ts":"1611356761.180100","parent_user_id":"UGKHXS9J6"}]