[{"type":"message","text":"Why does defining a new function impact the scope of variable `sum`?","files":[{"id":"F01T0JY5R9Q","created":1617239900,"timestamp":1617239900,"name":"Untitled.jpg","title":"Untitled.jpg","mimetype":"image/jpeg","filetype":"jpg","pretty_type":"JPEG","user":"U01HNPYMZ4M","editable":false,"size":23590,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01T0JY5R9Q/untitled.jpg","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01T0JY5R9Q/download/untitled.jpg","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01T0JY5R9Q-bbc1a1f5d6/untitled_64.jpg","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01T0JY5R9Q-bbc1a1f5d6/untitled_80.jpg","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01T0JY5R9Q-bbc1a1f5d6/untitled_360.jpg","thumb_360_w":360,"thumb_360_h":244,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01T0JY5R9Q-bbc1a1f5d6/untitled_160.jpg","original_w":430,"original_h":292,"thumb_tiny":"AwAgADDRIyM7iPpTflDYLtn0p46UhbH3uKAG7lIwHb1zQGViQHbpT80tAEZ2qRl2pwdTjB606igBB0oIzQOlIcsOOPrSAO+KAecH+VOopgFFFFID/9k=","permalink":"https://julialang.slack.com/files/U01HNPYMZ4M/F01T0JY5R9Q/untitled.jpg","permalink_public":"https://slack-files.com/T68168MUP-F01T0JY5R9Q-b097aa6b57","is_starred":false,"has_rich_preview":false}],"upload":false,"blocks":[{"type":"rich_text","block_id":"m37","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Why does defining a new function impact the scope of variable "},{"type":"text","text":"sum","style":{"code":true}},{"type":"text","text":"?"}]}]}],"user":"U01HNPYMZ4M","display_as_bot":false,"ts":"1617239923.163400","thread_ts":"1617239923.163400","reply_count":23,"reply_users_count":5,"latest_reply":"1617260714.177900","reply_users":["UM8JUNJG7","UDB26738Q","UB197FRCL","UPUBAM63X","U6BNE7LTZ"],"is_locked":false,"subscribed":false,"reactions":[{"name":"man-shrugging","users":["UB197FRCL","U7WB5HSBH"],"count":2}]},{"client_msg_id":"e9075330-5cce-4b99-bdd4-9fb6d530a8ec","type":"message","text":"that might be specific to pluto, running that exact code in repl returned 10","user":"UM8JUNJG7","ts":"1617240584.164200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LbYf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that might be specific to pluto, running that exact code in repl returned 10"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M","reactions":[{"name":"+1","users":["UB197FRCL"],"count":1}]},{"client_msg_id":"23663828-e60e-4c3e-979c-e57ce72aea70","type":"message","text":"What version of Julia are you using?","user":"UDB26738Q","ts":"1617240631.164400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UEvln","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What version of Julia are you using?"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"c4f99412-15ed-403e-a686-91122185ad10","type":"message","text":"I tried it in Pluto with Julia v1.6 and got the same error. It's actually pretty odd, since `f` actually gets defined even if the cell throws. And changing the definition of `f` works (with other cells reacting).","user":"UB197FRCL","ts":"1617240711.164600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ukk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I tried it in Pluto with Julia v1.6 and got the same error. It's actually pretty odd, since "},{"type":"text","text":"f","style":{"code":true}},{"type":"text","text":" actually gets defined even if the cell throws. And changing the definition of "},{"type":"text","text":"f","style":{"code":true}},{"type":"text","text":" works (with other cells reacting)."}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"type":"message","text":"","files":[{"id":"F01TD8CC56D","created":1617240822,"timestamp":1617240822,"name":"pluto_sum_not_defined.gif","title":"pluto_sum_not_defined.gif","mimetype":"image/gif","filetype":"gif","pretty_type":"GIF","user":"UB197FRCL","editable":false,"size":304540,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01TD8CC56D/pluto_sum_not_defined.gif","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01TD8CC56D/download/pluto_sum_not_defined.gif","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01TD8CC56D-0feaff2dea/pluto_sum_not_defined_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01TD8CC56D-0feaff2dea/pluto_sum_not_defined_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01TD8CC56D-0feaff2dea/pluto_sum_not_defined_360.png","thumb_360_w":322,"thumb_360_h":272,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01TD8CC56D-0feaff2dea/pluto_sum_not_defined_160.png","thumb_360_gif":"https://files.slack.com/files-tmb/T68168MUP-F01TD8CC56D-0feaff2dea/pluto_sum_not_defined_360.gif","original_w":322,"original_h":272,"deanimate":"https://files.slack.com/files-tmb/T68168MUP-F01TD8CC56D-0feaff2dea/pluto_sum_not_defined_deanimate.png","deanimate_gif":"https://files.slack.com/files-tmb/T68168MUP-F01TD8CC56D-0feaff2dea/pluto_sum_not_defined_deanimate_gif.png","thumb_tiny":"AwAoADDRK5wcsPoabwM8ycfWn9uKTJBwefpQA0kYHL8e1LgFc5fnmnA0tAEakbur/j0qQHIzRRQAg6Uhxn3pecUY7nrQAnIBOPwpVJIGQfxpaKACiiigBKAfbFLRQAUUUUAFFFFAH//Z","permalink":"https://julialang.slack.com/files/UB197FRCL/F01TD8CC56D/pluto_sum_not_defined.gif","permalink_public":"https://slack-files.com/T68168MUP-F01TD8CC56D-a1e2069f96","is_starred":false,"has_rich_preview":false}],"upload":false,"user":"UB197FRCL","display_as_bot":false,"ts":"1617240825.164800","thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"b49ac442-0c82-4793-8866-ec15312e80f4","type":"message","text":"weird... is it just because sum is a base function name as well? what happens if you rename it to `s`?","user":"UPUBAM63X","ts":"1617240873.165100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xxxy3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"weird... is it just because sum is a base function name as well? what happens if you rename it to "},{"type":"text","text":"s","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"e9790728-3017-45e1-92b2-5740a30cc21e","type":"message","text":"adding `global` to the `sum = sum + 1` line removes the error","user":"UB197FRCL","ts":"1617240894.165300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BWYt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"adding "},{"type":"text","text":"global","style":{"code":true}},{"type":"text","text":" to the "},{"type":"text","text":"sum = sum + 1","style":{"code":true}},{"type":"text","text":" line removes the error"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M","reactions":[{"name":"+1","users":["UPUBAM63X","U01HNPYMZ4M"],"count":2}]},{"client_msg_id":"e719f5bd-8eaf-4cdf-8f35-2be0d97e0336","type":"message","text":"No, I tried calling it `foo` too and same error","user":"UB197FRCL","ts":"1617240922.165600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"znM3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No, I tried calling it "},{"type":"text","text":"foo","style":{"code":true}},{"type":"text","text":" too and same error"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"de96fc74-786c-4f8c-9b2f-a96861110445","type":"message","text":"I think this might be worth an issue on Pluto.jl?","user":"UB197FRCL","ts":"1617240935.165800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qfy7F","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think this might be worth an issue on Pluto.jl?"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"876d0e43-3315-4125-a7ec-7cd3e34c8eea","type":"message","text":"(Maybe it's a known thing there too)","user":"UB197FRCL","ts":"1617240950.166000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wL7S=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(Maybe it's a known thing there too)"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"de8a0bb2-bfda-4ad3-8707-f8a90f049542","type":"message","text":"I don't see how defining a function would affect anything, but having to use `global` is expected","user":"UDB26738Q","ts":"1617240998.166200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"54odj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don't see how defining a function would affect anything, but having to use "},{"type":"text","text":"global","style":{"code":true}},{"type":"text","text":" is expected"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M","reactions":[{"name":"+1","users":["UB197FRCL"],"count":1}]},{"type":"message","text":"","files":[{"id":"F01T6QS16G4","created":1617241142,"timestamp":1617241142,"name":"foo_not_defined_f.gif","title":"foo_not_defined_f.gif","mimetype":"image/gif","filetype":"gif","pretty_type":"GIF","user":"UB197FRCL","editable":false,"size":891002,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01T6QS16G4/foo_not_defined_f.gif","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01T6QS16G4/download/foo_not_defined_f.gif","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01T6QS16G4-949cc871a9/foo_not_defined_f_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01T6QS16G4-949cc871a9/foo_not_defined_f_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01T6QS16G4-949cc871a9/foo_not_defined_f_360.png","thumb_360_w":322,"thumb_360_h":272,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01T6QS16G4-949cc871a9/foo_not_defined_f_160.png","thumb_360_gif":"https://files.slack.com/files-tmb/T68168MUP-F01T6QS16G4-949cc871a9/foo_not_defined_f_360.gif","original_w":322,"original_h":272,"deanimate":"https://files.slack.com/files-tmb/T68168MUP-F01T6QS16G4-949cc871a9/foo_not_defined_f_deanimate.png","deanimate_gif":"https://files.slack.com/files-tmb/T68168MUP-F01T6QS16G4-949cc871a9/foo_not_defined_f_deanimate_gif.png","thumb_tiny":"AwAoADDQK8k7m/A0mRj7z/kaec9qAexoAYSAckt09KUgADLPxTwc0UARqwGeWP1FSUUUAFNOMnHJ9KU57UAc55oATBxx1p1FFABRRRQAnT1NLRRQAUUUUAFFFFAH/9k=","permalink":"https://julialang.slack.com/files/UB197FRCL/F01T6QS16G4/foo_not_defined_f.gif","permalink_public":"https://slack-files.com/T68168MUP-F01T6QS16G4-c0b7b04481","is_starred":false,"has_rich_preview":false}],"upload":false,"user":"UB197FRCL","display_as_bot":false,"ts":"1617241164.168500","thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"3f7fd2dc-d937-4e1d-8ee5-c612bad89f80","type":"message","text":"(Sorry I pasted the wrong gif so deleted my previous message)","user":"UB197FRCL","ts":"1617241201.168900","team":"T68168MUP","edited":{"user":"UB197FRCL","ts":"1617241208.000000"},"blocks":[{"type":"rich_text","block_id":"iN7/n","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(Sorry I pasted the wrong gif so deleted my previous message)"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"af074029-3795-494e-af75-a63538af9710","type":"message","text":"ooo that's a weird one... Yea that's issue worthy","user":"UPUBAM63X","ts":"1617241241.169300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Gsb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ooo that's a weird one... Yea that's issue worthy"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"288c6de1-0c35-4604-aa5a-f6419670e535","type":"message","text":"Yes, what's odd is the function `f` affecting that. I just wanted to mention that adding `global` removes that odd behavior","user":"UB197FRCL","ts":"1617241267.169500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vYP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes, what's odd is the function "},{"type":"text","text":"f","style":{"code":true}},{"type":"text","text":" affecting that. I just wanted to mention that adding "},{"type":"text","text":"global","style":{"code":true}},{"type":"text","text":" removes that odd behavior"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M","reactions":[{"name":"+1","users":["U01HNPYMZ4M"],"count":1}]},{"client_msg_id":"a1d50d11-02f0-4753-80a7-df7946fc9052","type":"message","text":"bad take is that for loop going into the function scope :O","user":"UPUBAM63X","ts":"1617241282.169700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+K1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"bad take is that for loop going into the function scope :O"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"f3718469-3e8c-4114-90ad-45e3032f04e8","type":"message","text":"maybe try f(x,sum) = 0...","user":"UPUBAM63X","ts":"1617241370.170000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Opb3Q","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"maybe try f(x,sum) = 0..."}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"type":"message","text":"Nope, does not help","files":[{"id":"F01TD8W2VJ5","created":1617241468,"timestamp":1617241468,"name":"Screen Shot 2021-04-01 at 12.44.24 pm.png","title":"Screen Shot 2021-04-01 at 12.44.24 pm.png","mimetype":"image/png","filetype":"png","pretty_type":"PNG","user":"UB197FRCL","editable":false,"size":50827,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01TD8W2VJ5/screen_shot_2021-04-01_at_12.44.24_pm.png","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01TD8W2VJ5/download/screen_shot_2021-04-01_at_12.44.24_pm.png","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01TD8W2VJ5-cd323af338/screen_shot_2021-04-01_at_12.44.24_pm_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01TD8W2VJ5-cd323af338/screen_shot_2021-04-01_at_12.44.24_pm_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01TD8W2VJ5-cd323af338/screen_shot_2021-04-01_at_12.44.24_pm_360.png","thumb_360_w":360,"thumb_360_h":341,"thumb_480":"https://files.slack.com/files-tmb/T68168MUP-F01TD8W2VJ5-cd323af338/screen_shot_2021-04-01_at_12.44.24_pm_480.png","thumb_480_w":480,"thumb_480_h":455,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01TD8W2VJ5-cd323af338/screen_shot_2021-04-01_at_12.44.24_pm_160.png","original_w":576,"original_h":546,"thumb_tiny":"AwAtADDQK5wd7D6U3Kgkea2R2zUg+7SbufmwKBjQyFT+8J989KAynpKTt60/I9qWgREdqnmVgffFPV1wAGznofWlxRQADoKRgTilHSkOTjbz+NIY0Hnr+tKpyTz+tPopiCiiikAmecYNLSY4xRj3NMBaKKKACiiigD//2Q==","permalink":"https://julialang.slack.com/files/UB197FRCL/F01TD8W2VJ5/screen_shot_2021-04-01_at_12.44.24_pm.png","permalink_public":"https://slack-files.com/T68168MUP-F01TD8W2VJ5-056082b9f9","is_starred":false,"has_rich_preview":false}],"upload":false,"blocks":[{"type":"rich_text","block_id":"s+M","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Nope, does not help"}]}]}],"user":"UB197FRCL","display_as_bot":false,"ts":"1617241476.170200","thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"44c2af7f-a4a4-4d68-b17a-171177adbac1","type":"message","text":"okay whew","user":"UPUBAM63X","ts":"1617241484.170400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WPD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"okay whew"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"140da8ba-2ae7-4ddc-ab9a-bc713e8d642c","type":"message","text":"Also worth mentioning the REPL shows a scope warning when I run the Pluto cell that errors (but still runs partly and defines `f`):\n```┌ Warning: Assignment to `foo` in soft scope is ambiguous because a global variable by the same name exists: `foo` will be treated as a new local. Disambiguate by using `local foo` to suppress this warning or `global foo` to assign to the existing global variable.```","user":"UB197FRCL","ts":"1617241569.170800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"mPod","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also worth mentioning the REPL shows a scope warning when I run the Pluto cell that errors (but still runs partly and defines "},{"type":"text","text":"f","style":{"code":true}},{"type":"text","text":"):\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"┌ Warning: Assignment to `foo` in soft scope is ambiguous because a global variable by the same name exists: `foo` will be treated as a new local. Disambiguate by using `local foo` to suppress this warning or `global foo` to assign to the existing global variable."}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"87841a8b-08f8-46e2-a1dc-d39bf0b5ab32","type":"message","text":"this probably happens because pluto wraps cells in a function if it can show that's legal. Which it isn't when defining a new toplevel function","user":"U6BNE7LTZ","ts":"1617258817.176700","team":"T68168MUP","edited":{"user":"U6BNE7LTZ","ts":"1617258841.000000"},"blocks":[{"type":"rich_text","block_id":"VkCqc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"this probably happens because pluto wraps cells in a function if it can show that's legal. Which it isn't when defining a new toplevel function"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M","reactions":[{"name":"+1","users":["UB197FRCL"],"count":1}]},{"client_msg_id":"a5c36bfa-0294-4973-b882-412a0d109735","type":"message","text":"That sounds right","user":"UB197FRCL","ts":"1617259551.177400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vc=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That sounds right"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"e4537fdb-0c1a-48f1-b329-f43f832e3884","type":"message","text":"So when you define a function inside a cell, the cell is not wrapped anymore and then you have to say that `foo` is global. Did I get that correctly?","user":"UB197FRCL","ts":"1617259603.177700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jYluN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So when you define a function inside a cell, the cell is not wrapped anymore and then you have to say that "},{"type":"text","text":"foo","style":{"code":true}},{"type":"text","text":" is global. Did I get that correctly?"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"},{"client_msg_id":"36bb0963-8765-47c7-b4de-b93f2d3bb448","type":"message","text":"yes I think so","user":"U6BNE7LTZ","ts":"1617260714.177900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"60kw/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes I think so"}]}]}],"thread_ts":"1617239923.163400","parent_user_id":"U01HNPYMZ4M"}]