[{"client_msg_id":"a5d95f20-c4e5-4817-84fe-18f6acc44f19","type":"message","text":"Hey guys, I'm trying to plot the rastrigin function(given below) through plots.jl. It takes in a vector input (a x coordinate and y coordinate) . According to a <https://discourse.julialang.org/t/plotting-a-3d-surface/17143|Discourse post>, all I could come up with is this :\n\n```using Plots; pyplot()\nx=range(-5.12,stop=5.12,length=100)\ny=range(-5.12,stop=5.12,length=100)\nf(x,y) = 20 + x^2 + y^2 -10*cos(2*π*x) - 10*cos(2*π*y)\nplot(x,y,f,st=:surface,camera=(-30,30)) ```\nAlthough this gives me the right plot, I'm having to hardcode it, which is a pain. Could anyone please help me by suggesting a way that doesn't involve hardcoding the function? (ie, a method where the rastrigin function takes in a vector and spits out a number to plot, instead of taking 2 separate variables as a input)\n```function rastrigin(x::Vector{T}) where {T &lt;: Real}\n    return 10 * size(x)[1] + sum(@. x^2 - 10 * cos(2*π*x))\nend```","user":"U017D621ELC","ts":"1616096832.118400","team":"T68168MUP","edited":{"user":"U017D621ELC","ts":"1616097085.000000"},"attachments":[{"service_name":"JuliaLang","title":"Plotting a 3D Surface","title_link":"https://discourse.julialang.org/t/plotting-a-3d-surface/17143","text":"How would I plot the surface f(x,y)=xy-y-x+1 between \\sqrt2\\leq y\\leq2 using PyPlot; x = collect(Float16, range(-2,length=100,stop=2)); y = collect(Float16, range(sqrt(2),length=100, stop=2)); z = (x.*y).-y.-x.+1; surf(x,y,z);","fallback":"JuliaLang: Plotting a 3D Surface","thumb_url":"https://aws1.discourse-cdn.com/business5/uploads/julialang/original/2X/9/95b3da98ba6277dbc8cceb2385e6805aa6bd503c.png","fields":[{"title":"Reading time","value":"4 mins :clock2:","short":true},{"title":"Likes","value":"24 :heart:","short":true}],"ts":1541359416,"from_url":"https://discourse.julialang.org/t/plotting-a-3d-surface/17143","thumb_width":640,"thumb_height":480,"service_icon":"https://aws1.discourse-cdn.com/business5/uploads/julialang/optimized/2X/6/6ca888e296f59ca2a599807f7d5edd489e3d1829_2_180x180.png","id":1,"original_url":"https://discourse.julialang.org/t/plotting-a-3d-surface/17143"}],"blocks":[{"type":"rich_text","block_id":"kIv4k","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hey guys, I'm trying to plot the rastrigin function(given below) through plots.jl. It takes in a vector input (a x coordinate and y coordinate) . According to a "},{"type":"link","url":"https://discourse.julialang.org/t/plotting-a-3d-surface/17143","text":"Discourse post"},{"type":"text","text":", all I could come up with is this :\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"using Plots; pyplot()\nx=range(-5.12,stop=5.12,length=100)\ny=range(-5.12,stop=5.12,length=100)\nf(x,y) = 20 + x^2 + y^2 -10*cos(2*π*x) - 10*cos(2*π*y)\nplot(x,y,f,st=:surface,camera=(-30,30)) "}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Although this gives me the right plot, I'm having to hardcode it, which is a pain. Could anyone please help me by suggesting a way that doesn't involve hardcoding the function? (ie, a method where the rastrigin function takes in a vector and spits out a number to plot, instead of taking 2 separate variables as a input)\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function rastrigin(x::Vector{T}) where {T <: Real}\n    return 10 * size(x)[1] + sum(@. x^2 - 10 * cos(2*π*x))\nend"}]}]}],"thread_ts":"1616096832.118400","reply_count":9,"reply_users_count":3,"latest_reply":"1616154673.171600","reply_users":["B01J9QZ4SP8","U67G3QRJM","U017D621ELC"],"subscribed":false},{"type":"message","subtype":"bot_message","text":"Can we cross post this publicly to <https://discourse.julialang.org|Discourse> for further visibility? React with :bridge: on the message above to approve. <https://github.com/JuliaCommunity/SlackBridge/blob/main/README.md#faq|More info here>","ts":"1616096834.118500","username":"HelpDeskBot","bot_id":"B01J9QZ4SP8","thread_ts":"1616096832.118400","parent_user_id":"U017D621ELC"},{"client_msg_id":"754af0d4-f9b5-4dc2-9cf2-e5a83371de9c","type":"message","text":"Once you have defined your `rastrigin` function taking a vector, define another method as","user":"U67G3QRJM","ts":"1616137108.147900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IB+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Once you have defined your "},{"type":"text","text":"rastrigin","style":{"code":true}},{"type":"text","text":" function taking a vector, define another method as"}]}]}],"thread_ts":"1616096832.118400","parent_user_id":"U017D621ELC"},{"client_msg_id":"cc0bea95-0a85-4979-bf16-3f75cfde1b63","type":"message","text":"```rastrigin(x, y) = rastrigin([x, y])```","user":"U67G3QRJM","ts":"1616137125.148300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9Kc","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"rastrigin(x, y) = rastrigin([x, y])"}]}]}],"thread_ts":"1616096832.118400","parent_user_id":"U017D621ELC","reactions":[{"name":"+1","users":["U017D621ELC"],"count":1}]},{"client_msg_id":"c9f7965a-f7e8-4beb-a0fb-e9453ffda1a3","type":"message","text":"<@U017D621ELC> ^","user":"U67G3QRJM","ts":"1616137132.148500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1Hb7","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U017D621ELC"},{"type":"text","text":" ^"}]}]}],"thread_ts":"1616096832.118400","parent_user_id":"U017D621ELC"},{"client_msg_id":"4777d301-69e5-4f42-8b25-7a0b965f870c","type":"message","text":"Also you might like the `plotly()` backend, since it will allow you to rotate the 3D plot","user":"U67G3QRJM","ts":"1616137164.148900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"mAPU+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also you might like the "},{"type":"text","text":"plotly()","style":{"code":true}},{"type":"text","text":" backend, since it will allow you to rotate the 3D plot"}]}]}],"thread_ts":"1616096832.118400","parent_user_id":"U017D621ELC","reactions":[{"name":"heart","users":["U017D621ELC"],"count":1}]},{"client_msg_id":"cb1458a5-0383-4859-9420-9d9a6e1a854b","type":"message","text":"And you can just do `surface(x, y, f)`","user":"U67G3QRJM","ts":"1616137187.149200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6auC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And you can just do "},{"type":"text","text":"surface(x, y, f)","style":{"code":true}}]}]}],"thread_ts":"1616096832.118400","parent_user_id":"U017D621ELC","reactions":[{"name":"+1","users":["U017D621ELC"],"count":1}]},{"client_msg_id":"6562152f-9dc9-47da-8dca-e6d12756029e","type":"message","text":"Thanks for the help <@U67G3QRJM>!","user":"U017D621ELC","ts":"1616146250.161800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"945","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks for the help "},{"type":"user","user_id":"U67G3QRJM"},{"type":"text","text":"!"}]}]}],"thread_ts":"1616096832.118400","parent_user_id":"U017D621ELC"},{"client_msg_id":"d6a3e63b-39da-49c2-8d2a-88b2002ed69f","type":"message","text":"I tried it to code it up your way, and it works perfectly! I had one more question though, using a function call like `rastrigin(x, y) = rastrigin([x, y])`  leads to the compiler allocating `[x, y]` on the heap. Is there anyway according to you that bypasses this?\nIn the worst case, I could add StaticArrays to mitigate this, but I don't want to add a dependency just for this :sweat_smile:\nThanks again for the solution <@U67G3QRJM>","user":"U017D621ELC","ts":"1616152626.169200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Syw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I tried it to code it up your way, and it works perfectly! I had one more question though, using a function call like "},{"type":"text","text":"rastrigin(x, y) = rastrigin([x, y])","style":{"code":true}},{"type":"text","text":"  leads to the compiler allocating "},{"type":"text","text":"[x, y]","style":{"code":true}},{"type":"text","text":" on the heap. Is there anyway according to you that bypasses this?\nIn the worst case, I could add StaticArrays to mitigate this, but I don't want to add a dependency just for this "},{"type":"emoji","name":"sweat_smile"},{"type":"text","text":"\nThanks again for the solution "},{"type":"user","user_id":"U67G3QRJM"}]}]}],"thread_ts":"1616096832.118400","parent_user_id":"U017D621ELC"},{"client_msg_id":"b9b56379-0707-44a3-bba1-6ab9cf357bda","type":"message","text":"As an example, please have a look at the code block below:\n```julia&gt; rastrigin(x, y) = rastrigin([x, y])\nrastrigin (generic function with 2 methods)\n\njulia&gt; using Plots, BenchmarkTools\n\njulia&gt; plotly();\n\njulia&gt; x = y =  range(-5.12, stop=5.12, length=100);\n\njulia&gt; f(x,y) = 20 + x^2 + y^2 -10*cos(2*π*x) - 10*cos(2*π*y) \nf (generic function with 1 method)\n\njulia&gt; @btime surface(x, y, f)\n  761.244 μs (2869 allocations: 355.27 KiB)\n\njulia&gt; @btime surface(x, y, rastrigin)\n  1.347 ms (22869 allocations: 2.18 MiB)```\nThere's almost a 2x difference while plotting, and a ton of memory use difference. Any help is very much appreciated","user":"U017D621ELC","ts":"1616154673.171600","team":"T68168MUP","edited":{"user":"U017D621ELC","ts":"1616154890.000000"},"blocks":[{"type":"rich_text","block_id":"8WA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"As an example, please have a look at the code block below:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> rastrigin(x, y) = rastrigin([x, y])\nrastrigin (generic function with 2 methods)\n\njulia> using Plots, BenchmarkTools\n\njulia> plotly();\n\njulia> x = y =  range(-5.12, stop=5.12, length=100);\n\njulia> f(x,y) = 20 + x^2 + y^2 -10*cos(2*π*x) - 10*cos(2*π*y) \nf (generic function with 1 method)\n\njulia> @btime surface(x, y, f)\n  761.244 μs (2869 allocations: 355.27 KiB)\n\njulia> @btime surface(x, y, rastrigin)\n  1.347 ms (22869 allocations: 2.18 MiB)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"There's almost a 2x difference while plotting, and a ton of memory use difference. Any help is very much appreciated"}]}]}],"thread_ts":"1616096832.118400","parent_user_id":"U017D621ELC"}]