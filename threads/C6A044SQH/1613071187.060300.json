[{"client_msg_id":"947f0df2-bfe9-4786-a7e2-20e386673be3","type":"message","text":"Hi all, been struggling with this issue\n\nI currently have a dataframe consisting of 3 assets and a timestamp\n\nI've been trying to get the compound growth of each of the assets but it's coming back incorrect (asset increases in value and compound growth returns less than 1x)\n\nis anyone able to see where i'm going wrong?\n\nattaching the main code:\n```prices = assets[:, x]\nprintln(string(x)*\": start - \"*string(assets[:1, x])*\", end - \"*string(last(assets, 1)[:1, x]))\ndates = assets[:, 1]\n\ndf[:, x] = diff(log.(assets[:, x]))\n\ncumulativeprod = (cumprod(df[:, x] .+ 1))\n\ncompound_growth = prod(df[:, x] .+ 1)\nprintln(string(x)*\": compound growth - \" * string(compound_growth))\n\nn_periods = size(assets, 1)\nannual_return = (compound_growth^(periods_per_year/n_periods)-1)*100\nar[:, x] = [annual_return]```\nand what the println's are returning:\n```brka: start - 120450.0, end - 197800.0\nbrka: compound growth - 1.5245186742783305\nbrkb: start - 80.11, end - 132.04\nbrkb: compound growth - 1.5150777648833422\ngme: start - 22.88, end - 28.04\ngme: compound growth - 0.847837471902966\n1×3 DataFrame\n Row │ brka     brkb     gme      \n     │ Float64  Float64  Float64  \n─────┼────────────────────────────\n   1 │  8.8067   8.6715  -3.24996```","user":"U01MWCV0Y5A","ts":"1613071187.060300","team":"T68168MUP","edited":{"user":"U01MWCV0Y5A","ts":"1613071270.000000"},"blocks":[{"type":"rich_text","block_id":"30j","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi all, been struggling with this issue\n\nI currently have a dataframe consisting of 3 assets and a timestamp\n\nI've been trying to get the compound growth of each of the assets but it's coming back incorrect (asset increases in value and compound growth returns less than 1x)\n\nis anyone able to see where i'm going wrong?\n\nattaching the main code:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"prices = assets[:, x]\nprintln(string(x)*\": start - \"*string(assets[:1, x])*\", end - \"*string(last(assets, 1)[:1, x]))\ndates = assets[:, 1]\n\ndf[:, x] = diff(log.(assets[:, x]))\n\ncumulativeprod = (cumprod(df[:, x] .+ 1))\n\ncompound_growth = prod(df[:, x] .+ 1)\nprintln(string(x)*\": compound growth - \" * string(compound_growth))\n\nn_periods = size(assets, 1)\nannual_return = (compound_growth^(periods_per_year/n_periods)-1)*100\nar[:, x] = [annual_return]"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"and what the println's are returning:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"brka: start - 120450.0, end - 197800.0\nbrka: compound growth - 1.5245186742783305\nbrkb: start - 80.11, end - 132.04\nbrkb: compound growth - 1.5150777648833422\ngme: start - 22.88, end - 28.04\ngme: compound growth - 0.847837471902966\n1×3 DataFrame\n Row │ brka     brkb     gme      \n     │ Float64  Float64  Float64  \n─────┼────────────────────────────\n   1 │  8.8067   8.6715  -3.24996"}]}]}],"thread_ts":"1613071187.060300","reply_count":3,"reply_users_count":3,"latest_reply":"1613137633.151400","reply_users":["B01J9QZ4SP8","U68QW0PUZ","U01MWCV0Y5A"],"subscribed":false},{"type":"message","subtype":"bot_message","text":"Can we cross post this publicly to <https://discourse.julialang.org|Discourse> for further visibility? React with :bridge: on the message above to approve. <https://github.com/JuliaCommunity/SlackBridge/blob/main/README.md#faq|More info here>","ts":"1613071189.060400","username":"HelpDeskBot","bot_id":"B01J9QZ4SP8","thread_ts":"1613071187.060300","parent_user_id":"U01MWCV0Y5A"},{"client_msg_id":"be5be550-c646-469f-bca0-93dcd448ff38","type":"message","text":"Without seeing your data and how you constructed the DataFrame,\nI cannot tell you why one asset reports differently than the other two.\nHere is similar code that appears to work properly with simulated data.\nIf you encounter the same problem, then it is either about specifics of the data, or you have expressed the formulae for compound return incorrectly.\n\n```\n\nusing Dates, Tables, DataFrames\n\nperiods_per_year = 12\n\nround2(x) = round(x, digits=2, base=10)\n\nramp   = collect(1.0:0.1:4.0);\nwave   = map(x-&gt;x/(2pi), ramp);\ndates  = map(ith-&gt;Date(\"2010-01-01\") + Day(ith+rand(1:5)), 1:length(ramp));\nddates = map(x-&gt;Float64(x.value), diff(dates));\n\n\n# simulate assets steadily increasing in value\nasset_a = map((ramp, wave)-&gt;ramp + sin(wave), ramp, wave);\nasset_b = map((ramp, wave)-&gt;5*ramp - 2*cos(wave), ramp, wave);\nasset_c = map((ramp, wave)-&gt;10*ramp - 10*abs(cos(wave)), ramp, wave);\n\nassets = DataFrame(  a=asset_a, b=asset_b, c=asset_c );\n\ndf = zeros(length(asset_a)-1, 3);\n\nfor x=1:3\n  println();\n\n  prices = assets[:, x];\n  n_periods = length(prices)\n\n  df[:, x] = diff(log.(assets[:, x]))\n\n  cumulativeprod = cumprod(df[:, x] .+ 1)\n  compound_growth = prod(df[:, x] .+ 1)\n  annual_return = (compound_growth^(periods_per_year/n_periods)-1)*100\n\n  start  = round2(assets[:1, x])\n  finish = round2(assets[end, x])\n  growth = round2(compound_growth)\n  annual = round2(annual_return)\n  \n  msg = string(\"asset #\",x,\":\",\n               \"   start = \",start,\n               \"   end = \", finish,\n               \"   growth = \", growth,\n               \"   annual= \", annual)\n  println(msg)\nend```","user":"U68QW0PUZ","ts":"1613116860.121900","team":"T68168MUP","edited":{"user":"U68QW0PUZ","ts":"1613117045.000000"},"blocks":[{"type":"rich_text","block_id":"2=jk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Without seeing your data and how you constructed the DataFrame,\nI cannot tell you why one asset reports differently than the other two.\nHere is similar code that appears to work properly with simulated data.\nIf you encounter the same problem, then it is either about specifics of the data, or you have expressed the formulae for compound return incorrectly.\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"\n\nusing Dates, Tables, DataFrames\n\nperiods_per_year = 12\n\nround2(x) = round(x, digits=2, base=10)\n\nramp   = collect(1.0:0.1:4.0);\nwave   = map(x->x/(2pi), ramp);\ndates  = map(ith->Date(\"2010-01-01\") + Day(ith+rand(1:5)), 1:length(ramp));\nddates = map(x->Float64(x.value), diff(dates));\n\n\n# simulate assets steadily increasing in value\nasset_a = map((ramp, wave)->ramp + sin(wave), ramp, wave);\nasset_b = map((ramp, wave)->5*ramp - 2*cos(wave), ramp, wave);\nasset_c = map((ramp, wave)->10*ramp - 10*abs(cos(wave)), ramp, wave);\n\nassets = DataFrame(  a=asset_a, b=asset_b, c=asset_c );\n\ndf = zeros(length(asset_a)-1, 3);\n\nfor x=1:3\n  println();\n\n  prices = assets[:, x];\n  n_periods = length(prices)\n\n  df[:, x] = diff(log.(assets[:, x]))\n\n  cumulativeprod = cumprod(df[:, x] .+ 1)\n  compound_growth = prod(df[:, x] .+ 1)\n  annual_return = (compound_growth^(periods_per_year/n_periods)-1)*100\n\n  start  = round2(assets[:1, x])\n  finish = round2(assets[end, x])\n  growth = round2(compound_growth)\n  annual = round2(annual_return)\n  \n  msg = string(\"asset #\",x,\":\",\n               \"   start = \",start,\n               \"   end = \", finish,\n               \"   growth = \", growth,\n               \"   annual= \", annual)\n  println(msg)\nend"}]}]}],"thread_ts":"1613071187.060300","parent_user_id":"U01MWCV0Y5A"},{"client_msg_id":"5ea0de5b-04e0-4df8-8909-8e5d57256875","type":"message","text":"<@U68QW0PUZ> thankyou for this! It turned out the `diff(log.(assets[:, x]))` line wasn't doing what i thought it was doing, the difference between percentage change and percentage difference was throwing me off","user":"U01MWCV0Y5A","ts":"1613137633.151400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QqtF","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U68QW0PUZ"},{"type":"text","text":" thankyou for this! It turned out the "},{"type":"text","text":"diff(log.(assets[:, x]))","style":{"code":true}},{"type":"text","text":" line wasn't doing what i thought it was doing, the difference between percentage change and percentage difference was throwing me off"}]}]}],"thread_ts":"1613071187.060300","parent_user_id":"U01MWCV0Y5A"}]