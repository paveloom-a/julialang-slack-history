[{"client_msg_id":"a311cec6-c9ca-4c57-b55b-36a806e96dc2","type":"message","text":"I have some manual code I would like to automate. I have code that looks like this:\n```S′ =  view(du, 1:5)\n    V₁′ = view(du, 6:10)\n    V₂′ = view(du, 11:15)\n    E′ =  view(du, 16:20)\n    F₁′ = view()\n    F₂′ = view()\n    Ẽ′ =  view(du, 26:30)\n    F̃₁ =  view()\n    F̃₂ =  view()\n    A′ =  view(du, 36:40)\n    H̃′ =  view(du, 41:45)\n    # and so on... all the way to view(du, ~100)```\nAs you see, I added additional `F` variables and now i have to do redo all the indicies in the `view` function to accomodate the additional variables. Is there a way I can programmatically do that?","user":"U6Z8377N2","ts":"1609696979.077300","team":"T68168MUP","edited":{"user":"U6Z8377N2","ts":"1609697056.000000"},"blocks":[{"type":"rich_text","block_id":"2eC8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have some manual code I would like to automate. I have code that looks like this:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"S′ =  view(du, 1:5)\n    V₁′ = view(du, 6:10)\n    V₂′ = view(du, 11:15)\n    E′ =  view(du, 16:20)\n    F₁′ = view()\n    F₂′ = view()\n    Ẽ′ =  view(du, 26:30)\n    F̃₁ =  view()\n    F̃₂ =  view()\n    A′ =  view(du, 36:40)\n    H̃′ =  view(du, 41:45)\n    # and so on... all the way to view(du, ~100)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"As you see, I added additional "},{"type":"text","text":"F","style":{"code":true}},{"type":"text","text":" variables and now i have to do redo all the indicies in the "},{"type":"text","text":"view","style":{"code":true}},{"type":"text","text":" function to accomodate the additional variables. Is there a way I can programmatically do that?"}]}]}],"thread_ts":"1609696979.077300","reply_count":12,"reply_users_count":2,"latest_reply":"1609699965.088000","reply_users":["UD0NS8PDF","U6Z8377N2"],"subscribed":false},{"client_msg_id":"f6a44809-3f41-4f62-8706-3dee64e7b230","type":"message","text":"This won’t help you edit your file, but you might be interested in <https://github.com/jonniedie/ComponentArrays.jl> which would let you use names for these views. And hence add more next time without much hassle or chance of mistakes.","user":"UD0NS8PDF","ts":"1609697545.080000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"l6O","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"This won’t help you edit your file, but you might be interested in "},{"type":"link","url":"https://github.com/jonniedie/ComponentArrays.jl"},{"type":"text","text":" which would let you use names for these views. And hence add more next time without much hassle or chance of mistakes."}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"41449cfd-9ad1-4adf-96ec-6aa59060523e","type":"message","text":"I think I still have the same problem. The `du` is my code is passed in as a function argument, and its not a `ComponentArray` . I think I still will need to use view if I want to have the syntactic sugar and readibility.","user":"U6Z8377N2","ts":"1609697884.080600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Rz42","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think I still have the same problem. The "},{"type":"text","text":"du","style":{"code":true}},{"type":"text","text":" is my code is passed in as a function argument, and its not a "},{"type":"text","text":"ComponentArray","style":{"code":true}},{"type":"text","text":" . I think I still will need to use view if I want to have the syntactic sugar and readibility."}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"33027bef-c388-4d73-8da3-ebbe6a1672ac","type":"message","text":"My solution is:\n```function test() \n    array = zeros(15)\n    compartments = [:a, :b, :c]\n    for (i, comp) in enumerate(compartments)\n        ran = (i*5 - 4):(i*5)\n        println(\"i: $i, c: $c, range: $ran\")\n        @eval $(comp) = $(view(array, ran))\n    end\n    # check if a, b modify the array\n    a[1] = 10\n    b[2] = 20 \n    println(array)  # dosnt actually modify array\nend```","user":"U6Z8377N2","ts":"1609697890.080800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9JWK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"My solution is:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function test() \n    array = zeros(15)\n    compartments = [:a, :b, :c]\n    for (i, comp) in enumerate(compartments)\n        ran = (i*5 - 4):(i*5)\n        println(\"i: $i, c: $c, range: $ran\")\n        @eval $(comp) = $(view(array, ran))\n    end\n    # check if a, b modify the array\n    a[1] = 10\n    b[2] = 20 \n    println(array)  # dosnt actually modify array\nend"}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"4bee7526-f2db-4f2a-93eb-f933e7c2073a","type":"message","text":"The safe time to use eval is to generate code at the top level. And that’s fine, if you have a static list of names &amp; assign them each a view. It should run once, while your code is loading.","user":"UD0NS8PDF","ts":"1609698190.082500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4d7W","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The safe time to use eval is to generate code at the top level. And that’s fine, if you have a static list of names & assign them each a view. It should run once, while your code is loading."}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"f9170a7f-a464-42ac-9919-44555e2eb8c7","type":"message","text":"ComponentArrays are backed by a single vector. I don’t quite know what you’re doing, but it is entirely possible to pass that vector to some dumb function (like a solver) and at other places use the named components (like you are setting up here).","user":"UD0NS8PDF","ts":"1609698237.082800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SL2Sl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ComponentArrays are backed by a single vector. I don’t quite know what you’re doing, but it is entirely possible to pass that vector to some dumb function (like a solver) and at other places use the named components (like you are setting up here)."}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"43eddd57-7ec6-44d4-b270-072ba73b8ec3","type":"message","text":"I am using differential equations, and function signature for the model is\n```function aModel!(du, u, params, t) end```\nso the solver calls this function and passes in the internal solution and time variables. For me, the length of `du` is about 100 so instead of saying\n```du[1] = solve diff eq\ndu[2] = solve diff eq```\nI am just setting up names for the `du` so it's simply readable","user":"U6Z8377N2","ts":"1609698514.083900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"84aw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I am using differential equations, and function signature for the model is\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function aModel!(du, u, params, t) end"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"so the solver calls this function and passes in the internal solution and time variables. For me, the length of "},{"type":"text","text":"du","style":{"code":true}},{"type":"text","text":" is about 100 so instead of saying\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"du[1] = solve diff eq\ndu[2] = solve diff eq"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"I am just setting up names for the "},{"type":"text","text":"du","style":{"code":true}},{"type":"text","text":" so it's simply readable"}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"f11377b7-7d38-4926-8c5d-29d1eb4a433a","type":"message","text":"To use `ComponentArray`, the argument `du` should already be of that type, no?","user":"U6Z8377N2","ts":"1609698541.084100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5ow","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"To use "},{"type":"text","text":"ComponentArray","style":{"code":true}},{"type":"text","text":", the argument "},{"type":"text","text":"du","style":{"code":true}},{"type":"text","text":" should already be of that type, no?"}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"6a172edc-fe39-4d09-aa3e-3d7016edb77d","type":"message","text":"I think DiffEq stuff is pretty good at working with abstractarrays, so if your initial conditions use names, they may just propagate through. This is what the readme example does, with `comp_ic = ComponentArray(lorenz=lorenz_ic, lotka=lotka_ic)`","user":"UD0NS8PDF","ts":"1609699010.085800","team":"T68168MUP","edited":{"user":"UD0NS8PDF","ts":"1609699118.000000"},"blocks":[{"type":"rich_text","block_id":"xTfD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think DiffEq stuff is pretty good at working with abstractarrays, so if your initial conditions use names, they may just propagate through. This is what the readme example does, with "},{"type":"text","text":"comp_ic = ComponentArray(lorenz=lorenz_ic, lotka=lotka_ic)","style":{"code":true}}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"deb77ef7-f51c-4730-9c0a-19b326a246a0","type":"message","text":"If your function has to receive a plain Vector `v`, then it is very likely there is some function for saying “interpret this like the following ComponentArray”","user":"UD0NS8PDF","ts":"1609699057.086000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hrNYL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If your function has to receive a plain Vector "},{"type":"text","text":"v","style":{"code":true}},{"type":"text","text":", then it is very likely there is some function for saying “interpret this like the following ComponentArray”"}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"0dd577f1-8dcd-41af-8c90-fa84e8ff5fb3","type":"message","text":"Yes.. there is an example on <https://github.com/jonniedie/ComponentArrays.jl> that shows exactly what I want to do","user":"U6Z8377N2","ts":"1609699308.086800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hQTS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes.. there is an example on "},{"type":"link","url":"https://github.com/jonniedie/ComponentArrays.jl"},{"type":"text","text":" that shows exactly what I want to do"}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2","reactions":[{"name":"+1","users":["UD0NS8PDF"],"count":1}]},{"client_msg_id":"8e5470ab-88a5-4679-b14e-aa6e44124e92","type":"message","text":"Actually, found a much much better way.\nI simply just use a for loop to print out the syntax I need, and then copy paste. Too much work involved in using Component Arrays the way I've designed my model.\n```julia&gt; for (i, c) in enumerate(compartments)\n              ran = (i*5 - 4):(i*5)\n              str = \"$c = view(du, $ran)\"\n              println(str)\n          end\nS = view(du, 1:5)\nV₁′ = view(du, 6:10)\nV₂′ = view(du, 11:15)\nE′ = view(du, 16:20)\nF₁′ = view(du, 21:25)\nF₂′ = view(du, 26:30)\nẼ′ = view(du, 31:35)\n F̃₁′ = view(du, 36:40)\nF̃₂′ = view(du, 41:45)\nA′ = view(du, 46:50)\nH̃′ = view(du, 51:55)\nÃ′ = view(du, 56:60)\n P′ = view(du, 61:65)\nB̃′ = view(du, 66:70)\nP̃′ = view(du, 71:75)\nI′ = view(du, 76:80)\nQ̃′ = view(du, 81:85)\nĨ′ = view(du, 86:90)\n X′ = view(du, 91:95)\nD′ = view(du, 96:100)\nR′ = view(du, 101:105)\nW′ = view(du, 106:110)      ```","user":"U6Z8377N2","ts":"1609699928.087600","team":"T68168MUP","edited":{"user":"U6Z8377N2","ts":"1609699963.000000"},"blocks":[{"type":"rich_text","block_id":"/azr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Actually, found a much much better way.\nI simply just use a for loop to print out the syntax I need, and then copy paste. Too much work involved in using Component Arrays the way I've designed my model.\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> for (i, c) in enumerate(compartments)\n              ran = (i*5 - 4):(i*5)\n              str = \"$c = view(du, $ran)\"\n              println(str)\n          end\nS = view(du, 1:5)\nV₁′ = view(du, 6:10)\nV₂′ = view(du, 11:15)\nE′ = view(du, 16:20)\nF₁′ = view(du, 21:25)\nF₂′ = view(du, 26:30)\nẼ′ = view(du, 31:35)\n F̃₁′ = view(du, 36:40)\nF̃₂′ = view(du, 41:45)\nA′ = view(du, 46:50)\nH̃′ = view(du, 51:55)\nÃ′ = view(du, 56:60)\n P′ = view(du, 61:65)\nB̃′ = view(du, 66:70)\nP̃′ = view(du, 71:75)\nI′ = view(du, 76:80)\nQ̃′ = view(du, 81:85)\nĨ′ = view(du, 86:90)\n X′ = view(du, 91:95)\nD′ = view(du, 96:100)\nR′ = view(du, 101:105)\nW′ = view(du, 106:110)      "}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"},{"client_msg_id":"c18b11bc-2ba0-4b2a-bd47-39c268245419","type":"message","text":":slightly_smiling_face:","user":"U6Z8377N2","ts":"1609699965.088000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"66P","elements":[{"type":"rich_text_section","elements":[{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1609696979.077300","parent_user_id":"U6Z8377N2"}]