[{"client_msg_id":"6bcd88c5-4614-4a0a-990d-b95db37dce13","type":"message","text":"OK I tried copying `ToggleableAsserts` and got the following piece of code:\n```module Options\n\n    const options_lock = ReentrantLock()\n\n    last_coordinate() = \"issquare\"\n    function set_last_coordinates(v)\n        lock(options_lock) do\n            @eval Options.last_coordinate() = $v\n        end\n    end\n    export set_last_coordinates\nend```\nNow, defining `myfunc() = Options.last_coordinate() == \"issquare\" &amp;&amp; println(\"OK\")` and calling `@code_lowered myfunc()` I see there is a branch remaining, while I expected the branch to be killed off. Why is it still there?","user":"U01MG0TN079","ts":"1617549053.441900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CFTZJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"OK I tried copying "},{"type":"text","text":"ToggleableAsserts","style":{"code":true}},{"type":"text","text":" and got the following piece of code:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"module Options\n\n    const options_lock = ReentrantLock()\n\n    last_coordinate() = \"issquare\"\n    function set_last_coordinates(v)\n        lock(options_lock) do\n            @eval Options.last_coordinate() = $v\n        end\n    end\n    export set_last_coordinates\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Now, defining "},{"type":"text","text":"myfunc() = Options.last_coordinate() == \"issquare\" && println(\"OK\")","style":{"code":true}},{"type":"text","text":" and calling "},{"type":"text","text":"@code_lowered myfunc()","style":{"code":true}},{"type":"text","text":" I see there is a branch remaining, while I expected the branch to be killed off. Why is it still there?"}]}]}],"thread_ts":"1617549053.441900","reply_count":5,"reply_users_count":2,"latest_reply":"1617561376.455300","reply_users":["U01PLQWQXPV","U01MG0TN079"],"is_locked":false,"subscribed":false},{"client_msg_id":"1117c9cb-4263-403a-a295-85296cd87727","type":"message","text":"Because everything is dynamic so something like this (at runtime) is allowed\n```Options.last_coordinate() = \"isround\"```\nSince the return value of last_coordinate() can't be constant, you can't kill the branching","user":"U01PLQWQXPV","ts":"1617550742.442900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"rxIU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Because everything is dynamic so something like this (at runtime) is allowed\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"Options.last_coordinate() = \"isround\""}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nSince the return value of last_coordinate() can't be constant, you can't kill the branching"}]}]}],"thread_ts":"1617549053.441900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"07d7fc9a-403c-4c8e-b76d-bb034072e4d9","type":"message","text":"but why does it work with `ToggleableAsserts`  then?","user":"U01MG0TN079","ts":"1617550784.443100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QyWkp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but why does it work with "},{"type":"text","text":"ToggleableAsserts","style":{"code":true}},{"type":"text","text":"  then?"}]}]}],"thread_ts":"1617549053.441900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"56f14f1e-bd95-42e0-9b85-fd1a81376d4b","type":"message","text":"Look at the output of `@code_lowered` on the main example in `ToggleableAsserts` . The branching is still there","user":"U01PLQWQXPV","ts":"1617551503.443700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hTco8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Look at the output of "},{"type":"text","text":"@code_lowered","style":{"code":true}},{"type":"text","text":" on the main example in "},{"type":"text","text":"ToggleableAsserts","style":{"code":true}},{"type":"text","text":" . The branching is still there"}]}]}],"thread_ts":"1617549053.441900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"80d9e97d-1238-46ca-a307-291d7dac26f4","type":"message","text":"Ah, I see what you mean!\n\n```test() = 3\nfoo() = test() &amp;&amp; 4\n\n@code_llvm foo()```\nIt appears the branching can be killed with such `isbitstype`s.\n\nDon't know why exactly, though, it's beyond my expertise","user":"U01PLQWQXPV","ts":"1617552684.444200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4zU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah, I see what you mean!\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"test() = 3\nfoo() = test() && 4\n\n@code_llvm foo()"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nIt appears the branching can be killed with such "},{"type":"text","text":"isbitstype","style":{"code":true}},{"type":"text","text":"s.\n\nDon't know why exactly, though, it's beyond my expertise"}]}]}],"thread_ts":"1617549053.441900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"a9e936a5-d169-4ad5-b726-cfd3abc3027a","type":"message","text":"Ah, interesting. So I should make it into a `isbitstype` ,I'll see if that works. Thanks!","user":"U01MG0TN079","ts":"1617561376.455300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"uZA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah, interesting. So I should make it into a "},{"type":"text","text":"isbitstype","style":{"code":true}},{"type":"text","text":" ,I'll see if that works. Thanks!"}]}]}],"thread_ts":"1617549053.441900","parent_user_id":"U01MG0TN079"}]