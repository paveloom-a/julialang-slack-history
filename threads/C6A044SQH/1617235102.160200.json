[{"client_msg_id":"4249800e-c7e1-485e-a69f-b11b6b939029","type":"message","text":"Hi, I have a struct `MyStryct(A11, A12, A21, A22)`that holds multiple `AbstractMatrix`  types. In particular, I often need it to store some subpart of a large, sparse matrix. The tricky part is, that there is also a permutation, so in fact what I need is my container to hold `A[idx,idx]` . While analyzing my code with `@profview` , I observe that a lot of time is spent on constructing `MyStruct(A[idx,idx], ...)`  which calls  `SparseArrays.getindex`  and `SparseArrays_getindex_I_sorted` , which in turn calls `zeros` for some reason.\n\nI though that I could circumvent all of this by using `@view` , but the code slows down considerably when I do this. Am I missing something here? Any advice on how to improve it?","user":"U01L0RJC6FM","ts":"1617235102.160200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"S/r","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi, I have a struct "},{"type":"text","text":"MyStryct(A11, A12, A21, A22)","style":{"code":true}},{"type":"text","text":"that holds multiple "},{"type":"text","text":"AbstractMatrix","style":{"code":true}},{"type":"text","text":"  types. In particular, I often need it to store some subpart of a large, sparse matrix. The tricky part is, that there is also a permutation, so in fact what I need is my container to hold "},{"type":"text","text":"A[idx,idx]","style":{"code":true}},{"type":"text","text":" . While analyzing my code with "},{"type":"text","text":"@profview","style":{"code":true}},{"type":"text","text":" , I observe that a lot of time is spent on constructing "},{"type":"text","text":"MyStruct(A[idx,idx], ...)","style":{"code":true}},{"type":"text","text":"  which calls  "},{"type":"text","text":"SparseArrays.getindex","style":{"code":true}},{"type":"text","text":"  and "},{"type":"text","text":"SparseArrays_getindex_I_sorted","style":{"code":true}},{"type":"text","text":" , which in turn calls "},{"type":"text","text":"zeros","style":{"code":true}},{"type":"text","text":" for some reason.\n\nI though that I could circumvent all of this by using "},{"type":"text","text":"@view","style":{"code":true}},{"type":"text","text":" , but the code slows down considerably when I do this. Am I missing something here? Any advice on how to improve it?"}]}]}],"thread_ts":"1617235102.160200","reply_count":1,"reply_users_count":1,"latest_reply":"1617235536.160500","reply_users":["U011LUQ182G"],"is_locked":false,"subscribed":false},{"client_msg_id":"abbd555a-00f2-4bc5-8172-1bbf3ed31b99","type":"message","text":"is `idx` an index array, and can you post an MWE?","user":"U011LUQ182G","ts":"1617235536.160500","team":"T68168MUP","edited":{"user":"U011LUQ182G","ts":"1617235648.000000"},"blocks":[{"type":"rich_text","block_id":"mmqS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"is "},{"type":"text","text":"idx","style":{"code":true}},{"type":"text","text":" an index array, and can you post an MWE?"}]}]}],"thread_ts":"1617235102.160200","parent_user_id":"U01L0RJC6FM"}]