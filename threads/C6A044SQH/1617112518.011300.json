[{"client_msg_id":"b090db3e-2d89-4db7-a0ce-50d5bdced743","type":"message","text":"because right now I'm making a new vector out of the filtered last `vv[i]`  which I think is not ideal in terms of allocations (and I see `materialize()` happening a lot when profiling)","user":"U01MG0TN079","ts":"1617112518.011300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Z/C","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"because right now I'm making a new vector out of the filtered last "},{"type":"text","text":"vv[i]","style":{"code":true}},{"type":"text","text":"  which I think is not ideal in terms of allocations (and I see "},{"type":"text","text":"materialize()","style":{"code":true}},{"type":"text","text":" happening a lot when profiling)"}]}]}],"thread_ts":"1617112518.011300","reply_count":7,"reply_users_count":2,"latest_reply":"1617114717.014600","reply_users":["U01M655G9AR","U01MG0TN079"],"is_locked":false,"subscribed":false},{"client_msg_id":"7d6530b3-b942-456e-9fd5-4217c38130bb","type":"message","text":"Maybe something like `CatViews.jl`  ? (disclaimer: I never used it)","user":"U01M655G9AR","ts":"1617113923.012100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hsgi","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Maybe something like "},{"type":"text","text":"CatViews.jl","style":{"code":true}},{"type":"text","text":"  ? (disclaimer: I never used it)"}]}]}],"thread_ts":"1617112518.011300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"54e0c6f9-2090-4808-b03f-2a856864b6b4","type":"message","text":"google seems to say CatViews are actually worse allocation-wise","user":"U01MG0TN079","ts":"1617114015.013300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"y3OH=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"google seems to say CatViews are actually worse allocation-wise"}]}]}],"thread_ts":"1617112518.011300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"f874b3af-8c2a-4bf0-b1db-3c96e73042d3","type":"message","text":"I imagine that storing all values in one single `Vector`  (sorted!) and having `vv` to be a vector of views is out of the question","user":"U01M655G9AR","ts":"1617114033.013500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3fu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I imagine that storing all values in one single "},{"type":"text","text":"Vector","style":{"code":true}},{"type":"text","text":"  (sorted!) and having "},{"type":"text","text":"vv","style":{"code":true}},{"type":"text","text":" to be a vector of views is out of the question"}]}]}],"thread_ts":"1617112518.011300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"9bb3154e-d7d4-44b0-9c13-4a95d920be39","type":"message","text":"So, just concat everything and store the parts in `vv`  as views? that makes sense at least","user":"U01MG0TN079","ts":"1617114194.013700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WehQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So, just concat everything and store the parts in "},{"type":"text","text":"vv","style":{"code":true}},{"type":"text","text":"  as views? that makes sense at least"}]}]}],"thread_ts":"1617112518.011300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"14d71616-ca18-42df-9d4c-18742b68c44a","type":"message","text":"`CatViews` should almost not allocate","user":"U01M655G9AR","ts":"1617114332.014200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Wwdp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"CatViews","style":{"code":true}},{"type":"text","text":" should almost not allocate"}]}]}],"thread_ts":"1617112518.011300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"7ca04434-7b0c-4bc5-b98f-bbfb8f933798","type":"message","text":"yeah, I don't know how you construct them, but a single sorted `Vector` is as memory efficient as you can get, and you can get your values `&lt;k` with a single `@view`.","user":"U01M655G9AR","ts":"1617114463.014400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fu3//","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah, I don't know how you construct them, but a single sorted "},{"type":"text","text":"Vector","style":{"code":true}},{"type":"text","text":" is as memory efficient as you can get, and you can get your values "},{"type":"text","text":"<k","style":{"code":true}},{"type":"text","text":" with a single "},{"type":"text","text":"@view","style":{"code":true}},{"type":"text","text":"."}]}]}],"thread_ts":"1617112518.011300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"c1434e8e-2f8d-4199-93dc-529a1e917e66","type":"message","text":"OK, thanks! there is some other structure that I want to preserve so I can't just sort the vector like that, but I guess I'll follow this approach","user":"U01MG0TN079","ts":"1617114717.014600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9VsXH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"OK, thanks! there is some other structure that I want to preserve so I can't just sort the vector like that, but I guess I'll follow this approach"}]}]}],"thread_ts":"1617112518.011300","parent_user_id":"U01MG0TN079"}]