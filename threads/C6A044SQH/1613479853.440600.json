[{"client_msg_id":"d6df7bbc-b7ff-4c94-b6e3-1097afc274bb","type":"message","text":"I'm attempting to debug some knotty `ccall` calls and in doing so I realise that I don't know how the layout of structs works. I find the following unexpected but perhaps I'm being naive.\n\n```julia&gt; struct Bar\n       a::Int8\n       b::Int16\n       c::Int32\n       d::Int64\n       e::Int128\n       f::Ptr{Nothing}\n       g::Ptr{Nothing}\n       end\n\njulia&gt; structinfo(T) = [(fieldoffset(T,i), fieldname(T,i), fieldtype(T,i)) for i = 1:fieldcount(T)];\n\njulia&gt; structinfo(Bar)\n7-element Vector{Tuple{UInt64, Symbol, DataType}}:\n (0x0000000000000000, :a, Int8)\n (0x0000000000000002, :b, Int16)\n (0x0000000000000004, :c, Int32)\n (0x0000000000000008, :d, Int64)\n (0x0000000000000010, :e, Int128)\n (0x0000000000000020, :f, Ptr{Nothing})\n (0x0000000000000028, :g, Ptr{Nothing})```\nI naively expected offsets to be calculated by accumulating  `0,1,2,4,8,16,8`  to give `0,1,3,7,15,31,39`, but this evidently isn't the case. I've tried searching the docs to work out whats going on and have found <https://docs.julialang.org/en/v1/devdocs/reflection/#DataType-layout> and <https://docs.julialang.org/en/v1/devdocs/object/>. Are there any other docs pages could help, does anyone know?","user":"UDSG73JTH","ts":"1613479853.440600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"teTb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm attempting to debug some knotty "},{"type":"text","text":"ccall","style":{"code":true}},{"type":"text","text":" calls and in doing so I realise that I don't know how the layout of structs works. I find the following unexpected but perhaps I'm being naive.\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> struct Bar\n       a::Int8\n       b::Int16\n       c::Int32\n       d::Int64\n       e::Int128\n       f::Ptr{Nothing}\n       g::Ptr{Nothing}\n       end\n\njulia> structinfo(T) = [(fieldoffset(T,i), fieldname(T,i), fieldtype(T,i)) for i = 1:fieldcount(T)];\n\njulia> structinfo(Bar)\n7-element Vector{Tuple{UInt64, Symbol, DataType}}:\n (0x0000000000000000, :a, Int8)\n (0x0000000000000002, :b, Int16)\n (0x0000000000000004, :c, Int32)\n (0x0000000000000008, :d, Int64)\n (0x0000000000000010, :e, Int128)\n (0x0000000000000020, :f, Ptr{Nothing})\n (0x0000000000000028, :g, Ptr{Nothing})"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"I naively expected offsets to be calculated by accumulating  "},{"type":"text","text":"0,1,2,4,8,16,8","style":{"code":true}},{"type":"text","text":"  to give "},{"type":"text","text":"0,1,3,7,15,31,39","style":{"code":true}},{"type":"text","text":", but this evidently isn't the case. I've tried searching the docs to work out whats going on and have found "},{"type":"link","url":"https://docs.julialang.org/en/v1/devdocs/reflection/#DataType-layout"},{"type":"text","text":" and "},{"type":"link","url":"https://docs.julialang.org/en/v1/devdocs/object/"},{"type":"text","text":". Are there any other docs pages could help, does anyone know?"}]}]}],"thread_ts":"1613479853.440600","reply_count":31,"reply_users_count":4,"latest_reply":"1613492321.456800","reply_users":["B01J9QZ4SP8","UDB26738Q","U7HAYKY9X","UDSG73JTH"],"subscribed":false},{"type":"message","subtype":"bot_message","text":"Can we cross post this publicly to <https://discourse.julialang.org|Discourse> for further visibility? React with :bridge: on the message above to approve. <https://github.com/JuliaCommunity/SlackBridge/blob/main/README.md#faq|More info here>","ts":"1613479855.440700","username":"HelpDeskBot","bot_id":"B01J9QZ4SP8","thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"7a969b33-4092-4fc0-b00f-8130080a215b","type":"message","text":"is your C library doing struct packing?","user":"UDB26738Q","ts":"1613480161.441300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Tua9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"is your C library doing struct packing?"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH","reactions":[{"name":"man-shrugging","users":["UDSG73JTH"],"count":1}]},{"client_msg_id":"d81bbcf9-36b6-44f0-902c-74ebfc30cf2b","type":"message","text":"<https://github.com/analytech-solutions/CBinding.jl> may help with that","user":"UDB26738Q","ts":"1613480183.441500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Z04B2","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/analytech-solutions/CBinding.jl"},{"type":"text","text":" may help with that"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH","reactions":[{"name":"+1","users":["UDSG73JTH"],"count":1}]},{"client_msg_id":"a874c2b4-c398-4f40-bf1e-b0ada9241035","type":"message","text":"This is a low-level optimization. CPUs have a hard time fetching an object from the CPU cache if it straddles a \"cache line\", that is, if one part of the object has a memory address in one 64-byte chunk, and another part in the next chunk","user":"U7HAYKY9X","ts":"1613480187.441700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FpK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"This is a low-level optimization. CPUs have a hard time fetching an object from the CPU cache if it straddles a \"cache line\", that is, if one part of the object has a memory address in one 64-byte chunk, and another part in the next chunk"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"0d6bd5c8-1616-42e1-a051-8892000105b6","type":"message","text":"<https://en.wikipedia.org/wiki/Data_structure_alignment>","user":"U7HAYKY9X","ts":"1613480241.442100","team":"T68168MUP","attachments":[{"title":"Data structure alignment","title_link":"https://en.wikipedia.org/wiki/Data_structure_alignment","from_url":"https://en.wikipedia.org/wiki/Data_structure_alignment","author_name":"Wikipedia","author_link":"https://en.wikipedia.org/","text":"Data structure alignment is the way data is arranged and accessed in computer memory. It consists of three separate but related issues: data alignment, data structure padding, and packing.\nThe CPU in modern computer hardware performs reads and writes to memory most efficiently when the data is naturally aligned, which generally means that the data's memory address is a multiple of the data size. For instance, in a 32-bit architecture, the data may be aligned if the data is stored in four consecutive bytes and the first byte lies on a 4-byte boundary.\nData alignment is the aligning of elements according to their natural alignment. To ensure natural alignment, it may be necessary to insert some padding between structure elements or after the last element of a structure. For example, on a 32-bit machine, a data structure containing a 16-bit value followed by a 32-bit value could have 16 bits of padding between the 16-bit value and the 32-bit value to align the 32-bit value on a 32-bit boundary. Alternatively, one can pack the structure, omitting the padding, which may lead to slower access, but uses three quarters as much memory.\nAlthough data structure alignment is a fundamental issue for all modern computers, many computer languages and computer language implementations handle data alignment automatically. Fortran, Ada, PL/I, Pascal, certain C and C++ implementations, D, Rust, C#, and assembly language allow at least partial control of data structure padding, which may be useful in certain special circumstances.","fallback":"wikipedia: Data structure alignment","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/wikipedia.png","id":1,"original_url":"https://en.wikipedia.org/wiki/Data_structure_alignment"}],"blocks":[{"type":"rich_text","block_id":"36Ou3","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://en.wikipedia.org/wiki/Data_structure_alignment"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"ebb66f96-5722-44ff-9f66-f45166d0bb7a","type":"message","text":"Julia's structs are guaranteed to have the same memory layout as C's, both use padding by default","user":"U7HAYKY9X","ts":"1613480281.442400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=coW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Julia's structs are guaranteed to have the same memory layout as C's, both use padding by default"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH","reactions":[{"name":"heart","users":["UDSG73JTH"],"count":1}]},{"client_msg_id":"8a285d8a-a798-4052-bad7-691bd13dcb10","type":"message","text":"So I would probably find some documentation of how C does it","user":"U7HAYKY9X","ts":"1613480374.442600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jBT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So I would probably find some documentation of how C does it"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"6ffa1554-aff0-4d6f-b8e9-63eda637cf55","type":"message","text":"Cool. I've no doubt it's user error, it's just nice to see it written down.","user":"UDSG73JTH","ts":"1613480562.443100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"eRZw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Cool. I've no doubt it's user error, it's just nice to see it written down."}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"4af89a07-d094-46f8-83a4-ae655a57e84a","type":"message","text":"Is there anywhere in the docs that says the struct memory alignment is guaranteed to be same as in c?","user":"UDSG73JTH","ts":"1613480595.443300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tt=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there anywhere in the docs that says the struct memory alignment is guaranteed to be same as in c?"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"d59390b3-e4ea-495b-b724-9b3eefefebb4","type":"message","text":"Hm... this seems to imply it, but it's not clear:\n<https://docs.julialang.org/en/v1/manual/calling-c-and-fortran-code/#Struct-Type-Correspondences>","user":"U7HAYKY9X","ts":"1613480754.443800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Rk9L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hm... this seems to imply it, but it's not clear:\n"},{"type":"link","url":"https://docs.julialang.org/en/v1/manual/calling-c-and-fortran-code/#Struct-Type-Correspondences"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH","reactions":[{"name":"+1","users":["UDSG73JTH"],"count":1}]},{"client_msg_id":"040cce83-7529-481b-8f2e-14e3822e2a86","type":"message","text":"Thanks both. Very helpful.","user":"UDSG73JTH","ts":"1613481045.444200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/yXD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks both. Very helpful."}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"1d7ca7ba-ce9d-44c2-bc2b-34e5470af3e9","type":"message","text":"What does \"Unnamed structs are not possible in the translation to Julia.\" mean at the end of the 2nd para of <https://docs.julialang.org/en/v1/manual/calling-c-and-fortran-code/#Struct-Type-Correspondences>?","user":"UDSG73JTH","ts":"1613481774.444400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jha","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What does \"Unnamed structs are not possible in the translation to Julia.\" mean at the end of the 2nd para of "},{"type":"link","url":"https://docs.julialang.org/en/v1/manual/calling-c-and-fortran-code/#Struct-Type-Correspondences"},{"type":"text","text":"?"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"f3b106d0-cffc-4853-8404-98c2fba68043","type":"message","text":"Does it mean that anonymous structs don't exist in julia or that entities written c with anonymous structs can't be used in Julia? Probably the former?","user":"UDSG73JTH","ts":"1613481892.444600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Lc54","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does it mean that anonymous structs don't exist in julia or that entities written c with anonymous structs can't be used in Julia? Probably the former?"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH","reactions":[{"name":"shrug","users":["U7HAYKY9X"],"count":1}]},{"client_msg_id":"975eb2a2-8c57-4689-9867-a8a2f81b2467","type":"message","text":"maybe you can with <https://github.com/analytech-solutions/CBinding.jl>","user":"UDB26738Q","ts":"1613482132.445100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Bvia","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"maybe you can with "},{"type":"link","url":"https://github.com/analytech-solutions/CBinding.jl"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH","reactions":[{"name":"+1","users":["UDSG73JTH"],"count":1}]},{"client_msg_id":"3156aec8-c9a4-4938-aba3-b7d61ca8d9a7","type":"message","text":"Perhaps the docs could be improved a little there, but I have never really interfaced with C, so I'm not the one to know","user":"U7HAYKY9X","ts":"1613482197.445300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"B2c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Perhaps the docs could be improved a little there, but I have never really interfaced with C, so I'm not the one to know"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"e8d34e69-dd26-429c-a933-7d399ec16ac9","type":"message","text":"It looks like `MySecondType` in the README of the `CBindings.jl`  package makes an anonymous struct.","user":"UDSG73JTH","ts":"1613482462.445700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SjO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It looks like "},{"type":"text","text":"MySecondType","style":{"code":true}},{"type":"text","text":" in the README of the "},{"type":"text","text":"CBindings.jl","style":{"code":true}},{"type":"text","text":"  package makes an anonymous struct."}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"49176325-9c20-4582-a876-cbe3a64f3c70","type":"message","text":"julia's builtin C interface works very well but it's very standard, for anything else more advanced `CBindings.jl` does a good job","user":"UDB26738Q","ts":"1613482787.445900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cOCpq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"julia's builtin C interface works very well but it's very standard, for anything else more advanced "},{"type":"text","text":"CBindings.jl","style":{"code":true}},{"type":"text","text":" does a good job"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"322e58ed-9a98-4e8e-af55-6b07c198453e","type":"message","text":"(and it's also impressive you can do this in a third-party package)","user":"UDB26738Q","ts":"1613482815.446100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WSFG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(and it's also impressive you can do this in a third-party package)"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"38c03122-3566-422b-b487-338a3328cf54","type":"message","text":"I've made a lot of headway with `CBindings.jl`  - thanks for the suggestion","user":"UDSG73JTH","ts":"1613489448.447000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cL3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I've made a lot of headway with "},{"type":"text","text":"CBindings.jl","style":{"code":true}},{"type":"text","text":"  - thanks for the suggestion"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"4804c055-87e8-493c-b5d9-2a9647d5b980","type":"message","text":"BTW, there is also <https://github.com/analytech-solutions/CBindingGen.jl|https://github.com/analytech-solutions/CBindingGen.jl> to help generating the bindings. Vast majority of C-like libraries don't have this kind of fanciness like packed or anonymous structs, but when you bump into them `CBindings` is life-saving","user":"UDB26738Q","ts":"1613490316.453900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gpwFD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"BTW, there is also "},{"type":"link","url":"https://github.com/analytech-solutions/CBindingGen.jl","text":"https://github.com/analytech-solutions/CBindingGen.jl"},{"type":"text","text":" to help generating the bindings. Vast majority of C-like libraries don't have this kind of fanciness like packed or anonymous structs, but when you bump into them "},{"type":"text","text":"CBindings","style":{"code":true}},{"type":"text","text":" is life-saving"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH","reactions":[{"name":"+1","users":["UDSG73JTH"],"count":1}]},{"client_msg_id":"a3e793e0-f8e6-42f2-a14c-f667f22466dd","type":"message","text":"I've read your blog post <https://www.juliabloggers.com/getting-the-value-of-a-pointer-in-julia/>","user":"UDSG73JTH","ts":"1613490942.454300","team":"T68168MUP","attachments":[{"service_name":"juliabloggers.com","title":"Getting the value of a pointer in Julia | juliabloggers.com","title_link":"https://www.juliabloggers.com/getting-the-value-of-a-pointer-in-julia/","text":"Yesterday a question in the Juliaâ€™s Slack channel (request an invite here!) prompted a lively discussion about how to deal with pointers in Julia. As the history of the channel is ephemeral, I wrote this post to keep note...","fallback":"juliabloggers.com: Getting the value of a pointer in Julia | juliabloggers.com","from_url":"https://www.juliabloggers.com/getting-the-value-of-a-pointer-in-julia/","service_icon":"https://www.juliabloggers.com/favicon.ico","id":1,"original_url":"https://www.juliabloggers.com/getting-the-value-of-a-pointer-in-julia/"}],"blocks":[{"type":"rich_text","block_id":"j7Ktb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I've read your blog post "},{"type":"link","url":"https://www.juliabloggers.com/getting-the-value-of-a-pointer-in-julia/"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"66187509-66a3-4741-9271-d6a05b2f117e","type":"message","text":"`unsafe_load` isn't strictly a derefence because it copies, as you say. How is true dereferencing done in Julia?","user":"UDSG73JTH","ts":"1613490999.454600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"d2FnU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"unsafe_load","style":{"code":true}},{"type":"text","text":" isn't strictly a derefence because it copies, as you say. How is true dereferencing done in Julia?"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"70c60b67-8571-4400-90cc-e0d0f1b81d07","type":"message","text":"That's a good question. I think you can easily do it only for some datatypes (like arrays), in general you'd likely need to fiddle with some internals which honestly I currently don't remember","user":"UDB26738Q","ts":"1613491335.454900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GXDaU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That's a good question. I think you can easily do it only for some datatypes (like arrays), in general you'd likely need to fiddle with some internals which honestly I currently don't remember"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"60705ccc-8605-49d6-906c-d3dee77eae76","type":"message","text":"I wonder if CBindings can do that :joy:","user":"UDB26738Q","ts":"1613491435.455100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"C4W","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I wonder if CBindings can do that "},{"type":"emoji","name":"joy"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"1984a6ef-6733-43e5-a58c-118ab933576d","type":"message","text":"You can probably put it in a `Ref`  and then load it, but that's a little shady","user":"U7HAYKY9X","ts":"1613491612.455500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0z=wZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You can probably put it in a "},{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":"  and then load it, but that's a little shady"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"d9401a33-352e-4169-90b1-45d9fc7624dd","type":"message","text":"```using CBinding\n\n@ctypedef AD @cstruct A {\n  a::Cint\n}\nA(x::Number) = (a = A(undef); a.a = x; a)\n\n@ctypedef BD @cstruct B {\n  p::Ptr{A}\n}\nB(a::Ptr) = (b = B(undef); b.p = a; b)\n\na = A(111)\nb = B(convert(Ptr{A}, pointer_from_objref(a)))\nc = unsafe_load(b.p) # insert magic here\nc.a = 987\n@assert c.a == a.a```","user":"UDSG73JTH","ts":"1613491818.455800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kp8","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"using CBinding\n\n@ctypedef AD @cstruct A {\n  a::Cint\n}\nA(x::Number) = (a = A(undef); a.a = x; a)\n\n@ctypedef BD @cstruct B {\n  p::Ptr{A}\n}\nB(a::Ptr) = (b = B(undef); b.p = a; b)\n\na = A(111)\nb = B(convert(Ptr{A}, pointer_from_objref(a)))\nc = unsafe_load(b.p) # insert magic here\nc.a = 987\n@assert c.a == a.a"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"013d217f-5d43-4f70-9ef7-5466c2a04a74","type":"message","text":"Like this:\n```julia&gt; mystring = \"Hello, world!\"\n\"Hello, world!\"\n\njulia&gt; ptr = pointer(mystring)\nPtr{UInt8} @0x0000000115aabd78\n\njulia&gt; ref = Ref(\"\")\nBase.RefValue{String}(\"\")\n\njulia&gt; unsafe_store!(Ptr{UInt}(pointer_from_objref(ref)), UInt(ptr) - 8)\nPtr{UInt64} @0x0000000117dfcfc0\n\njulia&gt; ref\nBase.RefValue{String}(\"Hello, world!\")```","user":"U7HAYKY9X","ts":"1613491872.456000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UUnQ8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Like this:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> mystring = \"Hello, world!\"\n\"Hello, world!\"\n\njulia> ptr = pointer(mystring)\nPtr{UInt8} @0x0000000115aabd78\n\njulia> ref = Ref(\"\")\nBase.RefValue{String}(\"\")\n\njulia> unsafe_store!(Ptr{UInt}(pointer_from_objref(ref)), UInt(ptr) - 8)\nPtr{UInt64} @0x0000000117dfcfc0\n\njulia> ref\nBase.RefValue{String}(\"Hello, world!\")"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"39d56051-b7f0-4523-8ad1-82dd3537e781","type":"message","text":"I can't quite think how I'd work that in with what I've already got.","user":"UDSG73JTH","ts":"1613492133.456200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=Hu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I can't quite think how I'd work that in with what I've already got."}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"dec81826-521c-4ba7-a315-4cdf3c047f93","type":"message","text":"It's probably a terrible idea to do, in any case.","user":"U7HAYKY9X","ts":"1613492192.456400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"k85","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It's probably a terrible idea to do, in any case."}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"3617e658-9b33-488b-8ab6-af99bbcf066c","type":"message","text":"I'll consider anything!","user":"UDSG73JTH","ts":"1613492234.456600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TUvd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'll consider anything!"}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"},{"client_msg_id":"beeb749f-eeb1-4260-8b33-ac2d34fa7528","type":"message","text":"I'm trying to use the JuliaFMI to get an FMU working from Julia. There's a lot of great stuff in JuliaFMI and I'd like to re-use as much as possible. My hands are also tied by the way the structs are nested in the c code that generated the FMU.","user":"UDSG73JTH","ts":"1613492321.456800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vPlu8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm trying to use the JuliaFMI to get an FMU working from Julia. There's a lot of great stuff in JuliaFMI and I'd like to re-use as much as possible. My hands are also tied by the way the structs are nested in the c code that generated the FMU."}]}]}],"thread_ts":"1613479853.440600","parent_user_id":"UDSG73JTH"}]