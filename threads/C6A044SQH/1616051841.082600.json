[{"client_msg_id":"f53cc4e9-e461-4928-8499-65d87227695e","type":"message","text":"Say I have a matrix `M` . Does doing `M[i,:] = M[i,:] + M[j,:]` need me to define `zero(::Type{Entry})`   where `Entry`  is the type of my entries? Can I do without this ?","user":"U01MG0TN079","ts":"1616051841.082600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GIiRN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Say I have a matrix "},{"type":"text","text":"M","style":{"code":true}},{"type":"text","text":" . Does doing "},{"type":"text","text":"M[i,:] = M[i,:] + M[j,:]","style":{"code":true}},{"type":"text","text":" need me to define "},{"type":"text","text":"zero(::Type{Entry})","style":{"code":true}},{"type":"text","text":"   where "},{"type":"text","text":"Entry","style":{"code":true}},{"type":"text","text":"  is the type of my entries? Can I do without this ?"}]}]}],"thread_ts":"1616051841.082600","reply_count":19,"reply_users_count":3,"latest_reply":"1616054675.086800","reply_users":["B01J9QZ4SP8","U01MG0TN079","U01M655G9AR"],"subscribed":false},{"type":"message","subtype":"bot_message","text":"Can we cross post this publicly to <https://discourse.julialang.org|Discourse> for further visibility? React with :bridge: on the message above to approve. <https://github.com/JuliaCommunity/SlackBridge/blob/main/README.md#faq|More info here>","ts":"1616051843.082800","username":"HelpDeskBot","bot_id":"B01J9QZ4SP8","thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"9e003083-a3c4-4b8d-920f-57da03468919","type":"message","text":"I think it's proably the slicing that builds something like sparse arrays that need a notion of null entry…","user":"U01MG0TN079","ts":"1616051881.083000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cLT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think it's proably the slicing that builds something like sparse arrays that need a notion of null entry…"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"9206abc7-6d9d-4aed-9c95-54d35c78146e","type":"message","text":"`SparseMatrixCSC` needs a `zero` for obvious reasons. A `Matrix` should not. What error do you get?\n\n```julia&gt; struct T val::Float64; end\n\njulia&gt; Base.:+(x::T, y::T) = T(x.val + y.val)\n\njulia&gt; a = T.(rand(5,5))\n5×5 Matrix{T}:\n T(0.529017)   T(0.865792)  T(0.724149)  T(0.923644)   T(0.602507)\n T(0.20301)    T(0.407654)  T(0.804592)  T(0.150878)   T(0.917121)\n T(0.408626)   T(0.225299)  T(0.149397)  T(0.543663)   T(0.917837)\n T(0.890781)   T(0.408813)  T(0.925421)  T(0.537571)   T(0.82368)\n T(0.0229419)  T(0.430268)  T(0.330144)  T(0.0474557)  T(0.313368)\n\njulia&gt; a[:,1] = a[:,1] + a[:,2]\n5-element Vector{T}:\n T(1.3948090083868374)\n T(0.6106639107955631)\n T(0.6339247828410464)\n T(1.299593832210133)\n T(0.4532093614037498)\n\njulia&gt; a\n5×5 Matrix{T}:\n T(1.39481)   T(0.865792)  T(0.724149)  T(0.923644)   T(0.602507)\n T(0.610664)  T(0.407654)  T(0.804592)  T(0.150878)   T(0.917121)\n T(0.633925)  T(0.225299)  T(0.149397)  T(0.543663)   T(0.917837)\n T(1.29959)   T(0.408813)  T(0.925421)  T(0.537571)   T(0.82368)\n T(0.453209)  T(0.430268)  T(0.330144)  T(0.0474557)  T(0.313368)```","user":"U01M655G9AR","ts":"1616052574.083200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0td","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"SparseMatrixCSC","style":{"code":true}},{"type":"text","text":" needs a "},{"type":"text","text":"zero","style":{"code":true}},{"type":"text","text":" for obvious reasons. A "},{"type":"text","text":"Matrix","style":{"code":true}},{"type":"text","text":" should not. What error do you get?\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> struct T val::Float64; end\n\njulia> Base.:+(x::T, y::T) = T(x.val + y.val)\n\njulia> a = T.(rand(5,5))\n5×5 Matrix{T}:\n T(0.529017)   T(0.865792)  T(0.724149)  T(0.923644)   T(0.602507)\n T(0.20301)    T(0.407654)  T(0.804592)  T(0.150878)   T(0.917121)\n T(0.408626)   T(0.225299)  T(0.149397)  T(0.543663)   T(0.917837)\n T(0.890781)   T(0.408813)  T(0.925421)  T(0.537571)   T(0.82368)\n T(0.0229419)  T(0.430268)  T(0.330144)  T(0.0474557)  T(0.313368)\n\njulia> a[:,1] = a[:,1] + a[:,2]\n5-element Vector{T}:\n T(1.3948090083868374)\n T(0.6106639107955631)\n T(0.6339247828410464)\n T(1.299593832210133)\n T(0.4532093614037498)\n\njulia> a\n5×5 Matrix{T}:\n T(1.39481)   T(0.865792)  T(0.724149)  T(0.923644)   T(0.602507)\n T(0.610664)  T(0.407654)  T(0.804592)  T(0.150878)   T(0.917121)\n T(0.633925)  T(0.225299)  T(0.149397)  T(0.543663)   T(0.917837)\n T(1.29959)   T(0.408813)  T(0.925421)  T(0.537571)   T(0.82368)\n T(0.453209)  T(0.430268)  T(0.330144)  T(0.0474557)  T(0.313368)"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"95450e45-9a61-4e6d-bed0-aa3dfd176729","type":"message","text":"well, the error is deep in some other code but it's\n```ERROR: MethodError: no method matching zero(::Type{nf_elem})\nClosest candidates are:\n  zero(::Type{Missing}) at missing.jl:103\n  zero(::Type{Dates.Date}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/Dates/src/types.jl:40\n5\n  zero(::Type{Pkg.Resolve.FieldValue}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/Pkg/src/R\nesolve/fieldvalues.jl:38\n  ...\nStacktrace:\n [1] getindex(::SparseArrays.SparseMatrixCSC{nf_elem,Int64}, ::Int64, ::Int64) at /builddir/build/BUILD/julia/bui\nld/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:2038\n [2] (::VinbergsAlgorithmNF.var\"#1#6\"{SparseArrays.SparseMatrixCSC{nf_elem,Int64}})(::Int64) at ./none:0\n [3] iterate at ./iterators.jl:431 [inlined]\n [4] iterate at ./generator.jl:44 [inlined]\n [5] grow_to!(::Array{Int64,1}, ::Base.Generator{Base.Iterators.Filter{VinbergsAlgorithmNF.var\"#1#6\"{SparseArrays\n.SparseMatrixCSC{nf_elem,Int64}},UnitRange{Int64}},typeof(identity)}) at ./array.jl:747\n [6] collect at ./array.jl:684 [inlined]\n [7] diagonalize(::AnticNumberField, ::Array{Int64,2}) at /home/r/UNINE/VinbergsAlgorithmNF/src/util.jl:21\n [8] top-level scope at REPL[40]:1\n [9] run_repl(::REPL.AbstractREPL, ::Any) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/REPL/s\nrc/REPL.jl:288```","user":"U01MG0TN079","ts":"1616053142.083400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5lu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"well, the error is deep in some other code but it's\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: MethodError: no method matching zero(::Type{nf_elem})\nClosest candidates are:\n  zero(::Type{Missing}) at missing.jl:103\n  zero(::Type{Dates.Date}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/Dates/src/types.jl:40\n5\n  zero(::Type{Pkg.Resolve.FieldValue}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/Pkg/src/R\nesolve/fieldvalues.jl:38\n  ...\nStacktrace:\n [1] getindex(::SparseArrays.SparseMatrixCSC{nf_elem,Int64}, ::Int64, ::Int64) at /builddir/build/BUILD/julia/bui\nld/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:2038\n [2] (::VinbergsAlgorithmNF.var\"#1#6\"{SparseArrays.SparseMatrixCSC{nf_elem,Int64}})(::Int64) at ./none:0\n [3] iterate at ./iterators.jl:431 [inlined]\n [4] iterate at ./generator.jl:44 [inlined]\n [5] grow_to!(::Array{Int64,1}, ::Base.Generator{Base.Iterators.Filter{VinbergsAlgorithmNF.var\"#1#6\"{SparseArrays\n.SparseMatrixCSC{nf_elem,Int64}},UnitRange{Int64}},typeof(identity)}) at ./array.jl:747\n [6] collect at ./array.jl:684 [inlined]\n [7] diagonalize(::AnticNumberField, ::Array{Int64,2}) at /home/r/UNINE/VinbergsAlgorithmNF/src/util.jl:21\n [8] top-level scope at REPL[40]:1\n [9] run_repl(::REPL.AbstractREPL, ::Any) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/REPL/s\nrc/REPL.jl:288"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"b9dfc2a4-c34f-4730-bcd1-62e0550ccc6f","type":"message","text":"let me extract the important part","user":"U01MG0TN079","ts":"1616053169.083600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OJw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"let me extract the important part"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"0c858487-c1e3-4238-b5d8-da1e08bc0c2c","type":"message","text":"But if this is about sparse arrays, then yes, you need `zero(::Type{T}}`.","user":"U01M655G9AR","ts":"1616053429.083800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bPD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But if this is about sparse arrays, then yes, you need "},{"type":"text","text":"zero(::Type{T}}","style":{"code":true}},{"type":"text","text":"."}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"f49d8941-93a3-4fd8-a659-a7b078de9f83","type":"message","text":"well, i'm not explicitely calling spare arrays anywhere","user":"U01MG0TN079","ts":"1616053464.084000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"P7W","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"well, i'm not explicitely calling spare arrays anywhere"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"ad0791f5-39e3-4302-8576-73fb9ae328fe","type":"message","text":"probably something does without me knowing","user":"U01MG0TN079","ts":"1616053480.084200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OSqW4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"probably something does without me knowing"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079","reactions":[{"name":"thumbsup_all","users":["U01M655G9AR"],"count":1}]},{"client_msg_id":"c14aed6d-f582-4fd8-b088-a2990911ec52","type":"message","text":"<https://gist.github.com/bottine/881a552427f5e13467b1f96fbc7269de>","user":"U01MG0TN079","ts":"1616054181.084500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7H+","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://gist.github.com/bottine/881a552427f5e13467b1f96fbc7269de"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"b1d07391-02fc-49bd-915b-4da8dee29236","type":"message","text":"this tells me\n```ERROR: LoadError: MethodError: no method matching zero(::Type{NfAbsOrdElem{AnticNumberField,nf_elem}})\nClosest candidates are:\n  zero(::Type{Missing}) at missing.jl:103\n  zero(::Type{Dates.Date}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/Dates/src/types.jl:405\n  zero(::Type{Pkg.Resolve.FieldValue}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/Pkg/src/Resolve/fieldvalues.jl:38\n  ...\nStacktrace:\n [1] _spgetindex(::Int64, ::Array{Int64,1}, ::Array{NfAbsOrdElem{AnticNumberField,nf_elem},1}, ::Int64) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsevector.jl:776\n [2] getindex at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsevector.jl:781 [inlined]\n [3] getindex at ./reshapedarray.jl:229 [inlined]\n [4] iterate at ./abstractarray.jl:986 [inlined]\n [5] SparseArrays.SparseMatrixCSC{NfAbsOrdElem{AnticNumberField,nf_elem},Int64}(::Base.ReshapedArray{NfAbsOrdElem{AnticNumberField,nf_elem},2,SparseArrays.SparseVector{NfAbsOrdElem{AnticNumberField,nf_elem},Int64},Tuple{}}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:556\n [6] convert at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:603 [inlined]\n [7] _to_same_csc at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:2690 [inlined]\n [8] setindex!(::SparseArrays.SparseMatrixCSC{NfAbsOrdElem{AnticNumberField,nf_elem},Int64}, ::SparseArrays.SparseVector{NfAbsOrdElem{AnticNumberField,nf_elem},Int64}, ::Int64, ::Colon) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:2699\n [9] diagonalize(::NfAbsOrd{AnticNumberField,nf_elem}, ::Array{Int64,2}) at /home/r/UNINE/VinbergsAlgorithmNF/bad.jl:78\n [10] top-level scope at /home/r/UNINE/VinbergsAlgorithmNF/bad.jl:110\nin expression starting at /home/r/UNINE/VinbergsAlgorithmNF/bad.jl:110```","user":"U01MG0TN079","ts":"1616054204.084700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"X/8CW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"this tells me\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: LoadError: MethodError: no method matching zero(::Type{NfAbsOrdElem{AnticNumberField,nf_elem}})\nClosest candidates are:\n  zero(::Type{Missing}) at missing.jl:103\n  zero(::Type{Dates.Date}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/Dates/src/types.jl:405\n  zero(::Type{Pkg.Resolve.FieldValue}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/Pkg/src/Resolve/fieldvalues.jl:38\n  ...\nStacktrace:\n [1] _spgetindex(::Int64, ::Array{Int64,1}, ::Array{NfAbsOrdElem{AnticNumberField,nf_elem},1}, ::Int64) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsevector.jl:776\n [2] getindex at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsevector.jl:781 [inlined]\n [3] getindex at ./reshapedarray.jl:229 [inlined]\n [4] iterate at ./abstractarray.jl:986 [inlined]\n [5] SparseArrays.SparseMatrixCSC{NfAbsOrdElem{AnticNumberField,nf_elem},Int64}(::Base.ReshapedArray{NfAbsOrdElem{AnticNumberField,nf_elem},2,SparseArrays.SparseVector{NfAbsOrdElem{AnticNumberField,nf_elem},Int64},Tuple{}}) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:556\n [6] convert at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:603 [inlined]\n [7] _to_same_csc at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:2690 [inlined]\n [8] setindex!(::SparseArrays.SparseMatrixCSC{NfAbsOrdElem{AnticNumberField,nf_elem},Int64}, ::SparseArrays.SparseVector{NfAbsOrdElem{AnticNumberField,nf_elem},Int64}, ::Int64, ::Colon) at /builddir/build/BUILD/julia/build/usr/share/julia/stdlib/v1.5/SparseArrays/src/sparsematrix.jl:2699\n [9] diagonalize(::NfAbsOrd{AnticNumberField,nf_elem}, ::Array{Int64,2}) at /home/r/UNINE/VinbergsAlgorithmNF/bad.jl:78\n [10] top-level scope at /home/r/UNINE/VinbergsAlgorithmNF/bad.jl:110\nin expression starting at /home/r/UNINE/VinbergsAlgorithmNF/bad.jl:110"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"1a897fac-8c21-4d32-a53a-7cbed3533af5","type":"message","text":"can you try using  `I` instead of `I(n)`?","user":"U01M655G9AR","ts":"1616054419.084900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"78w","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"can you try using  "},{"type":"text","text":"I","style":{"code":true}},{"type":"text","text":" instead of "},{"type":"text","text":"I(n)","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"0acad048-feed-439a-b91c-325acbbe6333","type":"message","text":"Let me see","user":"U01MG0TN079","ts":"1616054436.085100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NFSD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Let me see"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"51e10b4d-7ce4-40e3-a1c1-b5b5e4001f5d","type":"message","text":"mmh, I get another unrelated error: seems like it did the trick!","user":"U01MG0TN079","ts":"1616054491.085300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IjuH6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"mmh, I get another unrelated error: seems like it did the trick!"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"456669e0-7470-4dec-8542-9d654fe56bec","type":"message","text":"what's the explanation?","user":"U01MG0TN079","ts":"1616054496.085500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qDn3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what's the explanation?"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"19651121-b864-4d86-90ca-c87047e31289","type":"message","text":"`[¶and(2,2) I]` gets you a dense matrix, `[rand(2,2) I(2)]`  gets you a sparse one.","user":"U01M655G9AR","ts":"1616054547.085700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sh6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"[¶and(2,2) I]","style":{"code":true}},{"type":"text","text":" gets you a dense matrix, "},{"type":"text","text":"[rand(2,2) I(2)]","style":{"code":true}},{"type":"text","text":"  gets you a sparse one."}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"65ea481e-2bf8-44cd-a331-89a5fb3a1b27","type":"message","text":"``¶and``  this is a typo?","user":"U01MG0TN079","ts":"1616054642.085900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FLLeD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"`"},{"type":"text","text":"¶and`","style":{"code":true}},{"type":"text","text":"  this is a typo?"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"f8d29499-8337-4a78-8769-cff645bfd7ca","type":"message","text":"But OK, thank you for the help!","user":"U01MG0TN079","ts":"1616054651.086400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oXbM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But OK, thank you for the help!"}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079","reactions":[{"name":"thumbsup_all","users":["U01M655G9AR"],"count":1}]},{"client_msg_id":"fe35ee27-f19a-4b1e-9a31-27103b11f297","type":"message","text":"It's tricky to decide a priori what's best for each method, and some times the choice errs on the sparse side because you risk less to saturate memory.","user":"U01M655G9AR","ts":"1616054662.086600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4Cv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It's tricky to decide a priori what's best for each method, and some times the choice errs on the sparse side because you risk less to saturate memory."}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"},{"client_msg_id":"465b7eb4-d143-409b-8fd2-7ef4c1d082bb","type":"message","text":"yes sorry, should be `rand`","user":"U01M655G9AR","ts":"1616054675.086800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RDj6d","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes sorry, should be "},{"type":"text","text":"rand","style":{"code":true}}]}]}],"thread_ts":"1616051841.082600","parent_user_id":"U01MG0TN079"}]