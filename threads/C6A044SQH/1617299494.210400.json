[{"client_msg_id":"0eced76f-ba1a-48a7-bb2f-a7cba4362e12","type":"message","text":"What's the difference between a `Ref` and a 0-dim array?","user":"U73ACR3TQ","ts":"1617299494.210400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FFS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What's the difference between a "},{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":" and a 0-dim array?"}]}]}],"thread_ts":"1617299494.210400","reply_count":17,"reply_users_count":4,"latest_reply":"1617305979.215900","reply_users":["UDB26738Q","UAUPJLBQX","UH24GRBLL","UM30MT6RF"],"is_locked":false,"subscribed":false},{"client_msg_id":"8fb8f47a-8111-4bd4-b084-a94285144169","type":"message","text":"the length: 1 for a `Ref`, 0 for a 0-dim array","user":"UDB26738Q","ts":"1617299564.210500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KNH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the length: 1 for a "},{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":", 0 for a 0-dim array"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ","reactions":[{"name":"exploding_head","users":["U73ACR3TQ"],"count":1}]},{"client_msg_id":"b9dcf99d-7f01-4e2c-9e7a-599484a97cc3","type":"message","text":"Also, `Ref`s can be stack allocated.","user":"UAUPJLBQX","ts":"1617299856.210700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MS/3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also, "},{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":"s can be stack allocated."}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"c836835f-9b88-49a7-8b65-9b76e5277219","type":"message","text":"can they?","user":"UH24GRBLL","ts":"1617299926.211300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BDH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"can they?"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"4337e4f4-acfe-404d-8808-4c895b6272d8","type":"message","text":"wouldn't that also mean that <https://github.com/JuliaLang/julia/issues/39041>  wouldn't allocate?","user":"UH24GRBLL","ts":"1617300003.211500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5K0b","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"wouldn't that also mean that "},{"type":"link","url":"https://github.com/JuliaLang/julia/issues/39041"},{"type":"text","text":"  wouldn't allocate?"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"02835338-9093-416c-a8be-e5f192e01cce","type":"message","text":"ah, I misunderstood the underlying problem, carry on","user":"UH24GRBLL","ts":"1617300195.211700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+V5yk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ah, I misunderstood the underlying problem, carry on"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"5bc56f57-0057-4975-8dc4-5ad841eac40f","type":"message","text":"hm, no, now I'm not sure again :thinking_face: If Refs were stack allocatable, that Ref would not have to be preserved with `@noinline`, I think?","user":"UH24GRBLL","ts":"1617300424.212000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"iBi0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"hm, no, now I'm not sure again "},{"type":"emoji","name":"thinking_face"},{"type":"text","text":" If Refs were stack allocatable, that Ref would not have to be preserved with "},{"type":"text","text":"@noinline","style":{"code":true}},{"type":"text","text":", I think?"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"1dd29055-eb9e-4bf8-9be7-28d12fbf5c08","type":"message","text":"They can also be completely eliminated by the compiler","user":"UAUPJLBQX","ts":"1617303941.213700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Jl88","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"They can also be completely eliminated by the compiler"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"a73b6d2a-68af-436d-baaa-35a427f934f5","type":"message","text":"unlike array allocation, `Ref`s are transparent","user":"UAUPJLBQX","ts":"1617303961.213900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"rc=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"unlike array allocation, "},{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":"s are transparent"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"8220c459-c105-4fb7-8c4b-119706332a64","type":"message","text":"If `Ref`s always allocated, using them when broadcasting wouldn't be so popular.","user":"UAUPJLBQX","ts":"1617304035.214100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QMXc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If "},{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":"s always allocated, using them when broadcasting wouldn't be so popular."}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"3b0984f3-f101-445b-b366-2f8e1a145550","type":"message","text":"`Ref`s are often used for pass-by-reference in `ccall`, especially when calling Fortran code","user":"UAUPJLBQX","ts":"1617304071.214300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TngZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":"s are often used for pass-by-reference in "},{"type":"text","text":"ccall","style":{"code":true}},{"type":"text","text":", especially when calling Fortran code"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"c919a846-adc4-4435-802d-e7e0a4ade7e7","type":"message","text":"&gt; the length: 1 for a `Ref`, 0 for a 0-dim array\n\nThey should both be length one, no?","user":"UM30MT6RF","ts":"1617305292.214700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KxB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"> the length: 1 for a "},{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":", 0 for a 0-dim array\n\nThey should both be length one, no?"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"1cca8e5f-3d1c-49e2-a228-76608ce4fb0f","type":"message","text":"should they?","user":"UDB26738Q","ts":"1617305387.214900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yzE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"should they?"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"41b14535-4764-414f-9fa0-33c6df8398de","type":"message","text":"Yep, a 0d array always contains exactly one entry, ie `fill(42)[] == 42`","user":"UM30MT6RF","ts":"1617305690.215100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"km8Le","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yep, a 0d array always contains exactly one entry, ie "},{"type":"text","text":"fill(42)[] == 42","style":{"code":true}}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"ad59e5e9-6c95-4275-a113-f0c7e500f277","type":"message","text":"oh, I was thinking to `[]`","user":"UDB26738Q","ts":"1617305740.215300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9IR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh, I was thinking to "},{"type":"text","text":"[]","style":{"code":true}}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"f45512d0-eaea-4458-99de-0e5cb6e1a4ec","type":"message","text":"Ah, I see. Yes, I think the OP meant `Array{T, 0}`, IIUC","user":"UM30MT6RF","ts":"1617305854.215500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oUj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah, I see. Yes, I think the OP meant "},{"type":"text","text":"Array{T, 0}","style":{"code":true}},{"type":"text","text":", IIUC"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"16d6fcc1-1132-45af-8b17-e05d89020928","type":"message","text":"`[]` is an empty vector, I guess","user":"UDB26738Q","ts":"1617305957.215700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Xly","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"[]","style":{"code":true}},{"type":"text","text":" is an empty vector, I guess"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"a79a296f-9d76-4acf-b21e-707494405898","type":"message","text":"Yes, exactly","user":"UM30MT6RF","ts":"1617305979.215900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RmEPE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes, exactly"}]}]}],"thread_ts":"1617299494.210400","parent_user_id":"U73ACR3TQ"}]