[{"client_msg_id":"f06f14d8-a9ea-483d-97f5-a3ac9487ddb0","type":"message","text":"A non-julia-specific question: say I have some code that eats up a lot of memory, (some gigas). The access is pretty much \"streaming\" through the data now and again, and updating it/adding entries. Does it make sense for performance reasons to store the data on disk?","user":"U01MG0TN079","ts":"1614242212.327900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5Ds","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"A non-julia-specific question: say I have some code that eats up a lot of memory, (some gigas). The access is pretty much \"streaming\" through the data now and again, and updating it/adding entries. Does it make sense for performance reasons to store the data on disk?"}]}]}],"thread_ts":"1614242212.327900","reply_count":28,"reply_users_count":3,"latest_reply":"1614244245.333900","reply_users":["B01J9QZ4SP8","U01MG0TN079","UH24GRBLL"],"subscribed":false},{"type":"message","subtype":"bot_message","text":"Can we cross post this publicly to <https://discourse.julialang.org|Discourse> for further visibility? React with :bridge: on the message above to approve. <https://github.com/JuliaCommunity/SlackBridge/blob/main/README.md#faq|More info here>","ts":"1614242214.328100","username":"HelpDeskBot","bot_id":"B01J9QZ4SP8","thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"4207f994-5e90-466a-be6d-ae3b8e652217","type":"message","text":"It seems when ram becomes rare, the system gets very laggy and even CPU usage of the code drops, which makes it seem to me that the system is choking","user":"U01MG0TN079","ts":"1614242273.328300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1EB0z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It seems when ram becomes rare, the system gets very laggy and even CPU usage of the code drops, which makes it seem to me that the system is choking"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"cb04023c-4387-47ae-b29e-1490517d80e5","type":"message","text":"and I have a notion that since the data access is essentially \"streaming\", maybe it's better to store everything on disk","user":"U01MG0TN079","ts":"1614242341.328500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"w8XU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and I have a notion that since the data access is essentially \"streaming\", maybe it's better to store everything on disk"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"7a465327-5004-4a06-bf24-d94d1c420182","type":"message","text":"sounds like you're swapping","user":"UH24GRBLL","ts":"1614242375.328700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qUg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"sounds like you're swapping"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"25032207-65a0-43c8-971d-e2f3f70d8ef4","type":"message","text":"you may want to mmap this","user":"UH24GRBLL","ts":"1614242384.328900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WP/Y0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"you may want to mmap this"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"d9637b8b-89a3-4f01-bb8a-a30b41c274d5","type":"message","text":"that won't necessarily fix the performance issue - if you hit disk (either via swapping or via Mmap), you'll have to wait until its done loading into RAM","user":"UH24GRBLL","ts":"1614242441.329100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7C5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that won't necessarily fix the performance issue - if you hit disk (either via swapping or via Mmap), you'll have to wait until its done loading into RAM"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"8a980491-e8fa-4060-9fe7-fbe677d3d4d8","type":"message","text":"but Mmap should be a little smarter than the swapping algorithm, I think","user":"UH24GRBLL","ts":"1614242457.329300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Hfz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but Mmap should be a little smarter than the swapping algorithm, I think"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"9772f424-a815-4dae-8b73-24cc2be8a39c","type":"message","text":"yeah, pretty sure it's swapping, since the usage gets very high","user":"U01MG0TN079","ts":"1614242807.329500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"PXAl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah, pretty sure it's swapping, since the usage gets very high"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"f7051b55-945c-4f0d-ad0b-549e1f4077a7","type":"message","text":"does Mmapping means doing that in the julia code?","user":"U01MG0TN079","ts":"1614242839.329700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/v/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"does Mmapping means doing that in the julia code?"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"0f7be47d-ab04-4d56-b55d-b70982613d5e","type":"message","text":"<https://docs.julialang.org/en/v1/stdlib/Mmap/>","user":"UH24GRBLL","ts":"1614242978.329900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hmBX","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://docs.julialang.org/en/v1/stdlib/Mmap/"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"4aabb981-0a74-463a-bcf6-ea06843c29dc","type":"message","text":"note that this is only useful if you're processing files larger than your total available RAM","user":"UH24GRBLL","ts":"1614243009.330100","team":"T68168MUP","edited":{"user":"UH24GRBLL","ts":"1614243109.000000"},"blocks":[{"type":"rich_text","block_id":"aobl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"note that this is only useful if you're processing files larger than your total available RAM"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"1f2caae3-92f3-475d-8b06-fe109effb29e","type":"message","text":"mmh, maybe I should try for better code first","user":"U01MG0TN079","ts":"1614243080.330300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sqqX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"mmh, maybe I should try for better code first"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"493fba86-4f80-4e0a-91b1-c8d0d3116627","type":"message","text":"If your code is allocating a lot, you could try to rework it to allocate less","user":"UH24GRBLL","ts":"1614243138.330600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"utYHu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If your code is allocating a lot, you could try to rework it to allocate less"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"11d51894-ef3f-4d32-957d-ac861fed7559","type":"message","text":"right, but the code is about storing \"all subgraphs of type X\" of some graph, with the cardinality of the graph getting to ~40, and the subgraphs getting to ~20","user":"U01MG0TN079","ts":"1614243289.330800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6he=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"right, but the code is about storing \"all subgraphs of type X\" of some graph, with the cardinality of the graph getting to ~40, and the subgraphs getting to ~20"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"dbc36bd4-cb99-4e0d-b5ec-843d07ea63c2","type":"message","text":"so it seems the allocation is pretty much bound by the algo's needs","user":"U01MG0TN079","ts":"1614243338.331000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ix0J","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so it seems the allocation is pretty much bound by the algo's needs"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"bd377d25-d6d4-4341-84d4-033aeae1a60c","type":"message","text":"sure, but that alone doesn't tell me anything about where your implementation spends its time","user":"UH24GRBLL","ts":"1614243355.331200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RCQx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"sure, but that alone doesn't tell me anything about where your implementation spends its time"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"c5896e6f-fee2-4e8c-8ed3-500e89a51185","type":"message","text":"ah, what do you mean?","user":"U01MG0TN079","ts":"1614243379.331400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Rk3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ah, what do you mean?"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"e1642469-ce8b-4af3-bf6b-68484a5d27bd","type":"message","text":"it's also dependent on how your code represents the graph(s) - if you e.g. use linked lists and continously create new elemnts or use a connection matrix approach","user":"UH24GRBLL","ts":"1614243406.331600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qNu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it's also dependent on how your code represents the graph(s) - if you e.g. use linked lists and continously create new elemnts or use a connection matrix approach"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"41d72aed-9050-48bb-99cc-c9274326feb6","type":"message","text":"and conversely, how you represent subgraphs","user":"UH24GRBLL","ts":"1614243424.331800","team":"T68168MUP","edited":{"user":"UH24GRBLL","ts":"1614243430.000000"},"blocks":[{"type":"rich_text","block_id":"D4t","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and conversely, how you represent subgraphs"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"01e350c3-c23b-4561-9dc4-7be113de24bb","type":"message","text":"the subgraphs are essentially stored as bitsets","user":"U01MG0TN079","ts":"1614243431.332100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BraPC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the subgraphs are essentially stored as bitsets"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"bb53b335-0793-494b-af0f-e6d4c826f027","type":"message","text":"and the whole graph is a matrix","user":"U01MG0TN079","ts":"1614243441.332300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oz+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and the whole graph is a matrix"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"e7ff786b-70cf-41f2-8018-e57f9503bf11","type":"message","text":"well, I'll leave soon but I'll make the code accessible then,","user":"U01MG0TN079","ts":"1614243502.332500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"d=q2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"well, I'll leave soon but I'll make the code accessible then,"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"34c7e524-25d6-4b54-a541-213a77e2a984","type":"message","text":"what I'm getting at is that just from the description \"it's a graph algorithm/problem\" I can't tell where your actual code is spending time/waiting/using ressources","user":"UH24GRBLL","ts":"1614243510.332700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xb0nx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what I'm getting at is that just from the description \"it's a graph algorithm/problem\" I can't tell where your actual code is spending time/waiting/using ressources"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"6e3467fa-a5db-4bf1-b89a-4fc301b43c42","type":"message","text":"yes, the total space/time needed is some O(N/M/etc), but with allocations, it matters when you do them, if you reuse memory etc","user":"UH24GRBLL","ts":"1614243567.332900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Tb7E","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes, the total space/time needed is some O(N/M/etc), but with allocations, it matters when you do them, if you reuse memory etc"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"28245f41-4c6b-4eee-b1c7-601788757262","type":"message","text":"that's some part of things a complexity analysis can't tell you","user":"UH24GRBLL","ts":"1614243593.333100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FixY9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that's some part of things a complexity analysis can't tell you"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"26386c42-29e0-4736-890d-bd40f8e8f407","type":"message","text":"You mean, it might be that the ram usage/swapping is actually no bottleneck, but just looks to be so","user":"U01MG0TN079","ts":"1614243804.333300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"90Er","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You mean, it might be that the ram usage/swapping is actually no bottleneck, but just looks to be so"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"9da4aa0b-7d9d-4e7d-bdfb-4c8e3409e92a","type":"message","text":"because cpu intensive stuff happens anyway, and doesn't have to wait on the memory?","user":"U01MG0TN079","ts":"1614243828.333700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+qTRE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"because cpu intensive stuff happens anyway, and doesn't have to wait on the memory?"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"},{"client_msg_id":"9307ab15-d3bf-4fe5-a0b5-b7271ae7caff","type":"message","text":"that and it also makes a difference how you implement the algorithm - if you copy a lot of data around unnecessarily, less time is spent on actually y'know running the computation you're interested in","user":"UH24GRBLL","ts":"1614244245.333900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UfC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that and it also makes a difference how you implement the algorithm - if you copy a lot of data around unnecessarily, less time is spent on actually y'know running the computation you're interested in"}]}]}],"thread_ts":"1614242212.327900","parent_user_id":"U01MG0TN079"}]