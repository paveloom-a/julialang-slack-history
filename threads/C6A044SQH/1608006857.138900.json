[{"client_msg_id":"355fa881-f3a8-45c4-9318-6dcc9808d0e0","type":"message","text":"is there's something like `NamedTuple` but keys are `String`? (`Base.getindex(N::NamedTuple, name::String) = getfield(N, Symbol(name))` implies a performance hit","user":"UH8A351DJ","ts":"1608006857.138900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GDRP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"is there's something like "},{"type":"text","text":"NamedTuple","style":{"code":true}},{"type":"text","text":" but keys are "},{"type":"text","text":"String","style":{"code":true}},{"type":"text","text":"? ("},{"type":"text","text":"Base.getindex(N::NamedTuple, name::String) = getfield(N, Symbol(name))","style":{"code":true}},{"type":"text","text":" implies a performance hit"}]}]}],"thread_ts":"1608006857.138900","reply_count":14,"reply_users_count":4,"latest_reply":"1608024027.158400","reply_users":["UH8A351DJ","U6QGE7S86","UGU761DU2","U01ECBX4MB7"],"subscribed":false},{"type":"message","text":"actually this is pretty confusing","files":[{"id":"F01GU0NT50V","created":1608007234,"timestamp":1608007234,"name":"image.png","title":"image.png","mimetype":"image/png","filetype":"png","pretty_type":"PNG","user":"UH8A351DJ","editable":false,"size":46525,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01GU0NT50V/image.png","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01GU0NT50V/download/image.png","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01GU0NT50V-170fc3df7f/image_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01GU0NT50V-170fc3df7f/image_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01GU0NT50V-170fc3df7f/image_360.png","thumb_360_w":360,"thumb_360_h":219,"thumb_480":"https://files.slack.com/files-tmb/T68168MUP-F01GU0NT50V-170fc3df7f/image_480.png","thumb_480_w":480,"thumb_480_h":293,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01GU0NT50V-170fc3df7f/image_160.png","original_w":566,"original_h":345,"thumb_tiny":"AwAdADCmSPSjI9KXBPelOezGgBmfYUU/5uzGmnceDQAlFLtNJQAvyn2pfloBHcUFs9qAD5aT5c07d7UmeelAB8tNpeMdD+dJQB//2Q==","permalink":"https://julialang.slack.com/files/UH8A351DJ/F01GU0NT50V/image.png","permalink_public":"https://slack-files.com/T68168MUP-F01GU0NT50V-72f48617ac","is_starred":false,"has_rich_preview":false}],"upload":false,"blocks":[{"type":"rich_text","block_id":"Jlr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"actually this is pretty confusing"}]}]}],"user":"UH8A351DJ","display_as_bot":false,"ts":"1608007238.139000","thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"44f44fe5-9e6a-411f-bb7a-3800e876500b","type":"message","text":"You gotta remember to inclue the `$`:","user":"U6QGE7S86","ts":"1608007391.139400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dfcAY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You gotta remember to inclue the "},{"type":"text","text":"$","style":{"code":true}},{"type":"text","text":":"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"d2167159-bea3-4594-836d-9fe986a5e887","type":"message","text":"```\njulia&gt; @btime x[Symbol(\"a\")]\n  36.432 ns (1 allocation: 32 bytes)\n\njulia&gt; @btime x[Symbol($\"a\")]\n  74.994 ns (1 allocation: 32 bytes)\n\njulia&gt; @btime $x[:a];\n  0.012 ns (0 allocations: 0 bytes)\n\njulia&gt; @btime getfield($x, Symbol($\"a\"))\n  0.012 ns (0 allocations: 0 bytes)\n\njulia&gt; @btime x[Symbol(\"a\")]\n  36.367 ns (1 allocation: 32 bytes)\n\njulia&gt; @btime $x[Symbol($\"a\")]\n  0.018 ns (0 allocations: 0 bytes)```","user":"U6QGE7S86","ts":"1608007436.139600","team":"T68168MUP","edited":{"user":"U6QGE7S86","ts":"1608007466.000000"},"blocks":[{"type":"rich_text","block_id":"Tqpx","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"\njulia> @btime x[Symbol(\"a\")]\n  36.432 ns (1 allocation: 32 bytes)\n\njulia> @btime x[Symbol($\"a\")]\n  74.994 ns (1 allocation: 32 bytes)\n\njulia> @btime $x[:a];\n  0.012 ns (0 allocations: 0 bytes)\n\njulia> @btime getfield($x, Symbol($\"a\"))\n  0.012 ns (0 allocations: 0 bytes)\n\njulia> @btime x[Symbol(\"a\")]\n  36.367 ns (1 allocation: 32 bytes)\n\njulia> @btime $x[Symbol($\"a\")]\n  0.018 ns (0 allocations: 0 bytes)"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"45804458-3fee-4a27-b11a-8431bc164044","type":"message","text":"that just optimized away the actual time","user":"UH8A351DJ","ts":"1608007458.139800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3WZ/j","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that just optimized away the actual time"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"fcae8df0-088d-4845-9627-9045893f73a5","type":"message","text":"I think `Base.getindex(N::NamedTuple, name::String) = getfield(N, Symbol(name))` is not good","user":"UH8A351DJ","ts":"1608007487.140100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"A2T","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think "},{"type":"text","text":"Base.getindex(N::NamedTuple, name::String) = getfield(N, Symbol(name))","style":{"code":true}},{"type":"text","text":" is not good"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"95ef3f72-d3a6-4ea1-8e7d-3fe7709560fc","type":"message","text":"can't tell :shrug::skin-tone-5:","user":"U6QGE7S86","ts":"1608007629.140300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VrhQI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"can't tell "},{"type":"emoji","name":"shrug","skin_tone":5}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"645bd96e-82b1-4eec-a944-dc9347251acd","type":"message","text":"isn't 0.02ns basically a (few) clock cycle?","user":"UH8A351DJ","ts":"1608007659.140600","team":"T68168MUP","edited":{"user":"UH8A351DJ","ts":"1608007731.000000"},"blocks":[{"type":"rich_text","block_id":"fl9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"isn't 0.02ns basically a (few) clock cycle?"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"3181d9f7-9faf-49ad-b64c-8c55ee19c7c1","type":"message","text":"I have a loop over 100k, and `t[:name]` vs. `t[\"name\"]` is 12ms vs. 40ms","user":"UH8A351DJ","ts":"1608007697.140900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QyVp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have a loop over 100k, and "},{"type":"text","text":"t[:name]","style":{"code":true}},{"type":"text","text":" vs. "},{"type":"text","text":"t[\"name\"]","style":{"code":true}},{"type":"text","text":" is 12ms vs. 40ms"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"c9b048b6-7ffa-458b-9332-0f142850bc8d","type":"message","text":"so something is slower for sure","user":"UH8A351DJ","ts":"1608007710.141200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SS+m/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so something is slower for sure"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"385ce3eb-986e-45a7-85a5-c0b85972de82","type":"message","text":"0.02 ns is like a tenth of a clock cycle, so yeah, there the benchmark has been outsmarted by the compiler. I think there’s some trick with `Ref` I’ve seen people use to get around that","user":"UGU761DU2","ts":"1608009077.141500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"d605v","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"0.02 ns is like a tenth of a clock cycle, so yeah, there the benchmark has been outsmarted by the compiler. I think there’s some trick with "},{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":" I’ve seen people use to get around that"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"eb5e3cba-c0c3-4716-bc7e-75a53f3f4dae","type":"message","text":"Something along the lines of\n```julia&gt; @btime x[:a] # Too slow because global variable\n  42.905 ns (1 allocation: 32 bytes)\n\njulia&gt; @btime $x[:a] # Outsmarted by compiler\n  0.020 ns (0 allocations: 0 bytes)\n\njulia&gt; @btime $x[$Ref(:a)[]] # actual time, maybe??\n  1.375 ns (0 allocations: 0 bytes)```","user":"UGU761DU2","ts":"1608009241.141700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YVPN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Something along the lines of\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> @btime x[:a] # Too slow because global variable\n  42.905 ns (1 allocation: 32 bytes)\n\njulia> @btime $x[:a] # Outsmarted by compiler\n  0.020 ns (0 allocations: 0 bytes)\n\njulia> @btime $x[$Ref(:a)[]] # actual time, maybe??\n  1.375 ns (0 allocations: 0 bytes)"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"f832f5fb-fbef-4b66-9d9c-629d052c79de","type":"message","text":"Isnt \"name\" heap allocated everytime?","user":"U6QGE7S86","ts":"1608009682.141900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"53Hu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Isnt \"name\" heap allocated everytime?"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"301a8bdb-b8bc-4c73-8236-095fd51393ac","type":"message","text":"<@UGU761DU2> oh nice hacking haha","user":"UH8A351DJ","ts":"1608010124.142100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qa4HP","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UGU761DU2"},{"type":"text","text":" oh nice hacking haha"}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"6f77a16a-b3c3-4fd1-ac6a-9b7646df35f6","type":"message","text":"I usually use:\n```julia&gt; @btime $nt[k] setup=(k=rand((:a, :b)))\n  21.246 ns (1 allocation: 32 bytes)```\nwhich simulates a realistic case where the key isn’t known statically.","user":"U01ECBX4MB7","ts":"1608024027.158400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XCy3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I usually use:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> @btime $nt[k] setup=(k=rand((:a, :b)))\n  21.246 ns (1 allocation: 32 bytes)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"which simulates a realistic case where the key isn’t known statically."}]}]}],"thread_ts":"1608006857.138900","parent_user_id":"UH8A351DJ","reactions":[{"name":"+1","users":["UGU761DU2","UH8A351DJ"],"count":2}]}]