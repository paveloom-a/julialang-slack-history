[{"client_msg_id":"5f9a3324-71b4-486f-b52b-5fadfd280a60","type":"message","text":"I have this large generated function `foo` . It's a massive function, with several parts of the (generated) function being duplicated. The function is so large that I'm afraid it can cause cache issues or general slowdown, so I'd like to automatically factor out the duplicated parts. I could do that by having an inner function that is called repeatedly. But how can I made a \"function\" that has access to all the local variables of the outer function?\nDoes what I wrote there make sense?","user":"U7HAYKY9X","ts":"1616943601.367900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZfpN2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have this large generated function "},{"type":"text","text":"foo","style":{"code":true}},{"type":"text","text":" . It's a massive function, with several parts of the (generated) function being duplicated. The function is so large that I'm afraid it can cause cache issues or general slowdown, so I'd like to automatically factor out the duplicated parts. I could do that by having an inner function that is called repeatedly. But how can I made a \"function\" that has access to all the local variables of the outer function?\nDoes what I wrote there make sense?"}]}]}],"thread_ts":"1616943601.367900","reply_count":8,"reply_users_count":3,"latest_reply":"1616944558.369600","reply_users":["U01M655G9AR","U0179G7FG4F","U7HAYKY9X"],"is_locked":false,"subscribed":false},{"client_msg_id":"3d38aa31-2828-4749-9b3d-1a482b49a4b1","type":"message","text":"just define the inner function inside the outer function, it will have access to all local variables of the outer one","user":"U01M655G9AR","ts":"1616943720.368100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4KBS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"just define the inner function inside the outer function, it will have access to all local variables of the outer one"}]}]}],"thread_ts":"1616943601.367900","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"a79111d9-64fc-4323-a7e0-76539768fc56","type":"message","text":"or maybe I'm misunderstanding the problem :wink:","user":"U01M655G9AR","ts":"1616943760.368400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dLF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"or maybe I'm misunderstanding the problem "},{"type":"emoji","name":"wink"}]}]}],"thread_ts":"1616943601.367900","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"e81f9080-860a-41f1-b4dd-34fcae8f7356","type":"message","text":"You can also just factor into variables","user":"U0179G7FG4F","ts":"1616943774.368600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WM=S","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You can also just factor into variables"}]}]}],"thread_ts":"1616943601.367900","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"c3efeb14-d72b-40f4-80c0-0f1ed3e70a83","type":"message","text":"Will there be a performance penalty for acessing variables in the outer function from the inner function?","user":"U7HAYKY9X","ts":"1616943814.368800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"445","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Will there be a performance penalty for acessing variables in the outer function from the inner function?"}]}]}],"thread_ts":"1616943601.367900","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"404a7d9b-3d72-4e0a-8583-24679e1af66a","type":"message","text":"I.e. in:\n```function foo(x)\n    bar() = x + 1\n    y = bar()\n    x = isodd(y) ? y + 2 : y\n    y = bar()\n    y\nend```\nit looks like `bar` doesn't inline.","user":"U7HAYKY9X","ts":"1616943850.369000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XYhX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I.e. in:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function foo(x)\n    bar() = x + 1\n    y = bar()\n    x = isodd(y) ? y + 2 : y\n    y = bar()\n    y\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"it looks like "},{"type":"text","text":"bar","style":{"code":true}},{"type":"text","text":" doesn't inline."}]}]}],"thread_ts":"1616943601.367900","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"3154a992-0a6c-4cb6-8ac0-efb6f575ec79","type":"message","text":"<@U0179G7FG4F> what do you mean by factoring into variables?","user":"U7HAYKY9X","ts":"1616943868.369200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3E=9","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U0179G7FG4F"},{"type":"text","text":" what do you mean by factoring into variables?"}]}]}],"thread_ts":"1616943601.367900","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"95882220-2f81-48fa-a59a-5a917ba05531","type":"message","text":"Basically I want a function without a scope - or something that behaves like a function without a scope. Is such a thing possible?","user":"U7HAYKY9X","ts":"1616944088.369400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DI7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Basically I want a function without a scope - or something that behaves like a function without a scope. Is such a thing possible?"}]}]}],"thread_ts":"1616943601.367900","parent_user_id":"U7HAYKY9X"},{"client_msg_id":"8756e979-46a4-4530-a5e9-f16a5adfeb17","type":"message","text":"I guess I can do something like this:\n```function foo(x)\n    endpoint = 0\n    @goto bar\n    @label endpoint0\n    x = isodd(y) ? y + 2 : y\n    endpoint = 1\n    @goto bar\n    @label endpoint1\n    return y\n    @label bar\n    y = x + 1\n    if endpoint == 0\n        @goto endpoint0\n    else\n        @goto endpoint1\n    end\nend```\n","user":"U7HAYKY9X","ts":"1616944558.369600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1gr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I guess I can do something like this:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function foo(x)\n    endpoint = 0\n    @goto bar\n    @label endpoint0\n    x = isodd(y) ? y + 2 : y\n    endpoint = 1\n    @goto bar\n    @label endpoint1\n    return y\n    @label bar\n    y = x + 1\n    if endpoint == 0\n        @goto endpoint0\n    else\n        @goto endpoint1\n    end\nend"}]},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1616943601.367900","parent_user_id":"U7HAYKY9X"}]