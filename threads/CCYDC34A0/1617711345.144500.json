[{"client_msg_id":"bbc94cf5-ef7f-4f5f-87a7-c484fae3d3e7","type":"message","text":"Hi all, I'm tipping my toes gently in Julia and Turing and so far I really love what I see, but I have some difficulties coming from python (and relatively new to PPLs in general).\nI'm trying to do something that I guess should be simple but got stuck so I thought I'd fetch some help :slightly_smiling_face:\nI'm trying to fit a zero-truncated Poisson, and get errors where the autodiff cannot infer the types of something. I basically adapted the simple example on Turing's homepage like so:\n```# Import libraries.\nusing Turing, StatsPlots, Random\n\n# Set the true Poisson rate\nλ_true = 0.5\n\n# Number of un-truncated Poisson observations (I know I can directly sample from Truncated, but don't want to).\nN = 1000\n\n# Draw data from a Poisson distribution\nRandom.seed!(12)\ndata = rand(Poisson(λ_true), N)\ndata_trunc = data[data .&gt; 0]\n\n# Declare our Turing model.\n@model function truncated_poisson(y)\n    # Our prior belief about the Poisson rate.\n    λ ~ Beta(1, 1)\n\n    # Data model\n    for n in 1:length(y)\n        y[n] ~ truncated(Poisson(λ), 0, Inf)\n    end\nend\n\nprint(length(data_trunc))\n\n# Settings of the Hamiltonian Monte Carlo (HMC) sampler.\niterations = 1000\nϵ = 0.05\nτ = 10\n\n# Start sampling.\nchain = sample(truncated_poisson(data_trunc), HMC(ϵ, τ), iterations)\n\n# Plot a summary of the sampling process for the parameter p, i.e. the probability of heads in a coin.\nhistogram(chain[:λ])```\nAm I doing something obviously stupid? I'd really appreciate help on this, thanks! :sweat_smile:  And thanks for the good work you guys are doing!!","user":"U01PJ4X8YCV","ts":"1617711345.144500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2Dmq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi all, I'm tipping my toes gently in Julia and Turing and so far I really love what I see, but I have some difficulties coming from python (and relatively new to PPLs in general).\nI'm trying to do something that I guess should be simple but got stuck so I thought I'd fetch some help "},{"type":"emoji","name":"slightly_smiling_face"},{"type":"text","text":"\nI'm trying to fit a zero-truncated Poisson, and get errors where the autodiff cannot infer the types of something. I basically adapted the simple example on Turing's homepage like so:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"# Import libraries.\nusing Turing, StatsPlots, Random\n\n# Set the true Poisson rate\nλ_true = 0.5\n\n# Number of un-truncated Poisson observations (I know I can directly sample from Truncated, but don't want to).\nN = 1000\n\n# Draw data from a Poisson distribution\nRandom.seed!(12)\ndata = rand(Poisson(λ_true), N)\ndata_trunc = data[data .> 0]\n\n# Declare our Turing model.\n@model function truncated_poisson(y)\n    # Our prior belief about the Poisson rate.\n    λ ~ Beta(1, 1)\n\n    # Data model\n    for n in 1:length(y)\n        y[n] ~ truncated(Poisson(λ), 0, Inf)\n    end\nend\n\nprint(length(data_trunc))\n\n# Settings of the Hamiltonian Monte Carlo (HMC) sampler.\niterations = 1000\nϵ = 0.05\nτ = 10\n\n# Start sampling.\nchain = sample(truncated_poisson(data_trunc), HMC(ϵ, τ), iterations)\n\n# Plot a summary of the sampling process for the parameter p, i.e. the probability of heads in a coin.\nhistogram(chain[:λ])"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Am I doing something obviously stupid? I'd really appreciate help on this, thanks! "},{"type":"emoji","name":"sweat_smile"},{"type":"text","text":"  And thanks for the good work you guys are doing!!"}]}]}],"thread_ts":"1617711345.144500","reply_count":2,"reply_users_count":2,"latest_reply":"1617712307.144800","reply_users":["U01PJ4X8YCV","UC0SY9JFP"],"is_locked":false,"subscribed":false},{"client_msg_id":"c26754d2-3d71-4aba-8d92-ba7645dae33a","type":"message","text":"I forgot to add the error message I get. It starts with:\n```MethodError: no method matching poiscdf(::ForwardDiff.Dual{ForwardDiff.Tag{Turing.Core.var\"#f#1\"{DynamicPPL.VarInfo{NamedTuple{(:λ,),Tuple{DynamicPPL.Metadata{Dict{DynamicPPL.VarName{:λ,Tuple{}},Int64},Array{Beta{Float64},1},Array{DynamicPPL.VarName{:λ,Tuple{}},1},Array{Float64,1},Array{Set{DynamicPPL.Selector},1}}}},Float64},DynamicPPL.Model{var\"#29#30\",(:y,),(),(),Tuple{Array{Int64,1}},Tuple{}},DynamicPPL.Sampler{HMC{Turing.Core.ForwardDiffAD{40},(),AdvancedHMC.UnitEuclideanMetric}},DynamicPPL.DefaultContext},Float64},Float64,1}, ::Int64)\nClosest candidates are:\n  poiscdf(::Union{Float64, Int64}, ::Union{Float64, Int64}) at /home/omri/.julia/packages/StatsFuns/zJ1EI/src/rmath.jl:77```","user":"U01PJ4X8YCV","ts":"1617711446.144600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"N5qDW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I forgot to add the error message I get. It starts with:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"MethodError: no method matching poiscdf(::ForwardDiff.Dual{ForwardDiff.Tag{Turing.Core.var\"#f#1\"{DynamicPPL.VarInfo{NamedTuple{(:λ,),Tuple{DynamicPPL.Metadata{Dict{DynamicPPL.VarName{:λ,Tuple{}},Int64},Array{Beta{Float64},1},Array{DynamicPPL.VarName{:λ,Tuple{}},1},Array{Float64,1},Array{Set{DynamicPPL.Selector},1}}}},Float64},DynamicPPL.Model{var\"#29#30\",(:y,),(),(),Tuple{Array{Int64,1}},Tuple{}},DynamicPPL.Sampler{HMC{Turing.Core.ForwardDiffAD{40},(),AdvancedHMC.UnitEuclideanMetric}},DynamicPPL.DefaultContext},Float64},Float64,1}, ::Int64)\nClosest candidates are:\n  poiscdf(::Union{Float64, Int64}, ::Union{Float64, Int64}) at /home/omri/.julia/packages/StatsFuns/zJ1EI/src/rmath.jl:77"}]}]}],"thread_ts":"1617711345.144500","parent_user_id":"U01PJ4X8YCV"},{"client_msg_id":"5e8af94d-b378-43b9-9f67-e5cb83b60aec","type":"message","text":"Yeah, that looks like a typical *pain in the ass* AD issue for the CDF of a Poisson distribution as it’s imported as an R function from StatsFuns.","user":"UC0SY9JFP","ts":"1617712307.144800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sdh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, that looks like a typical "},{"type":"text","text":"pain in the ass","style":{"bold":true}},{"type":"text","text":" AD issue for the CDF of a Poisson distribution as it’s imported as an R function from StatsFuns."}]}]}],"thread_ts":"1617711345.144500","parent_user_id":"U01PJ4X8YCV"}]