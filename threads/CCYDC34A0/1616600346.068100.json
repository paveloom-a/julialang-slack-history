[{"client_msg_id":"f3f9b73a-b611-4558-8694-7e7bec869a71","type":"message","text":"I'm trying to debug my Turing model:\n```@model function gdemo(datasets)\n    σ₀ ~ Gamma(1.0, 1/0.02) # μm^2\n    logκ ~ Normal(log(2000), 2) # NoUnits\n    cm ~ TruncatedNormal(2.35, 1.5, 0.0, Inf) # NoUnits\n    e0 ~ Gamma(1.0, 1/0.2) # Gy\n    logsf_sigma ~ Gamma(1.0, 1/0.2)\n    density = 1u\"g/cm^3\"\n    dlogs = map(d -&gt; d.log_sfs, datasets)\n\n    for (i, dataset) in enumerate(datasets)\n        doses = dataset.doses\n\n        cur_beta = e2beta(dataset.E)\n        cur_zeff = zeff(dataset.Z, cur_beta)\n        zkb = cur_zeff^2/(cur_beta^2 * exp(logκ))\n        p_ion_kill = (1.0 - exp(-zkb))^cm\n        σ = σ₀ * p_ion_kill\n\n        alet = glet(cur_beta, dataset.Z)\n        log_ion_kill = σ .* uconvert.(Ref(NoUnits), -density .* doses ./ alet .* 1.0u\"μm^2\")\n        \n        doses_Gy = uconvert.(Ref(NoUnits), doses ./ 1.0u\"Gy\")\n\n        log_gamma_kill = log.(1.0 .- (1.0 .- exp.(- (1.0 .- p_ion_kill) .* doses_Gy ./ e0)).^cm)\n        logsfs_mu = log_ion_kill + log_gamma_kill\n\n        dlogs[i] ~ MvNormal(logsfs_mu, logsf_sigma)\n    end\nend```\nIt seems to not fit to my data at all, that is posteriors for the first five variables in this model look more or less like priors. Yet `ess` and `rhat` in chain statistics look great. Is there any obvious error?","user":"U9AHT3YM7","ts":"1616600346.068100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"buE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm trying to debug my Turing model:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"@model function gdemo(datasets)\n    σ₀ ~ Gamma(1.0, 1/0.02) # μm^2\n    logκ ~ Normal(log(2000), 2) # NoUnits\n    cm ~ TruncatedNormal(2.35, 1.5, 0.0, Inf) # NoUnits\n    e0 ~ Gamma(1.0, 1/0.2) # Gy\n    logsf_sigma ~ Gamma(1.0, 1/0.2)\n    density = 1u\"g/cm^3\"\n    dlogs = map(d -> d.log_sfs, datasets)\n\n    for (i, dataset) in enumerate(datasets)\n        doses = dataset.doses\n\n        cur_beta = e2beta(dataset.E)\n        cur_zeff = zeff(dataset.Z, cur_beta)\n        zkb = cur_zeff^2/(cur_beta^2 * exp(logκ))\n        p_ion_kill = (1.0 - exp(-zkb))^cm\n        σ = σ₀ * p_ion_kill\n\n        alet = glet(cur_beta, dataset.Z)\n        log_ion_kill = σ .* uconvert.(Ref(NoUnits), -density .* doses ./ alet .* 1.0u\"μm^2\")\n        \n        doses_Gy = uconvert.(Ref(NoUnits), doses ./ 1.0u\"Gy\")\n\n        log_gamma_kill = log.(1.0 .- (1.0 .- exp.(- (1.0 .- p_ion_kill) .* doses_Gy ./ e0)).^cm)\n        logsfs_mu = log_ion_kill + log_gamma_kill\n\n        dlogs[i] ~ MvNormal(logsfs_mu, logsf_sigma)\n    end\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"It seems to not fit to my data at all, that is posteriors for the first five variables in this model look more or less like priors. Yet "},{"type":"text","text":"ess","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"rhat","style":{"code":true}},{"type":"text","text":" in chain statistics look great. Is there any obvious error?"}]}]}],"thread_ts":"1616600346.068100","reply_count":7,"reply_users_count":2,"latest_reply":"1616601751.069500","reply_users":["UC0SY9JFP","U9AHT3YM7"],"is_locked":false,"subscribed":false},{"client_msg_id":"0f3d29c0-19e8-46c9-8b36-8a0dfcdcbf28","type":"message","text":"Turing determines what to condition on based on the function arguments. So you need to have `dlogs` to be the function argument. Currently Turing will sample `dlogs` from the prior and not condition on anything.","user":"UC0SY9JFP","ts":"1616600610.068200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8R6Ue","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Turing determines what to condition on based on the function arguments. So you need to have "},{"type":"text","text":"dlogs","style":{"code":true}},{"type":"text","text":" to be the function argument. Currently Turing will sample "},{"type":"text","text":"dlogs","style":{"code":true}},{"type":"text","text":" from the prior and not condition on anything."}]}]}],"thread_ts":"1616600346.068100","parent_user_id":"U9AHT3YM7"},{"client_msg_id":"9e8f1289-eb96-4c86-be9c-ca38a618c654","type":"message","text":"Basically, do this `dlogs = map(d -&gt; d.log_sfs, datasets)` outside the Turing model, change the function signature and pass `gdemo(dlogs, datasets)`.","user":"UC0SY9JFP","ts":"1616600712.068400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7sX7r","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Basically, do this "},{"type":"text","text":"dlogs = map(d -> d.log_sfs, datasets)","style":{"code":true}},{"type":"text","text":" outside the Turing model, change the function signature and pass "},{"type":"text","text":"gdemo(dlogs, datasets)","style":{"code":true}},{"type":"text","text":"."}]}]}],"thread_ts":"1616600346.068100","parent_user_id":"U9AHT3YM7"},{"client_msg_id":"95917827-0691-4844-b02c-687f09e2d7b2","type":"message","text":"oh, thanks!","user":"U9AHT3YM7","ts":"1616600769.068600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4Slh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh, thanks!"}]}]}],"thread_ts":"1616600346.068100","parent_user_id":"U9AHT3YM7"},{"client_msg_id":"f731f156-76ed-4dbb-be7f-e24b7b5aaf1e","type":"message","text":"hm, after making this change log evidence decreased from 0 to about -200 to -1000 (depending on the dataset) but that's all","user":"U9AHT3YM7","ts":"1616601354.068800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"V6L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"hm, after making this change log evidence decreased from 0 to about -200 to -1000 (depending on the dataset) but that's all"}]}]}],"thread_ts":"1616600346.068100","parent_user_id":"U9AHT3YM7"},{"client_msg_id":"e58a85e7-09de-4c1b-8d87-04adb08291f9","type":"message","text":"posteriors look more or less the same","user":"U9AHT3YM7","ts":"1616601368.069000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ODbl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"posteriors look more or less the same"}]}]}],"thread_ts":"1616600346.068100","parent_user_id":"U9AHT3YM7","reactions":[{"name":"face_with_raised_eyebrow","users":["UC0SY9JFP"],"count":1}]},{"client_msg_id":"9d359222-2862-4a49-9d9b-2c4fd24d1607","type":"message","text":"Do you have some MWE that you can share?","user":"UC0SY9JFP","ts":"1616601737.069300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"67n","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Do you have some MWE that you can share?"}]}]}],"thread_ts":"1616600346.068100","parent_user_id":"U9AHT3YM7"},{"client_msg_id":"8c28541b-8726-478c-bce5-b941430c2684","type":"message","text":"I have a meeting now, I'll try making one later","user":"U9AHT3YM7","ts":"1616601751.069500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lez","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have a meeting now, I'll try making one later"}]}]}],"thread_ts":"1616600346.068100","parent_user_id":"U9AHT3YM7"}]