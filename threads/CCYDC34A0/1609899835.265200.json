[{"type":"message","text":"I have a more general MCMC question if I may. If my chains look like the ones below, with them getting stuck in certain points for long time, what is this indicative off and how can it be fixed? These chains were produced by Metropolis-Hastings sampler in Turing.","files":[{"id":"F01J8RJKE4U","created":1609899829,"timestamp":1609899829,"name":"image.png","title":"image.png","mimetype":"image/png","filetype":"png","pretty_type":"PNG","user":"UPK2KJ95Y","editable":false,"size":180796,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01J8RJKE4U/image.png","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01J8RJKE4U/download/image.png","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01J8RJKE4U-ebc06b2523/image_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01J8RJKE4U-ebc06b2523/image_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01J8RJKE4U-ebc06b2523/image_360.png","thumb_360_w":291,"thumb_360_h":360,"thumb_480":"https://files.slack.com/files-tmb/T68168MUP-F01J8RJKE4U-ebc06b2523/image_480.png","thumb_480_w":388,"thumb_480_h":480,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01J8RJKE4U-ebc06b2523/image_160.png","thumb_720":"https://files.slack.com/files-tmb/T68168MUP-F01J8RJKE4U-ebc06b2523/image_720.png","thumb_720_w":582,"thumb_720_h":720,"thumb_800":"https://files.slack.com/files-tmb/T68168MUP-F01J8RJKE4U-ebc06b2523/image_800.png","thumb_800_w":647,"thumb_800_h":800,"thumb_960":"https://files.slack.com/files-tmb/T68168MUP-F01J8RJKE4U-ebc06b2523/image_960.png","thumb_960_w":777,"thumb_960_h":960,"original_w":779,"original_h":963,"thumb_tiny":"AwAwACbRDEdQaAw9CKQvjtSK/PTrTsK4/OfajI70gbIzilPJpDFzRRRQA3K0ArnqKXA7UgX2piFBB6UEUAAUHOaQxaKKKAGhcUD8ePekw3rRhs/epiHYxRkg/WkGe/NLmkMXmikzS0Af/9k=","permalink":"https://julialang.slack.com/files/UPK2KJ95Y/F01J8RJKE4U/image.png","permalink_public":"https://slack-files.com/T68168MUP-F01J8RJKE4U-e3f93d48be","is_starred":false,"has_rich_preview":false}],"upload":false,"blocks":[{"type":"rich_text","block_id":"kUfj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have a more general MCMC question if I may. If my chains look like the ones below, with them getting stuck in certain points for long time, what is this indicative off and how can it be fixed? These chains were produced by Metropolis-Hastings sampler in Turing."}]}]}],"user":"UPK2KJ95Y","display_as_bot":false,"ts":"1609899835.265200","thread_ts":"1609899835.265200","reply_count":5,"reply_users_count":2,"latest_reply":"1609902426.266300","reply_users":["UHDQQ4GN6","UPK2KJ95Y"],"subscribed":false},{"client_msg_id":"5af6c769-bcfc-4c8c-93de-80ea486cde6f","type":"message","text":"These often indicate high curvature. There may be a lot of probability mass near a \"wall\" in the logpdf, so MCMC needs to sample that, but when it gets close, there's a good chance it will propose new moves jumping into the wall, which are always rejected, so you'll potentially have long periods being stuck near the wall and long periods not being able to get close to the wall. Importantly, cases like this violate the geometric requirements needed for the expectations computed by MCMC to converge to the true expectations wrt the posterior distribution. If you sample with NUTS, you'll see \"numerical error\" warnings. Sometimes all that is necessary is a reparamaterization (look up centered vs non-centered parameterizations). Sometimes it indicates a problem with the model. If using NUTS, plotting the divergent transitions (those with numerical error) can be helpful to diagnose where high curvature happens.","user":"UHDQQ4GN6","ts":"1609901974.265500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"l4xmL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"These often indicate high curvature. There may be a lot of probability mass near a \"wall\" in the logpdf, so MCMC needs to sample that, but when it gets close, there's a good chance it will propose new moves jumping into the wall, which are always rejected, so you'll potentially have long periods being stuck near the wall and long periods not being able to get close to the wall. Importantly, cases like this violate the geometric requirements needed for the expectations computed by MCMC to converge to the true expectations wrt the posterior distribution. If you sample with NUTS, you'll see \"numerical error\" warnings. Sometimes all that is necessary is a reparamaterization (look up centered vs non-centered parameterizations). Sometimes it indicates a problem with the model. If using NUTS, plotting the divergent transitions (those with numerical error) can be helpful to diagnose where high curvature happens."}]}]}],"thread_ts":"1609899835.265200","parent_user_id":"UPK2KJ95Y"},{"client_msg_id":"0ea91d8e-255b-485a-9618-16d9298c6df8","type":"message","text":"By curvature you mean where log-likelihood suddenly drops?","user":"UPK2KJ95Y","ts":"1609902112.265700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"G5D9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"By curvature you mean where log-likelihood suddenly drops?"}]}]}],"thread_ts":"1609899835.265200","parent_user_id":"UPK2KJ95Y"},{"client_msg_id":"cd121698-d74a-4112-bb60-95b9eadb9fae","type":"message","text":"That's right, yeah. It's especially common in hierarchical models (see e.g. Neal's Funnel)","user":"UHDQQ4GN6","ts":"1609902153.265900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DJSn5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That's right, yeah. It's especially common in hierarchical models (see e.g. Neal's Funnel)"}]}]}],"thread_ts":"1609899835.265200","parent_user_id":"UPK2KJ95Y"},{"client_msg_id":"43d3850e-b3ed-4b5c-bfcc-3c377486a298","type":"message","text":"Thank you! How can I get an idea of where those walls are? Would they show if I asked my sampler to start from a high likelihood region and make tiny jumps?","user":"UPK2KJ95Y","ts":"1609902233.266100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wXQuO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thank you! How can I get an idea of where those walls are? Would they show if I asked my sampler to start from a high likelihood region and make tiny jumps?"}]}]}],"thread_ts":"1609899835.265200","parent_user_id":"UPK2KJ95Y"},{"client_msg_id":"9754742c-1d41-458a-8f81-fb6f3858fcb6","type":"message","text":"If your model is differentiable (i.e. has no discrete variables), I would use NUTS and checkout e.g. <https://betanalpha.github.io/assets/case_studies/divergences_and_bias.html>. What Turing labels as \"numerical_error\" is what Stan, PyMC3, and others label as \"divergent\" transitions. That case study gives examples of using divergences to diagnose poor geometries.","user":"UHDQQ4GN6","ts":"1609902426.266300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"U+t","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If your model is differentiable (i.e. has no discrete variables), I would use NUTS and checkout e.g. "},{"type":"link","url":"https://betanalpha.github.io/assets/case_studies/divergences_and_bias.html"},{"type":"text","text":". What Turing labels as \"numerical_error\" is what Stan, PyMC3, and others label as \"divergent\" transitions. That case study gives examples of using divergences to diagnose poor geometries."}]}]}],"thread_ts":"1609899835.265200","parent_user_id":"UPK2KJ95Y","reactions":[{"name":"+1","users":["UPK2KJ95Y","U018NKR9X70"],"count":2}]}]