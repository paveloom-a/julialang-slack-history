[{"client_msg_id":"ae62e59a-ad13-45f2-81a6-265ede125c95","type":"message","text":"What is the best way to diagnose pathological behavior from MCMC chains in terms of plotting? Like for example the typical 'funnel' behavior. Especially when having more than 2 parameters that is (e.g. 10 to keep it simple for now). Are cornerplots a good way of doing this?","user":"U01C2AJ9F63","ts":"1616669326.079800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"PJI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What is the best way to diagnose pathological behavior from MCMC chains in terms of plotting? Like for example the typical 'funnel' behavior. Especially when having more than 2 parameters that is (e.g. 10 to keep it simple for now). Are cornerplots a good way of doing this?"}]}]}],"thread_ts":"1616669326.079800","reply_count":3,"reply_users_count":2,"latest_reply":"1616740387.092300","reply_users":["UHDQQ4GN6","U01C2AJ9F63"],"is_locked":false,"subscribed":false},{"client_msg_id":"b35d015d-fb2e-41c9-9e2b-08ca96971e71","type":"message","text":"For the funnel behavior, the location of divergent transitions in NUTS and HMC (those where `numerical_error=1` is really useful, since the divergences often are located near the region where numerical instability or high curvature happened. Corner plots with the divergent transitions differently colored are helpful (e.g. <https://arviz-devs.github.io/ArviZ.jl/stable/mpl_examples/#Pair-Plot>). If you have many variables, corner plots become unwieldy, but parallel coordinate plots can also be helpful, again with divergent transitions differently colored (see e.g. <https://arviz-devs.github.io/ArviZ.jl/stable/mpl_examples/#Parallel-Plot>).","user":"UHDQQ4GN6","ts":"1616671128.080300","team":"T68168MUP","edited":{"user":"UHDQQ4GN6","ts":"1616671211.000000"},"blocks":[{"type":"rich_text","block_id":"3GZRg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For the funnel behavior, the location of divergent transitions in NUTS and HMC (those where "},{"type":"text","text":"numerical_error=1","style":{"code":true}},{"type":"text","text":" is really useful, since the divergences often are located near the region where numerical instability or high curvature happened. Corner plots with the divergent transitions differently colored are helpful (e.g. "},{"type":"link","url":"https://arviz-devs.github.io/ArviZ.jl/stable/mpl_examples/#Pair-Plot"},{"type":"text","text":"). If you have many variables, corner plots become unwieldy, but parallel coordinate plots can also be helpful, again with divergent transitions differently colored (see e.g. "},{"type":"link","url":"https://arviz-devs.github.io/ArviZ.jl/stable/mpl_examples/#Parallel-Plot"},{"type":"text","text":")."}]}]}],"thread_ts":"1616669326.079800","parent_user_id":"U01C2AJ9F63","reactions":[{"name":"+1","users":["UC0SY9JFP","U01T2PGLDSL"],"count":2}]},{"client_msg_id":"d16c38fe-56d3-4cff-8402-bcb5db3900c3","type":"message","text":"That is very useful thanks! Also, I didn't actively realize that in order for something like a funnel to occur, divergences must occur as well. It makes sense though. So does that also imply that if I have 0 divergences, there is unlikely to be any problematic behavior? Because essentially I am trying to figure out what is causing high Rhat values and low convergence in certain case for my model.","user":"U01C2AJ9F63","ts":"1616675474.080800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NP71L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That is very useful thanks! Also, I didn't actively realize that in order for something like a funnel to occur, divergences must occur as well. It makes sense though. So does that also imply that if I have 0 divergences, there is unlikely to be any problematic behavior? Because essentially I am trying to figure out what is causing high Rhat values and low convergence in certain case for my model."}]}]}],"thread_ts":"1616669326.079800","parent_user_id":"U01C2AJ9F63"},{"client_msg_id":"9729825f-1667-43b6-a22c-903c32a7494e","type":"message","text":"Ah, no, it does not imply that. There are at least 4 things that can cause poor behavior. 1) bugs. 2) high curvature 3) heavy tails 4) multimodality.\nIf the bug is in the gradient, it can have the same effect as high curvature. Both can cause divergences but don't necessarily. Heavy tails and multimodality usually don't.\n\nAs an example of how heavy tails can mess everything up, consider sampling a Cauchy. There's actually a huge amount of probability mass in the tails, but it's spread thin over a wide support, so if your sampler ventures out into the tails, it may not come back for a long time, if ever. If it heads out there early, then you could end up tuning a poor set of parameters for exploring around the mode and only end ever explore the tails.\n\nIf you have multiple well-separated modes, then most MCMC methods can't transition between modes, and you'll only ever see the one. And if they're not well separated, then transitions between modes could be rare, so that you poorly estimate the relative amount of probability mass near the two modes.\n\nAnd I should probably throw in there that it is always possible that the expectation you are most interested in corresponds to an undefined integral, so that even exact MC will never asymptotically converge in its estimation. This can happen even if all of the diagnostics look good.\n\nYou can never know for certain that you're not seeing problematic behavior, which is why you want to always use every diagnostic at your disposal to critique your models. And never ignore a diagnostic that indicates there's something problematic. Even one divergent transition after tuning should be cause for concern.","user":"UHDQQ4GN6","ts":"1616740387.092300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"AJUF1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah, no, it does not imply that. There are at least 4 things that can cause poor behavior. 1) bugs. 2) high curvature 3) heavy tails 4) multimodality.\nIf the bug is in the gradient, it can have the same effect as high curvature. Both can cause divergences but don't necessarily. Heavy tails and multimodality usually don't.\n\nAs an example of how heavy tails can mess everything up, consider sampling a Cauchy. There's actually a huge amount of probability mass in the tails, but it's spread thin over a wide support, so if your sampler ventures out into the tails, it may not come back for a long time, if ever. If it heads out there early, then you could end up tuning a poor set of parameters for exploring around the mode and only end ever explore the tails.\n\nIf you have multiple well-separated modes, then most MCMC methods can't transition between modes, and you'll only ever see the one. And if they're not well separated, then transitions between modes could be rare, so that you poorly estimate the relative amount of probability mass near the two modes.\n\nAnd I should probably throw in there that it is always possible that the expectation you are most interested in corresponds to an undefined integral, so that even exact MC will never asymptotically converge in its estimation. This can happen even if all of the diagnostics look good.\n\nYou can never know for certain that you're not seeing problematic behavior, which is why you want to always use every diagnostic at your disposal to critique your models. And never ignore a diagnostic that indicates there's something problematic. Even one divergent transition after tuning should be cause for concern."}]}]}],"thread_ts":"1616669326.079800","parent_user_id":"U01C2AJ9F63"}]