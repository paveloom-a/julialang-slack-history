[{"client_msg_id":"ce5ed491-0f47-48c4-8ca5-efebcbcd4244","type":"message","text":"I have some code where for some functions I've provided custom  `frule`s via ChainRules. I've tested these frules using Zygote's `forwarddiff` function, and they work well. But, if I use Zygote in Turing, it defaults to reverse mode, and I don't have the relevant rrules defined. Is there a way to use Turing with Zygote in forward mode?","user":"U017YGFQTE3","ts":"1611074037.027100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DFF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have some code where for some functions I've provided custom  "},{"type":"text","text":"frule","style":{"code":true}},{"type":"text","text":"s via ChainRules. I've tested these frules using Zygote's "},{"type":"text","text":"forwarddiff","style":{"code":true}},{"type":"text","text":" function, and they work well. But, if I use Zygote in Turing, it defaults to reverse mode, and I don't have the relevant rrules defined. Is there a way to use Turing with Zygote in forward mode?"}]}]}],"thread_ts":"1611074037.027100","reply_count":5,"reply_users_count":2,"latest_reply":"1611081162.028000","reply_users":["UHDQQ4GN6","U017YGFQTE3"],"subscribed":false},{"client_msg_id":"823761f2-2a4d-4853-a0d5-55a331a94a50","type":"message","text":"I don't believe ForwardDiff even uses ChainRules. As far as I know, only ForwardDiff2 does, and last I checked it was not being actively maintained.","user":"UHDQQ4GN6","ts":"1611080247.027200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9v6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don't believe ForwardDiff even uses ChainRules. As far as I know, only ForwardDiff2 does, and last I checked it was not being actively maintained."}]}]}],"thread_ts":"1611074037.027100","parent_user_id":"U017YGFQTE3"},{"client_msg_id":"540d97ce-7b9c-49e8-a4b5-df9f4044e5d6","type":"message","text":"Once you have the frules, you can define the rrules. ChainRules docs give examples of this: <https://www.juliadiff.org/ChainRulesCore.jl/dev/arrays.html|https://www.juliadiff.org/ChainRulesCore.jl/dev/arrays.html>","user":"UHDQQ4GN6","ts":"1611080323.027400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7l/Yg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Once you have the frules, you can define the rrules. ChainRules docs give examples of this: "},{"type":"link","url":"https://www.juliadiff.org/ChainRulesCore.jl/dev/arrays.html","text":"https://www.juliadiff.org/ChainRulesCore.jl/dev/arrays.html"}]}]}],"thread_ts":"1611074037.027100","parent_user_id":"U017YGFQTE3"},{"client_msg_id":"4530ca54-06e2-430d-86d9-473b2f2722fc","type":"message","text":"Yep I just noticed earlier today that Zygote now has a forward mode so I was hoping i could use that; forward mode rules are a bit easier to write. But I'll keep reading up on rrules and see if I can get them running.","user":"U017YGFQTE3","ts":"1611080703.027600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wU6Ua","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yep I just noticed earlier today that Zygote now has a forward mode so I was hoping i could use that; forward mode rules are a bit easier to write. But I'll keep reading up on rrules and see if I can get them running."}]}]}],"thread_ts":"1611074037.027100","parent_user_id":"U017YGFQTE3"},{"client_msg_id":"d3eef4e8-254c-475b-90b5-1b2e2c210bba","type":"message","text":"It does, yeah. Test well though, because Zygote's forward mode is still experimental and is sometimes wrong. Also it does not use ChainRules. Depending on the dimensionality of your problem, reverse mode might be much faster. There's also <#C6G240ENA|autodiff>.","user":"UHDQQ4GN6","ts":"1611080859.027800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OHwl/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It does, yeah. Test well though, because Zygote's forward mode is still experimental and is sometimes wrong. Also it does not use ChainRules. Depending on the dimensionality of your problem, reverse mode might be much faster. There's also "},{"type":"channel","channel_id":"C6G240ENA"},{"type":"text","text":"."}]}]}],"thread_ts":"1611074037.027100","parent_user_id":"U017YGFQTE3"},{"client_msg_id":"e21a1ba8-c06c-4e93-b767-80a14f55e3fe","type":"message","text":"\"Also it does not use ChainRules\" i did not realise that. A couple of times now I've assumed that my frule is being used when its not (firstly with ForwardDiff). ForwardDiff2 seems to be quite particular about array types, which is frustrating. Anyway, this is moving away from being a Turing question very quickly. Thanks for your help!","user":"U017YGFQTE3","ts":"1611081162.028000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gSGi","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"\"Also it does not use ChainRules\" i did not realise that. A couple of times now I've assumed that my frule is being used when its not (firstly with ForwardDiff). ForwardDiff2 seems to be quite particular about array types, which is frustrating. Anyway, this is moving away from being a Turing question very quickly. Thanks for your help!"}]}]}],"thread_ts":"1611074037.027100","parent_user_id":"U017YGFQTE3","reactions":[{"name":"+1","users":["UHDQQ4GN6"],"count":1}]}]