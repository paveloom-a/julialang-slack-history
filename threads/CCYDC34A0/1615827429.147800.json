[{"client_msg_id":"056c0b0e-0d3d-4ee5-bb25-0b7ea3452043","type":"message","text":"I thought the Bayesian logistic regression example didn't look very \"Turian\" so I made some updates to it. I also reparameterized it for even *more* speed and efficiency\n\n```train_F = qr([ones(size(train,1)) train]);\ntrain_Q_ast = Matrix(train_F.Q) * sqrt(size(train,1)-1)\ntrain_R_ast = train_F.R / sqrt(size(train,1)-1)\ntrain_R_ast_inv = inv(train_R_ast)\n\n# Bayesian logistic regression (LR)\n@model logistic_regression_new(Q_ast, y, p, σ) = begin\n    theta ~ MvNormal(zeros(p), σ)\n    y ~ Distributions.Product(Bernoulli.(logistic.(Q_ast * theta)))\nend;\n# Retrieve the number of observations.\nn, p = size([ones(size(train,1)) train])\n\n# Sample using HMC.\n@time chain = mapreduce(c -&gt; sample(logistic_regression_new(train_Q_ast, train_label, p, 1), HMC(0.05, 10), 1500),\n    chainscat,\n    1:3\n)\n\ndescribe(chain)\n\nbeta = mapslices(x-&gt; train_R_ast_inv * x, chain[:,namesingroup(chain, :theta),:].value.data, dims=[2])\ntransformed_chain = Chains(beta, [\"Intercept\", \"student\", \"balance\", \"income\"]```\nOn my machine the original code gives\n```  28.732436 seconds (304.93 M allocations: 10.426 GiB, 9.61% gc time)```\nWhile the new code gives\n```  4.446898 seconds (8.36 M allocations: 2.351 GiB, 10.44% gc time)```\nPlus almost 6X increase in ESS :slightly_smiling_face:","user":"U6CFMFM2R","ts":"1615827429.147800","team":"T68168MUP","edited":{"user":"U6CFMFM2R","ts":"1615827586.000000"},"blocks":[{"type":"rich_text","block_id":"xGm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I thought the Bayesian logistic regression example didn't look very \"Turian\" so I made some updates to it. I also reparameterized it for even "},{"type":"text","text":"more","style":{"bold":true}},{"type":"text","text":" speed and efficiency\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"train_F = qr([ones(size(train,1)) train]);\ntrain_Q_ast = Matrix(train_F.Q) * sqrt(size(train,1)-1)\ntrain_R_ast = train_F.R / sqrt(size(train,1)-1)\ntrain_R_ast_inv = inv(train_R_ast)\n\n# Bayesian logistic regression (LR)\n@model logistic_regression_new(Q_ast, y, p, σ) = begin\n    theta ~ MvNormal(zeros(p), σ)\n    y ~ Distributions.Product(Bernoulli.(logistic.(Q_ast * theta)))\nend;\n# Retrieve the number of observations.\nn, p = size([ones(size(train,1)) train])\n\n# Sample using HMC.\n@time chain = mapreduce(c -> sample(logistic_regression_new(train_Q_ast, train_label, p, 1), HMC(0.05, 10), 1500),\n    chainscat,\n    1:3\n)\n\ndescribe(chain)\n\nbeta = mapslices(x-> train_R_ast_inv * x, chain[:,namesingroup(chain, :theta),:].value.data, dims=[2])\ntransformed_chain = Chains(beta, [\"Intercept\", \"student\", \"balance\", \"income\"]"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"On my machine the original code gives\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"  28.732436 seconds (304.93 M allocations: 10.426 GiB, 9.61% gc time)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"While the new code gives\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"  4.446898 seconds (8.36 M allocations: 2.351 GiB, 10.44% gc time)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Plus almost 6X increase in ESS "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1615827429.147800","reply_count":3,"reply_users_count":2,"latest_reply":"1615867848.000400","reply_users":["U01QBF4PHKP","U9JNHB83X"],"subscribed":false,"reactions":[{"name":"tada","users":["UC0SY9JFP","U01QBF4PHKP","UHDNY2YMA","U01A4SJJQDA","U018NKR9X70","U9JNHB83X","U85JBUGGP","U011SGGQJCA"],"count":8},{"name":"fast_parrot","users":["U01QBF4PHKP","U011SGGQJCA"],"count":2},{"name":"+1","users":["UH08DT0JU","U011SGGQJCA"],"count":2},{"name":"sonic","users":["U011SGGQJCA"],"count":1}]},{"client_msg_id":"7f7deff6-4ec5-4a57-8758-1fd74749fc8d","type":"message","text":"Thank YOU! I was having a very hard problem with `mapslices`. I knew this was the right function but I would never arrive in this subsetting (`chain[:,namesingroup(chain, :theta),:].value.data`)!!","user":"U01QBF4PHKP","ts":"1615829809.148100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cBGKa","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thank YOU! I was having a very hard problem with "},{"type":"text","text":"mapslices","style":{"code":true}},{"type":"text","text":". I knew this was the right function but I would never arrive in this subsetting ("},{"type":"text","text":"chain[:,namesingroup(chain, :theta),:].value.data","style":{"code":true}},{"type":"text","text":")!!"}]}]}],"thread_ts":"1615827429.147800","parent_user_id":"U6CFMFM2R"},{"client_msg_id":"76d32c2e-7c13-4e46-8751-2042c33f7035","type":"message","text":"Wow that is rad","user":"U9JNHB83X","ts":"1615867829.000200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3Ne1B","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Wow that is rad"}]}]}],"thread_ts":"1615827429.147800","parent_user_id":"U6CFMFM2R"},{"client_msg_id":"9ba0c1ea-c097-48df-a8b4-4c1a92e4bc09","type":"message","text":"We should toss this into the tutorial when the site's been migrated","user":"U9JNHB83X","ts":"1615867848.000400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"W3I","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"We should toss this into the tutorial when the site's been migrated"}]}]}],"thread_ts":"1615827429.147800","parent_user_id":"U6CFMFM2R"}]