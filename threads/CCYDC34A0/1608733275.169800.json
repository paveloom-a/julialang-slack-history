[{"client_msg_id":"0f45f689-10e3-4971-bee5-cadd0593d85e","type":"message","text":"Hello Turing friends! The <https://turing.ml/dev/tutorials/10-bayesiandiffeq/#inference-of-a-stochastic-differential-equation|Bayesian DiffEq tutorial> mentions SGHMC as a possibly better alternative to NUTS for SDE inference. Is this currently implemented? I don't see it in the docs. I implemented SGHMC in python/Tensorflow Probability a few months ago, so I would happy to help contribute to an implementation.","user":"U01H36BUDJB","ts":"1608733275.169800","team":"T68168MUP","attachments":[{"title":"Bayesian Estimation of Differential Equations","title_link":"https://turing.ml/dev/tutorials/10-bayesiandiffeq/#inference-of-a-stochastic-differential-equation","text":"Bayesian Estimation of Differential Equations","fallback":"Bayesian Estimation of Differential Equations","from_url":"https://turing.ml/dev/tutorials/10-bayesiandiffeq/#inference-of-a-stochastic-differential-equation","service_icon":"https://turing.ml/dev/assets/img/favicon.ico","service_name":"turing.ml","id":1,"original_url":"https://turing.ml/dev/tutorials/10-bayesiandiffeq/#inference-of-a-stochastic-differential-equation"}],"blocks":[{"type":"rich_text","block_id":"xeVKj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hello Turing friends! The "},{"type":"link","url":"https://turing.ml/dev/tutorials/10-bayesiandiffeq/#inference-of-a-stochastic-differential-equation","text":"Bayesian DiffEq tutorial"},{"type":"text","text":" mentions SGHMC as a possibly better alternative to NUTS for SDE inference. Is this currently implemented? I don't see it in the docs. I implemented SGHMC in python/Tensorflow Probability a few months ago, so I would happy to help contribute to an implementation."}]}]}],"thread_ts":"1608733275.169800","reply_count":14,"reply_users_count":4,"latest_reply":"1608798717.179200","reply_users":["U8T9JUA5R","U01H36BUDJB","U6C937ENB","UC0SY9JFP"],"subscribed":false},{"client_msg_id":"93f63813-1a51-4f43-9ed0-1feaf8148ef8","type":"message","text":"There exists an implementation (<https://github.com/TuringLang/Turing.jl/blob/master/src/contrib/inference/sghmc.jl>) but it was not kept uptodate with the large amount of internal changes in Turing. I assume it should be easy to update  it to the new interface, I can have a look at it (I just updated some other sampling algorithms).","user":"U8T9JUA5R","ts":"1608733463.170000","team":"T68168MUP","edited":{"user":"U8T9JUA5R","ts":"1608733486.000000"},"blocks":[{"type":"rich_text","block_id":"4aDy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"There exists an implementation ("},{"type":"link","url":"https://github.com/TuringLang/Turing.jl/blob/master/src/contrib/inference/sghmc.jl"},{"type":"text","text":") but it was not kept uptodate with the large amount of internal changes in Turing. I assume it should be easy to update  it to the new interface, I can have a look at it (I just updated some other sampling algorithms)."}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"646e8ac1-d39f-4700-8ac4-11e437564221","type":"message","text":"I seem to remember there being a \"friction\" variable. Is that what you are calling momentum decay here?","user":"U01H36BUDJB","ts":"1608733608.170300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fWnL8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I seem to remember there being a \"friction\" variable. Is that what you are calling momentum decay here?"}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"df1f985b-cbd5-49a0-8136-2b374d4b67c1","type":"message","text":"i.e. I remember that from the original paper.","user":"U01H36BUDJB","ts":"1608733634.170500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WTroc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"i.e. I remember that from the original paper."}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"2679564a-56b8-4b38-8f96-f3f68936da7d","type":"message","text":"I haven't checked the implementation in detail, mainly because it has been broken for a while.","user":"U8T9JUA5R","ts":"1608733802.170700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"f03","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I haven't checked the implementation in detail, mainly because it has been broken for a while."}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"9f386d9e-f073-4087-8637-6091b97c834b","type":"message","text":"And I don't even know who contributed it (and how long ago it was) :smile:","user":"U8T9JUA5R","ts":"1608733831.170900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Pcu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And I don't even know who contributed it (and how long ago it was) "},{"type":"emoji","name":"smile"}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"a0dd43af-7f28-4280-bd9c-fb6ea9c0d5bf","type":"message","text":"The implementation seems to be based on Chen et al. (2014), so you should be able to map meomentum decay and learning rate to their equation (15).","user":"U8T9JUA5R","ts":"1608733935.171100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EYj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The implementation seems to be based on Chen et al. (2014), so you should be able to map meomentum decay and learning rate to their equation (15)."}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"f7899c6a-cb7d-45da-a2d5-96b3271d629f","type":"message","text":"Using <https://github.com/TuringLang/Turing.jl/blob/fe9bee23671ba44d33ee4a27cbce0b8093a63d85/src/contrib/inference/sghmc.jl#L82> and <https://github.com/TuringLang/Turing.jl/blob/fe9bee23671ba44d33ee4a27cbce0b8093a63d85/src/contrib/inference/sghmc.jl#L98-L99>","user":"U8T9JUA5R","ts":"1608733957.171700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"r1/8U","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Using "},{"type":"link","url":"https://github.com/TuringLang/Turing.jl/blob/fe9bee23671ba44d33ee4a27cbce0b8093a63d85/src/contrib/inference/sghmc.jl#L82"},{"type":"text","text":" and "},{"type":"link","url":"https://github.com/TuringLang/Turing.jl/blob/fe9bee23671ba44d33ee4a27cbce0b8093a63d85/src/contrib/inference/sghmc.jl#L98-L99"}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"78B5F7B6-B76C-4189-A0C9-2CD4E7B90409","type":"message","text":"What’s your use case?","user":"U6C937ENB","ts":"1608733984.172400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"00JG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What’s your use case?"}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"789ee517-aa30-492a-9655-3592583041a5","type":"message","text":"<@U8T9JUA5R> Yes, that's the paper I was referring to. I remember now, friction maps to momentum decay in SGD.\n<@U6C937ENB> No specific use case, yet, but I suspect I'll need to convert to SDEs eventually. Would be nice to know that this is available.","user":"U01H36BUDJB","ts":"1608734543.172600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"o5vye","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U8T9JUA5R"},{"type":"text","text":" Yes, that's the paper I was referring to. I remember now, friction maps to momentum decay in SGD.\n"},{"type":"user","user_id":"U6C937ENB"},{"type":"text","text":" No specific use case, yet, but I suspect I'll need to convert to SDEs eventually. Would be nice to know that this is available."}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"8d8f26a5-b0c5-4d59-9f8d-12ea17e2af04","type":"message","text":"<@U8T9JUA5R> Let me know if you need help fixing it! I still need to learn more about Turing's internals, though.","user":"U01H36BUDJB","ts":"1608734644.172800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YatW","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U8T9JUA5R"},{"type":"text","text":" Let me know if you need help fixing it! I still need to learn more about Turing's internals, though."}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"D9979B57-C460-4F3A-81FA-41A56A1DE635","type":"message","text":"This was contributed by Emile a while ago. ","user":"UC0SY9JFP","ts":"1608739797.173900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vc6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"This was contributed by Emile a while ago. "}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"91883548-e809-4a41-ad2e-5ace1a1fd40d","type":"message","text":"I had a look at it, it seems quite straightforward and I put together a draft locally. It doesn't really involve many Turing internals, it is mainly about switching it to AbstractMCMC 2. The only problem here is that it is documented in the AbstractMCMC repo but the documentation on <http://turing.ml|turing.ml> still refers to the previous (and IMO more complicated) interface (see <https://github.com/TuringLang/Turing.jl/issues/1474> for a discussion).","user":"U8T9JUA5R","ts":"1608740450.174100","team":"T68168MUP","edited":{"user":"U8T9JUA5R","ts":"1608740461.000000"},"blocks":[{"type":"rich_text","block_id":"3Ga7y","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I had a look at it, it seems quite straightforward and I put together a draft locally. It doesn't really involve many Turing internals, it is mainly about switching it to AbstractMCMC 2. The only problem here is that it is documented in the AbstractMCMC repo but the documentation on "},{"type":"link","url":"http://turing.ml","text":"turing.ml"},{"type":"text","text":" still refers to the previous (and IMO more complicated) interface (see "},{"type":"link","url":"https://github.com/TuringLang/Turing.jl/issues/1474"},{"type":"text","text":" for a discussion)."}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"05D3BD1A-86C5-45DA-AC85-078D35662566","type":"message","text":"In the meantime if you _just_ want inference for SDEs, check <https://nextjournal.com/Lobatto/FitzHugh-Nagumo|https://nextjournal.com/Lobatto/FitzHugh-Nagumo>","user":"U6C937ENB","ts":"1608740549.175400","team":"T68168MUP","attachments":[{"title":"Bayesian inference for SDE models: a case study for an excitable stochastic-dynamical model","title_link":"https://nextjournal.com/Lobatto/FitzHugh-Nagumo","text":"Abstract: The FitzHugh-Nagumo (FHN) model is a versatile yet simple model for the evolution of excitable or oscillatory physical processes. It is a well-known two-dimensional simplification of the Hodgkin-Huxley model of spike generation in squid giant axons used in neuroscience. The dynamics of the process are governed by a two-dimensional hypo-elliptic Stochastic Differential Equation (SDE) of which only the first component is assumed to be observed discretely in time. Inferring parameters appearing in the SDE is a nontrivial problem. We illustrate how statistical inference can be done within the Bayesian setup using the Backward Filtering Forward Guiding algorithm as detailed in [1]. The complex interaction between the estimated parameters and the dynamics of the model is explored through an interactive interface is phase-space . Due to the generality of the statistical procedure, Julia-implementation and graphical interface, the program can be extended or adapted to other interesting models and applications.","fallback":"Bayesian inference for SDE models: a case study for an excitable stochastic-dynamical model","from_url":"https://nextjournal.com/Lobatto/FitzHugh-Nagumo","service_name":"nextjournal.com","id":1,"original_url":"https://nextjournal.com/Lobatto/FitzHugh-Nagumo"}],"blocks":[{"type":"rich_text","block_id":"LI4ih","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In the meantime if you "},{"type":"text","text":"just","style":{"italic":true}},{"type":"text","text":" want inference for SDEs, check "},{"type":"link","url":"https://nextjournal.com/Lobatto/FitzHugh-Nagumo","text":"https://nextjournal.com/Lobatto/FitzHugh-Nagumo"}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB","reactions":[{"name":"+1","users":["U8T9JUA5R"],"count":1}]},{"client_msg_id":"b0e9af5d-67f2-4448-a72e-d2d313fc6e16","type":"message","text":"A first draft: <https://github.com/TuringLang/Turing.jl/pull/1502|https://github.com/TuringLang/Turing.jl/pull/1502>","user":"U8T9JUA5R","ts":"1608798717.179200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TvL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"A first draft: "},{"type":"link","url":"https://github.com/TuringLang/Turing.jl/pull/1502","text":"https://github.com/TuringLang/Turing.jl/pull/1502"}]}]}],"thread_ts":"1608733275.169800","parent_user_id":"U01H36BUDJB","reactions":[{"name":"+1","users":["UH08DT0JU","U01H36BUDJB","U6QF223TN"],"count":3}]}]