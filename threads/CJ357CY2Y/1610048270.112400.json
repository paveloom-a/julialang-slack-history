[{"client_msg_id":"7ea756fd-5aa1-436a-ac1e-5a95737c3d9e","type":"message","text":"The thing with julia’s IR is that is it painful to work with.\nBecause of things like you need to renumber all the SSA values if you insert or delete a line.\nThere are tools in `Core.Compiler`  for doing this.\nand Cassette’s `insert_statements` uses them.\nbut IRTools avoids needing to do them because it’s data structures are a bit higher level","user":"U6A936746","ts":"1610048270.112400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qgTs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The thing with julia’s IR is that is it painful to work with.\nBecause of things like you need to renumber all the SSA values if you insert or delete a line.\nThere are tools in "},{"type":"text","text":"Core.Compiler","style":{"code":true}},{"type":"text","text":"  for doing this.\nand Cassette’s "},{"type":"text","text":"insert_statements","style":{"code":true}},{"type":"text","text":" uses them.\nbut IRTools avoids needing to do them because it’s data structures are a bit higher level"}]}]}],"thread_ts":"1610048270.112400","reply_count":5,"reply_users_count":2,"latest_reply":"1610060964.160400","reply_users":["UC6SUUPRC","U6A936746"],"subscribed":false},{"type":"message","subtype":"thread_broadcast","text":"there are actually a bunch of helper functions inside Julia compiler, e.g `renumber_ssa!` etc. I started writing YaoLang/YaoCompiler project with IRTools, but then later removed it since I don’t want to introduce too much levels of similar IRs in the compiler. But I agree, we don’t have much tools exposed for manipulating Julia’s IR. I think perhaps should move some of the tools in YaoCompiler for `CodeInfo` to a package and develop a light weight package for directly manipulating `CodeInfo` would be helpful","user":"UC6SUUPRC","ts":"1610060738.159100","thread_ts":"1610048270.112400","root":{"client_msg_id":"7ea756fd-5aa1-436a-ac1e-5a95737c3d9e","type":"message","text":"The thing with julia’s IR is that is it painful to work with.\nBecause of things like you need to renumber all the SSA values if you insert or delete a line.\nThere are tools in `Core.Compiler`  for doing this.\nand Cassette’s `insert_statements` uses them.\nbut IRTools avoids needing to do them because it’s data structures are a bit higher level","user":"U6A936746","ts":"1610048270.112400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qgTs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The thing with julia’s IR is that is it painful to work with.\nBecause of things like you need to renumber all the SSA values if you insert or delete a line.\nThere are tools in "},{"type":"text","text":"Core.Compiler","style":{"code":true}},{"type":"text","text":"  for doing this.\nand Cassette’s "},{"type":"text","text":"insert_statements","style":{"code":true}},{"type":"text","text":" uses them.\nbut IRTools avoids needing to do them because it’s data structures are a bit higher level"}]}]}],"thread_ts":"1610048270.112400","reply_count":5,"reply_users_count":2,"latest_reply":"1610060964.160400","reply_users":["UC6SUUPRC","U6A936746"],"subscribed":false},"blocks":[{"type":"rich_text","block_id":"0A6as","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"there are actually a bunch of helper functions inside Julia compiler, e.g "},{"type":"text","text":"renumber_ssa!","style":{"code":true}},{"type":"text","text":" etc. I started writing YaoLang/YaoCompiler project with IRTools, but then later removed it since I don’t want to introduce too much levels of similar IRs in the compiler. But I agree, we don’t have much tools exposed for manipulating Julia’s IR. I think perhaps should move some of the tools in YaoCompiler for "},{"type":"text","text":"CodeInfo","style":{"code":true}},{"type":"text","text":" to a package and develop a light weight package for directly manipulating "},{"type":"text","text":"CodeInfo","style":{"code":true}},{"type":"text","text":" would be helpful"}]}]}],"client_msg_id":"6c4f709e-b9d9-4863-b9d5-ce3a3c087b8e"},{"client_msg_id":"eded3d0b-33e8-41a5-9aad-bf2a8dd09efb","type":"message","text":"Yeah `renumber_ssa!` Is what Cassette's `insert_statements` uses","user":"U6A936746","ts":"1610060817.159800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5KK9L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah "},{"type":"text","text":"renumber_ssa!","style":{"code":true}},{"type":"text","text":" Is what Cassette's "},{"type":"text","text":"insert_statements","style":{"code":true}},{"type":"text","text":" uses"}]}]}],"thread_ts":"1610048270.112400","parent_user_id":"U6A936746"},{"client_msg_id":"d097ff2b-601e-4332-9200-4134cb008582","type":"message","text":"I never really learnt to use IRTools because I had already invested the effort into learning Julia's IR,  learning another IR is effort","user":"U6A936746","ts":"1610060886.160000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dT/3X","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I never really learnt to use IRTools because I had already invested the effort into learning Julia's IR,  learning another IR is effort"}]}]}],"thread_ts":"1610048270.112400","parent_user_id":"U6A936746"},{"client_msg_id":"f01109e4-2145-46f1-9315-6e9c972888a0","type":"message","text":"and I actually find it’s convenient to extend MLStyle to handle some CodeInfo patterns: <https://github.com/QuantumBFS/YaoCompiler.jl/blob/master/src/compiler/patch.jl>","user":"UC6SUUPRC","ts":"1610060930.160200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E5D","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and I actually find it’s convenient to extend MLStyle to handle some CodeInfo patterns: "},{"type":"link","url":"https://github.com/QuantumBFS/YaoCompiler.jl/blob/master/src/compiler/patch.jl"}]}]}],"thread_ts":"1610048270.112400","parent_user_id":"U6A936746","reactions":[{"name":"cool","users":["U6A936746","U8D9768Q6"],"count":2},{"name":"fire","users":["U6A936746"],"count":1}]},{"client_msg_id":"151a68f3-b045-4666-ad4d-09cbcb8d42d7","type":"message","text":"there could some more extension for MLStyle to be made for `CodeInfo` but I was too lazy and did some things manually","user":"UC6SUUPRC","ts":"1610060964.160400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Dl0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"there could some more extension for MLStyle to be made for "},{"type":"text","text":"CodeInfo","style":{"code":true}},{"type":"text","text":" but I was too lazy and did some things manually"}]}]}],"thread_ts":"1610048270.112400","parent_user_id":"U6A936746"}]