[{"client_msg_id":"19194730-77f1-4f9e-a477-fb0e7254bd65","type":"message","text":"In dynamos, when constructing IR from scratch (i.e. `IR()`, not `IR(f, args...)` ), how do we construct an argument list? I tried this:\n\n```@dynamo function __splatnew__(a...)\n    ir = IR()\n    vT = argument!(ir)      # argument for a type to be constructed\n    vargs = argument!(ir)   # argument for its field values\n    vres = push!(ir, Expr(:splatnew, vT, vargs))\n    return!(ir, vres)\n    return ir\nend```\nbut it results in an undefined variable\n```struct Point x; y end\n\n@code_ir __splatnew__(Point, (1, 2))```\nresult:\n```1: (%1, %2)\n  %3 = %splatnew(%2, IRTools.Inner.Undefined())\n  return %3```\nany examples of building functions from the grounds up?","user":"U72B014PN","ts":"1616973951.017500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"moh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In dynamos, when constructing IR from scratch (i.e. "},{"type":"text","text":"IR()","style":{"code":true}},{"type":"text","text":", not "},{"type":"text","text":"IR(f, args...)","style":{"code":true}},{"type":"text","text":" ), how do we construct an argument list? I tried this:\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"@dynamo function __splatnew__(a...)\n    ir = IR()\n    vT = argument!(ir)      # argument for a type to be constructed\n    vargs = argument!(ir)   # argument for its field values\n    vres = push!(ir, Expr(:splatnew, vT, vargs))\n    return!(ir, vres)\n    return ir\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nbut it results in an undefined variable\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"struct Point x; y end\n\n@code_ir __splatnew__(Point, (1, 2))"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"result:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"1: (%1, %2)\n  %3 = %splatnew(%2, IRTools.Inner.Undefined())\n  return %3"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"any examples of building functions from the grounds up?"}]}]}],"thread_ts":"1616973951.017500","reply_count":2,"reply_users_count":2,"latest_reply":"1617017749.018000","reply_users":["UM30MT6RF","UN45LV5K6"],"is_locked":false,"subscribed":false},{"client_msg_id":"68f0ab4e-107a-4419-a137-6927cd833c57","type":"message","text":"The number of slots need to match that of the dynamo. Here, there is just one vararg slot, so instead of adding two slots, you would have to manually destructure the first slot, which should always be a tuple.","user":"UM30MT6RF","ts":"1616975166.017700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"huX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The number of slots need to match that of the dynamo. Here, there is just one vararg slot, so instead of adding two slots, you would have to manually destructure the first slot, which should always be a tuple."}]}]}],"thread_ts":"1616973951.017500","parent_user_id":"U72B014PN","reactions":[{"name":"thinking_face","users":["U72B014PN"],"count":1}]},{"client_msg_id":"075a35a5-914d-47b0-97d7-3b5ddaf0fea6","type":"message","text":"You can also manually replicate what a dynamo is doing, e.g. <https://github.com/TuringLang/IRTracker.jl/blob/master/src/tracker.jl#L27> (there I'm adding an argument). This takes a while to figure out for each use case, though.","user":"UN45LV5K6","ts":"1617017749.018000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hxAl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You can also manually replicate what a dynamo is doing, e.g. "},{"type":"link","url":"https://github.com/TuringLang/IRTracker.jl/blob/master/src/tracker.jl#L27"},{"type":"text","text":" (there I'm adding an argument). This takes a while to figure out for each use case, though."}]}]}],"thread_ts":"1616973951.017500","parent_user_id":"U72B014PN"}]