[{"client_msg_id":"fed300f3-4e1c-408f-a8ac-57c49460a7fa","type":"message","text":"Implemented a simple agent based SIR model in julia as it's been a long time since I've written anything agent based. Here is the main function, any low hanging fruit I am missing?\n```function agents_step!(u_next,u,graph,params,t,rand_gen)\n    @unpack p, recovery_rate  = params  \n    u_next .= u\n    for (v,agent) in enumerate(u)\n        if agent == Susceptible\n            for w in LightGraphs.neighbors(graph,v)\n                if u[w] == Infected &amp;&amp; rand(rand_gen) &lt; p\n                    u_next[v] = Infected\n                end\n            end\n        elseif agent == Infected\n            if rand(rand_gen) &lt; recovery_rate\n                u_next[v] = Recovered\n            end\n        end\n    end\nend```","user":"U011V2YN59N","ts":"1611109097.016900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Jmfh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Implemented a simple agent based SIR model in julia as it's been a long time since I've written anything agent based. Here is the main function, any low hanging fruit I am missing?\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function agents_step!(u_next,u,graph,params,t,rand_gen)\n    @unpack p, recovery_rate  = params  \n    u_next .= u\n    for (v,agent) in enumerate(u)\n        if agent == Susceptible\n            for w in LightGraphs.neighbors(graph,v)\n                if u[w] == Infected && rand(rand_gen) < p\n                    u_next[v] = Infected\n                end\n            end\n        elseif agent == Infected\n            if rand(rand_gen) < recovery_rate\n                u_next[v] = Recovered\n            end\n        end\n    end\nend"}]}]}],"thread_ts":"1611109097.016900","reply_count":1,"reply_users_count":1,"latest_reply":"1611109637.019400","reply_users":["U011V2YN59N"],"subscribed":false},{"client_msg_id":"777c1027-c8dc-4d87-8203-0e126ec3e472","type":"message","text":"here is the rest of the code needed to run this:\n```\nusing LightGraphs\nusing RandomNumbers.Xorshifts\nusing UnPack\n@enum AgentStatus begin\n    Susceptible\n    Infected\n    Recovered\nend\nfunction get_graph()\n    return LightGraphs.grid([5,5])#change to whatever\nend\nfunction get_u_0(nodes)\n    u_0 = fill(Susceptible,nodes)\n    u_0[1] = Infected\n\n    return u_0\nend\nfunction get_parameters()\n    params = (\n        p = 0.5,\n        recovery_rate = 0.3,\n    )\n    return params\nend\nfunction solve!(u_0,graph,params,steps,solution_allocation,rand_gen)\n    for t in 1:steps\n        agents_step!(solution_allocation[t+1],solution_allocation[t],graph,params,t,rand_gen)\n    end\nend\nfunction main()\n\n    graph = get_graph()\n    u_0 = get_u_0(nv(graph))\n    params = get_parameters()\n    steps = 200\n    solution = vcat([u_0], [fill(Susceptible,length(u_0)) for i in 1:steps])\n    r = Xoroshiro128Plus()\n    @btime solve!($u_0,$graph,$params,$steps,$solution,$r)\n    display(solution)\nend```","user":"U011V2YN59N","ts":"1611109637.019400","team":"T68168MUP","edited":{"user":"U011V2YN59N","ts":"1611110200.000000"},"blocks":[{"type":"rich_text","block_id":"qCfy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"here is the rest of the code needed to run this:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"\nusing LightGraphs\nusing RandomNumbers.Xorshifts\nusing UnPack\n@enum AgentStatus begin\n    Susceptible\n    Infected\n    Recovered\nend\nfunction get_graph()\n    return LightGraphs.grid([5,5])#change to whatever\nend\nfunction get_u_0(nodes)\n    u_0 = fill(Susceptible,nodes)\n    u_0[1] = Infected\n\n    return u_0\nend\nfunction get_parameters()\n    params = (\n        p = 0.5,\n        recovery_rate = 0.3,\n    )\n    return params\nend\nfunction solve!(u_0,graph,params,steps,solution_allocation,rand_gen)\n    for t in 1:steps\n        agents_step!(solution_allocation[t+1],solution_allocation[t],graph,params,t,rand_gen)\n    end\nend\nfunction main()\n\n    graph = get_graph()\n    u_0 = get_u_0(nv(graph))\n    params = get_parameters()\n    steps = 200\n    solution = vcat([u_0], [fill(Susceptible,length(u_0)) for i in 1:steps])\n    r = Xoroshiro128Plus()\n    @btime solve!($u_0,$graph,$params,$steps,$solution,$r)\n    display(solution)\nend"}]}]}],"thread_ts":"1611109097.016900","parent_user_id":"U011V2YN59N"}]