[{"client_msg_id":"4e940f00-5495-4663-8c0d-2b55a325ee93","type":"message","text":"I have a complicated function that at some point uses 100 times this one that I defined previously:\n```@inline nth_neighbor(i,n,N) = mod1(i + n,N) ```\nOther things also happen 100 times but this takes most of the time according to the profiler. Is mod1 expected to be slow? If it is something not known I can try and do a MWE to post a better question.","user":"UEGRU91B2","ts":"1617309052.089600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Aw3f","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have a complicated function that at some point uses 100 times this one that I defined previously:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"@inline nth_neighbor(i,n,N) = mod1(i + n,N) "}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Other things also happen 100 times but this takes most of the time according to the profiler. Is mod1 expected to be slow? If it is something not known I can try and do a MWE to post a better question."}]}]}],"thread_ts":"1617309052.089600","reply_count":7,"reply_users_count":4,"latest_reply":"1617318926.091100","reply_users":["UEGRU91B2","U7HAYKY9X","U011V2YN59N","U67G3QRJM"],"is_locked":false,"subscribed":false},{"client_msg_id":"a66c0374-2a73-4aef-83bd-52ded30e906c","type":"message","text":"(also, I just threw the `@inline` in there to see if something magical happened","user":"UEGRU91B2","ts":"1617309084.089700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/Rf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(also, I just threw the "},{"type":"text","text":"@inline","style":{"code":true}},{"type":"text","text":" in there to see if something magical happened"}]}]}],"thread_ts":"1617309052.089600","parent_user_id":"UEGRU91B2"},{"client_msg_id":"4b8ade0f-c4ec-4315-86bf-7a5da9f1606e","type":"message","text":"How slow is slow? Integer division is much, much slower than other integer operations, but it's still just maybe 10 nanoseconds","user":"U7HAYKY9X","ts":"1617309401.089900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UDd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How slow is slow? Integer division is much, much slower than other integer operations, but it's still just maybe 10 nanoseconds"}]}]}],"thread_ts":"1617309052.089600","parent_user_id":"UEGRU91B2","reactions":[{"name":"+1","users":["U67G3QRJM"],"count":1}]},{"client_msg_id":"98172aac-aa4f-4e77-901a-1a5be0d037e0","type":"message","text":"I will try to isolate the issue and come back with proper measurements. Thanks for the order of magnitude estimate!","user":"UEGRU91B2","ts":"1617312293.090200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Lx3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I will try to isolate the issue and come back with proper measurements. Thanks for the order of magnitude estimate!"}]}]}],"thread_ts":"1617309052.089600","parent_user_id":"UEGRU91B2"},{"type":"message","subtype":"thread_broadcast","text":"I don't have a solution to your problem, but I have also found `mod1` to be very slow. I am not sure if that can be fixed though, as I have no frame of reference for the implementation in other languages.","user":"U011V2YN59N","ts":"1617313403.090400","thread_ts":"1617309052.089600","root":{"client_msg_id":"4e940f00-5495-4663-8c0d-2b55a325ee93","type":"message","text":"I have a complicated function that at some point uses 100 times this one that I defined previously:\n```@inline nth_neighbor(i,n,N) = mod1(i + n,N) ```\nOther things also happen 100 times but this takes most of the time according to the profiler. Is mod1 expected to be slow? If it is something not known I can try and do a MWE to post a better question.","user":"UEGRU91B2","ts":"1617309052.089600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Aw3f","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have a complicated function that at some point uses 100 times this one that I defined previously:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"@inline nth_neighbor(i,n,N) = mod1(i + n,N) "}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Other things also happen 100 times but this takes most of the time according to the profiler. Is mod1 expected to be slow? If it is something not known I can try and do a MWE to post a better question."}]}]}],"thread_ts":"1617309052.089600","reply_count":7,"reply_users_count":4,"latest_reply":"1617318926.091100","reply_users":["UEGRU91B2","U7HAYKY9X","U011V2YN59N","U67G3QRJM"],"is_locked":false,"subscribed":false},"blocks":[{"type":"rich_text","block_id":"uDv5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don't have a solution to your problem, but I have also found "},{"type":"text","text":"mod1","style":{"code":true}},{"type":"text","text":" to be very slow. I am not sure if that can be fixed though, as I have no frame of reference for the implementation in other languages."}]}]}],"client_msg_id":"bea45f7a-117e-49fd-b978-cf58406220ff"},{"client_msg_id":"cf4a4705-0ff5-4fd7-9626-0e39fbf17c58","type":"message","text":"```julia&gt; y = 112312312; n = 11\n11\n\njulia&gt; @btime mod1($(Ref(y))[], $(Ref(n))[])\n  2.899 ns (0 allocations: 0 bytes)\n2```","user":"U67G3QRJM","ts":"1617318808.090700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"M1kVO","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> y = 112312312; n = 11\n11\n\njulia> @btime mod1($(Ref(y))[], $(Ref(n))[])\n  2.899 ns (0 allocations: 0 bytes)\n2"}]}]}],"thread_ts":"1617309052.089600","parent_user_id":"UEGRU91B2"},{"client_msg_id":"fbe3fec0-b830-4080-a9cf-7eb68ab7143d","type":"message","text":"Doesn’t seem very slow?","user":"U67G3QRJM","ts":"1617318813.090900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gLYV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Doesn’t seem very slow?"}]}]}],"thread_ts":"1617309052.089600","parent_user_id":"UEGRU91B2"},{"client_msg_id":"0702a9ec-7f7b-4eef-89fb-0953b0d91d55","type":"message","text":"```julia&gt; i, n, N = 111234, 234234, 123\n(111234, 234234, 123)\n\njulia&gt; @btime nth_neighbor($(Ref(i))[], $(Ref(n))[], $(Ref(N))[])\n  3.039 ns (0 allocations: 0 bytes)```","user":"U67G3QRJM","ts":"1617318926.091100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NRAke","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> i, n, N = 111234, 234234, 123\n(111234, 234234, 123)\n\njulia> @btime nth_neighbor($(Ref(i))[], $(Ref(n))[], $(Ref(N))[])\n  3.039 ns (0 allocations: 0 bytes)"}]}]}],"thread_ts":"1617309052.089600","parent_user_id":"UEGRU91B2"}]