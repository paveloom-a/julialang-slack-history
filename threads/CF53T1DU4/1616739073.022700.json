[{"client_msg_id":"013325f4-7684-4d59-a775-b08637e7d21e","type":"message","text":"Hello. Running some code of mine with `@time` , I get :`7821.040149 seconds (23.55 G allocations: 1.653 TiB, 21.28% gc time)` . The code essentially consists in iterating over lots of small vectors constructed during the runtime. There is no big data that is read from disk or streamed from outside. The 1.6TiB makes me think I allocate way too much. How extreme are those numbers?","user":"U01MG0TN079","ts":"1616739073.022700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ab7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hello. Running some code of mine with "},{"type":"text","text":"@time","style":{"code":true}},{"type":"text","text":" , I get :"},{"type":"text","text":"7821.040149 seconds (23.55 G allocations: 1.653 TiB, 21.28% gc time)","style":{"code":true}},{"type":"text","text":" . The code essentially consists in iterating over lots of small vectors constructed during the runtime. There is no big data that is read from disk or streamed from outside. The 1.6TiB makes me think I allocate way too much. How extreme are those numbers?"}]}]}],"thread_ts":"1616739073.022700","reply_count":9,"reply_users_count":2,"latest_reply":"1616740822.024400","reply_users":["UJ7DVTVQ8","U01MG0TN079"],"is_locked":false,"subscribed":false},{"client_msg_id":"52df6663-afe5-4809-baf1-56333b810aad","type":"message","text":"How small is small? You might be able to improve performance by a lot by using StaticArrays.jl","user":"UJ7DVTVQ8","ts":"1616740451.022800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e1GI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How small is small? You might be able to improve performance by a lot by using StaticArrays.jl"}]}]}],"thread_ts":"1616739073.022700","parent_user_id":"U01MG0TN079"},{"client_msg_id":"da5fb0cf-8516-4469-89d0-e2dbe04db4ec","type":"message","text":"If small is less than about 100, I would give StaticArrays.jl a go","user":"UJ7DVTVQ8","ts":"1616740495.023000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LX2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If small is less than about 100, I would give StaticArrays.jl a go"}]}]}],"thread_ts":"1616739073.022700","parent_user_id":"U01MG0TN079"},{"client_msg_id":"c6759423-95fc-4a13-a720-8434d27906a3","type":"message","text":"small is \\leq 20","user":"U01MG0TN079","ts":"1616740523.023200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9lYXe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"small is \\leq 20"}]}]}],"thread_ts":"1616739073.022700","parent_user_id":"U01MG0TN079"},{"client_msg_id":"c8f4817d-eac6-4be9-950f-db11fa1106e5","type":"message","text":"but staticarrays require static-sized entries, don't they?","user":"U01MG0TN079","ts":"1616740538.023400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"AKG5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but staticarrays require static-sized entries, don't they?"}]}]}],"thread_ts":"1616739073.022700","parent_user_id":"U01MG0TN079"},{"client_msg_id":"ad1fb83a-30d1-4f3c-805f-b1945b9add5a","type":"message","text":"Maybe `SizedArray` s make sense, then","user":"U01MG0TN079","ts":"1616740591.023600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Sve","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Maybe "},{"type":"text","text":"SizedArray","style":{"code":true}},{"type":"text","text":" s make sense, then"}]}]}],"thread_ts":"1616739073.022700","parent_user_id":"U01MG0TN079"},{"client_msg_id":"2a109c9e-50be-46e9-95e7-f041f769b1b9","type":"message","text":"Say I have a diagonal matrix M and vectors u,v: does the product `u'*M*v` allocate a vector? Would it be better to have a custom routine to do the computation (since no allocation is needed here) ?","user":"U01MG0TN079","ts":"1616740705.023800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GIo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Say I have a diagonal matrix M and vectors u,v: does the product "},{"type":"text","text":"u'*M*v","style":{"code":true}},{"type":"text","text":" allocate a vector? Would it be better to have a custom routine to do the computation (since no allocation is needed here) ?"}]}]}],"thread_ts":"1616739073.022700","parent_user_id":"U01MG0TN079"},{"client_msg_id":"d3d367bd-50be-4779-89e8-ecd646f27ca5","type":"message","text":"It will allocate, but not if you use `dot`","user":"UJ7DVTVQ8","ts":"1616740765.024000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xUMWE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It will allocate, but not if you use "},{"type":"text","text":"dot","style":{"code":true}}]}]}],"thread_ts":"1616739073.022700","parent_user_id":"U01MG0TN079"},{"client_msg_id":"3a4c343f-47bd-4cc3-8481-29b56f6886b7","type":"message","text":"Dot is that custom function","user":"UJ7DVTVQ8","ts":"1616740780.024200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Ylk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Dot is that custom function"}]}]}],"thread_ts":"1616739073.022700","parent_user_id":"U01MG0TN079"},{"client_msg_id":"03e6ee3b-ed29-428f-8f82-8601cde0686f","type":"message","text":"And yeah, StaticArrays.jl require you to have a statically known size. Sometimes this can be worked around by using a function barrier","user":"UJ7DVTVQ8","ts":"1616740822.024400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"uyZKv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And yeah, StaticArrays.jl require you to have a statically known size. Sometimes this can be worked around by using a function barrier"}]}]}],"thread_ts":"1616739073.022700","parent_user_id":"U01MG0TN079"}]