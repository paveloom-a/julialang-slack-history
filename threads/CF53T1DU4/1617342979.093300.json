[{"client_msg_id":"c51b4210-36eb-4c88-8194-2d0d2b12033d","type":"message","text":"Hey. I'm puzzled by the following: I've been trying to optimize some code of mine: after doing some changes I got to this version: <https://github.com/bottine/VinbergsAlgorithmNF/blob/685fec1b92ed9f21eb8a725b933a32be1bed8130/src/vinbergs_algo.jl#L392> (the function `_extend_root_stem` is where stuff is happening) which ran under an hour on a specific \"benchmark\" example I have. I then cleanup up my changes to <https://github.com/bottine/VinbergsAlgorithmNF/blob/34f4d951541baf2b6132eeaeea2887dcd968b4d3/src/vinbergs_algo.jl#L389> and just like that my code took 2-3× longer. I'm now at this version <https://github.com/bottine/VinbergsAlgorithmNF/blob/c8bcd88897659a03d9990b15b2daad2d421a7779/src/vinbergs_algo.jl#L503> which is still quite slower than the commit `685fec1b` and I have no idea what made this commit so much better than everything coming after. Using Cthulhu, I don't see any type instabilities in my latest code, and it looks better in general. I think there is probably some \"one line\" that I changed which killed performance, but have no idea how to find it. Any idea ?","user":"U01MG0TN079","ts":"1617342979.093300","team":"T68168MUP","edited":{"user":"U01MG0TN079","ts":"1617343383.000000"},"blocks":[{"type":"rich_text","block_id":"R1R9U","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hey. I'm puzzled by the following: I've been trying to optimize some code of mine: after doing some changes I got to this version: "},{"type":"link","url":"https://github.com/bottine/VinbergsAlgorithmNF/blob/685fec1b92ed9f21eb8a725b933a32be1bed8130/src/vinbergs_algo.jl#L392"},{"type":"text","text":" (the function "},{"type":"text","text":"_extend_root_stem","style":{"code":true}},{"type":"text","text":" is where stuff is happening) which ran under an hour on a specific \"benchmark\" example I have. I then cleanup up my changes to "},{"type":"link","url":"https://github.com/bottine/VinbergsAlgorithmNF/blob/34f4d951541baf2b6132eeaeea2887dcd968b4d3/src/vinbergs_algo.jl#L389"},{"type":"text","text":" and just like that my code took 2-3× longer. I'm now at this version "},{"type":"link","url":"https://github.com/bottine/VinbergsAlgorithmNF/blob/c8bcd88897659a03d9990b15b2daad2d421a7779/src/vinbergs_algo.jl#L503"},{"type":"text","text":" which is still quite slower than the commit "},{"type":"text","text":"685fec1b","style":{"code":true}},{"type":"text","text":" and I have no idea what made this commit so much better than everything coming after. Using Cthulhu, I don't see any type instabilities in my latest code, and it looks better in general. I think there is probably some \"one line\" that I changed which killed performance, but have no idea how to find it. Any idea ?"}]}]}],"thread_ts":"1617342979.093300","reply_count":6,"reply_users_count":3,"latest_reply":"1617362430.106400","reply_users":["U0179G7FG4F","U01MG0TN079","UNMQDPP3L"],"is_locked":false,"subscribed":false},{"client_msg_id":"f32eaf19-5f58-4b3d-b046-09ffe21844b5","type":"message","text":"Have you profiled the code? I highly recomend ProfileViews","user":"U0179G7FG4F","ts":"1617343448.093500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hKc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Have you profiled the code? I highly recomend ProfileViews"}]}]}],"thread_ts":"1617342979.093300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"a5bb065d-05de-4cfc-9939-e90f7205c4b7","type":"message","text":"somewhat, yes: I usually @profile and see what that tells me, but I don't know how to make that into something really precise","user":"U01MG0TN079","ts":"1617343749.093700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Ez+8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"somewhat, yes: I usually @profile and see what that tells me, but I don't know how to make that into something really precise"}]}]}],"thread_ts":"1617342979.093300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"2dcb92e7-4783-4657-862d-715da20430ab","type":"message","text":"does ProfileViews give you anything more than StatsProfileHTML?","user":"U01MG0TN079","ts":"1617343796.093900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WJR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"does ProfileViews give you anything more than StatsProfileHTML?"}]}]}],"thread_ts":"1617342979.093300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"c4f37311-b471-4cbf-b50f-d9b4306b96ad","type":"message","text":"Have you tried TimerOutputs?, it is a great package to see performance issues in specific code?","user":"UNMQDPP3L","ts":"1617359248.105600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"rDw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Have you tried TimerOutputs?, it is a great package to see performance issues in specific code?"}]}]}],"thread_ts":"1617342979.093300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"8af19ed3-3d4a-47d7-aeed-369e3d6723d3","type":"message","text":"Also, I recommend you PProf","user":"UNMQDPP3L","ts":"1617359268.105800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"B7L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also, I recommend you PProf"}]}]}],"thread_ts":"1617342979.093300","parent_user_id":"U01MG0TN079"},{"client_msg_id":"c2038682-cf9e-4d9a-ac9e-30e5694f8be2","type":"message","text":"I haven't, but will look these up, thanks!","user":"U01MG0TN079","ts":"1617362430.106400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ImOjy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I haven't, but will look these up, thanks!"}]}]}],"thread_ts":"1617342979.093300","parent_user_id":"U01MG0TN079"}]