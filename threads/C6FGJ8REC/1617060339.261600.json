[{"client_msg_id":"79be9c35-9da9-4adb-8fb1-1840f4123286","type":"message","text":"```julia&gt; f() = 1;\n\njulia&gt; g() = 2;\n\njulia&gt; h(::typeof(f)) = 1.0;\n\njulia&gt; h(::typeof(g)) = -1.0;\n\njulia&gt; η(n) = h(isodd(n) ? f : g);\n\njulia&gt; @btime η(1)\n  0.013 ns (0 allocations: 0 bytes)\n1.0\n\njulia&gt; @btime η(2)\n  0.013 ns (0 allocations: 0 bytes)\n-1.0```\nI can't begin to say how satisfying this is after having wasted so much of my life on C++ \"functor\" shit","user":"U9VG1AYSG","ts":"1617060339.261600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/W3K","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> f() = 1;\n\njulia> g() = 2;\n\njulia> h(::typeof(f)) = 1.0;\n\njulia> h(::typeof(g)) = -1.0;\n\njulia> η(n) = h(isodd(n) ? f : g);\n\njulia> @btime η(1)\n  0.013 ns (0 allocations: 0 bytes)\n1.0\n\njulia> @btime η(2)\n  0.013 ns (0 allocations: 0 bytes)\n-1.0"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"I can't begin to say how satisfying this is after having wasted so much of my life on C++ \"functor\" shit"}]}]}],"thread_ts":"1617060339.261600","reply_count":2,"reply_users_count":2,"latest_reply":"1617088206.264600","reply_users":["UH108BJB1","U7HAYKY9X"],"is_locked":false,"subscribed":false,"reactions":[{"name":"dancingunicorn","users":["UPUBAM63X","UKG4WF8PJ"],"count":2},{"name":"sonic","users":["UGU761DU2","UE4DPAS4W","U9MED583T","UC6SUUPRC","U017D621ELC","UKG4WF8PJ"],"count":6},{"name":"juliaspinner","users":["UGU761DU2","UC6SUUPRC","U017D621ELC"],"count":3},{"name":"open_mouth","users":["UPQP0RWTH","UH108BJB1"],"count":2},{"name":"grin","users":["U687RKK0E"],"count":1}]},{"client_msg_id":"ee63c474-985f-4c47-b9cf-3bdc71f1d19c","type":"message","text":"Do you happen to know what kind of optimization is used behind the scenes? It’s amazing that this type-unstable function has no overhead.\n\nIn Julia 1.0:\n\n```julia&gt; @btime η(2)\n  1.420 ns (0 allocations: 0 bytes)\n-1.0```","user":"UH108BJB1","ts":"1617082417.263900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zyK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Do you happen to know what kind of optimization is used behind the scenes? It’s amazing that this type-unstable function has no overhead.\n\nIn Julia 1.0:\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> @btime η(2)\n  1.420 ns (0 allocations: 0 bytes)\n-1.0"}]}]}],"thread_ts":"1617060339.261600","parent_user_id":"U9VG1AYSG"},{"client_msg_id":"a33b16cc-f0cf-41cb-9af5-1381440b78e4","type":"message","text":"I would assume it's the improved constant folding","user":"U7HAYKY9X","ts":"1617088206.264600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fx1cp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I would assume it's the improved constant folding"}]}]}],"thread_ts":"1617060339.261600","parent_user_id":"U9VG1AYSG","reactions":[{"name":"eyes","users":["UH108BJB1"],"count":1},{"name":"point_up","users":["UAUCGGD6C","U9VG1AYSG"],"count":2}]}]