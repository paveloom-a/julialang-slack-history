[{"client_msg_id":"b51e02e1-7ab8-4622-919b-760d8c9a45d3","type":"message","text":"Hello!\n\nSuppose we have some data (e.g. the lengths of all the people on Earth). It is then easy to compute and plot a histogram of these data.\n*What are good (and frequently used) ways to compute error bars/confidence intervals on a histogram?*\n\nBoth code and formulas are welcome!\nThank you, in advance,\nBest,\nIgnace","user":"U01HC60USTH","ts":"1611257001.008400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HYFpj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hello!\n\nSuppose we have some data (e.g. the lengths of all the people on Earth). It is then easy to compute and plot a histogram of these data.\n"},{"type":"text","text":"What are good (and frequently used) ways to compute error bars/confidence intervals on a histogram?","style":{"bold":true}},{"type":"text","text":"\n\nBoth code and formulas are welcome!\nThank you, in advance,\nBest,\nIgnace"}]}]}],"thread_ts":"1611257001.008400","reply_count":9,"reply_users_count":5,"latest_reply":"1611626383.013700","reply_users":["UH8A351DJ","U019K6Q9N15","U01HC60USTH","U017JTQFNEQ","U6C937ENB"],"subscribed":false},{"client_msg_id":"5bba5382-8402-451f-9e52-a33cebb95a3e","type":"message","text":"for poisson error, good approximation is `sqrt(N)` as 1-sigma error","user":"UH8A351DJ","ts":"1611257278.009300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qaK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"for poisson error, good approximation is "},{"type":"text","text":"sqrt(N)","style":{"code":true}},{"type":"text","text":" as 1-sigma error"}]}]}],"thread_ts":"1611257001.008400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"08e6cdeb-c7df-4243-9ca1-b6d7e92edae9","type":"message","text":"<https://mathematica.stackexchange.com/questions/177277/histogram-with-error-bars>","user":"U019K6Q9N15","ts":"1611257350.009500","team":"T68168MUP","attachments":[{"service_name":"Mathematica Stack Exchange","title":"Histogram with Error bars","title_link":"https://mathematica.stackexchange.com/questions/177277/histogram-with-error-bars","text":"I have a dataset for which Mathematica easily creates a Histogram. However I also need Mathematica to show error bars corresponding to 3 standard deviations for each bar. This is something similar ...","fallback":"Mathematica Stack Exchange: Histogram with Error bars","thumb_url":"https://cdn.sstatic.net/Sites/mathematica/Img/apple-touch-icon@2.png?v=1b98edea1597","from_url":"https://mathematica.stackexchange.com/questions/177277/histogram-with-error-bars","thumb_width":316,"thumb_height":316,"service_icon":"https://cdn.sstatic.net/Sites/mathematica/Img/apple-touch-icon.png?v=e9d3b58724f3","id":1,"original_url":"https://mathematica.stackexchange.com/questions/177277/histogram-with-error-bars"}],"blocks":[{"type":"rich_text","block_id":"7ewc","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://mathematica.stackexchange.com/questions/177277/histogram-with-error-bars"}]}]}],"thread_ts":"1611257001.008400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"025090bf-49ed-48de-b751-ef32a4b3d7df","type":"message","text":"for small number where `sqrt(N)` ~&gt;=N, see this note from fermilab: <https://www-cdf.fnal.gov/physics/statistics/notes/pois_eb.txt>","user":"UH8A351DJ","ts":"1611257512.010100","team":"T68168MUP","edited":{"user":"UH8A351DJ","ts":"1611257522.000000"},"blocks":[{"type":"rich_text","block_id":"trOv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"for small number where "},{"type":"text","text":"sqrt(N)","style":{"code":true}},{"type":"text","text":" ~>=N, see this note from fermilab: "},{"type":"link","url":"https://www-cdf.fnal.gov/physics/statistics/notes/pois_eb.txt"}]}]}],"thread_ts":"1611257001.008400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"906cfcb8-453e-46e2-bf88-223429d04ad7","type":"message","text":"Thank you <@UH8A351DJ>. Two questions (if I may):\n\n* When is Poisson error a valid assumption? Let’s assume that I am having a huge amount of (continuous) data points, including a few rare events.\n\n* How can we intuitively understand that poorly populated bins have small error bars? One could say that adding one sample there would, instead, have huge influence.","user":"U01HC60USTH","ts":"1611259637.011000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"PjNb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thank you "},{"type":"user","user_id":"UH8A351DJ"},{"type":"text","text":". Two questions (if I may):\n\n* When is Poisson error a valid assumption? Let’s assume that I am having a huge amount of (continuous) data points, including a few rare events.\n\n* How can we intuitively understand that poorly populated bins have small error bars? One could say that adding one sample there would, instead, have huge influence."}]}]}],"thread_ts":"1611257001.008400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"e2eb1d36-5794-47fe-8fd5-6702807cd5d3","type":"message","text":"Poisson error is valid when you're \"counting # of occurrence\". It's the counting error due to we're making a histogram, for example, doesn't account for systematic errors and alikes","user":"UH8A351DJ","ts":"1611259754.011200","team":"T68168MUP","edited":{"user":"UH8A351DJ","ts":"1611259781.000000"},"blocks":[{"type":"rich_text","block_id":"urSs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Poisson error is valid when you're \"counting # of occurrence\". It's the counting error due to we're making a histogram, for example, doesn't account for systematic errors and alikes"}]}]}],"thread_ts":"1611257001.008400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"e4920a0d-b0ca-4187-bf4e-105c8cb56bb0","type":"message","text":"You can always sample from your distribution (with replacement) many times and then show the mean and CI of each bin in the histogram.","user":"U017JTQFNEQ","ts":"1611297259.011800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EJaC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You can always sample from your distribution (with replacement) many times and then show the mean and CI of each bin in the histogram."}]}]}],"thread_ts":"1611257001.008400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"2f1970e7-696e-416b-8a35-416fd68e49fd","type":"message","text":"```using Distributions, StatsBase, Plots\nX = Poisson(10); boots = 2000; n_samp=1000;\nBigXs = map((x)-&gt;rand(rand(X,n_samp),n_samp),1:boots)\n# We first take 1000 samples from Poisson(10) and then samples with replacement `boots` times from that data\nbins = 0:(mapreduce(maximum, max, BigXs) + 1)\nallH = map(x -&gt; fit(Histogram, x, bins), BigXs) # Fit a histogram to each of the `boots` samples\nW = zeros(boots, length(bins))\nfor ix = 1:boots\n  W[ix,:] = allH[ix].weights\nend\nμ = mean(W, dims=1)[:]\nthreeσ = 3 .* std(W, dims=1)[:]\nbinc = (bins[1:end-1] .+ bins[2:end]) ./2\nbar(binc, μ, yerr=threeσ)```","user":"U017JTQFNEQ","ts":"1611298495.012000","team":"T68168MUP","edited":{"user":"U017JTQFNEQ","ts":"1611298615.000000"},"blocks":[{"type":"rich_text","block_id":"uYizO","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"using Distributions, StatsBase, Plots\nX = Poisson(10); boots = 2000; n_samp=1000;\nBigXs = map((x)->rand(rand(X,n_samp),n_samp),1:boots)\n# We first take 1000 samples from Poisson(10) and then samples with replacement `boots` times from that data\nbins = 0:(mapreduce(maximum, max, BigXs) + 1)\nallH = map(x -> fit(Histogram, x, bins), BigXs) # Fit a histogram to each of the `boots` samples\nW = zeros(boots, length(bins))\nfor ix = 1:boots\n  W[ix,:] = allH[ix].weights\nend\nμ = mean(W, dims=1)[:]\nthreeσ = 3 .* std(W, dims=1)[:]\nbinc = (bins[1:end-1] .+ bins[2:end]) ./2\nbar(binc, μ, yerr=threeσ)"}]}]}],"thread_ts":"1611257001.008400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"d3b801eb-bcf4-4d04-89ed-84c6711093bd","type":"message","text":"If you never observed something, you have a small uncertainty about its probability in terms of absolute error (but small in terms of relative error)","user":"U6C937ENB","ts":"1611594887.013300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"n5=kl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If you never observed something, you have a small uncertainty about its probability in terms of absolute error (but small in terms of relative error)"}]}]}],"thread_ts":"1611257001.008400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"deb7b118-7297-45da-b8df-e57c38abc234","type":"message","text":"<@U01HC60USTH> There are a couple issues at play here.\n1. i personally think error bars on histograms don’t signal anything really useful, since changing the bin size changes the error bars. An empirical cumulative distribution (ECDF) doesn’t have this strange feature, and you can use the same technique i showed (resampling) to get a sense of the “confidence” in the ECDF. The histogram is already providing a lot of visual information about the distribution (e.g. compared to just providing the mean and stderr)\n2. I think your intuition about adding a sample to a bin that usually doesn’t have any samples applies more to something like <https://en.wikipedia.org/wiki/Coefficient_of_variation> than standard deviation. Compared to a bin where the # of samples has a large range, adding a sample to a bin with few samples will not result in a large variance or stdev. But it will be a large CV (which is std/mean) since the mean is very small. ","user":"U017JTQFNEQ","ts":"1611626383.013700","team":"T68168MUP","attachments":[{"title":"Coefficient of variation","title_link":"https://en.wikipedia.org/wiki/Coefficient_of_variation","from_url":"https://en.wikipedia.org/wiki/Coefficient_of_variation","author_name":"Wikipedia","author_link":"https://en.wikipedia.org/","text":"In probability theory and statistics, the coefficient of variation (CV), also known as relative standard deviation (RSD), is a standardized measure of dispersion of a probability distribution or frequency distribution. It is often expressed as a percentage, and is defined as the ratio of the standard deviation  \n  \n    \n      \n         \n        σ\n      \n    \n    {\\displaystyle \\ \\sigma }\n   to the mean  \n  \n    \n      \n         \n        μ\n      \n    \n    {\\displaystyle \\ \\mu }\n   (or its absolute value, \n  \n    \n      \n        \n          |\n        \n        μ\n        \n          |\n        \n      \n    \n    {\\displaystyle |\\mu |}\n  ).  The CV or RSD is widely used in analytical chemistry to express the precision and repeatability of an assay. It is also commonly used in fields such as engineering or physics when doing quality assurance studies and ANOVA gauge R&amp;R. In addition, CV is utilized by economists and investors in economic models.","fallback":"wikipedia: Coefficient of variation","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/wikipedia.png","id":1,"original_url":"https://en.wikipedia.org/wiki/Coefficient_of_variation"}],"blocks":[{"type":"rich_text","block_id":"sGP2N","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U01HC60USTH"},{"type":"text","text":" There are a couple issues at play here.\n"}]},{"type":"rich_text_list","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"i personally think error bars on histograms don’t signal anything really useful, since changing the bin size changes the error bars. An empirical cumulative distribution (ECDF) doesn’t have this strange feature, and you can use the same technique i showed (resampling) to get a sense of the “confidence” in the ECDF. The histogram is already providing a lot of visual information about the distribution (e.g. compared to just providing the mean and stderr)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"I think your intuition about adding a sample to a bin that usually doesn’t have any samples applies more to something like "},{"type":"link","url":"https://en.wikipedia.org/wiki/Coefficient_of_variation"},{"type":"text","text":" than standard deviation. Compared to a bin where the # of samples has a large range, adding a sample to a bin with few samples will not result in a large variance or stdev. But it will be a large CV (which is std/mean) since the mean is very small. "}]}],"style":"ordered","indent":0}]}],"thread_ts":"1611257001.008400","parent_user_id":"U01HC60USTH"}]