[{"client_msg_id":"c47da9ba-196c-4df9-8d10-eeb2efe73529","type":"message","text":"I see there have been some reworks in GLM about confidence intervals, but I wanted to ask: did confidence intervals change for the vanilla linear model?","user":"U6BJ9E351","ts":"1615281578.111900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LZh5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I see there have been some reworks in GLM about confidence intervals, but I wanted to ask: did confidence intervals change for the vanilla linear model?"}]}]}],"thread_ts":"1615281578.111900","reply_count":24,"reply_users_count":5,"latest_reply":"1615301548.118600","reply_users":["U67431ELR","U6BJ9E351","U7JQGPGCQ","U82LX4ACB","UBF9YRB6H"],"subscribed":false},{"client_msg_id":"76e3970b-0eb6-4dde-9e62-acfea4ff58cd","type":"message","text":"AFAIK we just added support for intervals in `predict.`","user":"U67431ELR","ts":"1615281616.112600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"chtMY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"AFAIK we just added support for intervals in "},{"type":"text","text":"predict.","style":{"code":true}}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"3f5adca0-2ca6-4435-b0a9-28bbd6991c14","type":"message","text":"In AlgebraOfGraphics, I get radically different plots (using `predict(lm::LinearModel, m::Matrix, interval=:confidence)`). Eg, <http://juliaplots.org/AlgebraOfGraphics.jl/stable/generated/linear.svg|before> and <http://juliaplots.org/AlgebraOfGraphics.jl/dev/generated/linear.svg|after>","user":"U6BJ9E351","ts":"1615281695.113500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/Aj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In AlgebraOfGraphics, I get radically different plots (using "},{"type":"text","text":"predict(lm::LinearModel, m::Matrix, interval=:confidence)","style":{"code":true}},{"type":"text","text":"). Eg, "},{"type":"link","url":"http://juliaplots.org/AlgebraOfGraphics.jl/stable/generated/linear.svg","text":"before"},{"type":"text","text":" and "},{"type":"link","url":"http://juliaplots.org/AlgebraOfGraphics.jl/dev/generated/linear.svg","text":"after"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"3f1b37f6-a054-4e03-8cf0-e96c132c9dbb","type":"message","text":"Hmm. The PR I recently merged is <https://github.com/JuliaStats/GLM.jl/pull/364>.","user":"U67431ELR","ts":"1615281768.113700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"F87","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmm. The PR I recently merged is "},{"type":"link","url":"https://github.com/JuliaStats/GLM.jl/pull/364"},{"type":"text","text":"."}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"10af41a3-8e8f-4ab5-aff8-11f3d7cc5926","type":"message","text":"What version is \"before\"?","user":"U67431ELR","ts":"1615281788.113900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EnAf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What version is \"before\"?"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"d20e01e4-109b-4c0b-b40c-902b5ef64b40","type":"message","text":"I think 1.3.11 (but I can double check locally)","user":"U6BJ9E351","ts":"1615281887.114100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Bwx6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think 1.3.11 (but I can double check locally)"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"776c0524-1373-4c85-bb8a-80b81b647428","type":"message","text":"yes, by bringing GLM back to 1.3.11 I can reproduce the old behavior... I'll try to come up with a MWE (still not sure what may be going on though, it does look like the method I'm calling hasn't been touched)","user":"U6BJ9E351","ts":"1615282423.114300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0y5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes, by bringing GLM back to 1.3.11 I can reproduce the old behavior... I'll try to come up with a MWE (still not sure what may be going on though, it does look like the method I'm calling hasn't been touched)"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"82a79e01-6a0f-4f86-972b-e6cdf7b8726a","type":"message","text":"Maybe you have a GLM with a normal distribution, rather than a proper LM? EDIT: that's not possible since we didn't support CIs for GLMs before.","user":"U67431ELR","ts":"1615282526.114500","team":"T68168MUP","edited":{"user":"U67431ELR","ts":"1615282726.000000"},"blocks":[{"type":"rich_text","block_id":"2vusf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Maybe you have a GLM with a normal distribution, rather than a proper LM? EDIT: that's not possible since we didn't support CIs for GLMs before."}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"30968efd-a1b3-4b1c-aa3d-459b10a0c2b0","type":"message","text":"I'm just calling `lm`, and I have checked that it gives me a `LinearModel`  (but I can definitely compare the GLM with identity link and normal distribution to see if they match)","user":"U6BJ9E351","ts":"1615282760.114800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"izdZ+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm just calling "},{"type":"text","text":"lm","style":{"code":true}},{"type":"text","text":", and I have checked that it gives me a "},{"type":"text","text":"LinearModel","style":{"code":true}},{"type":"text","text":"  (but I can definitely compare the GLM with identity link and normal distribution to see if they match)"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"87521e5d-b67a-4fb4-88d8-11721d24e895","type":"message","text":"btw, this is a MWE that behaves differently on the two versions:\n```julia&gt; using GLM\n\njulia&gt; x = [1.0 1.0\n            1.0 2.0\n            1.0 -1.0];\n\njulia&gt; y = [1.0, 3.0, -2.0];\n\njulia&gt; m = lm(x, y);\n\njulia&gt; predict(m, x, interval=:confidence)```","user":"U6BJ9E351","ts":"1615282784.115000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"==DsI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"btw, this is a MWE that behaves differently on the two versions:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> using GLM\n\njulia> x = [1.0 1.0\n            1.0 2.0\n            1.0 -1.0];\n\njulia> y = [1.0, 3.0, -2.0];\n\njulia> m = lm(x, y);\n\njulia> predict(m, x, interval=:confidence)"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"ebe89ad4-b462-4c66-a9e2-bf0611d186cb","type":"message","text":"I don't see any difference. :confused: I get this on both versions:\n```(prediction = [1.2142857142857146, 2.8571428571428585, -2.0714285714285725], lower = [-0.8151383947225981; -1.0989330286373797; -5.343776620915804], upper = [3.2437098232940276; 6.813218742923096; 1.2009194780586587])```","user":"U67431ELR","ts":"1615283033.115200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qqk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don't see any difference. "},{"type":"emoji","name":"confused"},{"type":"text","text":" I get this on both versions:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"(prediction = [1.2142857142857146, 2.8571428571428585, -2.0714285714285725], lower = [-0.8151383947225981; -1.0989330286373797; -5.343776620915804], upper = [3.2437098232940276; 6.813218742923096; 1.2009194780586587])"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"fa171b82-9cbe-4021-86f5-0ffe39bf1d1c","type":"message","text":"ah, that's weird, that's the one I get in 1.4 but not on 1.3.11, I've opened <https://github.com/JuliaStats/GLM.jl/issues/409>","user":"U6BJ9E351","ts":"1615283364.115400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e1TrF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ah, that's weird, that's the one I get in 1.4 but not on 1.3.11, I've opened "},{"type":"link","url":"https://github.com/JuliaStats/GLM.jl/issues/409"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"380ad068-966a-4de3-b801-44d0fbfa73f6","type":"message","text":"Ah wait I missed the difference because it only appears at the end.","user":"U67431ELR","ts":"1615283523.115600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/Mz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah wait I missed the difference because it only appears at the end."}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"aa588fdd-3b9a-4b8c-a514-df54724fcba9","type":"message","text":"yes, the end of the confidence interval changes, not too sure what to make of it, I guess I'll just bound it from AlgebraOfGraphics to the previous version until we figure out what this is (though I guess it would be good to know whether the \"before\" or \"after\" version is correct)","user":"U6BJ9E351","ts":"1615283815.115800","team":"T68168MUP","edited":{"user":"U6BJ9E351","ts":"1615283895.000000"},"blocks":[{"type":"rich_text","block_id":"vOdX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes, the end of the confidence interval changes, not too sure what to make of it, I guess I'll just bound it from AlgebraOfGraphics to the previous version until we figure out what this is (though I guess it would be good to know whether the \"before\" or \"after\" version is correct)"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"682bda88-782f-4c88-8260-15c8b81a2f3b","type":"message","text":"I found an explanation: <https://github.com/JuliaStats/GLM.jl/issues/409#issuecomment-793675906>","user":"U67431ELR","ts":"1615285426.116100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gXvQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I found an explanation: "},{"type":"link","url":"https://github.com/JuliaStats/GLM.jl/issues/409#issuecomment-793675906"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"dcad2919-cf83-4cdf-846c-cd05a089b2b6","type":"message","text":"Hm, that seems a bit concerning - `x` isn't rank deficient here afaict, so why would that keyword affect the results?","user":"U7JQGPGCQ","ts":"1615286751.116300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9Tv=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hm, that seems a bit concerning - "},{"type":"text","text":"x","style":{"code":true}},{"type":"text","text":" isn't rank deficient here afaict, so why would that keyword affect the results?"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"5f83d03f-3305-40a8-9803-1e713cd33476","type":"message","text":"I've updated the issue, even with reasonable data (from RDatasets), confidence intervals are very different with `dropcollinear`, looks like a bug","user":"U6BJ9E351","ts":"1615287322.116500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WRE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I've updated the issue, even with reasonable data (from RDatasets), confidence intervals are very different with "},{"type":"text","text":"dropcollinear","style":{"code":true}},{"type":"text","text":", looks like a bug"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"2ee38644-f506-4af8-b76e-062be21ecd4a","type":"message","text":"The problem is that `predict` wasn't developed with `allowrankdeficient=true` in mind, and then we turned that into the default. Cc: <@U73KENNG4>","user":"U67431ELR","ts":"1615287584.116700","team":"T68168MUP","edited":{"user":"U67431ELR","ts":"1615287937.000000"},"blocks":[{"type":"rich_text","block_id":"IGxC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The problem is that "},{"type":"text","text":"predict","style":{"code":true}},{"type":"text","text":" wasn't developed with "},{"type":"text","text":"allowrankdeficient=true","style":{"code":true}},{"type":"text","text":" in mind, and then we turned that into the default. Cc: "},{"type":"user","user_id":"U73KENNG4"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"50d528f2-b44f-4787-a86e-07b0664c95b3","type":"message","text":"Actually it's `allowrankdeficient` which was added later. That doesn't change the result.","user":"U67431ELR","ts":"1615287700.116900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"S1L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Actually it's "},{"type":"text","text":"allowrankdeficient","style":{"code":true}},{"type":"text","text":" which was added later. That doesn't change the result."}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"37ba0f1c-ec61-4088-bed7-80a045cb9781","type":"message","text":"I think I've found a solution. I'm a bit ashamed to say that I found the explanation in the R docs for the Cholesky decomposition, as the Julia docstring is really not explicit. <https://stat.ethz.ch/R-manual/R-patched/library/base/html/chol.html>","user":"U67431ELR","ts":"1615291767.117300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"I74ms","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think I've found a solution. I'm a bit ashamed to say that I found the explanation in the R docs for the Cholesky decomposition, as the Julia docstring is really not explicit. "},{"type":"link","url":"https://stat.ethz.ch/R-manual/R-patched/library/base/html/chol.html"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351","reactions":[{"name":"r","users":["U82LX4ACB","U680THK2S"],"count":2}]},{"client_msg_id":"bcf9d185-fe94-406a-a68d-59a543e9b97a","type":"message","text":"I guess it was missing something like this? <https://github.com/Nosferican/Econometrics.jl/blob/b58bcaff3e33a6943e0050e6abd7f986b20ca03f/src/solvers.jl#L177-L185>","user":"U82LX4ACB","ts":"1615294474.117600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1YQPL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I guess it was missing something like this? "},{"type":"link","url":"https://github.com/Nosferican/Econometrics.jl/blob/b58bcaff3e33a6943e0050e6abd7f986b20ca03f/src/solvers.jl#L177-L185"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351","reactions":[{"name":"heavy_check_mark","users":["U67431ELR"],"count":1}]},{"client_msg_id":"4832902b-d81c-4c00-aecf-499ba4da296e","type":"message","text":"Thanks a lot <@U67431ELR> for the detective work and the quick fix!","user":"U6BJ9E351","ts":"1615294522.117800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3oet","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks a lot "},{"type":"user","user_id":"U67431ELR"},{"type":"text","text":" for the detective work and the quick fix!"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"5bd3b183-4e2c-4557-9905-e0f09e4d729e","type":"message","text":"Sorry can I just checked - this only affected confidence intervals for `predict` in the most recent GLM versions?","user":"U7JQGPGCQ","ts":"1615296644.118000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Yd0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Sorry can I just checked - this only affected confidence intervals for "},{"type":"text","text":"predict","style":{"code":true}},{"type":"text","text":" in the most recent GLM versions?"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"},{"client_msg_id":"8a736b0d-261c-4117-8877-0f84d4454468","type":"message","text":"In 1.4.0, yes.","user":"U67431ELR","ts":"1615296672.118200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ES+56","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In 1.4.0, yes."}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351","reactions":[{"name":"+1","users":["U7JQGPGCQ"],"count":1}]},{"client_msg_id":"183bc298-023c-4031-9494-21752598b714","type":"message","text":"I'm sorry everyone!","user":"UBF9YRB6H","ts":"1615301548.118600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"AJ/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm sorry everyone!"}]}]}],"thread_ts":"1615281578.111900","parent_user_id":"U6BJ9E351"}]