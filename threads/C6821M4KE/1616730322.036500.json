[{"client_msg_id":"42b9a554-f6be-4886-9552-fb6784bed046","type":"message","text":"I have a basic stats question. So I am comparing a patient with a condition to the population of healthy. Due to only have 1 observation/patient, I am looking into the z-score, i.e. calculating that patient z-score based on healthy stats, to check how much it deviates to healthy central tendency and how significant it is (by converting it to p-value).\n\nMy questions:\n1. Can this approach be called a 'one-sample z-test'? I have been reading around and most of the example I found, the 'one-sample' refers to another sample population, not 1 observation.\n2. My follow-up question would be, is it valid to do multiple comparison correction, such as Bonferroni-Holm on top of this analysis?\nI have been browsing about this but could not find any information for this specific question. Any help would be greatly appreciated!","user":"UUT4VGTE2","ts":"1616730322.036500","team":"T68168MUP","edited":{"user":"UUT4VGTE2","ts":"1616730379.000000"},"blocks":[{"type":"rich_text","block_id":"DRZ2X","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have a basic stats question. So I am comparing a patient with a condition to the population of healthy. Due to only have 1 observation/patient, I am looking into the z-score, i.e. calculating that patient z-score based on healthy stats, to check how much it deviates to healthy central tendency and how significant it is (by converting it to p-value).\n\nMy questions:\n"}]},{"type":"rich_text_list","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Can this approach be called a 'one-sample z-test'? I have been reading around and most of the example I found, the 'one-sample' refers to another sample population, not 1 observation."}]},{"type":"rich_text_section","elements":[{"type":"text","text":"My follow-up question would be, is it valid to do multiple comparison correction, such as Bonferroni-Holm on top of this analysis?"}]}],"style":"ordered","indent":0},{"type":"rich_text_section","elements":[{"type":"text","text":"\nI have been browsing about this but could not find any information for this specific question. Any help would be greatly appreciated!"}]}]}],"thread_ts":"1616730322.036500","reply_count":18,"reply_users_count":4,"latest_reply":"1616900463.080800","reply_users":["UKLKS1WC8","UUT4VGTE2","U01EF0QVAB0","U7JQGPGCQ"],"is_locked":false,"subscribed":false},{"client_msg_id":"7d9a1052-c368-4ca4-938b-3c386682878a","type":"message","text":"I think this needs a bit more context! Can you elaborate on what the multiple comparisons are that you would want to do in 2.?  Also what are you measuring per patient and how big is your population of healthy?","user":"UKLKS1WC8","ts":"1616734143.036800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/oXJF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think this needs a bit more context! Can you elaborate on what the multiple comparisons are that you would want to do in 2.?  Also what are you measuring per patient and how big is your population of healthy?"}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"8953ede9-7b70-4a8d-8029-6a36a6c7b9ea","type":"message","text":"<@UKLKS1WC8> Thanks a lot for responding!\n\n&gt; Can you elaborate on what the multiple comparisons are that you would want to do in 2.?\nSo within that analysis, which includes 69 variables, I will have 69 z-scores. I would like to correct those p-values, that are converted from those z-scores to protect against false positive.\n\n&gt; Also what are you measuring per patient and how big is your population of healthy?\nI am measuring a metabolite (using magnetic resonance spectroscopy data) and my healthy population is 18.","user":"UUT4VGTE2","ts":"1616737294.037000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XcAKb","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UKLKS1WC8"},{"type":"text","text":" Thanks a lot for responding!\n\n"}]},{"type":"rich_text_quote","elements":[{"type":"text","text":"Can you elaborate on what the multiple comparisons are that you would want to do in 2.?"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"So within that analysis, which includes 69 variables, I will have 69 z-scores. I would like to correct those p-values, that are converted from those z-scores to protect against false positive.\n\n"}]},{"type":"rich_text_quote","elements":[{"type":"text","text":"Also what are you measuring per patient and how big is your population of healthy?"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"I am measuring a metabolite (using magnetic resonance spectroscopy data) and my healthy population is 18."}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"a64c01dd-190a-4367-a678-b9032d1d63eb","type":"message","text":"It makes sense to calculate some kind of percentile here but not z-score/p value I think with just n=1. You can calculate a percentile of this one patient in the empirical distribution that you are comparing to. Though with n=18 there it seems it will be very discretized in units of 1/18, so may want to smooth it out or something.","user":"U01EF0QVAB0","ts":"1616737626.037200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gnMd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It makes sense to calculate some kind of percentile here but not z-score/p value I think with just n=1. You can calculate a percentile of this one patient in the empirical distribution that you are comparing to. Though with n=18 there it seems it will be very discretized in units of 1/18, so may want to smooth it out or something."}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"29d5c7c8-3742-44a4-af24-b170555b3a96","type":"message","text":"So the multiple testing refers to 69 different metabolites of the same patient? It's somewhat tricky to really compute a p-value here and to interpret it. For example you could still do a two-sample t-test  (need to slightly modify it to account for n=1 in one group) if you are willing to make the two following assumptions: A) Z_1 is Normal -- note that in contrast to the usual argument about robustness of the t-test, here you won't have any central limit theorem, so you would really rely on Normality and B) the variance of Z_1 is the same as the variance of control measurements, which is also a  strong assumption..","user":"UKLKS1WC8","ts":"1616738307.037400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bWKUH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So the multiple testing refers to 69 different metabolites of the same patient? It's somewhat tricky to really compute a p-value here and to interpret it. For example you could still do a two-sample t-test  (need to slightly modify it to account for n=1 in one group) if you are willing to make the two following assumptions: A) Z_1 is Normal -- note that in contrast to the usual argument about robustness of the t-test, here you won't have any central limit theorem, so you would really rely on Normality and B) the variance of Z_1 is the same as the variance of control measurements, which is also a  strong assumption.."}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"ca4faa57-6de5-4681-9c95-be0fa8ca731c","type":"message","text":"As Rohan says though I would discourage you from doing formal null hypothesis testing and computing p-values in this scenario.","user":"UKLKS1WC8","ts":"1616738343.037600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"c6i","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"As Rohan says though I would discourage you from doing formal null hypothesis testing and computing p-values in this scenario."}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"0e61ffbb-061f-4045-a198-1ff5e3591abe","type":"message","text":"Just to clarify on how I calculate the z-score. It is `(x-central_tendency(healthy))/deviation(healthy)` . I would figure to calculate this to know how significant the difference is compared to healthy distribution, as where it sits in the healthy distribution shows that the variable is significant. Is it not make any sense?\n\nThe reason of I'm not doing a t-test is that some of my variables are not normal and point number 2, as we only have 1 sample, I wouldn't want to assume it has the same variance. I have a thread on this previously, which I don't have access to anymore cause it was prior to march 15. Someone suggested this approach and I think it is the best I can do with only 1 observation.\n\nAnyway, the central tendency and deviation I used is median and median abs deviation, because some of the variables are not normal.\n\n*EDIT*\n\nLet's take a step back and let me explain my research question. It is 'which molecule is significantly different/impacted by this condition?' And we don't want to assume if the variance/distribution is the same with healthy cause it is a very strong assumption to make.","user":"UUT4VGTE2","ts":"1616738594.037800","team":"T68168MUP","edited":{"user":"UUT4VGTE2","ts":"1616739340.000000"},"blocks":[{"type":"rich_text","block_id":"0+D2Q","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Just to clarify on how I calculate the z-score. It is "},{"type":"text","text":"(x-central_tendency(healthy))/deviation(healthy)","style":{"code":true}},{"type":"text","text":" . I would figure to calculate this to know how significant the difference is compared to healthy distribution, as where it sits in the healthy distribution shows that the variable is significant. Is it not make any sense?\n\nThe reason of I'm not doing a t-test is that some of my variables are not normal and point number 2, as we only have 1 sample, I wouldn't want to assume it has the same variance. I have a thread on this previously, which I don't have access to anymore cause it was prior to march 15. Someone suggested this approach and I think it is the best I can do with only 1 observation.\n\nAnyway, the central tendency and deviation I used is median and median abs deviation, because some of the variables are not normal.\n\n"},{"type":"text","text":"EDIT","style":{"bold":true}},{"type":"text","text":"\n\nLet's take a step back and let me explain my research question. It is 'which molecule is significantly different/impacted by this condition?' And we don't want to assume if the variance/distribution is the same with healthy cause it is a very strong assumption to make."}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"b4801fa7-1090-4db1-901c-0c753448854e","type":"message","text":"So to summarise you have 19 patients, for each of which you measure 69 metabolites, and for one of those patients you measure them twice (pre and post treatment). Your research question is whether there is a \"significant\" treatment effect on one or more of the metabolites. Is that correct?","user":"U7JQGPGCQ","ts":"1616743614.038400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Mql","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So to summarise you have 19 patients, for each of which you measure 69 metabolites, and for one of those patients you measure them twice (pre and post treatment). Your research question is whether there is a \"significant\" treatment effect on one or more of the metabolites. Is that correct?"}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"A3C1BAE1-2ECC-4826-BA41-E57FA2323DE4","type":"message","text":"<@U7JQGPGCQ> It is more like whether there is a significant difference on either pre or post treatment compared to healthy in one or more of the metabolites","user":"UUT4VGTE2","ts":"1616771823.040600","team":"T68168MUP","edited":{"user":"UUT4VGTE2","ts":"1616771854.000000"},"blocks":[{"type":"rich_text","block_id":"5k8zm","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U7JQGPGCQ"},{"type":"text","text":" It is more like whether there is a significant difference on either pre or post treatment compared to healthy in one or more of the metabolites"}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"2280a376-33a8-4817-a7a5-67be329b5874","type":"message","text":"I still think with only n=1 patient, whatever hypothesis testing you do won't be very informative. In this case it seems better to just use descriptive statistics. You don't even have an SE defined for n=1 to be able to do any kind of test","user":"U01EF0QVAB0","ts":"1616779352.041000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"H+L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I still think with only n=1 patient, whatever hypothesis testing you do won't be very informative. In this case it seems better to just use descriptive statistics. You don't even have an SE defined for n=1 to be able to do any kind of test"}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2","reactions":[{"name":"+1","users":["UKLKS1WC8","UUT4VGTE2"],"count":2}]},{"client_msg_id":"b2e7bb9e-0f0b-4eda-a5fb-e517205195b8","type":"message","text":"Agreed, I would probably start by plotting histograms of the 19 patients for each of the metabolites to see where the treated patient sits in the distribution (both before and after treatment). I suppose one would expect the patient to be at rank 1 or 19 a few times if all the draws are random, but I'm not sure that would be a sensible assumption here anyway (I don't know anything about metabolites, but it seems unlikely that there wouldn't be some correlation within patients)","user":"U7JQGPGCQ","ts":"1616780374.041200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nbY8L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Agreed, I would probably start by plotting histograms of the 19 patients for each of the metabolites to see where the treated patient sits in the distribution (both before and after treatment). I suppose one would expect the patient to be at rank 1 or 19 a few times if all the draws are random, but I'm not sure that would be a sensible assumption here anyway (I don't know anything about metabolites, but it seems unlikely that there wouldn't be some correlation within patients)"}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"a4562cb0-82a3-48b6-bbd3-445732b468af","type":"message","text":"And to put it another way, the only way you could really test (with non-trivial power) for difference in means based on a 1 vs 19 comparison is by making strong assumptions such as  the ones I mentioned above (treated has same variance as controls, the distribution of treated measurement, is known parametrically, say Gaussian). The way you define the z-score does not remove the need for such assumptions to get e.g. a p-value. In fact if I understand how you compute z-scores and then p-values; your p-value computation basically assumes both Gaussianity , same variance and that 19 = ∞. So I'd definitely recommend looking at the z-scores only in an exploratory way (and not interpreting futher), plus looking at all data (without summarizing to z-scores first) like Nils suggested.","user":"UKLKS1WC8","ts":"1616793976.050800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jPJc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And to put it another way, the only way you could really test (with non-trivial power) for difference in means based on a 1 vs 19 comparison is by making strong assumptions such as  the ones I mentioned above (treated has same variance as controls, the distribution of treated measurement, is known parametrically, say Gaussian). The way you define the z-score does not remove the need for such assumptions to get e.g. a p-value. In fact if I understand how you compute z-scores and then p-values; your p-value computation basically assumes both Gaussianity , same variance and that 19 = ∞. So I'd definitely recommend looking at the z-scores only in an exploratory way (and not interpreting futher), plus looking at all data (without summarizing to z-scores first) like Nils suggested."}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"DE038A4F-B02D-4C4D-A4D4-39ED50D0090A","type":"message","text":"Thanks all for the thoughts! I will re-consider my approach and discuss with my team too.\n\nBut could you answer question number 1? Can that be called one-sample z-test? ","user":"UUT4VGTE2","ts":"1616847815.062900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gKk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks all for the thoughts! I will re-consider my approach and discuss with my team too.\n"},{"type":"text","text":"\nBut could you answer question number 1? Can that be called one-sample z-test? "}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"DB5E6CF9-3DFE-4E7C-AD1B-C019C8F5813D","type":"message","text":"<@UKLKS1WC8> on that assuming gaussianity, I believe as I calculate the modified z-score (non-parametric) I don’t assume any gaussianity? Even if it is, at least, I don’t assume gaussianity in the patient’s (n=1) distribution and only looking at where it stands (considering both central tendency and deviation) in the healthy distribution, idk if this can even be called a ‘hypothesis testing’ (that’s why I’m asking question 1)? Hmm","user":"UUT4VGTE2","ts":"1616848805.068700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"whEa5","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UKLKS1WC8"},{"type":"text","text":" on that assuming gaussianity, I believe as I calculate the modified z-score (non-parametric) I don’t assume any gaussianity? Even if it is, at least, I don’t assume gaussianity in the patient’s (n=1) distribution and only looking at where it stands (considering both central tendency and deviation) in the healthy distribution, idk if this can even be called a ‘hypothesis testing’ (that’s why I’m asking question 1)? Hmm"}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"1FBF1676-927A-4339-99D9-8CC6E7C5DDE6","type":"message","text":"So in that descriptive stats perspective, that means doing this is okay *but* interpret this as difference, not as statistically significant? That means, don’t convert this to p-value (and further multiple comparison correction), right?","user":"UUT4VGTE2","ts":"1616849137.070900","team":"T68168MUP","edited":{"user":"UUT4VGTE2","ts":"1616849303.000000"},"blocks":[{"type":"rich_text","block_id":"+4YHM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So in that descriptive stats perspective, that means doing this is okay "},{"type":"text","text":"but","style":{"bold":true}},{"type":"text","text":" interpret this as difference, not as statistically significant? That means, don’t convert this to p-value (and further multiple comparison correction), right?"}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"3CEF16A0-5CAA-437F-8B5A-ED31FDEF8168","type":"message","text":"<@U7JQGPGCQ> as far as I remember, few of the metabolites having some correlation with Age, I could be wrong though. I will need to check with our research radiographers and if we’ve done age match, if it’s true.","user":"UUT4VGTE2","ts":"1616854777.073900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lnBqg","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U7JQGPGCQ"},{"type":"text","text":" as far as I remember, few of the metabolites having some correlation with Age, I could be wrong though. I will need to check with our research radiographers and if we’ve done age match, if it’s true."}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"1a2bdd79-c888-4563-8045-d0e477e63d17","type":"message","text":"I meant rather that there is within subject correlation of metabolites, so that if a subject scores high relative to others on one metabolite, it would likely also score highly on others. Then it doesn't make sense to think of them as 69 independent draws","user":"U7JQGPGCQ","ts":"1616855957.074100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"C8tl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I meant rather that there is within subject correlation of metabolites, so that if a subject scores high relative to others on one metabolite, it would likely also score highly on others. Then it doesn't make sense to think of them as 69 independent draws"}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"FF669F44-DA71-4896-845F-E9C4A2D73FB2","type":"message","text":"<@U7JQGPGCQ> I see! In different data I worked on, there are few variables are correlated, but I am not sure about causation. Metabolite A and B could tell different clinical impact (A could be related to dementia, while B related to anxiety, for instance), although correlated, so I think for explanatory analysis it’s better to look into all those. Otherwise, we could lose the info that it has some impact on both anxiety and dementia in that example.","user":"UUT4VGTE2","ts":"1616857671.079300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vt4I","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U7JQGPGCQ"},{"type":"text","text":" I see! In different data I worked on, there are few variables are correlated, but I am not sure about causation. Metabolite A and B could tell different clinical impact (A could be related to dementia, while B related to anxiety, for instance), although correlated, so I think for explanatory analysis it’s better to look into all those. Otherwise, we could lose the info that it has some impact on both anxiety and dementia in that example."}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"},{"client_msg_id":"60fac9d6-6c00-4af2-bfd4-759f2a9eb5c0","type":"message","text":"<@UUT4VGTE2> Since you call it a test,  I thought you calculate a p-value from the z-score.  To do so, you need to make the assumptions I mentioned above. If you are just looking at the z-score in an exploratory way, not interpreting what its distribution should be or thinking of it as a hypothesis test, then of course it is ok to do so.","user":"UKLKS1WC8","ts":"1616900463.080800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nh9+h","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UUT4VGTE2"},{"type":"text","text":" Since you call it a test,  I thought you calculate a p-value from the z-score.  To do so, you need to make the assumptions I mentioned above. If you are just looking at the z-score in an exploratory way, not interpreting what its distribution should be or thinking of it as a hypothesis test, then of course it is ok to do so."}]}]}],"thread_ts":"1616730322.036500","parent_user_id":"UUT4VGTE2"}]