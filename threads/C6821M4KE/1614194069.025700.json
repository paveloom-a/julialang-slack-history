[{"client_msg_id":"697d26a0-b7ed-4df6-91e6-41a9529dcb9b","type":"message","text":"I'm curious... is there any reason why functions like `var` and `std` doesn't return result as `Float64` when the input data is `Float32`?\n```julia&gt; var(rand(Float32, 10))\n0.07476148f0```","user":"U8T0YV7QC","ts":"1614194069.025700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UlS3w","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm curious... is there any reason why functions like "},{"type":"text","text":"var","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"std","style":{"code":true}},{"type":"text","text":" doesn't return result as "},{"type":"text","text":"Float64","style":{"code":true}},{"type":"text","text":" when the input data is "},{"type":"text","text":"Float32","style":{"code":true}},{"type":"text","text":"?\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> var(rand(Float32, 10))\n0.07476148f0"}]}]}],"thread_ts":"1614194069.025700","reply_count":12,"reply_users_count":3,"latest_reply":"1614197512.030300","reply_users":["UH8A351DJ","U8T0YV7QC","U6C937ENB"],"subscribed":false},{"client_msg_id":"e8d8111b-8eb8-449a-8259-2a845e9b45d8","type":"message","text":"don't want to accidentally promote users' type, especially if they are working on GPU later for example","user":"UH8A351DJ","ts":"1614194142.025800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"k5rR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"don't want to accidentally promote users' type, especially if they are working on GPU later for example"}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"12e8e89d-5b75-4e95-ba4a-8401cc637c86","type":"message","text":"so if I want a more precise result, would I first convert everything to `Float64` before calling `var`?","user":"U8T0YV7QC","ts":"1614194223.026000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zmg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so if I want a more precise result, would I first convert everything to "},{"type":"text","text":"Float64","style":{"code":true}},{"type":"text","text":" before calling "},{"type":"text","text":"var","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"a22d27a4-a4c6-45a7-8554-edf4d0e2e102","type":"message","text":"you can't get (much) more precise result right? because your data was in Float32.","user":"UH8A351DJ","ts":"1614194250.026200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=vPnm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"you can't get (much) more precise result right? because your data was in Float32."}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"a964b8e5-8393-4c65-87bc-66573ce7147e","type":"message","text":"Well, since there will be rounding errors so keeping the intermediate state as Float32 during the calculation would lead to a larger error. Right?","user":"U8T0YV7QC","ts":"1614194296.026400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"X+2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Well, since there will be rounding errors so keeping the intermediate state as Float32 during the calculation would lead to a larger error. Right?"}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"d508cfec-bb4f-4225-a7ce-850d06f86068","type":"message","text":"technically yes, but if your numerical accuracy is bounded by float32 vs. float64 your \"data\" should be in float64 all the time anyways.","user":"UH8A351DJ","ts":"1614194359.026600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zec","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"technically yes, but if your numerical accuracy is bounded by float32 vs. float64 your \"data\" should be in float64 all the time anyways."}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"64e4d13e-f69b-452f-bc54-0ac2ed15a621","type":"message","text":"and yes, if that's the concern, you should make them float64 first.\n\nBut if `var` defaults to that behavior, it's not elegant for user to \"opt-out\" and it's also not clear if we should prompt to BigFloat automatically for accuracy.","user":"UH8A351DJ","ts":"1614194449.026800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"krBN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and yes, if that's the concern, you should make them float64 first.\n\nBut if "},{"type":"text","text":"var","style":{"code":true}},{"type":"text","text":" defaults to that behavior, it's not elegant for user to \"opt-out\" and it's also not clear if we should prompt to BigFloat automatically for accuracy."}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"d08cd110-241c-4f92-88dc-ca213d843002","type":"message","text":"An analogy would be `var(1:10)` where input is just int's. That promotes to Float64.","user":"U8T0YV7QC","ts":"1614194470.027000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nJd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"An analogy would be "},{"type":"text","text":"var(1:10)","style":{"code":true}},{"type":"text","text":" where input is just int's. That promotes to Float64."}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"4635c579-6ea6-414b-9d23-cebfdeaa3daf","type":"message","text":"that is a different story. In this case, we return Float64 for the same reason `2/3` in julia returns a Float64","user":"UH8A351DJ","ts":"1614194535.027200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"b01","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that is a different story. In this case, we return Float64 for the same reason "},{"type":"text","text":"2/3","style":{"code":true}},{"type":"text","text":" in julia returns a Float64"}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"9e027b46-4452-4c25-8ae1-33eaaa23830b","type":"message","text":"that's true","user":"U8T0YV7QC","ts":"1614194643.027400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yIvE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that's true"}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"27c7a3a9-f047-4ef6-918e-773ce22b08ac","type":"message","text":"if we're finding analogy I guess, `mean(Vector{Float32})` returns Float32 for the same reason `sum(Vector{Float32})` returns Float32","user":"UH8A351DJ","ts":"1614194698.027600","team":"T68168MUP","edited":{"user":"UH8A351DJ","ts":"1614194704.000000"},"blocks":[{"type":"rich_text","block_id":"gKQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"if we're finding analogy I guess, "},{"type":"text","text":"mean(Vector{Float32})","style":{"code":true}},{"type":"text","text":" returns Float32 for the same reason "},{"type":"text","text":"sum(Vector{Float32})","style":{"code":true}},{"type":"text","text":" returns Float32"}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"cdc68372-fa22-4dfb-839a-d9c0069ff407","type":"message","text":":+1 thanks","user":"U8T0YV7QC","ts":"1614194748.027900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5x7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":":+1 thanks"}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"},{"client_msg_id":"5937A016-1709-4619-A17B-374563C2A035","type":"message","text":"Just nitpicking: if your floating point errors are  unbiased and the numbers are close then mean _can_ give higher precision,  that’s almost the point of computing a mean ","user":"U6C937ENB","ts":"1614197512.030300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"W65wZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Just nitpicking: if your floating point errors are  unbiased and the numbers are close then mean "},{"type":"text","text":"can","style":{"italic":true}},{"type":"text","text":" give higher precision,  that’s almost the point of computing a mean "}]}]}],"thread_ts":"1614194069.025700","parent_user_id":"U8T0YV7QC"}]