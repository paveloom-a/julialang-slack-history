[{"client_msg_id":"67dae504-e3f1-4356-a4f8-57c42ec30dc9","type":"message","text":"I've written some code that runs a bunch of linear models using `GLM.jl` and compares them. My code is painfully slow the first time it runs on new data, then pleasantly fast. It's like compilation cost, except that just changing the input data (not input types) to my function creates a slow down. Once the function has run on the data, it's fast. Does GLM have to compile something for every new formula it sees?","user":"U73ACR3TQ","ts":"1617391531.128900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vpH9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I've written some code that runs a bunch of linear models using "},{"type":"text","text":"GLM.jl","style":{"code":true}},{"type":"text","text":" and compares them. My code is painfully slow the first time it runs on new data, then pleasantly fast. It's like compilation cost, except that just changing the input data (not input types) to my function creates a slow down. Once the function has run on the data, it's fast. Does GLM have to compile something for every new formula it sees?"}]}]}],"thread_ts":"1617391531.128900","reply_count":7,"reply_users_count":3,"latest_reply":"1617401345.133100","reply_users":["UBF9YRB6H","U66M57AN4","U73ACR3TQ"],"is_locked":false,"subscribed":false},{"client_msg_id":"d4006d36-f744-4abf-9049-fb671f002d65","type":"message","text":"I think the answer is yes. Like a named tuple, a new formula will have different names, which are in the type signature, and thus there is new compilation that happens.","user":"UBF9YRB6H","ts":"1617391940.131700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"h3WR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think the answer is yes. Like a named tuple, a new formula will have different names, which are in the type signature, and thus there is new compilation that happens."}]}]}],"thread_ts":"1617391531.128900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"e3a51135-7fcf-4ddb-8fce-88dd359ab0a7","type":"message","text":"the names themselves aren't in the type signature but the types are...in THEORY as long as the formulae all have the same structure it shoudl work fast","user":"U66M57AN4","ts":"1617398292.132100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KLDF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the names themselves aren't in the type signature but the types are...in THEORY as long as the formulae all have the same structure it shoudl work fast"}]}]}],"thread_ts":"1617391531.128900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"feae042b-b30f-4133-a514-1c2a10282f80","type":"message","text":"I'd be curious to see the profiler output though, for the first/second runs","user":"U66M57AN4","ts":"1617398350.132300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9cLX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'd be curious to see the profiler output though, for the first/second runs"}]}]}],"thread_ts":"1617391531.128900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"6fdf10a4-65ed-4ab8-ad88-6e40b557a285","type":"message","text":"feel free to open an issue (or comment on <https://github.com/JuliaStats/StatsModels.jl/issues/201> with an example)","user":"U66M57AN4","ts":"1617398386.132500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Y7K","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"feel free to open an issue (or comment on "},{"type":"link","url":"https://github.com/JuliaStats/StatsModels.jl/issues/201"},{"type":"text","text":" with an example)"}]}]}],"thread_ts":"1617391531.128900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"260498e7-8371-45c2-8dc2-8ccb404be39f","type":"message","text":"BTW I don't think it's necessary to do `train_df` there, statsmodels should only look at the columns mentioned in the formula","user":"U66M57AN4","ts":"1617398435.132700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SCj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"BTW I don't think it's necessary to do "},{"type":"text","text":"train_df","style":{"code":true}},{"type":"text","text":" there, statsmodels should only look at the columns mentioned in the formula"}]}]}],"thread_ts":"1617391531.128900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"93113b83-61de-42bf-99a7-02d65c302d3f","type":"message","text":"In practice I'm also subsetting rows based on the data in the relevant columns, so `train_df` isn't _that_ memory inefficient :slightly_smiling_face:","user":"U73ACR3TQ","ts":"1617401335.132900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BOEJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In practice I'm also subsetting rows based on the data in the relevant columns, so "},{"type":"text","text":"train_df","style":{"code":true}},{"type":"text","text":" isn't "},{"type":"text","text":"that","style":{"italic":true}},{"type":"text","text":" memory inefficient "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1617391531.128900","parent_user_id":"U73ACR3TQ"},{"client_msg_id":"044584b6-2b4a-4ede-af3d-22f9bb0faa87","type":"message","text":"I will try to produce a smaller example with no proprietary data this weekend!","user":"U73ACR3TQ","ts":"1617401345.133100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2AHCu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I will try to produce a smaller example with no proprietary data this weekend!"}]}]}],"thread_ts":"1617391531.128900","parent_user_id":"U73ACR3TQ"}]