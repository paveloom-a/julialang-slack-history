[{"client_msg_id":"4c9be90d-eaac-4c14-8f77-e92b275596d4","type":"message","text":"The original question above has mutated into a more basic one. I repost as a new thread in case anybody has any suggestion. How can one build Julia + OpenBLAS from source these days? The make incantation `make USE_BINARYBUILDER_OBJCONV=0 USE_BINARYBUILDER_OPENBLAS=0` on Julia master fails with a `make[5]: *** [lapacke_cggsvp_work.o] Error 1` on macos. Is there any further `make` options required? Can one learn how to build external dependencies by examining the BinaryBuilder and associated repos somehow? I tried, but I could not make progress...","user":"U6G4M02N4","ts":"1611750602.012900","team":"T68168MUP","edited":{"user":"U6G4M02N4","ts":"1611750665.000000"},"blocks":[{"type":"rich_text","block_id":"tx4no","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The original question above has mutated into a more basic one. I repost as a new thread in case anybody has any suggestion. How can one build Julia + OpenBLAS from source these days? The make incantation "},{"type":"text","text":"make USE_BINARYBUILDER_OBJCONV=0 USE_BINARYBUILDER_OPENBLAS=0","style":{"code":true}},{"type":"text","text":" on Julia master fails with a "},{"type":"text","text":"make[5]: *** [lapacke_cggsvp_work.o] Error 1","style":{"code":true}},{"type":"text","text":" on macos. Is there any further "},{"type":"text","text":"make","style":{"code":true}},{"type":"text","text":" options required? Can one learn how to build external dependencies by examining the BinaryBuilder and associated repos somehow? I tried, but I could not make progress..."}]}]}],"thread_ts":"1611750602.012900","reply_count":13,"reply_users_count":2,"latest_reply":"1611854938.016000","reply_users":["U66GD0880","U6G4M02N4"],"subscribed":false},{"client_msg_id":"aee9ddf2-7edb-4654-b63c-593c12f0f0f8","type":"message","text":"Did this ever get answered for you?","user":"U66GD0880","ts":"1611783359.013400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gXY/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Did this ever get answered for you?"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"fa337e55-302a-4041-ab58-27d394695a38","type":"message","text":"That `make` invocation should work, so if it doesn’t, more information about the error would be useful.","user":"U66GD0880","ts":"1611783373.013600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"b57j4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That "},{"type":"text","text":"make","style":{"code":true}},{"type":"text","text":" invocation should work, so if it doesn’t, more information about the error would be useful."}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"a9771e65-0039-499d-bd75-0b2a6516d779","type":"message","text":"Since you’re failing on a `LAPACK` file, my guess is that there’s something wrong with your `gfortran` compiler","user":"U66GD0880","ts":"1611783393.013800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZLVK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Since you’re failing on a "},{"type":"text","text":"LAPACK","style":{"code":true}},{"type":"text","text":" file, my guess is that there’s something wrong with your "},{"type":"text","text":"gfortran","style":{"code":true}},{"type":"text","text":" compiler"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"67c12225-f438-4c70-817c-9fd6ca8c375c","type":"message","text":"Nope, I tried various things, including a lengthy `USE_BINARYBUILDER=0` but got the same error","user":"U6G4M02N4","ts":"1611817007.014000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TDX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Nope, I tried various things, including a lengthy "},{"type":"text","text":"USE_BINARYBUILDER=0","style":{"code":true}},{"type":"text","text":" but got the same error"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"a0e3d930-dfa6-45f7-817f-30d3ce4810d1","type":"message","text":"This is the last bit:\n```lapacke_cggsvp_work.c:139:9: error: implicit declaration of function 'cggsvp_' is invalid in C99 [-Werror,-Wimplicit-function-declaration]\n        LAPACK_cggsvp( &amp;jobu, &amp;jobv, &amp;jobq, &amp;m, &amp;p, &amp;n, a_t, &amp;lda_t, b_t,\n        ^\n../include/lapack.h:3771:23: note: expanded from macro 'LAPACK_cggsvp'\n#define LAPACK_cggsvp LAPACK_GLOBAL(cggsvp,CGGSVP)\n                      ^\n../include/lapacke_mangling.h:12:39: note: expanded from macro 'LAPACK_GLOBAL'\n#define LAPACK_GLOBAL(lcname,UCNAME)  lcname##_\n                                      ^\n&lt;scratch space&gt;:242:1: note: expanded from here\ncggsvp_\n^\n2 errors generated.\nmake[5]: *** [lapacke_cggsvp_work.o] Error 1\nmake[4]: *** [lapacke] Error 2\nmake[3]: *** [lapackelib] Error 2\nmake[2]: *** [netlib] Error 2\n*** Clean the OpenBLAS build with 'make -C deps clean-openblas'. Rebuild with 'make OPENBLAS_USE_THREAD=0' if OpenBLAS had trouble linking libpthread.so, and with 'make OPENBLAS_TARGET_ARCH=NEHALEM' if there were errors building SandyBridge support. Both these options can also be used simultaneously. ***\nmake[1]: *** [scratch/openblas-63b03efc2af332c88b86d4fd8079d00f4b439adf/build-compiled] Error 1\nmake: *** [julia-deps] Error 2```","user":"U6G4M02N4","ts":"1611817056.014200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hX5g","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"This is the last bit:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"lapacke_cggsvp_work.c:139:9: error: implicit declaration of function 'cggsvp_' is invalid in C99 [-Werror,-Wimplicit-function-declaration]\n        LAPACK_cggsvp( &jobu, &jobv, &jobq, &m, &p, &n, a_t, &lda_t, b_t,\n        ^\n../include/lapack.h:3771:23: note: expanded from macro 'LAPACK_cggsvp'\n#define LAPACK_cggsvp LAPACK_GLOBAL(cggsvp,CGGSVP)\n                      ^\n../include/lapacke_mangling.h:12:39: note: expanded from macro 'LAPACK_GLOBAL'\n#define LAPACK_GLOBAL(lcname,UCNAME)  lcname##_\n                                      ^\n<scratch space>:242:1: note: expanded from here\ncggsvp_\n^\n2 errors generated.\nmake[5]: *** [lapacke_cggsvp_work.o] Error 1\nmake[4]: *** [lapacke] Error 2\nmake[3]: *** [lapackelib] Error 2\nmake[2]: *** [netlib] Error 2\n*** Clean the OpenBLAS build with 'make -C deps clean-openblas'. Rebuild with 'make OPENBLAS_USE_THREAD=0' if OpenBLAS had trouble linking libpthread.so, and with 'make OPENBLAS_TARGET_ARCH=NEHALEM' if there were errors building SandyBridge support. Both these options can also be used simultaneously. ***\nmake[1]: *** [scratch/openblas-63b03efc2af332c88b86d4fd8079d00f4b439adf/build-compiled] Error 1\nmake: *** [julia-deps] Error 2"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"8a8d9494-a128-456d-9e2d-b4daeaf3ef31","type":"message","text":"I didn't touch the clone, that's just with Julia master","user":"U6G4M02N4","ts":"1611817109.014400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2nHV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I didn't touch the clone, that's just with Julia master"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"e30d224c-f782-45bf-a278-cf815d99e773","type":"message","text":"I have `GNU Fortran (Homebrew GCC 10.2.0_2) 10.2.0`","user":"U6G4M02N4","ts":"1611817174.014600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XgE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have "},{"type":"text","text":"GNU Fortran (Homebrew GCC 10.2.0_2) 10.2.0","style":{"code":true}}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"992b1c78-26be-4acc-8595-929f37d97331","type":"message","text":"The failing command emitted by make is something like\n```/Applications/Xcode.app/Contents/Developer/usr/bin/make -C scratch/openblas-63b03efc2af332c88b86d4fd8079d00f4b439adf/ CC=clang -mmacosx-version-min=10.9 -m64 FC=gfortran -mmacosx-version-min=10.9 -m64 LD=ld RANLIB=ranlib TARGET= BINARY=64 USE_THREAD=1 GEMM_MULTITHREADING_THRESHOLD=50 NUM_THREADS=16 NO_AFFINITY=1 DYNAMIC_ARCH=1 INTERFACE64=1 SYMBOLSUFFIX=64_ LIBPREFIX=libopenblas64_ OBJCONV=/Users/pablo/build/julialapack/deps/scratch/objconv/objconv CFLAGS= -O2 FFLAGS= -O2 -fPIC  -fdefault-integer-8 LDFLAGS= -Wl,-rpath,'@loader_path/' MAKE_NB_JOBS=0```","user":"U6G4M02N4","ts":"1611817255.014800","team":"T68168MUP","edited":{"user":"U6G4M02N4","ts":"1611826603.000000"},"blocks":[{"type":"rich_text","block_id":"3ffd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The failing command emitted by make is something like\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"/Applications/Xcode.app/Contents/Developer/usr/bin/make -C scratch/openblas-63b03efc2af332c88b86d4fd8079d00f4b439adf/ CC=clang -mmacosx-version-min=10.9 -m64 FC=gfortran -mmacosx-version-min=10.9 -m64 LD=ld RANLIB=ranlib TARGET= BINARY=64 USE_THREAD=1 GEMM_MULTITHREADING_THRESHOLD=50 NUM_THREADS=16 NO_AFFINITY=1 DYNAMIC_ARCH=1 INTERFACE64=1 SYMBOLSUFFIX=64_ LIBPREFIX=libopenblas64_ OBJCONV=/Users/pablo/build/julialapack/deps/scratch/objconv/objconv CFLAGS= -O2 FFLAGS= -O2 -fPIC  -fdefault-integer-8 LDFLAGS= -Wl,-rpath,'@loader_path/' MAKE_NB_JOBS=0"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"5a66cef8-a82f-464c-80c3-40ee73f22e07","type":"message","text":"macos 11.1","user":"U6G4M02N4","ts":"1611817500.015000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IsXB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"macos 11.1"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"206e15df-9521-4ecd-b1b7-b999764a0bec","type":"message","text":"okay this is a known issue with OpenBLAS 0.3.10","user":"U66GD0880","ts":"1611853556.015300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4SDT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"okay this is a known issue with OpenBLAS 0.3.10"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"34c73b53-bc58-418e-91d2-dfcf772d9330","type":"message","text":"<https://github.com/spack/spack/pull/19057>","user":"U66GD0880","ts":"1611853556.015500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XBSZn","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/spack/spack/pull/19057"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"},{"client_msg_id":"e959b97b-59a6-412a-b4f2-8a56bb0d2e7e","type":"message","text":"And Curtis already found this and is working on getting us updated to OpenBLAS 0.3.13, which does not have this issue: <https://github.com/JuliaLang/julia/issues/39201>","user":"U66GD0880","ts":"1611853604.015700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7=v","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And Curtis already found this and is working on getting us updated to OpenBLAS 0.3.13, which does not have this issue: "},{"type":"link","url":"https://github.com/JuliaLang/julia/issues/39201"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4","reactions":[{"name":"pray","users":["U6G4M02N4"],"count":1}]},{"client_msg_id":"7b14dcba-e737-4448-9d2c-f3c5676faad4","type":"message","text":"Thanks!","user":"U6G4M02N4","ts":"1611854938.016000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IS2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks!"}]}]}],"thread_ts":"1611750602.012900","parent_user_id":"U6G4M02N4"}]