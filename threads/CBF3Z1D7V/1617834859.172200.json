[{"client_msg_id":"C6163431-4EA8-4DE0-817A-DEF21F8B1FBE","type":"message","text":"They shouldn’t be, but can be if a dependency has been re-precompiled","user":"U8MPCDJAY","ts":"1617834859.172200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pu4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"They shouldn’t be, but can be if a dependency has been re-precompiled"}]}]}],"thread_ts":"1617834859.172200","reply_count":19,"reply_users_count":3,"latest_reply":"1617836380.178000","reply_users":["U01537M2E9W","U8MPCDJAY","U66GD0880"],"is_locked":false,"subscribed":false},{"client_msg_id":"bcba7ff1-f875-45af-b04f-6dcdc81275e2","type":"message","text":"It makes sense that a cache invalidation of a dependency would propagate to the consuming packages. What could cause a cache invalidation?","user":"U01537M2E9W","ts":"1617834912.172600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"rz0L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It makes sense that a cache invalidation of a dependency would propagate to the consuming packages. What could cause a cache invalidation?"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"152DBF66-8270-42DD-8073-8463E8590F53","type":"message","text":"I’m actually not that much of an expert on that","user":"U8MPCDJAY","ts":"1617834962.173200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6PD5V","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I’m actually not that much of an expert on that"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"579c1ade-6fcd-498f-af75-cf3b6ee27f1d","type":"message","text":"If your dependency chain is `A -&gt; B -&gt; C -&gt; D` where `A -&gt; B` means “`A` loads `B`“, then doing _anything_ to `C` that requires it to be recompiled (e.g. touching a file, upgrading a version, changing a preference) will cause `A`, `B` and `C` all to be recompiled.","user":"U66GD0880","ts":"1617835010.173400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"toYV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If your dependency chain is "},{"type":"text","text":"A -> B -> C -> D","style":{"code":true}},{"type":"text","text":" where "},{"type":"text","text":"A -> B","style":{"code":true}},{"type":"text","text":" means “"},{"type":"text","text":"A","style":{"code":true}},{"type":"text","text":" loads "},{"type":"text","text":"B","style":{"code":true}},{"type":"text","text":"“, then doing "},{"type":"text","text":"anything","style":{"italic":true}},{"type":"text","text":" to "},{"type":"text","text":"C","style":{"code":true}},{"type":"text","text":" that requires it to be recompiled (e.g. touching a file, upgrading a version, changing a preference) will cause "},{"type":"text","text":"A","style":{"code":true}},{"type":"text","text":", "},{"type":"text","text":"B","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"C","style":{"code":true}},{"type":"text","text":" all to be recompiled."}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"d257d8f5-3745-4f8f-97c4-d256efcb3097","type":"message","text":"We keep a small LRU of `.ji` files for each package, but if you have a bunch of different versions of, say, `CSV.jl` being used from a bunch of different environments, that cache can be exhausted.","user":"U66GD0880","ts":"1617835079.173600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"c57E","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"We keep a small LRU of "},{"type":"text","text":".ji","style":{"code":true}},{"type":"text","text":" files for each package, but if you have a bunch of different versions of, say, "},{"type":"text","text":"CSV.jl","style":{"code":true}},{"type":"text","text":" being used from a bunch of different environments, that cache can be exhausted."}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"edfd3d86-5fa6-4a2f-987e-a5323763a240","type":"message","text":"meaning that you may recompile `CSV.jl` a lot since the LRU cache holds only 5 versions right now, so if you regularly work with more than 5 “versions” of the same package, you may run out of slots in that LRU and start evicting `.ji` files that you otherwise would have used.","user":"U66GD0880","ts":"1617835143.174000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0aXRU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"meaning that you may recompile "},{"type":"text","text":"CSV.jl","style":{"code":true}},{"type":"text","text":" a lot since the LRU cache holds only 5 versions right now, so if you regularly work with more than 5 “versions” of the same package, you may run out of slots in that LRU and start evicting "},{"type":"text","text":".ji","style":{"code":true}},{"type":"text","text":" files that you otherwise would have used."}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"2fd1432b-c9e8-4cb7-8837-1e0ed560d33e","type":"message","text":"What version of Julia are you using?","user":"U66GD0880","ts":"1617835166.174600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lkHR5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What version of Julia are you using?"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"e38aa87f-0c3b-4ea4-a1d3-e1b24c769d94","type":"message","text":"ugh slack didn't copy that message... sorry\nI am using 1.6","user":"U01537M2E9W","ts":"1617835177.175000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hQbe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ugh slack didn't copy that message... sorry\nI am using 1.6"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"27f41534-4589-49f0-8c60-22f473fd3ea8","type":"message","text":"Hmm, if you can reproduce that, I think you should open an issue.  Julia should keep the last 5 or so things you precompile for a specific package, so if you’re seeing that behavior, it’s probably a bug","user":"U66GD0880","ts":"1617835215.175200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EV5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmm, if you can reproduce that, I think you should open an issue.  Julia should keep the last 5 or so things you precompile for a specific package, so if you’re seeing that behavior, it’s probably a bug"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"57f611af-61be-42c1-ace6-1ea27c479259","type":"message","text":"Okay, I will try to open an issue. Also, is there a way I can increase the LRU size?","user":"U01537M2E9W","ts":"1617835234.175400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Gahs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Okay, I will try to open an issue. Also, is there a way I can increase the LRU size?"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"aa883188-b23c-4acd-91b7-073849c03367","type":"message","text":"So if you precompile version `1.1`, then install `1.2`, then downgrade to `1.1`, the precompiled version _should_ still be there","user":"U66GD0880","ts":"1617835236.175600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IOA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So if you precompile version "},{"type":"text","text":"1.1","style":{"code":true}},{"type":"text","text":", then install "},{"type":"text","text":"1.2","style":{"code":true}},{"type":"text","text":", then downgrade to "},{"type":"text","text":"1.1","style":{"code":true}},{"type":"text","text":", the precompiled version "},{"type":"text","text":"should","style":{"italic":true}},{"type":"text","text":" still be there"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"25cb2f1e-38e3-4875-b019-dd288f6e17ce","type":"message","text":"looks like it’s bumped up to 10 now","user":"U66GD0880","ts":"1617835338.175800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"02nZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"looks like it’s bumped up to 10 now"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"e43bac44-57a3-40bc-b72b-08a297eac6d8","type":"message","text":"<https://github.com/JuliaLang/julia/blob/76c1d1d262c8cee22ec4aef4b01457dc74264412/base/loading.jl#L1304>","user":"U66GD0880","ts":"1617835339.176000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Usz","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/JuliaLang/julia/blob/76c1d1d262c8cee22ec4aef4b01457dc74264412/base/loading.jl#L1304"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"fa20ac98-6d4c-4694-b1d1-9e77c7627030","type":"message","text":"You should be able to bump it up by setting `Base.MAX_NUM_PRECOMPILE_FILES[] = 100` in your startup.jl file","user":"U66GD0880","ts":"1617835362.176200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NRW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You should be able to bump it up by setting "},{"type":"text","text":"Base.MAX_NUM_PRECOMPILE_FILES[] = 100","style":{"code":true}},{"type":"text","text":" in your startup.jl file"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"4b69fc88-8f8e-4d3d-8e77-047e76737385","type":"message","text":"&gt;  Julia should keep the last 5 or so things you precompile for a specific package, so if you’re seeing that behavior, it’s probably a bug\nDoes it also do this for the home environment? I can't reproduce this in a package, but I can reproduce this in my home env.","user":"U01537M2E9W","ts":"1617835733.176500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"euy3","elements":[{"type":"rich_text_quote","elements":[{"type":"text","text":" Julia should keep the last 5 or so things you precompile for a specific package, so if you’re seeing that behavior, it’s probably a bug"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Does it also do this for the home environment? I can't reproduce this in a package, but I can reproduce this in my home env."}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"f35fec70-8333-4fac-89b3-74dd0b54da60","type":"message","text":"yeah, it shouldn’t matter either way","user":"U66GD0880","ts":"1617835769.176700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Tat","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah, it shouldn’t matter either way"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"type":"message","text":"<@U01537M2E9W> something like this? I can’t reproduce it","files":[{"id":"F01THNSHA5T","created":1617836261,"timestamp":1617836261,"name":"Untitled.txt","title":"Untitled","mimetype":"text/plain","filetype":"text","pretty_type":"Plain Text","user":"U8MPCDJAY","editable":true,"size":3330,"mode":"snippet","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01THNSHA5T/Untitled.txt","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01THNSHA5T/download/Untitled.txt","permalink":"https://julialang.slack.com/files/U8MPCDJAY/F01THNSHA5T/Untitled.txt","permalink_public":"https://slack-files.com/T68168MUP-F01THNSHA5T-68f9d03c3f","edit_link":"https://julialang.slack.com/files/U8MPCDJAY/F01THNSHA5T/Untitled.txt/edit","preview":"(@v1.6) pkg> activate --temp\n  Activating new environment at `/var/folders/_6/1yf6sj0950vcg4t91m9ltb5w0000gn/T/jl_QrBPo8/Project.toml`\n\n(jl_QrBPo8) pkg> add CSV\n    Updating registry at `~/.julia/registries/General`","preview_highlight":"<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text/plain',window.getSelection().toString().replace(/\\u200b/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre>(@v1.6) pkg&gt; activate --temp</pre></div>\n<div><pre>  Activating new environment at `/var/folders/_6/1yf6sj0950vcg4t91m9ltb5w0000gn/T/jl_QrBPo8/Project.toml`</pre></div>\n<div><pre></pre></div>\n<div><pre>(jl_QrBPo8) pkg&gt; add CSV</pre></div>\n<div><pre>    Updating registry at `~/.julia/registries/General`</pre></div>\n</div>\n</div>\n","lines":86,"lines_more":81,"preview_is_truncated":true,"is_starred":false,"has_rich_preview":false}],"upload":true,"blocks":[{"type":"rich_text","block_id":"facy","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U01537M2E9W"},{"type":"text","text":" something like this? I can’t reproduce it"}]}]}],"user":"U8MPCDJAY","display_as_bot":false,"ts":"1617836262.177000","edited":{"user":"U8MPCDJAY","ts":"1617836275.000000"},"client_msg_id":"7e341a51-f2b5-40ab-a0be-d81e481e53f5","thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"994c0a81-64dd-40e0-be31-1f03f1b900be","type":"message","text":"Yeah something like that. Now that I am trying to, I can't reproduce it, either... Maybe it was just the LRU cache being small and getting exhausted from the other packages in my messy home environment","user":"U01537M2E9W","ts":"1617836326.177600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"N3UC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah something like that. Now that I am trying to, I can't reproduce it, either... Maybe it was just the LRU cache being small and getting exhausted from the other packages in my messy home environment"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"fcef92fd-2969-4db9-b2a4-0250e795dffe","type":"message","text":"I'll keep an eye out if it happens again","user":"U01537M2E9W","ts":"1617836336.177800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"i5qt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'll keep an eye out if it happens again"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"6a3f1cba-b4bf-4b95-ad0f-cc173f5f6acc","type":"message","text":"I think the cache is cleared out oldest file first, not oldest version first, if that helps explain it?","user":"U8MPCDJAY","ts":"1617836380.178000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"uoP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think the cache is cleared out oldest file first, not oldest version first, if that helps explain it?"}]}]}],"thread_ts":"1617834859.172200","parent_user_id":"U8MPCDJAY"}]