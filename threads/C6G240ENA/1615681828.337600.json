[{"client_msg_id":"1121912e-c505-47bb-926c-83bf7cb43cf3","type":"message","text":"in general is there any advice for when I’m planning on writing chain rules for my package, should I aim to be as granular as possible (e.g. all helper methods get a chain rule and the main computation method manually propagates the chain rules to form the “main” chain rule) or should I aim to write as few rules as possible (e.g., write all the helper methods to manually keep track of jacobians and only have the one or two chain rules on the “surface”)","user":"UN97XTLCV","ts":"1615681828.337600","team":"T68168MUP","edited":{"user":"UN97XTLCV","ts":"1615682001.000000"},"blocks":[{"type":"rich_text","block_id":"1DU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"in general is there any advice for when I’m planning on writing chain rules for my package, should I aim to be as granular as possible (e.g. all helper methods get a chain rule and the main computation method manually propagates the chain rules to form the “main” chain rule) or should I aim to write as few rules as possible (e.g., write all the helper methods to manually keep track of jacobians and only have the one or two chain rules on the “surface”)"}]}]}],"thread_ts":"1615681828.337600","reply_count":2,"reply_users_count":2,"latest_reply":"1615683578.338200","reply_users":["U6A936746","UN97XTLCV"],"subscribed":false},{"client_msg_id":"153765b5-603b-4814-8ea2-7874c738503a","type":"message","text":"The AD should hook all your rules together.\nRarely should it be needed to manually hook them together.\n\nI would write the rules for the smallest parts that I find I have to in order to make the AD work well.\nHopefully that means writing far fewer rules than \"every helper method\"","user":"U6A936746","ts":"1615682407.337800","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1615682455.000000"},"blocks":[{"type":"rich_text","block_id":"IJUx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The AD should hook all your rules together.\nRarely should it be needed to manually hook them together.\n\nI would write the rules for the smallest parts that I find I have to in order to make the AD work well.\nHopefully that means writing far fewer rules than \"every helper method\""}]}]}],"thread_ts":"1615681828.337600","parent_user_id":"UN97XTLCV"},{"client_msg_id":"75b4d98b-3d54-43b5-a086-836beea09b50","type":"message","text":"hmm, the way I’ve written it I have to write a chain rule “at the top” because I have to deal with a custom struct and the Composite differential for it. I don’t quite know how to describe the situation better than mathematically the package is a single function however the code is written with lots of helpers purely for organizational purposes. Some of the helpers have pretty awkward chain rules because they’re returning a bunch of intermediate values, most of which have 0 effect on the derivative of the primary output.\n\nIt does make a lot of sense to have some granularity though, especially considering the usage of thunks and what not to increase efficiency","user":"UN97XTLCV","ts":"1615683578.338200","team":"T68168MUP","edited":{"user":"UN97XTLCV","ts":"1615683736.000000"},"blocks":[{"type":"rich_text","block_id":"Bct","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"hmm, the way I’ve written it I have to write a chain rule “at the top” because I have to deal with a custom struct and the Composite differential for it. I don’t quite know how to describe the situation better than mathematically the package is a single function however the code is written with lots of helpers purely for organizational purposes. Some of the helpers have pretty awkward chain rules because they’re returning a bunch of intermediate values, most of which have 0 effect on the derivative of the primary output.\n\nIt does make a lot of sense to have some granularity though, especially considering the usage of thunks and what not to increase efficiency"}]}]}],"thread_ts":"1615681828.337600","parent_user_id":"UN97XTLCV"}]