[{"client_msg_id":"663268d4-3a88-48e5-bac7-b0c6881c623c","type":"message","text":"Dear AD-lovers,\nI am *looking for a good reference* explaining the relation between\n• (backward) AD, and \n• solving the adjoint of a given ODE or PDE;\nespecially in the context where one is interested in *computing the gradient of an ODE/PDE-constrained cost functional*. To what extent is it *possible to solve the adjoint equation ‘automatically’?*\n\nAlso, where could one find some introductory *numerical examples*, and fast (Julia) libraries for this?\n\nWould you have any suggestions?\nThank you!","user":"U01HC60USTH","ts":"1611657947.034400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5UcW6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Dear AD-lovers,\nI am "},{"type":"text","text":"looking for a good reference","style":{"bold":true}},{"type":"text","text":" explaining the relation between\n"}]},{"type":"rich_text_list","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(backward) AD, and "}]},{"type":"rich_text_section","elements":[{"type":"text","text":"solving the adjoint of a given ODE or PDE;"}]}],"style":"bullet","indent":0},{"type":"rich_text_section","elements":[{"type":"text","text":"especially in the context where one is interested in "},{"type":"text","text":"computing the gradient of an ODE/PDE-constrained cost functional","style":{"bold":true}},{"type":"text","text":". To what extent is it "},{"type":"text","text":"possible to solve the adjoint equation ‘automatically’?","style":{"bold":true}},{"type":"text","text":"\n\nAlso, where could one find some introductory "},{"type":"text","text":"numerical examples","style":{"bold":true}},{"type":"text","text":", and fast (Julia) libraries for this?\n\nWould you have any suggestions?\nThank you!"}]}]}],"thread_ts":"1611657947.034400","reply_count":17,"reply_users_count":5,"latest_reply":"1611684528.045100","reply_users":["U6A936746","UMDEUKM29","U69BL50BF","U6P4UPP9D","U67G3QRJM"],"subscribed":false},{"client_msg_id":"5d7e4491-7806-445a-9b8f-a8f0416d2ae0","type":"message","text":"<@U69BL50BF> and <@U67G3QRJM>'s notes\n\n\n - MIT 18337 lecture notes 8-10 (by [Christopher Rackauckas](<https://github.com/ChrisRackauckas|https://github.com/ChrisRackauckas>) and [David P. Sanders](<https://github.com/dpsanders|https://github.com/dpsanders>)  : moves fast from basic to advanced, particularly good if you like applicable mathematics\n   - [Automatic Differentiation and Application](<https://mitmath.github.io/18337/lecture8/automatic_differentiation|https://mitmath.github.io/18337/lecture8/automatic_differentiation>): Good introduction\n   - [Forward-Mode AD via High Dimensional Algebras](<https://mitmath.github.io/18337/lecture9/autodiff_dimensions|https://mitmath.github.io/18337/lecture9/autodiff_dimensions>): actually part 2 of the introduction\n   - [Solving Stiff Ordinary Differential Equations](<https://mitmath.github.io/18337/lecture9/stiff_odes|https://mitmath.github.io/18337/lecture9/stiff_odes>): the ODE stuff, most of this is about Sparse AutoDiff, can skip/skim this one\n   - [Basic Parameter Estimation, Reverse-Mode AD, and Inverse Problems](<https://mitmath.github.io/18337/lecture10/estimation_identification|https://mitmath.github.io/18337/lecture10/estimation_identification>): use in optimization, and details connections of other math.","user":"U6A936746","ts":"1611658125.034600","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1611658193.000000"},"blocks":[{"type":"rich_text","block_id":"W=z8j","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U69BL50BF"},{"type":"text","text":" and "},{"type":"user","user_id":"U67G3QRJM"},{"type":"text","text":"'s notes\n\n\n - MIT 18337 lecture notes 8-10 (by [Christopher Rackauckas]("},{"type":"link","url":"https://github.com/ChrisRackauckas","text":"https://github.com/ChrisRackauckas"},{"type":"text","text":") and [David P. Sanders]("},{"type":"link","url":"https://github.com/dpsanders","text":"https://github.com/dpsanders"},{"type":"text","text":")  : moves fast from basic to advanced, particularly good if you like applicable mathematics\n   - [Automatic Differentiation and Application]("},{"type":"link","url":"https://mitmath.github.io/18337/lecture8/automatic_differentiation","text":"https://mitmath.github.io/18337/lecture8/automatic_differentiation"},{"type":"text","text":"): Good introduction\n   - [Forward-Mode AD via High Dimensional Algebras]("},{"type":"link","url":"https://mitmath.github.io/18337/lecture9/autodiff_dimensions","text":"https://mitmath.github.io/18337/lecture9/autodiff_dimensions"},{"type":"text","text":"): actually part 2 of the introduction\n   - [Solving Stiff Ordinary Differential Equations]("},{"type":"link","url":"https://mitmath.github.io/18337/lecture9/stiff_odes","text":"https://mitmath.github.io/18337/lecture9/stiff_odes"},{"type":"text","text":"): the ODE stuff, most of this is about Sparse AutoDiff, can skip/skim this one\n   - [Basic Parameter Estimation, Reverse-Mode AD, and Inverse Problems]("},{"type":"link","url":"https://mitmath.github.io/18337/lecture10/estimation_identification","text":"https://mitmath.github.io/18337/lecture10/estimation_identification"},{"type":"text","text":"): use in optimization, and details connections of other math."}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH","reactions":[{"name":"heart","users":["U0138UTB7A4"],"count":1}]},{"client_msg_id":"214e2ab0-8084-4785-8900-bb2ba6857240","type":"message","text":"I also have notes at <http://antoine.levitt.fr/adjoint.pdf|http://antoine.levitt.fr/adjoint.pdf> written from the perspective of a PDE person if that helps","user":"UMDEUKM29","ts":"1611666699.036700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0CjNn","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I also have notes at "},{"type":"link","url":"http://antoine.levitt.fr/adjoint.pdf","text":"http://antoine.levitt.fr/adjoint.pdf"},{"type":"text","text":" written from the perspective of a PDE person if that helps"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"1bdd6746-129c-44ec-af53-d10d974d32d1","type":"message","text":"I also like stevengj's notes","user":"UMDEUKM29","ts":"1611666757.036900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cQLQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I also like stevengj's notes"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"cb0f4bee-53d7-4eee-9051-4076ce3e725b","type":"message","text":"For Julia examples see:\n\n<https://diffeqflux.sciml.ai/dev/>\n<https://neuralpde.sciml.ai/dev/>","user":"U69BL50BF","ts":"1611668595.037200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+ER4Z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For Julia examples see:\n\n"},{"type":"link","url":"https://diffeqflux.sciml.ai/dev/"},{"type":"text","text":"\n"},{"type":"link","url":"https://neuralpde.sciml.ai/dev/"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"7122aaf8-d726-4e8c-bc1f-2de75f820fea","type":"message","text":"<https://www.mcs.anl.gov/~hongzh/publication/zhang-2014/SISC_FATODE_final.pdf> describes discrete adjoints and how they are equivalent to AD on the solver.","user":"U69BL50BF","ts":"1611668664.037400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"W4Ea","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://www.mcs.anl.gov/~hongzh/publication/zhang-2014/SISC_FATODE_final.pdf"},{"type":"text","text":" describes discrete adjoints and how they are equivalent to AD on the solver."}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"6b2ecb48-f26b-42d8-86f1-d38c4e12bb3b","type":"message","text":"And the numerical properties of the solution.","user":"U69BL50BF","ts":"1611668671.037600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CZo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And the numerical properties of the solution."}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"207cea59-f9c9-4bc1-833f-d21f463b0568","type":"message","text":"<https://diffeqflux.sciml.ai/dev/examples/pde_constrained/> is PDE-constrained optimization.","user":"U69BL50BF","ts":"1611668705.037800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yLe","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://diffeqflux.sciml.ai/dev/examples/pde_constrained/"},{"type":"text","text":" is PDE-constrained optimization."}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"dffdd825-6976-436e-94c4-8246f6bae8c5","type":"message","text":"I think a good reference for just pointing out the analogy would be A mathematical view of automatic differentiation by Griewank 2003","user":"U6P4UPP9D","ts":"1611678986.043000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nw4qd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think a good reference for just pointing out the analogy would be A mathematical view of automatic differentiation by Griewank 2003"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"type":"message","subtype":"thread_broadcast","text":"I have been reading about this a lot lately. It is quite an interesting interwined story, it goes something roughly like this AFAICT.\n\nThe first numerical studies of cost functional ODEs actually proposed for the first time what we call backpropagation (look at The Numerical Solution of Variational Problems, Dreyfus 1962).\n\nYann LeCun derives backpropagation as a consequence of variational calculus and constraints between layers of a NN (A theoretical framework for back-propagation, LeCun 1988) and notes that it is equivalent to what was called multistage systems by the founders of applied control (Applied Optimal Control, Bryson &amp; Ho 1969).\n\nThen AD comes as a modern and general implementation of the extended ideas by Werbos 1974 but in some cases analogous to the discretization of such optimal control problems, as Griewank points out in his book and the article above.","user":"U6P4UPP9D","ts":"1611679103.043200","thread_ts":"1611657947.034400","root":{"client_msg_id":"663268d4-3a88-48e5-bac7-b0c6881c623c","type":"message","text":"Dear AD-lovers,\nI am *looking for a good reference* explaining the relation between\n• (backward) AD, and \n• solving the adjoint of a given ODE or PDE;\nespecially in the context where one is interested in *computing the gradient of an ODE/PDE-constrained cost functional*. To what extent is it *possible to solve the adjoint equation ‘automatically’?*\n\nAlso, where could one find some introductory *numerical examples*, and fast (Julia) libraries for this?\n\nWould you have any suggestions?\nThank you!","user":"U01HC60USTH","ts":"1611657947.034400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5UcW6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Dear AD-lovers,\nI am "},{"type":"text","text":"looking for a good reference","style":{"bold":true}},{"type":"text","text":" explaining the relation between\n"}]},{"type":"rich_text_list","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(backward) AD, and "}]},{"type":"rich_text_section","elements":[{"type":"text","text":"solving the adjoint of a given ODE or PDE;"}]}],"style":"bullet","indent":0},{"type":"rich_text_section","elements":[{"type":"text","text":"especially in the context where one is interested in "},{"type":"text","text":"computing the gradient of an ODE/PDE-constrained cost functional","style":{"bold":true}},{"type":"text","text":". To what extent is it "},{"type":"text","text":"possible to solve the adjoint equation ‘automatically’?","style":{"bold":true}},{"type":"text","text":"\n\nAlso, where could one find some introductory "},{"type":"text","text":"numerical examples","style":{"bold":true}},{"type":"text","text":", and fast (Julia) libraries for this?\n\nWould you have any suggestions?\nThank you!"}]}]}],"thread_ts":"1611657947.034400","reply_count":17,"reply_users_count":5,"latest_reply":"1611684528.045100","reply_users":["U6A936746","UMDEUKM29","U69BL50BF","U6P4UPP9D","U67G3QRJM"],"subscribed":false},"blocks":[{"type":"rich_text","block_id":"=M==u","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have been reading about this a lot lately. It is quite an interesting interwined story, it goes something roughly like this AFAICT.\n\nThe first numerical studies of cost functional ODEs actually proposed for the first time what we call backpropagation (look at The Numerical Solution of Variational Problems, Dreyfus 1962).\n\nYann LeCun derives backpropagation as a consequence of variational calculus and constraints between layers of a NN (A theoretical framework for back-propagation, LeCun 1988) and notes that it is equivalent to what was called multistage systems by the founders of applied control (Applied Optimal Control, Bryson & Ho 1969).\n\nThen AD comes as a modern and general implementation of the extended ideas by Werbos 1974 but in some cases analogous to the discretization of such optimal control problems, as Griewank points out in his book and the article above."}]}]}],"client_msg_id":"2e93b924-2371-46d0-9f3b-c015a036c7c9"},{"client_msg_id":"570bee34-472f-4e2b-b349-eefd32db9e47","type":"message","text":"I would be surprised if it was not much older than that","user":"UMDEUKM29","ts":"1611679497.043500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2ms2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I would be surprised if it was not much older than that"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"7dfa2566-50f4-41ed-863b-eb24a766f15f","type":"message","text":"the idea of having an adjoint state that is propagated in reverse time must be pretty old","user":"UMDEUKM29","ts":"1611679527.043700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ySFNq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the idea of having an adjoint state that is propagated in reverse time must be pretty old"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"d667495c-e55f-4b4f-a77e-b2f9ded4343a","type":"message","text":"indeed I can't find anything older than 62, but bellman's work on dynamical programming in the 50s is probably very much related?","user":"UMDEUKM29","ts":"1611679929.043900","team":"T68168MUP","edited":{"user":"UMDEUKM29","ts":"1611679959.000000"},"blocks":[{"type":"rich_text","block_id":"noP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"indeed I can't find anything older than 62, but bellman's work on dynamical programming in the 50s is probably very much related?"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"ce096b94-de28-492a-b77a-6cd8e3a1a3fd","type":"message","text":"Yeah, Dreyfus wrote the famous book with Bellman around those years. I think the approach is different though.","user":"U6P4UPP9D","ts":"1611680066.044200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9=yvY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, Dreyfus wrote the famous book with Bellman around those years. I think the approach is different though."}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"84d09133-b9fe-4b67-80a3-6d62f43f9045","type":"message","text":"Forward AD for Taylor series was already in Moore’s *Interval Analysis* book published in 1966","user":"U67G3QRJM","ts":"1611682234.044400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BdT7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Forward AD for Taylor series was already in Moore’s "},{"type":"text","text":"Interval Analysis","style":{"bold":true}},{"type":"text","text":" book published in 1966"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"3f14cad0-ab16-4745-9784-dfdad7ec54b4","type":"message","text":"Although I don’t think it uses the phrase “automatic differentiation”","user":"U67G3QRJM","ts":"1611682250.044600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FEkd=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Although I don’t think it uses the phrase “automatic differentiation”"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH"},{"client_msg_id":"3d9ddb61-cb99-42f9-8519-aff89dae2243","type":"message","text":"Griewank and Walther attribute (forwards mode) AD to Newton.\nWhile in the modern day we do differentiation symbolically, then subsitute in all the numbers,\napparently Newton computed each application of the chainrule numerically at each step.","user":"U6A936746","ts":"1611684115.044900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"eFm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Griewank and Walther attribute (forwards mode) AD to Newton.\nWhile in the modern day we do differentiation symbolically, then subsitute in all the numbers,\napparently Newton computed each application of the chainrule numerically at each step."}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH","reactions":[{"name":"open_mouth","users":["U67G3QRJM","UKG4WF8PJ","U9TCDH0E7"],"count":3}]},{"client_msg_id":"67eed0dc-ce18-4c8c-bfe6-f7404fd682a6","type":"message","text":"The historical way of doing calculus with infinitesimal is much closer to AD than the modern version with limits","user":"UMDEUKM29","ts":"1611684528.045100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"P53S","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The historical way of doing calculus with infinitesimal is much closer to AD than the modern version with limits"}]}]}],"thread_ts":"1611657947.034400","parent_user_id":"U01HC60USTH","reactions":[{"name":"+1","users":["U67G3QRJM","UKG4WF8PJ","U9TCDH0E7"],"count":3}]}]