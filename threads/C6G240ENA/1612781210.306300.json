[{"client_msg_id":"560962f2-1f50-46fb-ab07-ffe2ce7b54ca","type":"message","text":"Has anyone observed a performance regression of Zygote in Julia 1.6.0-rc1\nIn Julia 1.5.2\nCompilation\n```julia&gt; @you wasted your time gradient(() -&gt; Flux.Losses.logitcrossentropy(model(ds).data, yy), ps)\n108.710175 seconds (99.36 M allocations: 5.025 GiB, 3.03% gc time)```\nand 2nd invokation subsequent evaluation\n```julia&gt; @time gradient(() -&gt; Flux.Losses.logitcrossentropy(model(ds).data, yy), ps)\n  0.262026 seconds (100.82 k allocations: 47.256 MiB)```\nJulia 1.6.0-rc1\n```julia&gt; @time gradient(() -&gt; Flux.Losses.logitcrossentropy(model(ds).data, yy), ps)\n1192.249257 seconds (82.90 M allocations: 4.778 GiB, 0.73% gc time, 99.95% compilation time)```\nsecond invocation\n```julia&gt; @time gradient(() -&gt; Flux.Losses.logitcrossentropy(model(ds).data, yy), ps)\n  2.337661 seconds (101.71 k allocations: 52.019 MiB, 93.80% compilation time)```\n","user":"U6YRZ18GZ","ts":"1612781210.306300","team":"T68168MUP","edited":{"user":"U6YRZ18GZ","ts":"1612781304.000000"},"blocks":[{"type":"rich_text","block_id":"VHCw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Has anyone observed a performance regression of Zygote in Julia 1.6.0-rc1\nIn Julia 1.5.2\nCompilation\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> @you wasted your time gradient(() -> Flux.Losses.logitcrossentropy(model(ds).data, yy), ps)\n108.710175 seconds (99.36 M allocations: 5.025 GiB, 3.03% gc time)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nand 2nd invokation subsequent evaluation\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> @time gradient(() -> Flux.Losses.logitcrossentropy(model(ds).data, yy), ps)\n  0.262026 seconds (100.82 k allocations: 47.256 MiB)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nJulia 1.6.0-rc1\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> @time gradient(() -> Flux.Losses.logitcrossentropy(model(ds).data, yy), ps)\n1192.249257 seconds (82.90 M allocations: 4.778 GiB, 0.73% gc time, 99.95% compilation time)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"second invocation\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> @time gradient(() -> Flux.Losses.logitcrossentropy(model(ds).data, yy), ps)\n  2.337661 seconds (101.71 k allocations: 52.019 MiB, 93.80% compilation time)"}]},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1612781210.306300","reply_count":8,"reply_users_count":3,"latest_reply":"1612786839.308100","reply_users":["UM30MT6RF","U6YRZ18GZ","U6PQP41C3"],"subscribed":false},{"client_msg_id":"0e263439-2c18-47b2-88f7-68ff97f7a4d8","type":"message","text":"That looks quite bad. Are they both using the same versions of Zygote and Flux?","user":"UM30MT6RF","ts":"1612781359.306500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qYrBV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That looks quite bad. Are they both using the same versions of Zygote and Flux?"}]}]}],"thread_ts":"1612781210.306300","parent_user_id":"U6YRZ18GZ"},{"client_msg_id":"96833d7e-6bc6-4fdf-baa9-1fa8fe7c1570","type":"message","text":"(ember) pkg&gt; st Zygote Zygote\n      Status\n```  [587475ba] Flux v0.11.3\n  [e88e6eb3] Zygote v0.5.17```\n","user":"U6YRZ18GZ","ts":"1612781388.306700","team":"T68168MUP","edited":{"user":"U6YRZ18GZ","ts":"1612781516.000000"},"blocks":[{"type":"rich_text","block_id":"NI12","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(ember) pkg> st Zygote Zygote\n      Status\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"  [587475ba] Flux v0.11.3\n  [e88e6eb3] Zygote v0.5.17"}]},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1612781210.306300","parent_user_id":"U6YRZ18GZ"},{"client_msg_id":"bec52bce-3811-4de1-8868-64aee8be2a04","type":"message","text":"Pehaps try upgrading to Zygote 0.6?","user":"U6PQP41C3","ts":"1612782103.307100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jdf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Pehaps try upgrading to Zygote 0.6?"}]}]}],"thread_ts":"1612781210.306300","parent_user_id":"U6YRZ18GZ"},{"client_msg_id":"84a4cfa1-e4f9-48f4-a141-a07b86455d67","type":"message","text":"Does not seems to be the cause. It is still takes ages with Zygote 0.6.3 and Flux 0.11.6.","user":"U6YRZ18GZ","ts":"1612783925.307300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1e+Pb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does not seems to be the cause. It is still takes ages with Zygote 0.6.3 and Flux 0.11.6."}]}]}],"thread_ts":"1612781210.306300","parent_user_id":"U6YRZ18GZ"},{"client_msg_id":"01ab3232-b492-4ff7-83d7-159c97e768b5","type":"message","text":"Should I post the regression somewhere?","user":"U6YRZ18GZ","ts":"1612783937.307500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"iu2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Should I post the regression somewhere?"}]}]}],"thread_ts":"1612781210.306300","parent_user_id":"U6YRZ18GZ"},{"client_msg_id":"233cd205-12f6-4f99-b2c7-022f6dfa0317","type":"message","text":"Please do :slightly_smiling_face: I imagine either of the Flux or Zygote repos would be fine.","user":"U6PQP41C3","ts":"1612784119.307700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xdVo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Please do "},{"type":"emoji","name":"slightly_smiling_face"},{"type":"text","text":" I imagine either of the Flux or Zygote repos would be fine."}]}]}],"thread_ts":"1612781210.306300","parent_user_id":"U6YRZ18GZ"},{"client_msg_id":"936300ae-66a7-49b3-b3f3-d319d4ce36ad","type":"message","text":"If it's with the same exact Flux and Zygote version, it's likely a Julia issue, so it would be best to post there","user":"UM30MT6RF","ts":"1612784761.307900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"X/r","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If it's with the same exact Flux and Zygote version, it's likely a Julia issue, so it would be best to post there"}]}]}],"thread_ts":"1612781210.306300","parent_user_id":"U6YRZ18GZ"},{"client_msg_id":"224bd851-66e3-4b26-825f-d49e2683ab9f","type":"message","text":"Good point","user":"U6PQP41C3","ts":"1612786839.308100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"91YN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Good point"}]}]}],"thread_ts":"1612781210.306300","parent_user_id":"U6YRZ18GZ"}]