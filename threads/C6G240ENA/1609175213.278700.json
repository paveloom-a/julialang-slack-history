[{"client_msg_id":"e2f6ebae-da32-4790-9064-25eece07bd62","type":"message","text":"People should be aware of this super cool PR <@U6PQP41C3> is working on for Zygote.\nThat massively improves performance by allowing you to disable support for working with global variables\n<https://github.com/FluxML/Zygote.jl/pull/864>","user":"U6A936746","ts":"1609175213.278700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2K8sX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"People should be aware of this super cool PR "},{"type":"user","user_id":"U6PQP41C3"},{"type":"text","text":" is working on for Zygote.\nThat massively improves performance by allowing you to disable support for working with global variables\n"},{"type":"link","url":"https://github.com/FluxML/Zygote.jl/pull/864"}]}]}],"thread_ts":"1609175213.278700","reply_count":8,"reply_users_count":2,"latest_reply":"1609193165.280800","reply_users":["UJ7DVTVQ8","U6PQP41C3"],"subscribed":false},{"client_msg_id":"61ef1c87-d44c-480b-a9ad-11874de8072d","type":"message","text":"Cool! I noticed that the benchmarks showed sub-ns timings, indicating that the compiler probably performed the entire computation. While it's since to see that the change made the compiler smarter, it would perhaps be more useful to time the actual computation?","user":"UJ7DVTVQ8","ts":"1609175472.278900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ow9+3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Cool! I noticed that the benchmarks showed sub-ns timings, indicating that the compiler probably performed the entire computation. While it's since to see that the change made the compiler smarter, it would perhaps be more useful to time the actual computation?"}]}]}],"thread_ts":"1609175213.278700","parent_user_id":"U6A936746"},{"client_msg_id":"7f57d1cb-a783-4f39-9281-200790da7c15","type":"message","text":"E.g., by not interpolating `$a` into the first expression","user":"UJ7DVTVQ8","ts":"1609175497.279100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/hV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"E.g., by not interpolating "},{"type":"text","text":"$a","style":{"code":true}},{"type":"text","text":" into the first expression"}]}]}],"thread_ts":"1609175213.278700","parent_user_id":"U6A936746"},{"client_msg_id":"09adda26-7ee4-4677-93cd-10c7213cce02","type":"message","text":"or the Ref trick, which I can never remember exactly how it goes\n`Ref($(a))[]` or something like that","user":"UJ7DVTVQ8","ts":"1609175547.279300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CSq8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"or the Ref trick, which I can never remember exactly how it goes\n"},{"type":"text","text":"Ref($(a))[]","style":{"code":true}},{"type":"text","text":" or something like that"}]}]}],"thread_ts":"1609175213.278700","parent_user_id":"U6A936746"},{"client_msg_id":"ac1fc115-70ac-496e-a341-eefd997679af","type":"message","text":"```julia&gt; @btime $a + 1\n  0.025 ns (0 allocations: 0 bytes)\n2\n\njulia&gt; @btime Ref($a)[] + 1\n  1.587 ns (0 allocations: 0 bytes)\n2```","user":"UJ7DVTVQ8","ts":"1609175708.279500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NMvQs","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> @btime $a + 1\n  0.025 ns (0 allocations: 0 bytes)\n2\n\njulia> @btime Ref($a)[] + 1\n  1.587 ns (0 allocations: 0 bytes)\n2"}]}]}],"thread_ts":"1609175213.278700","parent_user_id":"U6A936746"},{"client_msg_id":"abbbba61-654f-485d-8d13-10025c526fcb","type":"message","text":"Ooo I was not aware of the `Ref` trick. I’ll modify the timings. In any case, the key takeaway is that the allocations have disappeared and everything has inferred properly.","user":"U6PQP41C3","ts":"1609192747.280200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xUJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ooo I was not aware of the "},{"type":"text","text":"Ref","style":{"code":true}},{"type":"text","text":" trick. I’ll modify the timings. In any case, the key takeaway is that the allocations have disappeared and everything has inferred properly."}]}]}],"thread_ts":"1609175213.278700","parent_user_id":"U6A936746"},{"client_msg_id":"063aa287-b6ff-4780-a70a-cc091666fefa","type":"message","text":"Oh wow, yeah, this breaks the performance improvements :grimacing:","user":"U6PQP41C3","ts":"1609193127.280400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bK407","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Oh wow, yeah, this breaks the performance improvements "},{"type":"emoji","name":"grimacing"}]}]}],"thread_ts":"1609175213.278700","parent_user_id":"U6A936746"},{"client_msg_id":"7b81a6a7-fc41-4934-be46-f46472dc3713","type":"message","text":"I’ll have to find a different example where this works out.","user":"U6PQP41C3","ts":"1609193141.280600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2p91","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I’ll have to find a different example where this works out."}]}]}],"thread_ts":"1609175213.278700","parent_user_id":"U6A936746"},{"client_msg_id":"52201785-bb08-4a17-868d-60206a766569","type":"message","text":"&gt;  everything has inferred properly.\nApparently everything _hadn’t_ inferred.","user":"U6PQP41C3","ts":"1609193165.280800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3Z0jq","elements":[{"type":"rich_text_quote","elements":[{"type":"text","text":" everything has inferred properly."}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Apparently everything "},{"type":"text","text":"hadn’t","style":{"italic":true}},{"type":"text","text":" inferred."}]}]}],"thread_ts":"1609175213.278700","parent_user_id":"U6A936746"}]