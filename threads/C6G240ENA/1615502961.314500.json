[{"client_msg_id":"2d0d163f-baf0-4adb-a8fd-ae8a225c78ec","type":"message","text":"is there any way for ForwardDiff to deal with cases where a matrix is updated in a for loop? A minimum working example is like:\n```function g2(x)\n    e = zeros(1000, 10)\n    for i in 1:10\n        e[:,i] = rand(1000) .+ x\n    end\n    res = mean(e)\n    return res\nend\n\nForwardDiff.derivative(g2,1) # fail```\nIn real application, the calculations within the for loop is complicated so I can't really get rid of it. Are there any solutions? Or I should just try to formulate the problem in another way to avoid updating in for loops?","user":"UM3GCDFGR","ts":"1615502961.314500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ytK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"is there any way for ForwardDiff to deal with cases where a matrix is updated in a for loop? A minimum working example is like:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function g2(x)\n    e = zeros(1000, 10)\n    for i in 1:10\n        e[:,i] = rand(1000) .+ x\n    end\n    res = mean(e)\n    return res\nend\n\nForwardDiff.derivative(g2,1) # fail"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"In real application, the calculations within the for loop is complicated so I can't really get rid of it. Are there any solutions? Or I should just try to formulate the problem in another way to avoid updating in for loops?"}]}]}],"thread_ts":"1615502961.314500","reply_count":4,"reply_users_count":3,"latest_reply":"1615504321.315400","reply_users":["UD0NS8PDF","U6A936746","UM3GCDFGR"],"subscribed":false},{"client_msg_id":"063ccfca-ce41-419c-a2ec-a27fdc1beb37","type":"message","text":"You can do `e = fill(zero(x), 1000, 10)` so that it picks up the type of `x`","user":"UD0NS8PDF","ts":"1615503187.314600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tlH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You can do "},{"type":"text","text":"e = fill(zero(x), 1000, 10)","style":{"code":true}},{"type":"text","text":" so that it picks up the type of "},{"type":"text","text":"x","style":{"code":true}}]}]}],"thread_ts":"1615502961.314500","parent_user_id":"UM3GCDFGR","reactions":[{"name":"+1","users":["U6A936746"],"count":1}]},{"client_msg_id":"7fe705ce-63a9-4714-8fcb-87efadc35597","type":"message","text":"Or `zeros(typeof(x), 1000, 10)`","user":"U6A936746","ts":"1615503233.314900","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1615503293.000000"},"blocks":[{"type":"rich_text","block_id":"/ER","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Or "},{"type":"text","text":"zeros(typeof(x), 1000, 10)","style":{"code":true}}]}]}],"thread_ts":"1615502961.314500","parent_user_id":"UM3GCDFGR"},{"client_msg_id":"70af8bd7-c655-43da-9099-40342c81e091","type":"message","text":"AD aside this care with types is best practices since what if `x` is a Float32 cos you want to save memory, or a BigFloat cos you need precision","user":"U6A936746","ts":"1615503457.315200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zvcZw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"AD aside this care with types is best"},{"type":"text","text":" ","style":{"code":true}},{"type":"text","text":"practices since what if "},{"type":"text","text":"x ","style":{"code":true}},{"type":"text","text":"is a Float32 cos you want to save memory, or a BigFloat cos you need precision"}]}]}],"thread_ts":"1615502961.314500","parent_user_id":"UM3GCDFGR"},{"client_msg_id":"7bbf4455-99ad-423b-b26b-9ede9d480e8f","type":"message","text":"Aha, so it's actually the type issue. Thank you so much <@UD0NS8PDF> and <@U6A936746>!","user":"UM3GCDFGR","ts":"1615504321.315400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"p41hs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Aha, so it's actually the type issue. Thank you so much "},{"type":"user","user_id":"UD0NS8PDF"},{"type":"text","text":" and "},{"type":"user","user_id":"U6A936746"},{"type":"text","text":"!"}]}]}],"thread_ts":"1615502961.314500","parent_user_id":"UM3GCDFGR"}]