[{"client_msg_id":"75c29e1a-21f6-49d6-9ec4-e21005dde50f","type":"message","text":"Hey folks. I was just trying to understand what it means to make a library \"differentiable.\" Like is there a template for what a differentiable library looks like or how one is implemented. I need to write a differentiable solver for a linear program. Linear programs are not usually differentiable, but I can apply some smoothing to make it differentiable. But I am not sure how to implement this in a library so that I can connect it back to Flux or something. Any guidance would be appreciated.","user":"UDDSTBX19","ts":"1614188557.089700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VlAK5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hey folks. I was just trying to understand what it means to make a library \"differentiable.\" Like is there a template for what a differentiable library looks like or how one is implemented. I need to write a differentiable solver for a linear program. Linear programs are not usually differentiable, but I can apply some smoothing to make it differentiable. But I am not sure how to implement this in a library so that I can connect it back to Flux or something. Any guidance would be appreciated."}]}]}],"thread_ts":"1614188557.089700","reply_count":24,"reply_users_count":6,"latest_reply":"1614197840.101100","reply_users":["ULG5V164A","UDDSTBX19","U67G3QRJM","U6A936746","U82RE6STE","UCZ7VBGUD"],"subscribed":false},{"client_msg_id":"4becc761-64e5-461d-9b9f-65ed06cbc6f0","type":"message","text":"Like this? <https://fluxml.ai/Zygote.jl/latest/adjoints/>","user":"ULG5V164A","ts":"1614188600.089800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fJX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Like this? "},{"type":"link","url":"https://fluxml.ai/Zygote.jl/latest/adjoints/"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"99e8779a-3acf-4653-bc83-5ef24b534ec5","type":"message","text":"<@ULG5V164A> Oh okay. So basically a custom adjoint is a wrapper for some function. So I don't need to worry about all of the dependencies being fully differentiable. I can write the custom adjoint and handle the parameters within that.","user":"UDDSTBX19","ts":"1614188792.090000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Nbd","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"ULG5V164A"},{"type":"text","text":" Oh okay. So basically a custom adjoint is a wrapper for some function. So I don't need to worry about all of the dependencies being fully differentiable. I can write the custom adjoint and handle the parameters within that."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"5e41c6ca-45f2-435d-bf78-89f04ecf0855","type":"message","text":"I would say that it means that each operation you do should be differentiable","user":"U67G3QRJM","ts":"1614188793.090200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BoKKo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I would say that it means that each operation you do should be differentiable"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"5d4ef14e-fb48-415e-a1a0-f74eda4b7da2","type":"message","text":"cc <@U82RE6STE>","user":"U6A936746","ts":"1614188871.090400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8xiEI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"cc "},{"type":"user","user_id":"U82RE6STE"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"e3afbdde-5b18-40a9-9cef-e71ca0c92368","type":"message","text":"Does it even make sense to talk about a differentiable linear programming solver?","user":"U67G3QRJM","ts":"1614188896.090600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Fbv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does it even make sense to talk about a differentiable linear programming solver?"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"f292f4a3-1878-4da3-b188-ffdeced95448","type":"message","text":"I guess it means that you expect the optimizer to vary continuously as you change the constraints","user":"U67G3QRJM","ts":"1614188945.090900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zYe2W","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I guess it means that you expect the optimizer to vary continuously as you change the constraints"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"ca718387-492c-45c2-9b30-60e9a74179a7","type":"message","text":"&gt;  Does it even make sense to talk about a differentiable linear programming solver?\njust LP, it is wrt some paramaters (locally), not to all","user":"U82RE6STE","ts":"1614188946.091100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pcql","elements":[{"type":"rich_text_quote","elements":[{"type":"text","text":" Does it even make sense to talk about a differentiable linear programming solver?"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"just LP, it is wrt some paramaters (locally), not to all"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"c92b220c-a7d4-49dd-9bda-8b9b04119819","type":"message","text":"Consider things like this: <https://arxiv.org/abs/1907.05912>","user":"ULG5V164A","ts":"1614188949.091300","team":"T68168MUP","attachments":[{"service_name":"arXiv.org","title":"MIPaaL: Mixed Integer Program as a Layer","title_link":"https://arxiv.org/abs/1907.05912","text":"Machine learning components commonly appear in larger decision-making pipelines; however, the model training process typically focuses only on a loss that measures accuracy between predicted...","fallback":"arXiv.org: MIPaaL: Mixed Integer Program as a Layer","from_url":"https://arxiv.org/abs/1907.05912","service_icon":"https://static.arxiv.org/static/browse/0.3.2.6/images/icons/favicon.ico","id":1,"original_url":"https://arxiv.org/abs/1907.05912"}],"blocks":[{"type":"rich_text","block_id":"mOC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Consider things like this: "},{"type":"link","url":"https://arxiv.org/abs/1907.05912"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"c4dd99f1-cf1a-4c9e-8c0a-ff6e4ffc47d2","type":"message","text":"<@U67G3QRJM> This is a very good question, but yes :wink:. Usually LPs are not differentiable, but if you apply a smoother you can actually get a derivative.","user":"UDDSTBX19","ts":"1614188949.091500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Y8GDQ","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U67G3QRJM"},{"type":"text","text":" This is a very good question, but yes "},{"type":"emoji","name":"wink"},{"type":"text","text":". Usually LPs are not differentiable, but if you apply a smoother you can actually get a derivative."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19","reactions":[{"name":"+1","users":["ULG5V164A"],"count":1}]},{"client_msg_id":"e1e1f2e3-0316-4641-b2d1-1da57d97d189","type":"message","text":"<https://arxiv.org/abs/1802.03676>","user":"UDDSTBX19","ts":"1614189005.091900","team":"T68168MUP","attachments":[{"service_name":"arXiv.org","title":"Differentiable Dynamic Programming for Structured Prediction and Attention","title_link":"https://arxiv.org/abs/1802.03676","text":"Dynamic programming (DP) solves a variety of structured combinatorial problems by iteratively breaking them down into smaller subproblems. In spite of their versatility, DP algorithms are usually...","fallback":"arXiv.org: Differentiable Dynamic Programming for Structured Prediction and Attention","from_url":"https://arxiv.org/abs/1802.03676","service_icon":"https://static.arxiv.org/static/browse/0.3.2.6/images/icons/favicon.ico","id":1,"original_url":"https://arxiv.org/abs/1802.03676"}],"blocks":[{"type":"rich_text","block_id":"5tjCl","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://arxiv.org/abs/1802.03676"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19","reactions":[{"name":"+1","users":["ULG5V164A","U67G3QRJM"],"count":2}]},{"client_msg_id":"5988e781-8be7-4b26-89ad-c305f9203cb8","type":"message","text":"And <@UDDSTBX19> yes, I haven't done it myself (Lyndon is the expert here) but that's how I understand it. You can call out to external programs and provide your own adjoint code so it all \"works.\"","user":"ULG5V164A","ts":"1614189020.092300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aC2+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And "},{"type":"user","user_id":"UDDSTBX19"},{"type":"text","text":" yes, I haven't done it myself (Lyndon is the expert here) but that's how I understand it. You can call out to external programs and provide your own adjoint code so it all \"works.\""}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19","reactions":[{"name":"+1","users":["UDDSTBX19"],"count":1}]},{"client_msg_id":"896ab566-1b27-4186-b72b-f9fe85ef4288","type":"message","text":"These guys are differentiating through a dynamic program, but at each step of the dynamic program they are solving a linear program by smoothing.","user":"UDDSTBX19","ts":"1614189049.092600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GW5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"These guys are differentiating through a dynamic program, but at each step of the dynamic program they are solving a linear program by smoothing."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"cefee276-619b-45e4-8ded-ab08d3dfb004","type":"message","text":"<@ULG5V164A> Okay, that is great. Yeah, that is definitely enough to get me started :slightly_smiling_face:. Nice. Thanks again.","user":"UDDSTBX19","ts":"1614189255.093300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ujKdg","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"ULG5V164A"},{"type":"text","text":" Okay, that is great. Yeah, that is definitely enough to get me started "},{"type":"emoji","name":"slightly_smiling_face"},{"type":"text","text":". Nice. Thanks again."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"6c302f07-39db-4e6e-8319-bce50ffd1c37","type":"message","text":"check out <https://github.com/jump-dev/DiffOpt.jl> btw!","user":"UCZ7VBGUD","ts":"1614189433.093500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"h1F5F","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"check out "},{"type":"link","url":"https://github.com/jump-dev/DiffOpt.jl"},{"type":"text","text":" btw!"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19","reactions":[{"name":"point_up","users":["U6A936746","ULG5V164A"],"count":2},{"name":"heavy_check_mark","users":["UDDSTBX19","U82RE6STE"],"count":2}]},{"client_msg_id":"b1a176ba-1f71-4f17-9d52-30c2ec91ee32","type":"message","text":"Yep, I just found that <@UCZ7VBGUD>. That looks very interesting. I am right at that phase where I need to write something simple just to understand the algorithms, but then I can start to work in the library. Seems like this is a new library, so I can help them out perhaps :slightly_smiling_face:.","user":"UDDSTBX19","ts":"1614189597.094000","team":"T68168MUP","edited":{"user":"UDDSTBX19","ts":"1614189615.000000"},"blocks":[{"type":"rich_text","block_id":"D2W","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yep, I just found that "},{"type":"user","user_id":"UCZ7VBGUD"},{"type":"text","text":". That looks very interesting. I am right at that phase where I need to write something simple just to understand the algorithms, but then I can start to work in the library. Seems like this is a new library, so I can help them out perhaps "},{"type":"emoji","name":"slightly_smiling_face"},{"type":"text","text":"."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"fe7b5049-69bf-48e7-b858-6d0f5bdbd5a5","type":"message","text":"<@U67G3QRJM> I was just reading this blog post on convex optimization layers. It seems really nice if you are interested. <https://locuslab.github.io/2019-10-28-cvxpylayers/>","user":"UDDSTBX19","ts":"1614191344.094500","team":"T68168MUP","attachments":[{"title":"Differentiable Convex Optimization Layers","title_link":"https://locuslab.github.io/2019-10-28-cvxpylayers/","text":"CVXPY creates powerful new PyTorch and TensorFlow layers","fallback":"Differentiable Convex Optimization Layers","from_url":"https://locuslab.github.io/2019-10-28-cvxpylayers/","service_name":"locuslab.github.io","id":1,"original_url":"https://locuslab.github.io/2019-10-28-cvxpylayers/"}],"blocks":[{"type":"rich_text","block_id":"Lur","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U67G3QRJM"},{"type":"text","text":" I was just reading this blog post on convex optimization layers. It seems really nice if you are interested. "},{"type":"link","url":"https://locuslab.github.io/2019-10-28-cvxpylayers/"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19","reactions":[{"name":"+1","users":["U67G3QRJM"],"count":1}]},{"client_msg_id":"4d6218e5-e8a3-43b9-aad6-c6c7918835fe","type":"message","text":"That is a great post, thanks <@UDDSTBX19>. How much of that is doable in Julia?","user":"U67G3QRJM","ts":"1614195155.095100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tUq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That is a great post, thanks "},{"type":"user","user_id":"UDDSTBX19"},{"type":"text","text":". How much of that is doable in Julia?"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"6879b9ad-f1d8-4840-8d18-63e77b445575","type":"message","text":"<@U67G3QRJM> Yeah, I am reading through it as well, and it is really interesting. I think that there is some interest because the <https://github.com/jump-dev/DiffOpt.jl> is already starting to implement this. So it seems like Julia could do this?","user":"UDDSTBX19","ts":"1614195283.095400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=d8hg","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U67G3QRJM"},{"type":"text","text":" Yeah, I am reading through it as well, and it is really interesting. I think that there is some interest because the "},{"type":"link","url":"https://github.com/jump-dev/DiffOpt.jl"},{"type":"text","text":" is already starting to implement this. So it seems like Julia could do this?"}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19","reactions":[{"name":"+1","users":["U67G3QRJM"],"count":1}]},{"client_msg_id":"2e2dd03e-1687-4713-b98e-1963fed886a2","type":"message","text":"Like I also wonder if something like this is a good candidate for ModellingToolkit. Something that can reason about the problem and then choose the right solver methods.","user":"UDDSTBX19","ts":"1614195383.095700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dDe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Like I also wonder if something like this is a good candidate for ModellingToolkit. Something that can reason about the problem and then choose the right solver methods."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"d7fab2f6-8561-4a31-9ce6-9a2ba245e37e","type":"message","text":"Then it would just plug into the rest of the flux ecosystem, right.","user":"UDDSTBX19","ts":"1614195407.095900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OtY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Then it would just plug into the rest of the flux ecosystem, right."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"B671DCC6-9D5E-4051-AF3C-4EB25CD432BA","type":"message","text":"Btw the Julia analog to CVX or CVXPY is Convex.jl (although it hasn’t gotten as much development), and <https://github.com/jump-dev/Convex.jl/issues/383|https://github.com/jump-dev/Convex.jl/issues/383> is relevant ","user":"UCZ7VBGUD","ts":"1614196576.097300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"d5Rp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Btw the Julia analog to CVX or CVXPY is Convex.jl (although it hasn’t gotten as much development), and "},{"type":"link","url":"https://github.com/jump-dev/Convex.jl/issues/383","text":"https://github.com/jump-dev/Convex.jl/issues/383"},{"type":"text","text":" is relevant "}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19"},{"client_msg_id":"d9d0dfcc-d1fa-41a9-a37d-8c7e23afecd7","type":"message","text":"<@UCZ7VBGUD> Oh thanks for the tip. I have been looking at Convex.jl. I am still just trying to get my head around trainable convex layers. But it definitely seems like there is an interest in this topic.","user":"UDDSTBX19","ts":"1614196902.097500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Kn7h","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UCZ7VBGUD"},{"type":"text","text":" Oh thanks for the tip. I have been looking at Convex.jl. I am still just trying to get my head around trainable convex layers. But it definitely seems like there is an interest in this topic."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19","reactions":[{"name":"+1","users":["UCZ7VBGUD"],"count":1}]},{"client_msg_id":"4AEE3FD8-6779-4777-B643-F4002094DFBD","type":"message","text":"I think so :). I am interested mostly out of curiosity; I still maintain Convex (note I didn’t write it though!) but since finishing my PhD I haven’t been using it in my work so it hasn’t been a big priority. I think it’s definitely worth considering using MTK or other ways to formulate problems though; just wanted to point out that there is basically a Julia version of CVXPY.","user":"UCZ7VBGUD","ts":"1614197491.100700","team":"T68168MUP","edited":{"user":"UCZ7VBGUD","ts":"1614197523.000000"},"blocks":[{"type":"rich_text","block_id":"69fot","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think so :). I am interested mostly out of curiosity; I still maintain Convex (note I didn’t write it though!) but since finishing my PhD I haven’t been using it in my work so it hasn’t been a big priority. I think it’s definitely worth considering using MTK or other ways to formulate problems though; just wanted to point out that there is basically a Julia version of CVXPY."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19","reactions":[{"name":"+1","users":["U67G3QRJM"],"count":1}]},{"client_msg_id":"cf3c6f1c-95d4-45e0-839f-6f39d8681d15","type":"message","text":"<@UCZ7VBGUD> that is very helpful. Yeah, that sets up a very good starting point.","user":"UDDSTBX19","ts":"1614197840.101100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aR7I","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UCZ7VBGUD"},{"type":"text","text":" that is very helpful. Yeah, that sets up a very good starting point."}]}]}],"thread_ts":"1614188557.089700","parent_user_id":"UDDSTBX19","reactions":[{"name":"+1","users":["UCZ7VBGUD"],"count":1}]}]