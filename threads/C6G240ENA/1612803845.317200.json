[{"client_msg_id":"bfc4a183-7588-4a60-84cf-e8b1c3b29cbc","type":"message","text":"For those interested in using automatic differentiation to learn force fields for molecular simulation, we have a pre-print just out: <https://twitter.com/jgreener64/status/1358793009106665476>.\nNo Julia in this one, in fact I think this work was started before the first Zygote release, but I'm hoping that the next steps will be in Julia (using Molly.jl).","user":"U9TCDH0E7","ts":"1612803845.317200","team":"T68168MUP","attachments":[{"fallback":"<https://twitter.com/jgreener64|@jgreener64>: Breaking my Twitter silence to share our recent work on differentiable molecular simulation: <https://www.biorxiv.org/content/10.1101/2021.02.05.429941v1>.\n\nWe use automatic differentiation to learn all the parameters in a coarse-grained force field for proteins.\n\n(1/6)","ts":1612796473,"author_name":"Joe Greener","author_link":"https://twitter.com/jgreener64/status/1358793009106665476","author_icon":"https://pbs.twimg.com/profile_images/1161578493869776896/xXLprxTP_normal.png","author_subname":"@jgreener64","text":"Breaking my Twitter silence to share our recent work on differentiable molecular simulation: <https://www.biorxiv.org/content/10.1101/2021.02.05.429941v1>.\n\nWe use automatic differentiation to learn all the parameters in a coarse-grained force field for proteins.\n\n(1/6)","service_name":"twitter","service_url":"https://twitter.com/","from_url":"https://twitter.com/jgreener64/status/1358793009106665476","id":1,"original_url":"https://twitter.com/jgreener64/status/1358793009106665476","footer":"Twitter","footer_icon":"https://a.slack-edge.com/80588/img/services/twitter_pixel_snapped_32.png"}],"blocks":[{"type":"rich_text","block_id":"R2o","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For those interested in using automatic differentiation to learn force fields for molecular simulation, we have a pre-print just out: "},{"type":"link","url":"https://twitter.com/jgreener64/status/1358793009106665476"},{"type":"text","text":".\nNo Julia in this one, in fact I think this work was started before the first Zygote release, but I'm hoping that the next steps will be in Julia (using Molly.jl)."}]}]}],"thread_ts":"1612803845.317200","reply_count":21,"reply_users_count":2,"latest_reply":"1612866840.348100","reply_users":["UMDEUKM29","U9TCDH0E7"],"subscribed":false,"reactions":[{"name":"+1","users":["U67G3QRJM","U66SR8JHX","U85JBUGGP","UGU761DU2","UM6JW2SF9","U6A936746","U018F5W2H24","UHDQQ4GN6","UKG4WF8PJ"],"count":9},{"name":"100","users":["UGU761DU2"],"count":1}]},{"client_msg_id":"6f212357-2b2d-4f85-bdb9-bee1bf9b3e73","type":"message","text":"looks super nice! any hope of doing that in one of these big MD packages?","user":"UMDEUKM29","ts":"1612809728.328000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vyXHO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"looks super nice! any hope of doing that in one of these big MD packages?"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"d5579c76-31b7-496c-8a5a-5f0e2b85a11a","type":"message","text":"our goal is to do the same but for DFT (so no trajectories but a big equation to solve)","user":"UMDEUKM29","ts":"1612809750.328200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"JQ=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"our goal is to do the same but for DFT (so no trajectories but a big equation to solve)"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"f6e4776c-6a63-433c-bab4-3827217ab7ec","type":"message","text":"also if you do MD at finite temperature eg for free energies, you'll get things that are pretty noisy - are derivatives useful in this case?","user":"UMDEUKM29","ts":"1612811733.336800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e2k","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"also if you do MD at finite temperature eg for free energies, you'll get things that are pretty noisy - are derivatives useful in this case?"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"859b0d4a-6816-4b3f-a9ad-735337098dea","type":"message","text":"Thanks! There is work to get something like this into OpenMM but I'm not sure how advanced it is.","user":"U9TCDH0E7","ts":"1612813668.338200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6Zuw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks! There is work to get something like this into OpenMM but I'm not sure how advanced it is."}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"a00df7e6-dd77-4f51-90c8-fe27915f665d","type":"message","text":"Sounds cool.","user":"U9TCDH0E7","ts":"1612813671.338400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tdqNO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Sounds cool."}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"5b55dc16-4731-4a99-a2ef-23cd306b0df5","type":"message","text":"That's an interesting question, we mention the use of thermostats briefly in the discussion. I expect there will be gradient problems if you use a stochastic thermostat; we didn't for training but did for the long inference simulations.","user":"U9TCDH0E7","ts":"1612813728.338600","team":"T68168MUP","edited":{"user":"U9TCDH0E7","ts":"1612813767.000000"},"blocks":[{"type":"rich_text","block_id":"vE2v","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That's an interesting question, we mention the use of thermostats briefly in the discussion. I expect there will be gradient problems if you use a stochastic thermostat; we didn't for training but did for the long inference simulations."}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"0d9a8c67-2117-454b-a84c-fbc7947a42db","type":"message","text":"I know that eg quantum monte carlo people have a lot of trouble computing forces, I don't know if there are good tricks that can be used from there","user":"UMDEUKM29","ts":"1612814454.339100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yzQ+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I know that eg quantum monte carlo people have a lot of trouble computing forces, I don't know if there are good tricks that can be used from there"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7","reactions":[{"name":"+1","users":["U9TCDH0E7"],"count":1}]},{"client_msg_id":"abc7b978-12ff-4554-b2ec-e578d296f342","type":"message","text":"so I don't get it, you use an NVE simulation to get to a desired configuration? That sounds nuts to me, NVE doesn't go anywhere, it's reversible and just oscillates a bunch, right?","user":"UMDEUKM29","ts":"1612814707.339300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"B+D=W","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so I don't get it, you use an NVE simulation to get to a desired configuration? That sounds nuts to me, NVE doesn't go anywhere, it's reversible and just oscillates a bunch, right?"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"9a9d9074-1bc8-45a2-9676-a3f59e083cb5","type":"message","text":"The training simulations just keep the native structure stable rather than doing the folding. But the potential has to learn to counter the random starting velocity. The inference simulations are NVT and do folding.","user":"U9TCDH0E7","ts":"1612815032.339700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"69OH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The training simulations just keep the native structure stable rather than doing the folding. But the potential has to learn to counter the random starting velocity. The inference simulations are NVT and do folding."}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"fb64dcad-713e-4251-a19a-21fadd06acda","type":"message","text":"so there's like an external force keeping the structure in place?","user":"UMDEUKM29","ts":"1612815176.340000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YCsxo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so there's like an external force keeping the structure in place?"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"f918ce34-9641-419e-89f2-0eeddbfcca5c","type":"message","text":"I have to find the place in the paper where this is discussed, I'm not used to this format","user":"UMDEUKM29","ts":"1612815211.340200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nvYJT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have to find the place in the paper where this is discussed, I'm not used to this format"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"30d9daa4-2567-4341-928e-6c0d9eebaae7","type":"message","text":"OK so if i understand well your loss function is the ability of a potential to stabilize a native structure","user":"UMDEUKM29","ts":"1612815559.341000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WDh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"OK so if i understand well your loss function is the ability of a potential to stabilize a native structure"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"711512ae-dd22-422f-ae4f-86c0a6ea958c","type":"message","text":"so eg E and 40 E are both equally valid energy surfaces?","user":"UMDEUKM29","ts":"1612815574.341200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wlW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so eg E and 40 E are both equally valid energy surfaces?"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"0454c5ff-99f7-446c-bc62-8926fd8abfdc","type":"message","text":"don't you lose any sense of dynamics by doing so?","user":"UMDEUKM29","ts":"1612815588.341400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ETD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"don't you lose any sense of dynamics by doing so?"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"e3c5605e-4b2a-4883-9a3e-c88df96af7ad","type":"message","text":"Yeah the model basically learns the potential that gives the forces that keep the native structure stable. There's no external force keeping the structure in place.","user":"U9TCDH0E7","ts":"1612825507.346500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sFS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah the model basically learns the potential that gives the forces that keep the native structure stable. There's no external force keeping the structure in place."}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"e103f452-1d85-4745-812d-b99da016286d","type":"message","text":"E and 40 E would give forces 40 times as large, which would not be identical.","user":"U9TCDH0E7","ts":"1612825557.346700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dTwH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"E and 40 E would give forces 40 times as large, which would not be identical."}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"1b011f51-069a-4b51-9e55-267de1698a66","type":"message","text":"The simulation somewhat fails to keep the native structure stable due to the high starting velocities. The training simulations reach about 4 Å RMSD. That's deliberate, and means that a lot of the potential gets sampled and is modified by the gradients.","user":"U9TCDH0E7","ts":"1612825723.346900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BCd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The simulation somewhat fails to keep the native structure stable due to the high starting velocities. The training simulations reach about 4 Å RMSD. That's deliberate, and means that a lot of the potential gets sampled and is modified by the gradients."}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"966f7814-bd08-403b-a17c-0582830a70a8","type":"message","text":"But forces 40 times as large would simply scale time, right?","user":"UMDEUKM29","ts":"1612851755.347500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E8K8m","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But forces 40 times as large would simply scale time, right?"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"596a6a57-59bf-47ca-8299-933c5ea85773","type":"message","text":"Hm, not if you fix nonzero velocities though","user":"UMDEUKM29","ts":"1612851776.347700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tam6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hm, not if you fix nonzero velocities though"}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"1d95e292-e8e5-4247-ada2-eb4302cf00a2","type":"message","text":"Yeah, larger forces would scale time, but the starting velocities would be separate from that.","user":"U9TCDH0E7","ts":"1612866737.347900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"JjH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, larger forces would scale time, but the starting velocities would be separate from that."}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"},{"client_msg_id":"b27848e5-0313-4fa5-827b-987d3c905deb","type":"message","text":"We aren't so bothered about the exact numbers for the energy, since none of the quantities (energy, temperature, time) are trivially mappable to real units. We looked more at the qualitative shapes of the potentials and their ability to reproduce folding when run over longer time scales.","user":"U9TCDH0E7","ts":"1612866840.348100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2PXX4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"We aren't so bothered about the exact numbers for the energy, since none of the quantities (energy, temperature, time) are trivially mappable to real units. We looked more at the qualitative shapes of the potentials and their ability to reproduce folding when run over longer time scales."}]}]}],"thread_ts":"1612803845.317200","parent_user_id":"U9TCDH0E7"}]