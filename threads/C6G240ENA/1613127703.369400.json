[{"client_msg_id":"c37c476e-a7f8-4e7f-a297-0474f34e7c27","type":"message","text":"I'm trying to do a forward-over-reverse Hessian. The backward pass (Zygote) is going to generate something including an FFT, then the forward needs to work through that. ForwardDiff doesn't seem to support complex numbers so I suppose it can't?\n```ForwardDiff.gradient(((A,),) -&gt; real(sum(fft(A*x))), [1]) # error```\nIs there anything in Julia that could potentially work?","user":"UUMJUCYRK","ts":"1613127703.369400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vKv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm trying to do a forward-over-reverse Hessian. The backward pass (Zygote) is going to generate something including an FFT, then the forward needs to work through that. ForwardDiff doesn't seem to support complex numbers so I suppose it can't?\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ForwardDiff.gradient(((A,),) -> real(sum(fft(A*x))), [1]) # error"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Is there anything in Julia that could potentially work?"}]}]}],"thread_ts":"1613127703.369400","reply_count":5,"reply_users_count":2,"latest_reply":"1613129567.370600","reply_users":["UD0NS8PDF","UUMJUCYRK"],"subscribed":false},{"client_msg_id":"e344c586-6296-4218-bae3-97013d7d7417","type":"message","text":"This was the motivation for <https://github.com/JuliaDiff/ForwardDiff.jl/pull/495> , but no promise that it’ll actually work","user":"UD0NS8PDF","ts":"1613127787.369500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pGr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"This was the motivation for "},{"type":"link","url":"https://github.com/JuliaDiff/ForwardDiff.jl/pull/495"},{"type":"text","text":" , but no promise that it’ll actually work"}]}]}],"thread_ts":"1613127703.369400","parent_user_id":"UUMJUCYRK"},{"client_msg_id":"a5bc6696-4711-4334-bcc0-7c1d0e76d16a","type":"message","text":"Great, thanks, will give it a try to see if it works","user":"UUMJUCYRK","ts":"1613127907.369700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IhM9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Great, thanks, will give it a try to see if it works"}]}]}],"thread_ts":"1613127703.369400","parent_user_id":"UUMJUCYRK"},{"client_msg_id":"8f88b2ff-6a28-464c-acf3-68638092ce73","type":"message","text":"Some earlier bits were here: <https://discourse.julialang.org/t/forwarddiff-and-zygote-cannot-automatically-differentiate-ad-function-from-c-n-to-r-that-uses-fft/52440/18> . `Zygote.hessian` uses forwarddiff, but IIRC it needed a method like the `Zygote.extract(xs::AbstractArray{&lt;:Complex{&lt;:ForwardDiff.Dual{` one there, to allow complex numbers.","user":"UD0NS8PDF","ts":"1613128418.369900","team":"T68168MUP","edited":{"user":"UD0NS8PDF","ts":"1613128425.000000"},"blocks":[{"type":"rich_text","block_id":"lT3hS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Some earlier bits were here: "},{"type":"link","url":"https://discourse.julialang.org/t/forwarddiff-and-zygote-cannot-automatically-differentiate-ad-function-from-c-n-to-r-that-uses-fft/52440/18"},{"type":"text","text":" . "},{"type":"text","text":"Zygote.hessian","style":{"code":true}},{"type":"text","text":" uses forwarddiff, but IIRC it needed a method like the "},{"type":"text","text":"Zygote.extract(xs::AbstractArray{<:Complex{<:ForwardDiff.Dual{","style":{"code":true}},{"type":"text","text":" one there, to allow complex numbers."}]}]}],"thread_ts":"1613127703.369400","parent_user_id":"UUMJUCYRK"},{"client_msg_id":"0963d1ce-e98d-4866-833e-756a6dd1a85a","type":"message","text":"wow nice, with your PR and defining that `extract` method, the exact code I posted above works!","user":"UUMJUCYRK","ts":"1613129477.370300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cqT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"wow nice, with your PR and defining that "},{"type":"text","text":"extract","style":{"code":true}},{"type":"text","text":" method, the exact code I posted above works!"}]}]}],"thread_ts":"1613127703.369400","parent_user_id":"UUMJUCYRK","reactions":[{"name":"+1","users":["UD0NS8PDF","UKG4WF8PJ"],"count":2}]},{"client_msg_id":"a07896a8-08e0-4095-b2bd-133300777068","type":"message","text":"err sorry, rather\n```Zygote.hessian(((A,),) -&gt; real(sum(fft(A^2*x))), [1])```\nworks, same difference","user":"UUMJUCYRK","ts":"1613129567.370600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Y1Lad","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"err sorry, rather\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"Zygote.hessian(((A,),) -> real(sum(fft(A^2*x))), [1])"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"works, same difference"}]}]}],"thread_ts":"1613127703.369400","parent_user_id":"UUMJUCYRK"}]