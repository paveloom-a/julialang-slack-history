[{"client_msg_id":"002bf3a2-6c75-46da-b2a1-46266a8d892d","type":"message","text":"OS: Linux, Julia v\"1.3.0\"\n\nI'm trying to build binary of a Foo C/C++ package using `run_wizard()` And when I run\n```autoreconf -fiv\n./configure --prefix=${prefix} --build=${MACHTYPE} --host=${target}```\nI got this error `Configure has not found BLAS libraries for your system.  Please install BLAS or provide appropriate -l and -L flags to LIBS and LDFLAGS to allow configure to locate the dcopy function.`\nfrom BB troubleshooting (<https://docs.binarybuilder.org/dev/troubleshooting/#Libraries-of-the-dependencies-can't-be-found>)\nI added\n```export LDFLAGS=\"-L${libdir}\"\nexport LIBS=\"-l${libdir}\"```\nand ran `./configure...`\nagain. Now I am running into `C++ compiler cannot create executables` error.\nThe config.log has the following (looks like -V and -qversion are wrong flags\n```configure:4950: $? = 0\nconfigure:4939: c++ -v &gt;&amp;5\nUsing built-in specs.\nCOLLECT_GCC=/opt/x86_64-linux-gnu/bin/x86_64-linux-gnu-g++\nCOLLECT_LTO_WRAPPER=/opt/x86_64-linux-gnu/bin/../libexec/gcc/x86_64-linux-gnu/9.1.0/lto-wrapper\nTarget: x86_64-linux-gnu\nConfigured with: /workspace/srcdir/gcc-9.1.0/configure --prefix=/workspace/destdir --target=x86_64-linux-gnu --host=x86_64-linux-musl --build=x86_64-linux-musl --disable-multilib --disable-werror --enable-shared --enable-host-shared --enable-threads=posix --with-sysroot=/workspace/destdir/x86_64-linux-gnu/sys-root --program-prefix=x86_64-linux-gnu- --disable-bootstrap --with-arch=core2 --enable-languages=c,c++,fortran,objc,obj-c++\nThread model: posix\ngcc version 9.1.0 (GCC)\nconfigure:4950: $? = 0\nconfigure:4939: c++ -V &gt;&amp;5\nx86_64-linux-gnu-g++: error: unrecognized command line option '-V'\nx86_64-linux-gnu-g++: fatal error: no input files\ncompilation terminated.\nconfigure:4950: $? = 1\nconfigure:4939: c++ -qversion &gt;&amp;5\nx86_64-linux-gnu-g++: error: unrecognized command line option '-qversion'; did you mean '--version'?\nx86_64-linux-gnu-g++: fatal error: no input files\ncompilation terminated.\nconfigure:4950: $? = 1\nconfigure:4970: checking whether the C++ compiler works\nconfigure:4992: c++   -l/workspace/destdir/lib conftest.cpp -L/workspace/destdir/lib &gt;&amp;5\n/opt/x86_64-linux-gnu/bin/../lib/gcc/x86_64-linux-gnu/9.1.0/../../../../x86_64-linux-gnu/bin/ld: cannot find -l/workspace/destdir/lib\ncollect2: error: ld returned 1 exit status\nconfigure:4996: $? = 1\nconfigure:5034: result: no```\nFrom arch wiki <https://bbs.archlinux.org/viewtopic.php?id=163913> I see that this error is due to setting wrong ldflags.\n\nWhat can I do to resolve this error? Am I missing something?","user":"UN5FQHFNY","ts":"1611829978.140600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bgKFw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"OS: Linux, Julia v\"1.3.0\"\n\nI'm trying to build binary of a Foo C/C++ package using "},{"type":"text","text":"run_wizard()","style":{"code":true}},{"type":"text","text":" And when I run\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"autoreconf -fiv\n./configure --prefix=${prefix} --build=${MACHTYPE} --host=${target}"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"I got this error "},{"type":"text","text":"Configure has not found BLAS libraries for your system.  Please install BLAS or provide appropriate -l and -L flags to LIBS and LDFLAGS to allow configure to locate the dcopy function.","style":{"code":true}},{"type":"text","text":"\nfrom BB troubleshooting ("},{"type":"link","url":"https://docs.binarybuilder.org/dev/troubleshooting/#Libraries-of-the-dependencies-can't-be-found"},{"type":"text","text":")\nI added\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"export LDFLAGS=\"-L${libdir}\"\nexport LIBS=\"-l${libdir}\""}]},{"type":"rich_text_section","elements":[{"type":"text","text":"and ran "},{"type":"text","text":"./configure...","style":{"code":true}},{"type":"text","text":"\nagain. Now I am running into "},{"type":"text","text":"C++ compiler cannot create executables","style":{"code":true}},{"type":"text","text":" error.\nThe config.log has the following (looks like -V and -qversion are wrong flags\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"configure:4950: $? = 0\nconfigure:4939: c++ -v >&5\nUsing built-in specs.\nCOLLECT_GCC=/opt/x86_64-linux-gnu/bin/x86_64-linux-gnu-g++\nCOLLECT_LTO_WRAPPER=/opt/x86_64-linux-gnu/bin/../libexec/gcc/x86_64-linux-gnu/9.1.0/lto-wrapper\nTarget: x86_64-linux-gnu\nConfigured with: /workspace/srcdir/gcc-9.1.0/configure --prefix=/workspace/destdir --target=x86_64-linux-gnu --host=x86_64-linux-musl --build=x86_64-linux-musl --disable-multilib --disable-werror --enable-shared --enable-host-shared --enable-threads=posix --with-sysroot=/workspace/destdir/x86_64-linux-gnu/sys-root --program-prefix=x86_64-linux-gnu- --disable-bootstrap --with-arch=core2 --enable-languages=c,c++,fortran,objc,obj-c++\nThread model: posix\ngcc version 9.1.0 (GCC)\nconfigure:4950: $? = 0\nconfigure:4939: c++ -V >&5\nx86_64-linux-gnu-g++: error: unrecognized command line option '-V'\nx86_64-linux-gnu-g++: fatal error: no input files\ncompilation terminated.\nconfigure:4950: $? = 1\nconfigure:4939: c++ -qversion >&5\nx86_64-linux-gnu-g++: error: unrecognized command line option '-qversion'; did you mean '--version'?\nx86_64-linux-gnu-g++: fatal error: no input files\ncompilation terminated.\nconfigure:4950: $? = 1\nconfigure:4970: checking whether the C++ compiler works\nconfigure:4992: c++   -l/workspace/destdir/lib conftest.cpp -L/workspace/destdir/lib >&5\n/opt/x86_64-linux-gnu/bin/../lib/gcc/x86_64-linux-gnu/9.1.0/../../../../x86_64-linux-gnu/bin/ld: cannot find -l/workspace/destdir/lib\ncollect2: error: ld returned 1 exit status\nconfigure:4996: $? = 1\nconfigure:5034: result: no"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"From arch wiki "},{"type":"link","url":"https://bbs.archlinux.org/viewtopic.php?id=163913"},{"type":"text","text":" I see that this error is due to setting wrong ldflags.\n\nWhat can I do to resolve this error? Am I missing something?"}]}]}],"thread_ts":"1611829978.140600","reply_count":20,"reply_users_count":3,"latest_reply":"1611858545.152600","reply_users":["UDB26738Q","UN5FQHFNY","U01CH05FTMM"],"subscribed":false},{"client_msg_id":"28b1a3ca-d2cb-4cb9-a1db-40c05ea6bdb8","type":"message","text":"Patch the configure script not to use wrong flags? (why would they use non-existing flags in the first place?)","user":"UDB26738Q","ts":"1611830599.140700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"L9m","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Patch the configure script not to use wrong flags? (why would they use non-existing flags in the first place?)"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"7ff627c1-5881-4bd6-aa2b-fd88cec686be","type":"message","text":"Unrelated: why gcc 9? A c++ package built with gcc 9 won't likely work with any released Julia version","user":"UDB26738Q","ts":"1611830650.140900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yH7V","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Unrelated: why gcc 9? A c++ package built with gcc 9 won't likely work with any released Julia version"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"c5fd69f2-dd3c-4278-969f-f8268dc65f3e","type":"message","text":"^^ Oh I thought patching source file should be avoided.","user":"UN5FQHFNY","ts":"1611830716.141100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"raY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"^^ Oh I thought patching source file should be avoided."}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"d933269c-3452-434f-b833-c51d85caf5ee","type":"message","text":"^ Ah that i saw ` c++ -v &gt;&amp;5` in the log. So changed gcc to 9.0.1 from default 4.8.5 (thinking that was the problem)","user":"UN5FQHFNY","ts":"1611830761.141300","team":"T68168MUP","edited":{"user":"UN5FQHFNY","ts":"1611830783.000000"},"blocks":[{"type":"rich_text","block_id":"AV5Hb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"^ Ah that i saw ` c++ -v >&5` in the log. So changed gcc to 9.0.1 from default 4.8.5 (thinking that was the problem)"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"347fcc41-ac57-4ada-806e-d3ccbc8b4666","type":"message","text":"If the source code is wrong you can only patch it... :shrugging:","user":"UDB26738Q","ts":"1611830794.141600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gcjo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If the source code is wrong you can only patch it... "},{"type":"emoji","name":"shrugging"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"d3b97a46-4462-4416-8413-ef9b793672da","type":"message","text":"But I have no idea why they're doing something wrong, maybe there is something else","user":"UDB26738Q","ts":"1611830819.141800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"otL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But I have no idea why they're doing something wrong, maybe there is something else"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"0a4a3d7a-93f2-48ab-9ec2-e46b4a57eca0","type":"message","text":"^^ Ok I'll try making a patched config file.","user":"UN5FQHFNY","ts":"1611831084.142000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xreU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"^^ Ok I'll try making a patched config file."}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"99dc79e0-8cc9-4173-a8e8-7d4fdb15dbe6","type":"message","text":"^ Oh. I'll try to see what else might be the reason. Thank you","user":"UN5FQHFNY","ts":"1611831112.142200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+jlVM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"^ Oh. I'll try to see what else might be the reason. Thank you"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"2a172701-9dad-4476-bc3d-157aff93da24","type":"message","text":"That `export LIBS=\"-l${libdir}\"` is wrong, it should be either `-lsomelibrary` or just remove that variable","user":"U01CH05FTMM","ts":"1611831375.142400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"srsUO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That "},{"type":"text","text":"export LIBS=\"-l${libdir}\"","style":{"code":true}},{"type":"text","text":" is wrong, it should be either "},{"type":"text","text":"-lsomelibrary","style":{"code":true}},{"type":"text","text":" or just remove that variable"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"03c0bdff-9447-4ed6-a43e-ed24d35654a4","type":"message","text":"I changed it to `export LIBS=\"openblas-dev\"` and it seems to have solved some part of it. But the space before `-L/workspace...`  needs to go, which i don't know how\n```configure:4970: checking whether the C++ compiler works\nconfigure:4992: c++   -L/workspace/destdir/lib conftest.cpp -openblas-dev &gt;&amp;5\nconfigure:4996: $? = 0\nconfigure:5034: result: no```","user":"UN5FQHFNY","ts":"1611833753.142600","team":"T68168MUP","edited":{"user":"UN5FQHFNY","ts":"1611833795.000000"},"blocks":[{"type":"rich_text","block_id":"ITn","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I changed it to "},{"type":"text","text":"export LIBS=\"openblas-dev\"","style":{"code":true}},{"type":"text","text":" and it seems to have solved some part of it. But the space before "},{"type":"text","text":"-L/workspace...","style":{"code":true}},{"type":"text","text":"  needs to go, which i don't know how\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"configure:4970: checking whether the C++ compiler works\nconfigure:4992: c++   -L/workspace/destdir/lib conftest.cpp -openblas-dev >&5\nconfigure:4996: $? = 0\nconfigure:5034: result: no"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"eb014151-54d3-472c-9df6-cabc7a9106c4","type":"message","text":"`configure:4992: c++   -L/workspace/destdir/lib conftest.cpp -openblas-dev`\nspaces should not cause any issues, but `-openblas-dev` is still not a valid flag\nwhat happens if you remove the LIBS variable?\n(usually configure will determine what libs are needed and set the correct flags, ldflags is needed for binarybuilder in many cases because of the non-standard paths)","user":"U01CH05FTMM","ts":"1611835192.142900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5FS=V","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"configure:4992: c++   -L/workspace/destdir/lib conftest.cpp -openblas-dev","style":{"code":true}},{"type":"text","text":"\nspaces should not cause any issues, but "},{"type":"text","text":"-openblas-dev","style":{"code":true}},{"type":"text","text":" is still not a valid flag\nwhat happens if you remove the LIBS variable?\n(usually configure will determine what libs are needed and set the correct flags, ldflags is needed for binarybuilder in many cases because of the non-standard paths)"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY","reactions":[{"name":"+1","users":["UDB26738Q"],"count":1}]},{"client_msg_id":"08b82945-094b-40db-a52f-a89e73d2a90f","type":"message","text":"Without exporting LIBS i get `Configure has not found BLAS libraries for your system.  Please install BLAS or provide appropriate -l and -L flags to LIBS and LDFLAGS to allow configure to locate the dcopy function`  error. (Surprisingly not exporting ldflag doesnt throw this as long as LIBS is exported)\n\nThis is the <http://configure.ac|configure.ac> lines which throws that error. <https://github.com/Xyce/Xyce/blob/4e440501e5600ef8d6bdfd88ee0759783a5a3784/configure.ac#L512>","user":"UN5FQHFNY","ts":"1611835935.143200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ALLNx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Without exporting LIBS i get "},{"type":"text","text":"Configure has not found BLAS libraries for your system.  Please install BLAS or provide appropriate -l and -L flags to LIBS and LDFLAGS to allow configure to locate the dcopy function","style":{"code":true}},{"type":"text","text":"  error. (Surprisingly not exporting ldflag doesnt throw this as long as LIBS is exported)\n\nThis is the "},{"type":"link","url":"http://configure.ac","text":"configure.ac"},{"type":"text","text":" lines which throws that error. "},{"type":"link","url":"https://github.com/Xyce/Xyce/blob/4e440501e5600ef8d6bdfd88ee0759783a5a3784/configure.ac#L512"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"f7a2aaeb-d2cf-4d4f-a492-5e7207e42c40","type":"message","text":"This is the config.log <https://docs.google.com/document/d/1DWZ0tNj-6XWB582pCilUXqrcWQQvqf6ryqm3LNbeGrI/edit?usp=sharing>","user":"UN5FQHFNY","ts":"1611836176.143400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"AMh=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"This is the config.log "},{"type":"link","url":"https://docs.google.com/document/d/1DWZ0tNj-6XWB582pCilUXqrcWQQvqf6ryqm3LNbeGrI/edit?usp=sharing"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"7dcee2c2-badd-49f6-a0a5-26a9a6bb6dae","type":"message","text":"line 72 onwards the error can be seen","user":"UN5FQHFNY","ts":"1611836346.143600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Dq4u","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"line 72 onwards the error can be seen"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"face982e-0a59-47db-bddc-1bce73d2dc91","type":"message","text":"there is still LIBS set in that config.log\nplease try setting\n`LIBS=-lopenblas64_`\n(including that dash at the beginning and the underscore at the end)\nthis will not work on all platforms but should help for linux, you can then check other packages linking with openblas for details:\n<https://github.com/JuliaPackaging/Yggdrasil/search?q=openblas64_>\nso you will probably need a similiar if statement and then pass:\n`LIBS=-l${BLAS_NAME}`","user":"U01CH05FTMM","ts":"1611837446.143800","team":"T68168MUP","edited":{"user":"U01CH05FTMM","ts":"1611837460.000000"},"blocks":[{"type":"rich_text","block_id":"KrU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"there is still LIBS set in that config.log\nplease try setting\n"},{"type":"text","text":"LIBS=-lopenblas64_","style":{"code":true}},{"type":"text","text":"\n(including that dash at the beginning and the underscore at the end)\nthis will not work on all platforms but should help for linux, you can then check other packages linking with openblas for details:\n"},{"type":"link","url":"https://github.com/JuliaPackaging/Yggdrasil/search?q=openblas64_"},{"type":"text","text":"\nso you will probably need a similiar if statement and then pass:\n"},{"type":"text","text":"LIBS=-l${BLAS_NAME}","style":{"code":true}}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"f65476dc-f91a-4a0c-b3ad-76300ff4c224","type":"message","text":"Thanks <@U01CH05FTMM>. I'm using apk package manager it only has openblas-dev. So it couldn't locate -lopenblas64_. I am following the other examples to resolve this issue. Will get back once I figure it out.","user":"UN5FQHFNY","ts":"1611858011.151800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"O40","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks "},{"type":"user","user_id":"U01CH05FTMM"},{"type":"text","text":". I'm using apk package manager it only has openblas-dev. So it couldn't locate -lopenblas64_. I am following the other examples to resolve this issue. Will get back once I figure it out."}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"62ce8785-0eb8-42f6-8e72-e06fa85c25ec","type":"message","text":"`apk`?","user":"UDB26738Q","ts":"1611858074.152000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"afJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"apk","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"feef7a3f-3bcf-4bc7-a979-a8e88fc69a34","type":"message","text":"the alpine package manger","user":"UN5FQHFNY","ts":"1611858266.152200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"w4Wxg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the alpine package manger"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"899cbef5-39ea-40ac-86ff-c276386c8a7b","type":"message","text":"I know what it is, but I don't know what you're doing","user":"UDB26738Q","ts":"1611858354.152400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"islyz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I know what it is, but I don't know what you're doing"}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"},{"client_msg_id":"5508a06a-fefa-4be6-be1a-eabae13dca6d","type":"message","text":"It couldn't locate -lopenblas64 anywhere. Gave no such file error. So I tried `apk add openblas-dev` this exits with `1` but `result: no`","user":"UN5FQHFNY","ts":"1611858545.152600","team":"T68168MUP","edited":{"user":"UN5FQHFNY","ts":"1611858567.000000"},"blocks":[{"type":"rich_text","block_id":"EI9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It couldn't locate -lopenblas64 anywhere. Gave no such file error. So I tried "},{"type":"text","text":"apk add openblas-dev","style":{"code":true}},{"type":"text","text":" this exits with "},{"type":"text","text":"1","style":{"code":true}},{"type":"text","text":" but "},{"type":"text","text":"result: no","style":{"code":true}}]}]}],"thread_ts":"1611829978.140600","parent_user_id":"UN5FQHFNY"}]