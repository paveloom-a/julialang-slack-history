[{"client_msg_id":"6ec9d4b6-2622-4f85-a48b-8d9e3a5e3586","type":"message","text":"did anything changed in Julia v1.6 regarding `ARGS`?  we're getting meaningless\n````\nERROR: LoadError: UndefVarError: ARGS not defined```","user":"UDB26738Q","ts":"1613680388.470900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3Ui0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"did anything changed in Julia v1.6 regarding "},{"type":"text","text":"ARGS","style":{"code":true}},{"type":"text","text":"?  we're getting meaningless\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"`\nERROR: LoadError: UndefVarError: ARGS not defined"}]}]}],"thread_ts":"1613680388.470900","reply_count":24,"reply_users_count":2,"latest_reply":"1613688248.475700","reply_users":["U67SCG4HG","UDB26738Q"],"subscribed":false},{"client_msg_id":"b6c04ca6-29a1-4e1c-bbeb-790d1528baf8","type":"message","text":"<https://github.com/JuliaLang/julia/issues/39259|https://github.com/JuliaLang/julia/issues/39259> might be related","user":"U67SCG4HG","ts":"1613681984.471000","team":"T68168MUP","edited":{"user":"U67SCG4HG","ts":"1613682001.000000"},"blocks":[{"type":"rich_text","block_id":"GI=G","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/JuliaLang/julia/issues/39259","text":"https://github.com/JuliaLang/julia/issues/39259"},{"type":"text","text":" might be related"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"7632d829-b6de-4916-89a5-cd45acdebc2a","type":"message","text":"is it in rc1?","user":"UDB26738Q","ts":"1613682062.471300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"U90","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"is it in rc1?"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"7a59d8be-9778-438d-979d-e5ed535e4b19","type":"message","text":"The fix? Looks like it","user":"U67SCG4HG","ts":"1613682090.471500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Hk7B","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The fix? Looks like it"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"a4c6e3e7-332e-4b9a-9ceb-d76acb596269","type":"message","text":"then it must be different, we're running rc1 in Yggdrasil (and I can reproduce the issue also locally with my rc1)","user":"UDB26738Q","ts":"1613682120.471700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IElt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"then it must be different, we're running rc1 in Yggdrasil (and I can reproduce the issue also locally with my rc1)"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"92b02946-f7b0-465f-b610-7daf98266a15","type":"message","text":"Right but you might have relied on the bug then, it is present in 1.4, and 1.5 too","user":"U67SCG4HG","ts":"1613682152.471900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=tas","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Right but you might have relied on the bug then, it is present in 1.4, and 1.5 too"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"4cb8ae75-ab36-4eaf-a870-4b5fa1a82f2f","type":"message","text":"basically `ARGS` here gives the `UndefVarError`: <https://github.com/jstrube/Yggdrasil/blob/c9d50864b2dcb2bc0bcff0281cd529bdee9b233d/F/FastJet_Julia_Wrapper/build_tarballs.jl#L47>","user":"UDB26738Q","ts":"1613682231.472100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"stX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"basically "},{"type":"text","text":"ARGS","style":{"code":true}},{"type":"text","text":" here gives the "},{"type":"text","text":"UndefVarError","style":{"code":true}},{"type":"text","text":": "},{"type":"link","url":"https://github.com/jstrube/Yggdrasil/blob/c9d50864b2dcb2bc0bcff0281cd529bdee9b233d/F/FastJet_Julia_Wrapper/build_tarballs.jl#L47"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"f5e093c1-f3af-409f-b86d-39f3859bc0e6","type":"message","text":"(this happens without the `ARGS` at line 28)","user":"UDB26738Q","ts":"1613682255.472300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SNl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(this happens without the "},{"type":"text","text":"ARGS","style":{"code":true}},{"type":"text","text":" at line 28)"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"72dd1bf4-dbb1-4721-a5af-2ba6095341da","type":"message","text":"L28?","user":"U67SCG4HG","ts":"1613682261.472500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jwCm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"L28?"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"1e54e9cc-f7a3-4069-b266-e1f85f4f7270","type":"message","text":"it looks like the `include` makes the `ARGS` undefined","user":"UDB26738Q","ts":"1613682277.472700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2wu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it looks like the "},{"type":"text","text":"include","style":{"code":true}},{"type":"text","text":" makes the "},{"type":"text","text":"ARGS","style":{"code":true}},{"type":"text","text":" undefined"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"334a1712-53b0-4d8e-b5e5-28660a1780d2","type":"message","text":"You mean it doesn't resolve it when that file is `include`d?","user":"U67SCG4HG","ts":"1613682347.472900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Bys","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You mean it doesn't resolve it when that file is "},{"type":"text","text":"include","style":{"code":true}},{"type":"text","text":"d?"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"a13a5df1-3612-4865-b870-0103098724b1","type":"message","text":"yes","user":"UDB26738Q","ts":"1613682356.473100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yjSj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"ca31e926-3faf-4d36-a7af-954f5e0530a6","type":"message","text":"unless `ARGS` is referenced already before the `include`, hence why the workaround at line 28","user":"UDB26738Q","ts":"1613682376.473300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3L/s","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"unless "},{"type":"text","text":"ARGS","style":{"code":true}},{"type":"text","text":" is referenced already before the "},{"type":"text","text":"include","style":{"code":true}},{"type":"text","text":", hence why the workaround at line 28"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"bbfb9d13-9026-4b44-8024-ecfbed4e7b86","type":"message","text":"Okay, probably relied on that bug then since it was always resolved to `Base.ARGS` but I don't know why it happens.","user":"U67SCG4HG","ts":"1613682501.473500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Ot1fl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Okay, probably relied on that bug then since it was always resolved to "},{"type":"text","text":"Base.ARGS","style":{"code":true}},{"type":"text","text":" but I don't know why it happens."}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"54fe5658-8926-49eb-b93b-b6426aeb1179","type":"message","text":"<https://github.com/JuliaPackaging/BinaryBuilder.jl/blob/5a88b728fc16b7061c1d14de2f0b726bc492f3e6/src/AutoBuild.jl#L132> does this look dodgy?","user":"UDB26738Q","ts":"1613682625.473700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kWDTN","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/JuliaPackaging/BinaryBuilder.jl/blob/5a88b728fc16b7061c1d14de2f0b726bc492f3e6/src/AutoBuild.jl#L132"},{"type":"text","text":" does this look dodgy?"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"9dd46953-556b-4cb7-9726-cd9b4fe094a9","type":"message","text":"but no, `ARGS` is an argument, so shouldn't be too dodgy","user":"UDB26738Q","ts":"1613683040.473900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"O+AW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but no, "},{"type":"text","text":"ARGS","style":{"code":true}},{"type":"text","text":" is an argument, so shouldn't be too dodgy"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"8e6d5904-a188-40dd-911f-7e1d591c1752","type":"message","text":"it works if I use `Base.ARGS`","user":"UDB26738Q","ts":"1613683193.474100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sSJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it works if I use "},{"type":"text","text":"Base.ARGS","style":{"code":true}}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"18626e68-c7d3-42b6-a72f-02cc19f17331","type":"message","text":"but `Main.ARGS` is undefined.  what's the difference?","user":"UDB26738Q","ts":"1613683265.474300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"viP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but "},{"type":"text","text":"Main.ARGS","style":{"code":true}},{"type":"text","text":" is undefined.  what's the difference?"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"13a25d73-fa6b-43ce-9155-2cf12f9b60e9","type":"message","text":"`ARGS` in `Main` should not be resolved to `Base.ARGS` until \"first use\"","user":"U67SCG4HG","ts":"1613684210.474500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7796","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ARGS","style":{"code":true}},{"type":"text","text":" in "},{"type":"text","text":"Main","style":{"code":true}},{"type":"text","text":" should not be resolved to "},{"type":"text","text":"Base.ARGS","style":{"code":true}},{"type":"text","text":" until \"first use\""}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"690bb36b-2f78-404b-8146-da2af2e6dbd1","type":"message","text":"I can't come up with a reproducer. Do you ahve a link to a CI failure?","user":"U67SCG4HG","ts":"1613685716.474700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sXdsG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I can't come up with a reproducer. Do you ahve a link to a CI failure?"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"4591b015-6bdf-4196-9c17-6ecc4902439e","type":"message","text":"<https://dev.azure.com/JuliaPackaging/Yggdrasil/_build/results?buildId=9170&amp;view=logs&amp;j=96c13d9d-dfd2-51e5-2f76-4a0b3ce09abc&amp;t=09532434-8b0a-5f0e-118d-a3181cde5ec8|https://dev.azure.com/JuliaPackaging/Yggdrasil/_build/results?buildId=9170&amp;view=logs&amp;j=96c13d9d-dfd2-51e5-2f76-4a0b3ce09abc&amp;t=09532434-8b0a-5f0e-118d-a3181cde5ec8>","user":"UDB26738Q","ts":"1613687345.474900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"v1H/","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://dev.azure.com/JuliaPackaging/Yggdrasil/_build/results?buildId=9170&view=logs&j=96c13d9d-dfd2-51e5-2f76-4a0b3ce09abc&t=09532434-8b0a-5f0e-118d-a3181cde5ec8","text":"https://dev.azure.com/JuliaPackaging/Yggdrasil/_build/results?buildId=9170&view=logs&j=96c13d9d-dfd2-51e5-2f76-4a0b3ce09abc&t=09532434-8b0a-5f0e-118d-a3181cde5ec8"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"95467a05-861d-4517-89a8-d31a9c0e95b0","type":"message","text":"Corresponding build_tarballs <https://github.com/JuliaPackaging/Yggdrasil/blob/685552d6d8d7b3e72adc1580dfb2bbddba1fde3b/F/FastJet_Julia_Wrapper/build_tarballs.jl|https://github.com/JuliaPackaging/Yggdrasil/blob/685552d6d8d7b3e72adc1580dfb2bbddba1fde3b/F/FastJet_Julia_Wrapper/build_tarballs.jl>","user":"UDB26738Q","ts":"1613687378.475100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YEQTY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Corresponding build_tarballs "},{"type":"link","url":"https://github.com/JuliaPackaging/Yggdrasil/blob/685552d6d8d7b3e72adc1580dfb2bbddba1fde3b/F/FastJet_Julia_Wrapper/build_tarballs.jl","text":"https://github.com/JuliaPackaging/Yggdrasil/blob/685552d6d8d7b3e72adc1580dfb2bbddba1fde3b/F/FastJet_Julia_Wrapper/build_tarballs.jl"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"2619fddf-f7b2-4af7-83cf-5f285e10bf53","type":"message","text":"<https://github.com/JuliaPackaging/Yggdrasil/blob/1aa0ca50d15ecbbc30834dd871a4dd810f0e3426/L/libjulia/common.jl#L276> uhmmm","user":"UDB26738Q","ts":"1613687984.475300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Ejg","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/JuliaPackaging/Yggdrasil/blob/1aa0ca50d15ecbbc30834dd871a4dd810f0e3426/L/libjulia/common.jl#L276"},{"type":"text","text":" uhmmm"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"fa94d71a-c0af-4b6d-9a80-cf75229f3b6a","type":"message","text":"that seems to be the culprit.  if I remove that line and add an `ARGS` argument to the script, it works","user":"UDB26738Q","ts":"1613688073.475500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Sj3iw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that seems to be the culprit.  if I remove that line and add an "},{"type":"text","text":"ARGS","style":{"code":true}},{"type":"text","text":" argument to the script, it works"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"},{"client_msg_id":"dc041763-4691-4d1a-a932-0ad49f746177","type":"message","text":"ok, I have a small reproducer.  `foo.jl`\n```include(\"bar.jl\")\nARGS```\n`bar.jl`:\n```function args()\n    global ARGS\n    ARGS\nend```\noutput:\n```% julia-master foo.jl these are the arguments\nERROR: LoadError: UndefVarError: ARGS not defined\nin expression starting at /tmp/foo.jl:2```","user":"UDB26738Q","ts":"1613688248.475700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"k5ae","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ok, I have a small reproducer.  "},{"type":"text","text":"foo.jl","style":{"code":true}},{"type":"text","text":"\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"include(\"bar.jl\")\nARGS"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"bar.jl","style":{"code":true}},{"type":"text","text":":\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function args()\n    global ARGS\n    ARGS\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"output:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"% julia-master foo.jl these are the arguments\nERROR: LoadError: UndefVarError: ARGS not defined\nin expression starting at /tmp/foo.jl:2"}]}]}],"thread_ts":"1613680388.470900","parent_user_id":"UDB26738Q"}]