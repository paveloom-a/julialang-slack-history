[{"client_msg_id":"12b6d840-4b7a-4323-8964-56bf97a56326","type":"message","text":"so, besides the broken macOS shards, the main problem I'm having for `HostBuildDependency` is this: <https://github.com/JuliaPackaging/BinaryBuilderBase.jl/pull/43/files#diff-48f90c9f7d86cf3e80c85fa66b31702f51d91cb8f6ce531575d7cc1f85f200f9R518> now we have platform-specific prefixes, and I've added a `platform` argument to `cleanup_dependencies` so the it cleans up only the dependencies for the given platform, but when the wizard needs to cleanup doesn't always know the platforms.  passing the platforms around would be quite a bit work.  is there any problem if we just cleanup everything in `prefix`, instead of `prefix/triplet/destdir`?","user":"UDB26738Q","ts":"1611702823.105500","team":"T68168MUP","edited":{"user":"UDB26738Q","ts":"1611702863.000000"},"blocks":[{"type":"rich_text","block_id":"z9gm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so, besides the broken macOS shards, the main problem I'm having for "},{"type":"text","text":"HostBuildDependency","style":{"code":true}},{"type":"text","text":" is this: "},{"type":"link","url":"https://github.com/JuliaPackaging/BinaryBuilderBase.jl/pull/43/files#diff-48f90c9f7d86cf3e80c85fa66b31702f51d91cb8f6ce531575d7cc1f85f200f9R518"},{"type":"text","text":" now we have platform-specific prefixes, and I've added a "},{"type":"text","text":"platform","style":{"code":true}},{"type":"text","text":" argument to "},{"type":"text","text":"cleanup_dependencies","style":{"code":true}},{"type":"text","text":" so the it cleans up only the dependencies for the given platform, but when the wizard needs to cleanup doesn't always know the platforms.  passing the platforms around would be quite a bit work.  is there any problem if we just cleanup everything in "},{"type":"text","text":"prefix","style":{"code":true}},{"type":"text","text":", instead of "},{"type":"text","text":"prefix/triplet/destdir","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1611702823.105500","reply_count":4,"reply_users_count":2,"latest_reply":"1611771731.115700","reply_users":["UDB26738Q","U66GD0880"],"subscribed":false},{"client_msg_id":"9d6de722-f00f-4589-a078-125deb57322a","type":"message","text":"or maybe look for all `prefix/*/destdir`?","user":"UDB26738Q","ts":"1611703535.105700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"n=k9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"or maybe look for all "},{"type":"text","text":"prefix/*/destdir","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1611702823.105500","parent_user_id":"UDB26738Q"},{"client_msg_id":"0fe657b2-c81b-4055-8be0-29cb563c3884","type":"message","text":"<@U66GD0880> opinions? :grin:","user":"UDB26738Q","ts":"1611705036.105900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"mFr","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U66GD0880"},{"type":"text","text":" opinions? "},{"type":"emoji","name":"grin"}]}]}],"thread_ts":"1611702823.105500","parent_user_id":"UDB26738Q"},{"client_msg_id":"D5022F96-4603-4EBD-B848-44271E95FFC9","type":"message","text":"I think we should be able to always clean the whole prefix","user":"U66GD0880","ts":"1611721961.106500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1FG6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think we should be able to always clean the whole prefix"}]}]}],"thread_ts":"1611702823.105500","parent_user_id":"UDB26738Q"},{"client_msg_id":"da6f29cc-9c53-4c96-a5da-8cf974342901","type":"message","text":"so like this:\n```function cleanup_dependencies(prefix::Prefix, artifact_paths)\n    for art_path in artifact_paths\n        # Unsymlink all destdirs within the prefix\n        for dir in readdir(prefix)\n            destdir = joinpath(dir, \"destdir\")\n            if isdir(destdir)\n                unsymlink_tree(art_path, destdir)\n            end\n        end\n    end\nend```\n?","user":"UDB26738Q","ts":"1611771731.115700","team":"T68168MUP","edited":{"user":"UDB26738Q","ts":"1611772003.000000"},"blocks":[{"type":"rich_text","block_id":"ti7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so like this:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function cleanup_dependencies(prefix::Prefix, artifact_paths)\n    for art_path in artifact_paths\n        # Unsymlink all destdirs within the prefix\n        for dir in readdir(prefix)\n            destdir = joinpath(dir, \"destdir\")\n            if isdir(destdir)\n                unsymlink_tree(art_path, destdir)\n            end\n        end\n    end\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"?"}]}]}],"thread_ts":"1611702823.105500","parent_user_id":"UDB26738Q"}]