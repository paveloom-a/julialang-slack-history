[{"client_msg_id":"1c6b55c2-d612-4b61-8561-3cd2609322f7","type":"message","text":"Hi, I'm using `NelderMead` from Optim.jl. The function calls are very slow so I'd like to do the optimization in multiple parts; is there a way to save a simplex and continue from there? Using the last optimum as the new starting point doesn't work that well.","user":"UCB7L9W49","ts":"1615806082.093200","team":"T68168MUP","edited":{"user":"UCB7L9W49","ts":"1615807488.000000"},"blocks":[{"type":"rich_text","block_id":"q7mQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi, I'm using "},{"type":"text","text":"NelderMead","style":{"code":true}},{"type":"text","text":" from Optim.jl. The function calls are very slow so I'd like to do the optimization in multiple parts; is there a way to save a simplex and continue from there? Using the last optimum as the new starting point doesn't work that well."}]}]}],"thread_ts":"1615806082.093200","reply_count":21,"reply_users_count":3,"latest_reply":"1615905374.005100","reply_users":["UDSG73JTH","UCB7L9W49","U6CJRSR63"],"subscribed":false},{"client_msg_id":"cea11215-17fe-439b-8d10-dd2087a0a714","type":"message","text":"You might find it easier to work with <https://github.com/jwscook/NelderMead.jl>","user":"UDSG73JTH","ts":"1615808377.093400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LtKo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You might find it easier to work with "},{"type":"link","url":"https://github.com/jwscook/NelderMead.jl"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"df342215-85e7-42b5-a5c8-14973bddfe4e","type":"message","text":"How would I do it with that package? I wasn't able to find any documentation, unfortunately.","user":"UCB7L9W49","ts":"1615810069.093600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HeoU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How would I do it with that package? I wasn't able to find any documentation, unfortunately."}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"0a57a391-42cd-418b-9a70-f0812ba1e15a","type":"message","text":"If you construct a Simplex via <https://github.com/jwscook/NelderMead.jl/blob/69feeb60bd5612fcc18f8b4c526b428934b41c57/src/Simplexes.jl#L22> then you can call the optimisation via <https://github.com/jwscook/NelderMead.jl/blob/master/src/NelderMead.jl#L107>","user":"UDSG73JTH","ts":"1615811520.093800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"JgV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If you construct a Simplex via "},{"type":"link","url":"https://github.com/jwscook/NelderMead.jl/blob/69feeb60bd5612fcc18f8b4c526b428934b41c57/src/Simplexes.jl#L22"},{"type":"text","text":" then you can call the optimisation via "},{"type":"link","url":"https://github.com/jwscook/NelderMead.jl/blob/master/src/NelderMead.jl#L107"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"e7580cf9-6b20-46a9-8486-171570c515da","type":"message","text":"NLSolvers.jl outputs convergence info that contains the simplex, and you can pass that into a new call instead of a single state .. <https://github.com/JuliaNLSolvers/NLSolvers.jl/blob/master/src/optimize/directsearch/neldermead.jl>","user":"U6CJRSR63","ts":"1615819105.094600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"k8+Q","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"NLSolvers.jl outputs convergence info that contains the simplex, and you can pass that into a new call instead of a single state .. "},{"type":"link","url":"https://github.com/JuliaNLSolvers/NLSolvers.jl/blob/master/src/optimize/directsearch/neldermead.jl"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"2e6d8fc7-07ff-4edc-b8b3-bb146fe3d90f","type":"message","text":"Thanks for the tip. This doesn't work with Optim? I know you can get the simplex but I don't know how to stick it back in there again. Or is it better to switch to NLSolvers anyway (that is supposed to be the Optim successor, right?)?","user":"UCB7L9W49","ts":"1615819714.094800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aUhT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks for the tip. This doesn't work with Optim? I know you can get the simplex but I don't know how to stick it back in there again. Or is it better to switch to NLSolvers anyway (that is supposed to be the Optim successor, right?)?"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"df23832e-0559-4a01-9711-e83e2268d1ac","type":"message","text":"I think you can do it in Optim if you pass the initial state, yes","user":"U6CJRSR63","ts":"1615820279.095400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"S2u2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think you can do it in Optim if you pass the initial state, yes"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"9350d826-6a2b-49dd-89bc-c6b40616c910","type":"message","text":"It's a bit undocumented, but I use it internally in Fminbox","user":"U6CJRSR63","ts":"1615820296.095600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"b16o1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It's a bit undocumented, but I use it internally in Fminbox"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"db80a6ad-ae8b-4f3f-8262-5c3a872c6c79","type":"message","text":"NLSolvers is the successor code, but you know... busy at work :slightly_smiling_face:","user":"U6CJRSR63","ts":"1615820324.095800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9JlY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"NLSolvers is the successor code, but you know... busy at work "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"c74ca70c-94ac-4245-8790-64bc6945ee33","type":"message","text":"```julia&gt; using NelderMead\n\njulia&gt; function rosenbrocknd(x)\n         ithterm(i) = (1 - x[i])^2 + 100 * (x[i+1] - x[i]^2)^2\n         return mapreduce(ithterm, +, 1:length(x)-1)\n       end\nrosenbrocknd (generic function with 1 method)\n\njulia&gt; simplex = NelderMead.Simplex(rosenbrocknd, [[0.0, 0.0], [0.0, 1.0], [1.0, 0.0]])\nNelderMead.Simplex{Float64, Float64}(NelderMead.Vertex{Float64, Float64}[NelderMead.Vertex{Float64, Float64}([0.0, 0.0], 1.0), NelderMead.Vertex{Float64, Float64}([1.0, 0.0], 100.0), NelderMead.Vertex{Float64, Float64}([0.0, 1.0], 101.0)])\n\njulia&gt; NelderMead.optimise(rosenbrocknd, simplex)\n(3.319096403946775e-9, [1.0000062305014783, 1.0000181884122503], :STOPVAL_REACHED, 67)\n\njulia&gt; simplex\nNelderMead.Simplex{Float64, Float64}(NelderMead.Vertex{Float64, Float64}[NelderMead.Vertex{Float64, Float64}([1.0000062305014783, 1.0000181884122503], 3.319096403946775e-9), NelderMead.Vertex{Float64, Float64}([1.0001959544077672, 1.0003930790734006], 3.8526240569630584e-8), NelderMead.Vertex{Float64, Float64}([1.0001691720751302, 1.000320522393765], 6.048278221867266e-8)])```","user":"UDSG73JTH","ts":"1615821663.096000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5T5O","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> using NelderMead\n\njulia> function rosenbrocknd(x)\n         ithterm(i) = (1 - x[i])^2 + 100 * (x[i+1] - x[i]^2)^2\n         return mapreduce(ithterm, +, 1:length(x)-1)\n       end\nrosenbrocknd (generic function with 1 method)\n\njulia> simplex = NelderMead.Simplex(rosenbrocknd, [[0.0, 0.0], [0.0, 1.0], [1.0, 0.0]])\nNelderMead.Simplex{Float64, Float64}(NelderMead.Vertex{Float64, Float64}[NelderMead.Vertex{Float64, Float64}([0.0, 0.0], 1.0), NelderMead.Vertex{Float64, Float64}([1.0, 0.0], 100.0), NelderMead.Vertex{Float64, Float64}([0.0, 1.0], 101.0)])\n\njulia> NelderMead.optimise(rosenbrocknd, simplex)\n(3.319096403946775e-9, [1.0000062305014783, 1.0000181884122503], :STOPVAL_REACHED, 67)\n\njulia> simplex\nNelderMead.Simplex{Float64, Float64}(NelderMead.Vertex{Float64, Float64}[NelderMead.Vertex{Float64, Float64}([1.0000062305014783, 1.0000181884122503], 3.319096403946775e-9), NelderMead.Vertex{Float64, Float64}([1.0001959544077672, 1.0003930790734006], 3.8526240569630584e-8), NelderMead.Vertex{Float64, Float64}([1.0001691720751302, 1.000320522393765], 6.048278221867266e-8)])"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"e183fff6-fcba-42c7-8b03-5563f05784fe","type":"message","text":"A better function signature would be `optimise!(simplex::Simplex, objective::Function; kwargs...)`","user":"UDSG73JTH","ts":"1615821728.096200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2F9L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"A better function signature would be "},{"type":"text","text":"optimise!(simplex::Simplex, objective::Function; kwargs...)","style":{"code":true}}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"248234ff-bf3c-48d4-9ea6-f536aa008199","type":"message","text":"Thanks for both of your help, I'll see if I can get it working for me.\nOut of curiosity James, was there any specific reason you decided to implement your own NelderMead instead of using an existing one?","user":"UCB7L9W49","ts":"1615876028.000100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Aqz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks for both of your help, I'll see if I can get it working for me.\nOut of curiosity James, was there any specific reason you decided to implement your own NelderMead instead of using an existing one?"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"3daec372-a7c8-439e-9ce5-eba6306a2af2","type":"message","text":"My problem was hanging in Optim.jl and I couldn’t figure it out. I wanted to learn more about it so wrote my own, which ended up being neater (imo) than that in Optim.jl largely because Optim.jl has to fit all the algos under one API.\n\nAlso, in the end I wrote <https://github.com/jwscook/WindingNelderMead.jl> which bought me about a factor of 10 speed up because my problem is 1) very expensive, 2) complex valued and 3) has minima at zero.","user":"UDSG73JTH","ts":"1615901143.002600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jEk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"My problem was hanging in Optim.jl and I couldn’t figure it out. I wanted to learn more about it so wrote my own, which ended up being neater (imo) than that in Optim.jl largely because Optim.jl has to fit all the algos under one API.\n\nAlso, in the end I wrote "},{"type":"link","url":"https://github.com/jwscook/WindingNelderMead.jl"},{"type":"text","text":" which bought me about a factor of 10 speed up because my problem is 1) very expensive, 2) complex valued and 3) has minima at zero."}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"35fa67ab-e3f0-4a6f-a124-731795146a3f","type":"message","text":"Interesting, thanks for the insight! I'll give it a shot and see how it goes.","user":"UCB7L9W49","ts":"1615904651.003400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"I1gQl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Interesting, thanks for the insight! I'll give it a shot and see how it goes."}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"7902e0e5-de31-4feb-9e16-351e15269bef","type":"message","text":"What's the issue with minima at zero? Isn't that just because you pass in a different simplex to begin with?","user":"U6CJRSR63","ts":"1615904749.003600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GSc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What's the issue with minima at zero? Isn't that just because you pass in a different simplex to begin with?"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"55018972-83e5-4848-8787-88dffc19aa74","type":"message","text":"I never got to the bottom of it. The function I have is incredibly steep sided, so it’s likely to be something to do with that. Using the winding number of the simplex to ascertain whether a zero is enclosed fixed that problem. A hybrid method is really effective. If a root is not enclosed by the simplex then use Nelder Mead on the absolute value of the function. If a root is enclosed, then bifurcate the simplex until a suitable resolution is reached.","user":"UDSG73JTH","ts":"1615905067.003800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qss","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I never got to the bottom of it. The function I have is incredibly steep sided, so it’s likely to be something to do with that. Using the winding number of the simplex to ascertain whether a zero is enclosed fixed that problem. A hybrid method is really effective. If a root is not enclosed by the simplex then use Nelder Mead on the absolute value of the function. If a root is enclosed, then bifurcate the simplex until a suitable resolution is reached."}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"458ef377-8cb9-4aea-baa2-c4e8083d8a8c","type":"message","text":"Are you using it for rootfinding?","user":"U6CJRSR63","ts":"1615905125.004000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NDTW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Are you using it for rootfinding?"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"363db265-708b-499d-b8d3-d5919f08bff0","type":"message","text":"Yes","user":"UDSG73JTH","ts":"1615905135.004200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GnHX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"91a9bd30-9562-4758-ad79-1e980a162ee5","type":"message","text":"and were you minimizing `g(x) = ||F(x)||` or something like thta?","user":"U6CJRSR63","ts":"1615905207.004400","team":"T68168MUP","edited":{"user":"U6CJRSR63","ts":"1615905232.000000"},"blocks":[{"type":"rich_text","block_id":"Xy7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and were you minimizing "},{"type":"text","text":"g(x) = ||F(x)||","style":{"code":true}},{"type":"text","text":" or something like thta?"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"7fbb7e2d-8fe6-4369-a70d-3366dd5c8985","type":"message","text":"where F is some some system?","user":"U6CJRSR63","ts":"1615905260.004700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4PR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"where F is some some system?"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"b2051fe8-f5eb-42ab-b043-b416d57698f8","type":"message","text":"Yep `abs(det(F))` where F is a 3x3 complex values matrix","user":"UDSG73JTH","ts":"1615905284.004900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CqinW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yep "},{"type":"text","text":"abs(det(F))","style":{"code":true}},{"type":"text","text":" where F is a 3x3 complex values matrix"}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"},{"client_msg_id":"41cbf500-46eb-464e-a5cc-34b100ce0eb5","type":"message","text":"or simply `det(F)`  where complex values are handled.","user":"UDSG73JTH","ts":"1615905374.005100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"j9Rvf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"or simply "},{"type":"text","text":"det(F)","style":{"code":true}},{"type":"text","text":"  where complex values are handled."}]}]}],"thread_ts":"1615806082.093200","parent_user_id":"UCB7L9W49"}]