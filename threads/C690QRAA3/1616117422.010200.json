[{"type":"message","text":"Question regarding Zygote.jl.  Any help is appreciated.\n\nHow do we handle sparse data when calculating the gradients? I get the following error:","files":[{"id":"F01RT1AB3GA","created":1616117418,"timestamp":1616117418,"name":"image.png","title":"image.png","mimetype":"image/png","filetype":"png","pretty_type":"PNG","user":"U0158N77PFT","editable":false,"size":44225,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01RT1AB3GA/image.png","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01RT1AB3GA/download/image.png","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01RT1AB3GA-bfd395b484/image_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01RT1AB3GA-bfd395b484/image_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01RT1AB3GA-bfd395b484/image_360.png","thumb_360_w":360,"thumb_360_h":55,"thumb_480":"https://files.slack.com/files-tmb/T68168MUP-F01RT1AB3GA-bfd395b484/image_480.png","thumb_480_w":480,"thumb_480_h":74,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01RT1AB3GA-bfd395b484/image_160.png","thumb_720":"https://files.slack.com/files-tmb/T68168MUP-F01RT1AB3GA-bfd395b484/image_720.png","thumb_720_w":720,"thumb_720_h":111,"thumb_800":"https://files.slack.com/files-tmb/T68168MUP-F01RT1AB3GA-bfd395b484/image_800.png","thumb_800_w":800,"thumb_800_h":123,"thumb_960":"https://files.slack.com/files-tmb/T68168MUP-F01RT1AB3GA-bfd395b484/image_960.png","thumb_960_w":960,"thumb_960_h":148,"thumb_1024":"https://files.slack.com/files-tmb/T68168MUP-F01RT1AB3GA-bfd395b484/image_1024.png","thumb_1024_w":1024,"thumb_1024_h":158,"original_w":1091,"original_h":168,"thumb_tiny":"AwAHADCrkYpOKSimAvHr+lB20lFABx70ce9JRQB//9k=","permalink":"https://julialang.slack.com/files/U0158N77PFT/F01RT1AB3GA/image.png","permalink_public":"https://slack-files.com/T68168MUP-F01RT1AB3GA-67a083f35b","is_starred":false,"has_rich_preview":false}],"upload":false,"blocks":[{"type":"rich_text","block_id":"NMm/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Question regarding Zygote.jl.  Any help is appreciated.\n\nHow do we handle sparse data when calculating the gradients? I get the following error:"}]}]}],"user":"U0158N77PFT","display_as_bot":false,"ts":"1616117422.010200","edited":{"user":"U0158N77PFT","ts":"1616117456.000000"},"thread_ts":"1616117422.010200","reply_count":4,"reply_users_count":3,"latest_reply":"1616168143.011800","reply_users":["U01SFUPBJ9E","UH24GRBLL","U0158N77PFT"],"subscribed":false},{"client_msg_id":"23b7ce17-97e5-44c4-bb7c-836c3f9fa32d","type":"message","text":"Looks like the output of your function is a 1x1 vector (e.g. [0.0]). Can you make it a scalar instead? (e.g. 0.0)","user":"U01SFUPBJ9E","ts":"1616119423.010700","team":"T68168MUP","edited":{"user":"U01SFUPBJ9E","ts":"1616119641.000000"},"blocks":[{"type":"rich_text","block_id":"=5J","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Looks like the output of your function is a 1x1 vector (e.g. [0.0]). Can you make it a scalar instead? (e.g. 0.0)"}]}]}],"thread_ts":"1616117422.010200","parent_user_id":"U0158N77PFT"},{"client_msg_id":"5ab1faa6-2ae7-4f00-9d40-730d0b6867d6","type":"message","text":"For example, the following won't work (using Zygote's gradient) because the output is a Vector:\n```gradient(b -&gt; [b], 0.0)```\nBut the following will work because the output is a scalar:\n```gradient(b -&gt; b, 0.0)```","user":"U01SFUPBJ9E","ts":"1616119576.010900","team":"T68168MUP","edited":{"user":"U01SFUPBJ9E","ts":"1616119888.000000"},"blocks":[{"type":"rich_text","block_id":"8NQIi","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For example, the following won't work (using Zygote's gradient) because the output is a Vector:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"gradient(b -> [b], 0.0)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nBut the following will work because the output is a scalar:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"gradient(b -> b, 0.0)"}]}]}],"thread_ts":"1616117422.010200","parent_user_id":"U0158N77PFT","reactions":[{"name":"+1","users":["U0158N77PFT"],"count":1}]},{"client_msg_id":"824ab509-b54c-4a32-b8b9-6856961b1b94","type":"message","text":"Not sure why you think this is related to sparsity?","user":"UH24GRBLL","ts":"1616142696.011400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WJ7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Not sure why you think this is related to sparsity?"}]}]}],"thread_ts":"1616117422.010200","parent_user_id":"U0158N77PFT","reactions":[{"name":"+1","users":["U0158N77PFT"],"count":1}]},{"type":"message","text":"Thank you both for the feedback/questions - it led me to go back and retrace my steps.\n\nI have code that uses Zygote.jl to find the first row (81 terms) in an 6,561 element complex valued matrix. Long story, but I'm attempting to recover a unitary operator based on a set of complex valued input/output column vectors. Anyway, for this first effort I have dense data and everything went according to plan.\n\nFor the next experiment, I wanted to use sparse complex valued data to see how well I could recover the 6,561 element complex valued matrix. Another problem with this sparse data is that on average it's also orders of magnitude smaller than the previous data set. So I added SparseArrays.jl to clean the data up a bit (i.e., make values &lt; 1e-5 equal zero), but then when I went to run the code I got the error I posted previously.\n\nSo I went back to my old working code with the non-sparse data and got the same error (see below). Anyway, I removed SparseArrays.jl and all is well.\n\nThank you again for the comment and feedback!\n\nI did find what I believe to be a bug though between Zygote.jl and SparseArrays.jl -- or it could just be an emergent property of my crappy Julia proficiency.","files":[{"id":"F01RVMAS9DH","created":1616168077,"timestamp":1616168077,"name":"image.png","title":"image.png","mimetype":"image/png","filetype":"png","pretty_type":"PNG","user":"U0158N77PFT","editable":false,"size":44935,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01RVMAS9DH/image.png","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01RVMAS9DH/download/image.png","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01RVMAS9DH-9737bd14d0/image_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01RVMAS9DH-9737bd14d0/image_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01RVMAS9DH-9737bd14d0/image_360.png","thumb_360_w":360,"thumb_360_h":49,"thumb_480":"https://files.slack.com/files-tmb/T68168MUP-F01RVMAS9DH-9737bd14d0/image_480.png","thumb_480_w":480,"thumb_480_h":65,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01RVMAS9DH-9737bd14d0/image_160.png","thumb_720":"https://files.slack.com/files-tmb/T68168MUP-F01RVMAS9DH-9737bd14d0/image_720.png","thumb_720_w":720,"thumb_720_h":97,"thumb_800":"https://files.slack.com/files-tmb/T68168MUP-F01RVMAS9DH-9737bd14d0/image_800.png","thumb_800_w":800,"thumb_800_h":108,"thumb_960":"https://files.slack.com/files-tmb/T68168MUP-F01RVMAS9DH-9737bd14d0/image_960.png","thumb_960_w":960,"thumb_960_h":130,"thumb_1024":"https://files.slack.com/files-tmb/T68168MUP-F01RVMAS9DH-9737bd14d0/image_1024.png","thumb_1024_w":1024,"thumb_1024_h":138,"original_w":1088,"original_h":147,"thumb_tiny":"AwAGADCr2oxRS9qYCYFBAFLTW6UAJkelHHvSUUAf/9k=","permalink":"https://julialang.slack.com/files/U0158N77PFT/F01RVMAS9DH/image.png","permalink_public":"https://slack-files.com/T68168MUP-F01RVMAS9DH-433c00d2d0","is_starred":false,"has_rich_preview":false}],"upload":false,"blocks":[{"type":"rich_text","block_id":"s4o","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thank you both for the feedback/questions - it led me to go back and retrace my steps.\n\nI have code that uses Zygote.jl to find the first row (81 terms) in an 6,561 element complex valued matrix. Long story, but I'm attempting to recover a unitary operator based on a set of complex valued input/output column vectors. Anyway, for this first effort I have dense data and everything went according to plan.\n\nFor the next experiment, I wanted to use sparse complex valued data to see how well I could recover the 6,561 element complex valued matrix. Another problem with this sparse data is that on average it's also orders of magnitude smaller than the previous data set. So I added SparseArrays.jl to clean the data up a bit (i.e., make values < 1e-5 equal zero), but then when I went to run the code I got the error I posted previously.\n\nSo I went back to my old working code with the non-sparse data and got the same error (see below). Anyway, I removed SparseArrays.jl and all is well.\n\nThank you again for the comment and feedback!\n\nI did find what I believe to be a bug though between Zygote.jl and SparseArrays.jl -- or it could just be an emergent property of my crappy Julia proficiency."}]}]}],"user":"U0158N77PFT","display_as_bot":false,"ts":"1616168143.011800","edited":{"user":"U0158N77PFT","ts":"1616168318.000000"},"thread_ts":"1616117422.010200","parent_user_id":"U0158N77PFT","reactions":[{"name":"+1","users":["U01SFUPBJ9E"],"count":1}]}]