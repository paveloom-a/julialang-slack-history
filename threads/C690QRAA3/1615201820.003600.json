[{"client_msg_id":"f292845c-8ed0-417e-bd9d-cc949d87dc52","type":"message","text":"Hi everyone,\nI have a question for my neural ODE which is :\n```\nfunction dudt2(u,p,t)\n  FastChain(\n        (u,p) -&gt; ifelse(t &lt;= tc, c_int , 0) .- u,\n            FastDense(1, 2, tanh),\n        FastDense(2, 1))\nend\n\n\nfunction neural_ode_f(u,p,t)\n  FastChain((u,p) -&gt; ifelse(t &lt;= tc,c_int , 0) .- u,\n        FastDense(1, 2, tanh),\n        FastDense(2, 1))(u,p)\nend\n\npinit = initial_params(dudt2(u0,p_start,tbegin))\nprob = ODEProblem(neural_ode_f, u0, tspan, pinit)```\n\nDo you think that it understand the parameters p to learn ? Like this ODE \n```\nfunction odeTK(du, u, p,t)\n    if t &lt;= tc\n        du[1] = p[1]*c_int - p[2]u[1]\n    else t &gt; tc\n        du[1] = -p[2]*(u[1])\n    end\nend```\nAnd I’m not sure that it understand the if condition, because the result as the same when I only use\n\n```\nfunction dudt2(u,p,t)\n  FastChain(\n        (u,p) -&gt; c_int .- u,\n            FastDense(1, 2, tanh),\n        FastDense(2, 1))\nend\n\n\nfunction neural_ode_f(u,p,t)\n  FastChain((u,p) -&gt; c_int .- u,\n        FastDense(1, 2, tanh),\n        FastDense(2, 1))(u,p)\nend\n\npinit = initial_params(dudt2(u0,p_start,tbegin))\nprob = ODEProblem(neural_ode_f, u0, tspan, pinit)```\nThank you for your help :smile:","user":"U01NRTNRCDV","ts":"1615201820.003600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KI2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi everyone,\nI have a question for my neural ODE which is :\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"\nfunction dudt2(u,p,t)\n  FastChain(\n        (u,p) -> ifelse(t <= tc, c_int , 0) .- u,\n            FastDense(1, 2, tanh),\n        FastDense(2, 1))\nend\n\n\nfunction neural_ode_f(u,p,t)\n  FastChain((u,p) -> ifelse(t <= tc,c_int , 0) .- u,\n        FastDense(1, 2, tanh),\n        FastDense(2, 1))(u,p)\nend\n\npinit = initial_params(dudt2(u0,p_start,tbegin))\nprob = ODEProblem(neural_ode_f, u0, tspan, pinit)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\n\nDo you think that it understand the parameters p to learn ? Like this ODE \n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"\nfunction odeTK(du, u, p,t)\n    if t <= tc\n        du[1] = p[1]*c_int - p[2]u[1]\n    else t > tc\n        du[1] = -p[2]*(u[1])\n    end\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nAnd I’m not sure that it understand the if condition, because the result as the same when I only use\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"\nfunction dudt2(u,p,t)\n  FastChain(\n        (u,p) -> c_int .- u,\n            FastDense(1, 2, tanh),\n        FastDense(2, 1))\nend\n\n\nfunction neural_ode_f(u,p,t)\n  FastChain((u,p) -> c_int .- u,\n        FastDense(1, 2, tanh),\n        FastDense(2, 1))(u,p)\nend\n\npinit = initial_params(dudt2(u0,p_start,tbegin))\nprob = ODEProblem(neural_ode_f, u0, tspan, pinit)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Thank you for your help "},{"type":"emoji","name":"smile"}]}]}],"thread_ts":"1615201820.003600","reply_count":8,"reply_users_count":3,"latest_reply":"1615221215.005800","reply_users":["UNG2XJJP3","U01NRTNRCDV","UDFRYRTBL"],"subscribed":false},{"client_msg_id":"e69fd889-ddad-48fd-85d1-807da1d3075c","type":"message","text":"Does your loss get decreased? The ifelse func is just a deterministic pre-conditioning and no NN parameters get trained there. I see no reason why it doesn’t understand.","user":"UNG2XJJP3","ts":"1615202403.003700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Swlss","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does your loss get decreased? The ifelse func is just a deterministic pre-conditioning and no NN parameters get trained there. I see no reason why it doesn’t understand."}]}]}],"thread_ts":"1615201820.003600","parent_user_id":"U01NRTNRCDV"},{"client_msg_id":"ae49c2e7-868f-4671-ad5f-7b773f1a9e77","type":"message","text":"Yes, it get decreased, but it stagnates at one after 300 epochs","user":"U01NRTNRCDV","ts":"1615209568.004300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HXg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes, it get decreased, but it stagnates at one after 300 epochs"}]}]}],"thread_ts":"1615201820.003600","parent_user_id":"U01NRTNRCDV"},{"type":"message","text":"It's my result :","files":[{"id":"F01R73NSMNU","created":1615209584,"timestamp":1615209584,"name":"image.png","title":"image.png","mimetype":"image/png","filetype":"png","pretty_type":"PNG","user":"U01NRTNRCDV","editable":false,"size":32049,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01R73NSMNU/image.png","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01R73NSMNU/download/image.png","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01R73NSMNU-ee76afbc99/image_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01R73NSMNU-ee76afbc99/image_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01R73NSMNU-ee76afbc99/image_360.png","thumb_360_w":360,"thumb_360_h":240,"thumb_480":"https://files.slack.com/files-tmb/T68168MUP-F01R73NSMNU-ee76afbc99/image_480.png","thumb_480_w":480,"thumb_480_h":320,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01R73NSMNU-ee76afbc99/image_160.png","original_w":654,"original_h":436,"thumb_tiny":"AwAgADDSHXrS4pO/aj8aAD60tHPrSY96ABs4+XrSDOeaXmgfWgA6HpS0nQ9KM+xoAWikz7GjPsaAFoxSZ9jS59qAP//Z","permalink":"https://julialang.slack.com/files/U01NRTNRCDV/F01R73NSMNU/image.png","permalink_public":"https://slack-files.com/T68168MUP-F01R73NSMNU-4e2fac9724","is_starred":false,"has_rich_preview":false}],"upload":false,"blocks":[{"type":"rich_text","block_id":"s/Ymq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It's my result :"}]}]}],"user":"U01NRTNRCDV","display_as_bot":false,"ts":"1615209587.004500","thread_ts":"1615201820.003600","parent_user_id":"U01NRTNRCDV"},{"client_msg_id":"bede6ac3-de4c-4f36-b2e6-17140063cbbd","type":"message","text":"after 900 epochs\nI tried to change my NN architecture, but the result was still the same","user":"U01NRTNRCDV","ts":"1615209693.004900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ej49","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"after 900 epochs\nI tried to change my NN architecture, but the result was still the same"}]}]}],"thread_ts":"1615201820.003600","parent_user_id":"U01NRTNRCDV"},{"client_msg_id":"00615bcf-8db3-4e02-b56b-514f5b6ceb65","type":"message","text":"Hmm, maybe it gets stuck in a local minimum. Try fitting over fewer time steps first, and then gradually increase.","user":"UDFRYRTBL","ts":"1615218138.005200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E9u","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmm, maybe it gets stuck in a local minimum. Try fitting over fewer time steps first, and then gradually increase."}]}]}],"thread_ts":"1615201820.003600","parent_user_id":"U01NRTNRCDV"},{"client_msg_id":"aef752da-5da8-4de6-8346-eb6897f80af4","type":"message","text":"So you think it's the architecture of my network that is not adapted to my data?","user":"U01NRTNRCDV","ts":"1615219405.005400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"20u","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So you think it's the architecture of my network that is not adapted to my data?"}]}]}],"thread_ts":"1615201820.003600","parent_user_id":"U01NRTNRCDV"},{"client_msg_id":"4676b070-282f-43f2-bb9e-d47bd5369ad9","type":"message","text":"It could happen. I’m not sure about your data and your c_int. Have you tested the FastChain without initial condition, does it converge?","user":"UNG2XJJP3","ts":"1615220895.005600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Qf4P","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It could happen. I’m not sure about your data and your c_int. Have you tested the FastChain without initial condition, does it converge?"}]}]}],"thread_ts":"1615201820.003600","parent_user_id":"U01NRTNRCDV"},{"client_msg_id":"acb1dde0-d6ee-4fd6-97e6-5279565e4f58","type":"message","text":"No I didn't do that,...\n when you talk about the initial condition, did you mean u0 or pinit?","user":"U01NRTNRCDV","ts":"1615221215.005800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"11Fbm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No I didn't do that,...\n when you talk about the initial condition, did you mean u0 or pinit?"}]}]}],"thread_ts":"1615201820.003600","parent_user_id":"U01NRTNRCDV"}]