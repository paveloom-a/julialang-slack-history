[{"client_msg_id":"b724f2a9-9eb1-4ac4-9e20-800b3e8bc928","type":"message","text":"Am I missing something about scoping when defining macros across workers? This fails\n```using Distributed \naddprocs()\n\n@everywhere begin \n    using AWS: @service\n    @service S3\nend\n\nERROR: On worker 2:\nLoadError: UndefVarError: @service not defined\ntop-level scope\neval at ./boot.jl:331\n#103 at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/process_messages.jl:290\nrun_work_thunk at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/process_messages.jl:79\nrun_work_thunk at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/process_messages.jl:88\n#96 at ./task.jl:356\nin expression starting at REPL[3]:3\n\n...and 11 more exception(s).\n\nStacktrace:\n [1] sync_end(::Channel{Any}) at ./task.jl:314\n [2] macro expansion at ./task.jl:333 [inlined]\n [3] remotecall_eval(::Module, ::Array{Int64,1}, ::Expr) at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/macros.jl:218\n [4] top-level scope at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/macros.jl:202```\nbut this works\n```using Distributed\naddprocs()\n@everywhere using AWS: @service \n@everywhere @service S3```","user":"UNH0PT5D3","ts":"1614116007.001800","team":"T68168MUP","edited":{"user":"UNH0PT5D3","ts":"1614116115.000000"},"blocks":[{"type":"rich_text","block_id":"DL13","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Am I missing something about scoping when defining macros across workers? This fails\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"using Distributed \naddprocs()\n\n@everywhere begin \n    using AWS: @service\n    @service S3\nend\n\nERROR: On worker 2:\nLoadError: UndefVarError: @service not defined\ntop-level scope\neval at ./boot.jl:331\n#103 at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/process_messages.jl:290\nrun_work_thunk at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/process_messages.jl:79\nrun_work_thunk at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/process_messages.jl:88\n#96 at ./task.jl:356\nin expression starting at REPL[3]:3\n\n...and 11 more exception(s).\n\nStacktrace:\n [1] sync_end(::Channel{Any}) at ./task.jl:314\n [2] macro expansion at ./task.jl:333 [inlined]\n [3] remotecall_eval(::Module, ::Array{Int64,1}, ::Expr) at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/macros.jl:218\n [4] top-level scope at /buildworker/worker/package_linux64/build/usr/share/julia/stdlib/v1.5/Distributed/src/macros.jl:202"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"but this works\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"using Distributed\naddprocs()\n@everywhere using AWS: @service \n@everywhere @service S3"}]}]}],"thread_ts":"1614116007.001800","reply_count":3,"reply_users_count":2,"latest_reply":"1614122442.002800","reply_users":["UCZ7VBGUD","UNH0PT5D3"],"subscribed":false},{"client_msg_id":"48655306-6d30-4f21-b64e-54f75e29bf76","type":"message","text":"`@everywhere` defines special behavior for running imports first (ref <https://github.com/JuliaLang/julia/blob/788b2c77c10c2160f4794a4d4b6b81a95a90940c/stdlib/Distributed/src/macros.jl#L198>), maybe that’s somehow interfering?","user":"UCZ7VBGUD","ts":"1614122068.002000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fac","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"@everywhere","style":{"code":true}},{"type":"text","text":" defines special behavior for running imports first (ref "},{"type":"link","url":"https://github.com/JuliaLang/julia/blob/788b2c77c10c2160f4794a4d4b6b81a95a90940c/stdlib/Distributed/src/macros.jl#L198"},{"type":"text","text":"), maybe that’s somehow interfering?"}]}]}],"thread_ts":"1614116007.001800","parent_user_id":"UNH0PT5D3"},{"client_msg_id":"CDCE1B39-99C8-4DF6-9ADD-E11F8F6E87DF","type":"message","text":"Okay that makes some sense, thanks!","user":"UNH0PT5D3","ts":"1614122393.002600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1T5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Okay that makes some sense, thanks!"}]}]}],"thread_ts":"1614116007.001800","parent_user_id":"UNH0PT5D3"},{"client_msg_id":"04f92f7d-7c1f-4f35-a453-854b99fd7d8d","type":"message","text":"yeah, I’m not totally sure it solves it though because I’d think that would just mean it calls `using AWS: @service` first before calling the other stuff but that should be OK since that’s the order you’re doing it in anyway aha","user":"UCZ7VBGUD","ts":"1614122442.002800","team":"T68168MUP","edited":{"user":"UCZ7VBGUD","ts":"1614122479.000000"},"blocks":[{"type":"rich_text","block_id":"wnl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah, I’m not totally sure it solves it though because I’d think that would just mean it calls "},{"type":"text","text":"using AWS: @service","style":{"code":true}},{"type":"text","text":" first before calling the other stuff but that should be OK since that’s the order you’re doing it in anyway aha"}]}]}],"thread_ts":"1614116007.001800","parent_user_id":"UNH0PT5D3"}]