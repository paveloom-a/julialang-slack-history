[{"client_msg_id":"bde65b7a-3593-476c-9b4f-ba0933285a21","type":"message","text":"```function spring_mass_damper_system(;name)\n  @variables x(t)\n  D = Differential(t)\n  @parameters M b k\n  eqs = [D(D(x)) ~ b/M*D(x) + k/M*x] # equations defining the system\n  iv = t # the independent variable\n  states = [x] # the dependent (state) variables\n  ps = [M, b, k] # parameter variables\n  default_u0 = [D(x) =&gt; 0.0, x =&gt; 0.0] # default initial conditions\n  default_p = [M =&gt; 1.0, b =&gt; 1.0, k =&gt; 1.0] # default parameter values\n  sys = ODESystem(eqs, iv, states, ps, name=name, default_u0=default_u0, default_p=default_p)\n  ode_order_lowering(sys)\nend\n\nfunction spring_mass_damper_problem()\n  @named smd_sys = spring_mass_damper_system()\n  @show smd_sys\n  u0 = [] # initial conditions (empty = use defaults)\n  tspan = (0, 10.0) # time span\n  u0_kludge = Vector{Pair{Num, Float64}}() # <https://github.com/SciML/ModelingToolkit.jl/issues/869>\n  prob = ODEProblem(smd_sys, u0_kludge, tspan)\n  # return prob\n  sol = solve(prob, Tsit5())\nend\n\nsol = spring_mass_damper_problem()```\nGives me\n\n```ERROR: MethodError: no method matching promote_typeof()\nClosest candidates are:\n  promote_typeof(::Any) at promotion.jl:271\n  promote_typeof(::Any, ::Any...) at promotion.jl:272\nStacktrace:\n  [1] varmap_to_vars(varmap::Dict{Num, Float64}, varlist::Vector{Term{Real, Nothing}}; defaults::Dict{Any, Any})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/variables.jl:15\n  [2] varmap_to_vars\n    @ ~/.julia/dev/ModelingToolkit/src/variables.jl:8 [inlined]\n  [3] #varmap_to_vars#11\n    @ ~/.julia/dev/ModelingToolkit/src/variables.jl:28 [inlined]\n  [4] (::ModelingToolkit.var\"#varmap_to_vars##kw\")(::NamedTuple{(:defaults,), Tuple{Dict{Any, Any}}}, ::typeof(ModelingToolkit.varmap_to_vars), varmap::Vector{Pair{Num, Float64}}, varlist::Vector{Term{Real, Nothing}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/variables.jl:27\n  [5] process_DEProblem(constructor::Type, sys::ODESystem, u0map::Vector{Pair{Num, Float64}}, parammap::SciMLBase.NullParameters; version::Nothing, tgrad::Bool, jac::Bool, checkbounds::Bool, sparse::Bool, simplify::Bool, linenumbers::Bool, parallel::Symbolics.SerialForm, eval_expression::Bool, kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:277\n  [6] process_DEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:271 [inlined]\n  [7] (ODEProblem{true, tType, isinplace, P, F, K, PT} where {tType, isinplace, P, F, K, PT})(sys::ODESystem, u0map::Vector{Pair{Num, Float64}}, tspan::Tuple{Int64, Float64}, parammap::SciMLBase.NullParameters; kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323\n  [8] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323 [inlined]\n  [9] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323 [inlined]\n [10] #ODEProblem#162\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:303 [inlined]\n [11] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:303 [inlined]\n [12] spring_mass_damper_problem()\n    @ Main ~/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:78\n [13] top-level scope\n    @ ~/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:83\nin expression starting at /Users/patrick/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:83```\n","user":"U7ZNTQFLH","ts":"1615764328.128200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TO754","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function spring_mass_damper_system(;name)\n  @variables x(t)\n  D = Differential(t)\n  @parameters M b k\n  eqs = [D(D(x)) ~ b/M*D(x) + k/M*x] # equations defining the system\n  iv = t # the independent variable\n  states = [x] # the dependent (state) variables\n  ps = [M, b, k] # parameter variables\n  default_u0 = [D(x) => 0.0, x => 0.0] # default initial conditions\n  default_p = [M => 1.0, b => 1.0, k => 1.0] # default parameter values\n  sys = ODESystem(eqs, iv, states, ps, name=name, default_u0=default_u0, default_p=default_p)\n  ode_order_lowering(sys)\nend\n\nfunction spring_mass_damper_problem()\n  @named smd_sys = spring_mass_damper_system()\n  @show smd_sys\n  u0 = [] # initial conditions (empty = use defaults)\n  tspan = (0, 10.0) # time span\n  u0_kludge = Vector{Pair{Num, Float64}}() # "},{"type":"link","url":"https://github.com/SciML/ModelingToolkit.jl/issues/869"},{"type":"text","text":"\n  prob = ODEProblem(smd_sys, u0_kludge, tspan)\n  # return prob\n  sol = solve(prob, Tsit5())\nend\n\nsol = spring_mass_damper_problem()"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nGives me\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: MethodError: no method matching promote_typeof()\nClosest candidates are:\n  promote_typeof(::Any) at promotion.jl:271\n  promote_typeof(::Any, ::Any...) at promotion.jl:272\nStacktrace:\n  [1] varmap_to_vars(varmap::Dict{Num, Float64}, varlist::Vector{Term{Real, Nothing}}; defaults::Dict{Any, Any})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/variables.jl:15\n  [2] varmap_to_vars\n    @ ~/.julia/dev/ModelingToolkit/src/variables.jl:8 [inlined]\n  [3] #varmap_to_vars#11\n    @ ~/.julia/dev/ModelingToolkit/src/variables.jl:28 [inlined]\n  [4] (::ModelingToolkit.var\"#varmap_to_vars##kw\")(::NamedTuple{(:defaults,), Tuple{Dict{Any, Any}}}, ::typeof(ModelingToolkit.varmap_to_vars), varmap::Vector{Pair{Num, Float64}}, varlist::Vector{Term{Real, Nothing}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/variables.jl:27\n  [5] process_DEProblem(constructor::Type, sys::ODESystem, u0map::Vector{Pair{Num, Float64}}, parammap::SciMLBase.NullParameters; version::Nothing, tgrad::Bool, jac::Bool, checkbounds::Bool, sparse::Bool, simplify::Bool, linenumbers::Bool, parallel::Symbolics.SerialForm, eval_expression::Bool, kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:277\n  [6] process_DEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:271 [inlined]\n  [7] (ODEProblem{true, tType, isinplace, P, F, K, PT} where {tType, isinplace, P, F, K, PT})(sys::ODESystem, u0map::Vector{Pair{Num, Float64}}, tspan::Tuple{Int64, Float64}, parammap::SciMLBase.NullParameters; kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323\n  [8] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323 [inlined]\n  [9] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323 [inlined]\n [10] #ODEProblem#162\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:303 [inlined]\n [11] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:303 [inlined]\n [12] spring_mass_damper_problem()\n    @ Main ~/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:78\n [13] top-level scope\n    @ ~/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:83\nin expression starting at /Users/patrick/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:83"}]},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1615764328.128200","reply_count":16,"reply_users_count":3,"latest_reply":"1615768157.133500","reply_users":["U69BL50BF","U6788D83U","U7ZNTQFLH"],"subscribed":false},{"client_msg_id":"b062c486-7f70-4617-979f-9b02fd93d613","type":"message","text":"<@U6788D83U> <https://github.com/SciML/ModelingToolkit.jl/blob/master/src/systems/diffeqs/first_order_transform.jl#L10>","user":"U69BL50BF","ts":"1615766477.130400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EkkI","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U6788D83U"},{"type":"text","text":" "},{"type":"link","url":"https://github.com/SciML/ModelingToolkit.jl/blob/master/src/systems/diffeqs/first_order_transform.jl#L10"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"f5673e06-d686-488d-8dbb-c4afc3577b56","type":"message","text":"it's dropping the other information","user":"U69BL50BF","ts":"1615766482.130600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fzS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it's dropping the other information"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"c202103e-b057-49de-9ef5-48c123639cb5","type":"message","text":"what did you use instead of `remake`, setfield!?","user":"U69BL50BF","ts":"1615766494.130800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"I4XD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what did you use instead of "},{"type":"text","text":"remake","style":{"code":true}},{"type":"text","text":", setfield!?"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"867778b8-c157-42bc-8993-236f57bdde06","type":"message","text":"Yeah","user":"U6788D83U","ts":"1615766558.131000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"m53E","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"84002396-a638-4078-80a5-8fa572571b4e","type":"message","text":"can you tackle that really quickly?","user":"U69BL50BF","ts":"1615766584.131200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YH0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"can you tackle that really quickly?"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"4d59623b-985f-49bd-b6fa-8780dbee312e","type":"message","text":"I have some stuff open to make autoswitch better :slightly_smiling_face:","user":"U69BL50BF","ts":"1615766592.131400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jXaZb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have some stuff open to make autoswitch better "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"8f3f4be2-93b4-4762-8cec-3aaac2135a07","type":"message","text":"Is the order lowering required? I tried without but got a different error","user":"U7ZNTQFLH","ts":"1615766599.131600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kPz6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is the order lowering required? I tried without but got a different error"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"b7c02d62-88be-4c2a-bcb3-bf2122e6eeff","type":"message","text":"Can you open an issue?","user":"U69BL50BF","ts":"1615767213.131800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yrF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Can you open an issue?"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"1ebf7ad5-af45-473d-9d40-15850ae60651","type":"message","text":"Sure","user":"U7ZNTQFLH","ts":"1615767245.132000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DledJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Sure"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"beae410c-ab8b-4a36-a733-b0ac12002c4c","type":"message","text":"Fixed <https://github.com/SciML/ModelingToolkit.jl/pull/888>","user":"U6788D83U","ts":"1615767639.132200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gieiR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Fixed "},{"type":"link","url":"https://github.com/SciML/ModelingToolkit.jl/pull/888"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"30c03fd9-f268-4c19-b4a6-dad65b5adf61","type":"message","text":"BTW, I am pretty sure you meant to write\n```eqs = [D(D(x)) ~ -b/M*D(x) - k/M*x]```\nif you want a damped mass-spring system","user":"U6788D83U","ts":"1615767685.132400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kNv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"BTW, I am pretty sure you meant to write\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"eqs = [D(D(x)) ~ -b/M*D(x) - k/M*x]"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"if you want a damped mass-spring system"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"5cd4c208-8d02-4d31-82db-f3721d4ce240","type":"message","text":"Oh yeah the signs are incorrect, I'd originally written everything on the lhs (and didn't divide through by M) but it didn't like that.","user":"U7ZNTQFLH","ts":"1615767777.132600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ujV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Oh yeah the signs are incorrect, I'd originally written everything on the lhs (and didn't divide through by M) but it didn't like that."}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"bb7fb77a-0ede-4aff-b0b0-1980a65be499","type":"message","text":"Oh nice, I'll try that branch!","user":"U7ZNTQFLH","ts":"1615768021.132800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZN6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Oh nice, I'll try that branch!"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"cafa4aa1-f42f-4220-9ee4-c12d7012ea2d","type":"message","text":"That's a lucky PR number too :slightly_smiling_face:","user":"U7ZNTQFLH","ts":"1615768050.133000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"x3af","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That's a lucky PR number too "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"7421d820-dbcf-4fc0-be6b-f8df528795f3","type":"message","text":"Haha, are you aware of Chinese numerology? <https://en.wikipedia.org/wiki/Chinese_numerology#Eight>","user":"U6788D83U","ts":"1615768125.133200","team":"T68168MUP","attachments":[{"image_url":"https://upload.wikimedia.org/wikipedia/commons/d/d4/ShanghaiMissingFloors.jpg","image_width":280,"image_height":504,"image_bytes":31810,"title":"Chinese numerology","title_link":"https://en.wikipedia.org/wiki/Chinese_numerology#Eight","from_url":"https://en.wikipedia.org/wiki/Chinese_numerology#Eight","author_name":"Wikipedia","author_link":"https://en.wikipedia.org/","text":"In Chinese tradition, certain numbers are believed by some to be auspicious (吉利, pinyin: jílì; Cantonese Yale: gātleih) or inauspicious (不吉, pinyin: bùjí; Cantonese Yale: bātgāt) based on the Chinese word that the number sounds similar to. The numbers 3, 5,and 8, are generally considered to be auspicious, while 4 is considered inauspicious.","fallback":"wikipedia: Chinese numerology","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/wikipedia.png","id":1,"original_url":"https://en.wikipedia.org/wiki/Chinese_numerology#Eight"}],"blocks":[{"type":"rich_text","block_id":"8hQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Haha, are you aware of Chinese numerology? "},{"type":"link","url":"https://en.wikipedia.org/wiki/Chinese_numerology#Eight"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"},{"client_msg_id":"7b9b68e5-b04b-43ef-8965-39d6ca2dac51","type":"message","text":"Superficially, yeah","user":"U7ZNTQFLH","ts":"1615768157.133500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lH4N","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Superficially, yeah"}]}]}],"thread_ts":"1615764328.128200","parent_user_id":"U7ZNTQFLH"}]