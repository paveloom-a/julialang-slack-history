[{"client_msg_id":"9ef17720-74b9-4d57-8ff5-8990cd6a2e67","type":"message","text":"that other solver, what is the local tolerance it's able to achieve?","user":"U69BL50BF","ts":"1614086572.092300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E66","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that other solver, what is the local tolerance it's able to achieve?"}]}]}],"thread_ts":"1614086572.092300","reply_count":41,"reply_users_count":2,"latest_reply":"1614278753.195100","reply_users":["U01H36BUDJB","U69BL50BF"],"subscribed":false},{"client_msg_id":"71b7028a-0a7c-4831-93ec-9b0d7656530a","type":"message","text":"Looking at the code, it seems to use a custom convergence criterion. It iterates until the enthalpy and enthalpy inverse functions are invertible within some tolerance of about 10^-3.","user":"U01H36BUDJB","ts":"1614086730.093200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HMg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Looking at the code, it seems to use a custom convergence criterion. It iterates until the enthalpy and enthalpy inverse functions are invertible within some tolerance of about 10^-3."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"54df3b92-6750-4455-84fc-b1367c8c4fcb","type":"message","text":"no, not the convergence criteria","user":"U69BL50BF","ts":"1614086749.093400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6C+E","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"no, not the convergence criteria"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"eeafbfc5-d7bf-485e-9854-34e29a5a0d1a","type":"message","text":"after the step, how much error does u(t+dt) have?","user":"U69BL50BF","ts":"1614086760.093600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Nx0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"after the step, how much error does u(t+dt) have?"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"3e21bfbb-c649-445f-9e23-f87bac7cea5c","type":"message","text":"good question...","user":"U01H36BUDJB","ts":"1614086799.093800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CZreJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"good question..."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"d48e67f0-49b1-468a-aac0-edbf8a32ca7b","type":"message","text":"let me try to figure it out","user":"U01H36BUDJB","ts":"1614086804.094000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5E7=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"let me try to figure it out"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"a2fd94d3-0b17-41b2-9360-df072261f133","type":"message","text":"A second order method most likely is rejecting to small time steps to achieve the step tolerance, not because of Newton divergence.","user":"U69BL50BF","ts":"1614086928.094200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hLC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"A second order method most likely is rejecting to small time steps to achieve the step tolerance, not because of Newton divergence."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"73f7d910-cbc2-46d7-bc2c-b200e2823b97","type":"message","text":"Oh. Well the warning I get says \"Newton steps could not converge ...\"","user":"U01H36BUDJB","ts":"1614087319.097300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"exzH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Oh. Well the warning I get says \"Newton steps could not converge ...\""}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"8ed4efd9-94ed-468b-b821-9fe0ab625df9","type":"message","text":"when?","user":"U69BL50BF","ts":"1614087342.097500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"JEN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"when?"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"7cc632c0-64de-450e-89da-503081569fae","type":"message","text":"what do you mean when? like after how many time steps?","user":"U01H36BUDJB","ts":"1614087375.097700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"F8R","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what do you mean when? like after how many time steps?"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"a091ec8b-1369-4e6f-b051-3ea9a1a4648a","type":"message","text":"no, lik","user":"U69BL50BF","ts":"1614087428.097900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"itVs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"no, lik"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"c8c8fe33-c751-4253-b484-8e7f2ceef65c","type":"message","text":"with Trapezoid when tolerance is decreased","user":"U69BL50BF","ts":"1614087435.098100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nAt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"with Trapezoid when tolerance is decreased"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"3e1b27ed-ed90-471b-8f8d-5c54eed7c458","type":"message","text":"or something","user":"U69BL50BF","ts":"1614087437.098300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"b8T","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"or something"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"c7738b65-2d84-496f-ada1-10b96f53ec65","type":"message","text":"I have no idea what was ran :rolling_on_the_floor_laughing:","user":"U69BL50BF","ts":"1614087442.098500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sGte","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have no idea what was ran "},{"type":"emoji","name":"rolling_on_the_floor_laughing"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"75761392-a1fa-46ea-9692-72815e31bcf0","type":"message","text":"yeah sorry... I think I got those warnings with `ImplicitMidpoint`","user":"U01H36BUDJB","ts":"1614087456.098700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aW0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah sorry... I think I got those warnings with "},{"type":"text","text":"ImplicitMidpoint","style":{"code":true}}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"e6278e16-24c3-4658-9443-a37b031667b8","type":"message","text":"I wouldn't use ImplicitMidpoint unless you're really looking for the symplectic property.","user":"U69BL50BF","ts":"1614087492.098900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GO/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I wouldn't use ImplicitMidpoint unless you're really looking for the symplectic property."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"6c6cf11c-22fc-4ee9-adec-a8a57d5c5875","type":"message","text":"decreasing `abstol` on Trapezoid for some reason doesn't speed anything up, which surprised me.","user":"U01H36BUDJB","ts":"1614087493.099100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VCEv+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"decreasing "},{"type":"text","text":"abstol","style":{"code":true}},{"type":"text","text":" on Trapezoid for some reason doesn't speed anything up, which surprised me."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"d0cf7600-e617-49f7-abcf-61e75520fba6","type":"message","text":"I'm not,  I just wanted something implicit and non-adaptive.","user":"U01H36BUDJB","ts":"1614087505.099300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e3xc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm not,  I just wanted something implicit and non-adaptive."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"13b80bfd-c373-47c8-af10-409cd2b897b2","type":"message","text":"if you set `adaptive=false` you can force anything to be non-adaptive","user":"U69BL50BF","ts":"1614087532.099500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ffsv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"if you set "},{"type":"text","text":"adaptive=false","style":{"code":true}},{"type":"text","text":" you can force anything to be non-adaptive"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF","reactions":[{"name":"+1","users":["U01H36BUDJB"],"count":1}]},{"client_msg_id":"211899e0-55d2-44dd-977a-dd54b499460e","type":"message","text":"but it's still going to be quasi-Newton, which might not be a good thing.","user":"U69BL50BF","ts":"1614087541.099800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5K1Tn","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but it's still going to be quasi-Newton, which might not be a good thing."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"bb1fcedd-2f58-4414-8ac7-171b8d7684f3","type":"message","text":"did not know that","user":"U01H36BUDJB","ts":"1614087547.100000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HZO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"did not know that"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"b565a4f2-b443-4992-ab49-ff378ebf8933","type":"message","text":"would it help to implement phase change as a continuous callback?","user":"U01H36BUDJB","ts":"1614087929.100200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HSWa=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"would it help to implement phase change as a continuous callback?"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"d57f55b8-126e-44e3-9334-929fabbf9d77","type":"message","text":"yes","user":"U69BL50BF","ts":"1614087937.100400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RgrzP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"9087a1e0-00e9-4b0f-b7b6-10aa6931b2ef","type":"message","text":"so that the solver is aware of the discontinuity?","user":"U01H36BUDJB","ts":"1614087940.100600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"d7S","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so that the solver is aware of the discontinuity?"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"0e26958c-ecb8-4e00-ba3d-75cf494cfa83","type":"message","text":"have it be non-discontinuous and then flip a parameter at the discontinuity point, yes","user":"U69BL50BF","ts":"1614087952.100800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nADCk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"have it be non-discontinuous and then flip a parameter at the discontinuity point, yes"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"c7776606-4aa4-42ed-a07a-1f0bf187043d","type":"message","text":"that's what is normally suggested in the ODE literature.","user":"U69BL50BF","ts":"1614087959.101000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YSeQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that's what is normally suggested in the ODE literature."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"eb04736d-9d92-463b-8fe9-a7c72f96a3be","type":"message","text":"what should that parameter do?","user":"U01H36BUDJB","ts":"1614087972.101200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"B5cya","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what should that parameter do?"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"c302c337-61b6-41fd-9a00-e84e3be6c4fc","type":"message","text":"I guess just change the derivative computation","user":"U01H36BUDJB","ts":"1614087989.101400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Cxlc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I guess just change the derivative computation"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"809905c1-22a2-48a1-800d-7ae0ccf06285","type":"message","text":"I meant that's what happens right now anyway","user":"U01H36BUDJB","ts":"1614087997.101600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"n3h","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I meant that's what happens right now anyway"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"06c29f4b-af77-4a81-8c68-bad0d4a034c4","type":"message","text":"yeah","user":"U69BL50BF","ts":"1614088085.102500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"k2Y","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"e46c6a63-a602-4a61-94c7-25076def22af","type":"message","text":"so I haven't quantified it, but the solve for the TDMA method visually appears almost identical to the high-accuracy Crank-Nicolson solution produced by OrdinaryDiffEq.jl","user":"U01H36BUDJB","ts":"1614262276.187000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kt4Xl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so I haven't quantified it, but the solve for the TDMA method visually appears almost identical to the high-accuracy Crank-Nicolson solution produced by OrdinaryDiffEq.jl"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"1c9d72f9-b815-4b85-9150-a811b4a4eaf1","type":"message","text":"at least good enough for our purposes.","user":"U01H36BUDJB","ts":"1614262287.187200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"G3/1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"at least good enough for our purposes."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"31cf4ee4-95d6-476e-a8c9-376d0c90a334","type":"message","text":"so I'd like to figure out how to implement this method using `DifferentialEquations.jl` . I'm pretty sure I need to specify a custom LinSolve but I'm not sure about nlsolve. I don't really understand what that's doing.","user":"U01H36BUDJB","ts":"1614262331.187400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HAF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so I'd like to figure out how to implement this method using "},{"type":"text","text":"DifferentialEquations.jl","style":{"code":true}},{"type":"text","text":" . I'm pretty sure I need to specify a custom LinSolve but I'm not sure about nlsolve. I don't really understand what that's doing."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"67985792-5eb3-4e8b-9791-4d615e7990b1","type":"message","text":"reference here: <https://idp.springer.com/authorize/casa?redirect_uri=https://link.springer.com/content/pdf/10.1007/BF02649725.pdf&amp;casa_token=c2Jzrt_VIXMAAAAA:JsM5CfS0wp42U9MlAnoDHiLP7GFRPqQVDtNIb5kJWfYRLZFlZkZVVBrxNeRtKk-ZujtveBfjD8YiQmc|https://idp.springer.com/authorize/casa?redirect_uri=https://link.springer.com/conten[…]DHiLP7GFRPqQVDtNIb5kJWfYRLZFlZkZVVBrxNeRtKk-ZujtveBfjD8YiQmc>\nequation 7 is the important thing. H is the state variable.","user":"U01H36BUDJB","ts":"1614262484.187600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HgND","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"reference here: "},{"type":"link","url":"https://idp.springer.com/authorize/casa?redirect_uri=https://link.springer.com/content/pdf/10.1007/BF02649725.pdf&casa_token=c2Jzrt_VIXMAAAAA:JsM5CfS0wp42U9MlAnoDHiLP7GFRPqQVDtNIb5kJWfYRLZFlZkZVVBrxNeRtKk-ZujtveBfjD8YiQmc","text":"https://idp.springer.com/authorize/casa?redirect_uri=https://link.springer.com/conten[…]DHiLP7GFRPqQVDtNIb5kJWfYRLZFlZkZVVBrxNeRtKk-ZujtveBfjD8YiQmc"},{"type":"text","text":"\nequation 7 is the important thing. H is the state variable."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"2c93fb58-3732-4e30-8e9f-fe339b9435cc","type":"message","text":"It would be interesting to see a non-quasi Newton added for this.","user":"U69BL50BF","ts":"1614262691.188500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LED8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It would be interesting to see a non-quasi Newton added for this."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"7e1caa78-7f0f-4ebb-a076-f07705248615","type":"message","text":"I'd be curious","user":"U69BL50BF","ts":"1614262696.188800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2XYdt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'd be curious"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"01f160d8-a780-4ade-9707-b02526913612","type":"message","text":"basically we already know how to compute our A in the linear solve Ax = dH/dt ... and it's tridiagonal","user":"U01H36BUDJB","ts":"1614264373.193900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Elb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"basically we already know how to compute our A in the linear solve Ax = dH/dt ... and it's tridiagonal"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"ce1d8afc-3d38-463d-8893-30115e50a9d7","type":"message","text":"hence the TDMA solver. I get that I would need a custom LinSolve, but is there a way to disable nlsolve?","user":"U01H36BUDJB","ts":"1614264396.194100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"stndJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"hence the TDMA solver. I get that I would need a custom LinSolve, but is there a way to disable nlsolve?"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"d992ae8f-96da-4e2e-9cc5-9320f00fd79e","type":"message","text":"so interestingly, after adding forcings from air temeprature (non-constant BCs) fixed timestep Euler beats both ImplicitEuler and Trapezoid and TRBDF2. The latter are all not only multiple times slower, but they are actually wrong during the re-freezing period. They produce huge numerical errors.","user":"U01H36BUDJB","ts":"1614278723.194500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1Q8c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so interestingly, after adding forcings from air temeprature (non-constant BCs) fixed timestep Euler beats both ImplicitEuler and Trapezoid and TRBDF2. The latter are all not only multiple times slower, but they are actually wrong during the re-freezing period. They produce huge numerical errors."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"f54bd4ad-ba79-4655-89e8-262df14b2d5c","type":"message","text":"interesting...","user":"U69BL50BF","ts":"1614278737.194700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"a9QRs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"interesting..."}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"3a0dd160-2983-4fff-961b-600cb26dbb91","type":"message","text":"still haven't done the callback though","user":"U01H36BUDJB","ts":"1614278748.194900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"N/T","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"still haven't done the callback though"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"},{"client_msg_id":"cc5ff3f9-3312-4c10-87a2-f3f11835a0fa","type":"message","text":"that's next up on the list","user":"U01H36BUDJB","ts":"1614278753.195100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KdrYK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that's next up on the list"}]}]}],"thread_ts":"1614086572.092300","parent_user_id":"U69BL50BF"}]