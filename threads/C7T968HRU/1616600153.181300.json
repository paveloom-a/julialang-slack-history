[{"client_msg_id":"f75dacd0-f046-474c-ae78-18879c6efa2d","type":"message","text":"Hi all. I hope this is the right place to ask. Otherwise, please feel free to re-direct me! :slightly_smiling_face:\n\nI am encountering an issue with the minimal MLK non-working example below:\n\n`using Flux`\n`using Symbolics`\n`using DiffEqFlux`\n`using ModelingToolkit`\n`using NeuralPDE`\n`using GalacticOptim`\n\n`@parameters t, l, r`\n`TMAX = 1000.0`\n`LMAX = 300.0`\n`RMAX = 10.0`\n\n`Dt  = Differential(t)`\n`Dl  = Differential(l)`\n`Dr  = Differential(r)`\n\n`@variables u1(..), u2(..)`\n\n`domains = [`\n    `t in ModelingToolkit.IntervalDomain(0.0,TMAX),`\n    `l in ModelingToolkit.IntervalDomain(0.0,LMAX),`\n    `r in ModelingToolkit.IntervalDomain(0.0,RMAX), ]`\n`steps = [ 10,10,10 ]` \n`dxs = [`\n    `(domains[i].domain.upper-domains[i].domain.lower)/steps[i]`\n    `for i in 1:length(domains) ]`\n`indvars = [t,l,r]`\n`depvars = [u1,u2]`\n\n`inner = 30`\n`chains = [`\n    `FastChain(`\n        `FastDense(length(indvars),inner,Flux.σ),`\n        `FastDense(inner,inner,Flux.σ),`\n        `FastDense(inner,inner,Flux.σ),`\n        `FastDense(inner,1))`\n    `for u in depvars]`\n`strategy = GridTraining(dxs)`\n`discretization = PhysicsInformedNN(chains, strategy)`\n\n`I(t) = (t&lt;=TMAX/2) ? -1.0 : 1.0`\n`ModelingToolkit.@register I(t)`\n\n`eqs = [`\n    `Dl(u1(t,l,r)) ~ 0.f0,`\n    `Dr(u1(t,l,r)) ~ 0.f0,`\n    `Dt(u2(t,l,r)) ~ 0.f0,`\n    `Dl(u2(t,l,r)) ~ 0.f0,`\n    `Dr(u2(t,l,r)) ~ 0.f0, ]`\n`bcs = [`\n    `u1(t,0,0) ~ I(t),`\n    `u2(0,0,r) ~ 2.f0, ]`\n\n`max_iterations = 3`\n`pde_system = PDESystem(eqs,bcs,domains,indvars,depvars)`\n`prob = discretize(pde_system,discretization)`\n\nwhich produces an\n\n`ERROR: LoadError: BoundsError: attempt to access 0-element Vector{Vector{Any}} at index [1]` \n\nin NeuralPDE/`pinns_pde_solve.jl` :get_argument() while returning the `first.(args_)` , that I think depends on the fact that `e isa Expr` is False in `find_thing_in_expr()`  for the `eqs` above.\n\nAny suggestions? :-D","user":"U01R0NYA8F9","ts":"1616600153.181300","team":"T68168MUP","edited":{"user":"U01R0NYA8F9","ts":"1616600422.000000"},"blocks":[{"type":"rich_text","block_id":"ecjd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi all. I hope this is the right place to ask. Otherwise, please feel free to re-direct me! "},{"type":"emoji","name":"slightly_smiling_face"},{"type":"text","text":"\n\nI am encountering an issue with the minimal MLK non-working example below:\n\n"},{"type":"text","text":"using Flux","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"using Symbolics","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"using DiffEqFlux","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"using ModelingToolkit","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"using NeuralPDE","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"using GalacticOptim","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"@parameters t, l, r","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"TMAX = 1000.0","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"LMAX = 300.0","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"RMAX = 10.0","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"Dt  = Differential(t)","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"Dl  = Differential(l)","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"Dr  = Differential(r)","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"@variables u1(..), u2(..)","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"domains = [","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    t in ModelingToolkit.IntervalDomain(0.0,TMAX),","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    l in ModelingToolkit.IntervalDomain(0.0,LMAX),","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    r in ModelingToolkit.IntervalDomain(0.0,RMAX), ]","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"steps = [ 10,10,10 ] ","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"dxs = [","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    (domains[i].domain.upper-domains[i].domain.lower)/steps[i]","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    for i in 1:length(domains) ]","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"indvars = [t,l,r]","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"depvars = [u1,u2]","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"inner = 30","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"chains = [","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    FastChain(","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"        FastDense(length(indvars),inner,Flux.σ),","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"        FastDense(inner,inner,Flux.σ),","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"        FastDense(inner,inner,Flux.σ),","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"        FastDense(inner,1))","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    for u in depvars]","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"strategy = GridTraining(dxs)","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"discretization = PhysicsInformedNN(chains, strategy)","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"I(t) = (t<=TMAX/2) ? -1.0 : 1.0","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"ModelingToolkit.@register I(t)","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"eqs = [","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    Dl(u1(t,l,r)) ~ 0.f0,","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    Dr(u1(t,l,r)) ~ 0.f0,","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    Dt(u2(t,l,r)) ~ 0.f0,","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    Dl(u2(t,l,r)) ~ 0.f0,","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    Dr(u2(t,l,r)) ~ 0.f0, ]","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"bcs = [","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    u1(t,0,0) ~ I(t),","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    u2(0,0,r) ~ 2.f0, ]","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"max_iterations = 3","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"pde_system = PDESystem(eqs,bcs,domains,indvars,depvars)","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"prob = discretize(pde_system,discretization)","style":{"code":true}},{"type":"text","text":"\n\nwhich produces an\n\n"},{"type":"text","text":"ERROR: LoadError: BoundsError: attempt to access 0-element Vector{Vector{Any}} at index [1] ","style":{"code":true}},{"type":"text","text":"\n\nin NeuralPDE/"},{"type":"text","text":"pinns_pde_solve.jl","style":{"code":true}},{"type":"text","text":" :get_argument() while returning the "},{"type":"text","text":"first.(args_)","style":{"code":true}},{"type":"text","text":" , that I think depends on the fact that "},{"type":"text","text":"e isa Expr","style":{"code":true}},{"type":"text","text":" is False in "},{"type":"text","text":"find_thing_in_expr()","style":{"code":true}},{"type":"text","text":"  for the "},{"type":"text","text":"eqs","style":{"code":true}},{"type":"text","text":" above.\n\nAny suggestions? :-D"}]}]}],"thread_ts":"1616600153.181300","reply_count":1,"reply_users_count":1,"latest_reply":"1616616970.184000","reply_users":["U69BL50BF"],"is_locked":false,"subscribed":false},{"client_msg_id":"f380a45b-afc1-478f-bca4-635b6a6d258a","type":"message","text":"open an issue.","user":"U69BL50BF","ts":"1616616970.184000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"I1qZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"open an issue."}]}]}],"thread_ts":"1616600153.181300","parent_user_id":"U01R0NYA8F9"}]