[{"client_msg_id":"bd24cf7c-326f-4598-a7e4-8414656abe10","type":"message","text":"I'm trying to improve type stability in `DiffEqUncertainty.expectation()` and saw that `QuadratureProblem()`  was type unstable.  It is unclear to me why.\n```@code_warntype QuadratureProblem((x,p)-&gt;sin(x[1]), -1.0, 1.0)```","user":"UP95S4864","ts":"1616179641.051500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"g1cf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm trying to improve type stability in "},{"type":"text","text":"DiffEqUncertainty.expectation()","style":{"code":true}},{"type":"text","text":" and saw that "},{"type":"text","text":"QuadratureProblem()","style":{"code":true}},{"type":"text","text":"  was type unstable.  It is unclear to me why.\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"@code_warntype QuadratureProblem((x,p)->sin(x[1]), -1.0, 1.0)"}]}]}],"thread_ts":"1616179641.051500","reply_count":7,"reply_users_count":3,"latest_reply":"1616180067.052800","reply_users":["UP95S4864","U69BL50BF","U8T9JUA5R"],"subscribed":false},{"client_msg_id":"8a0b7edd-e49a-4ad8-be17-10b7ead7f32a","type":"message","text":"`ODEProblem()`  is also unstable\n```@code_warntype ODEProblem((du,u,p,t)-&gt;du.=0.0, [-1.0, 2, 3], (0.0,1.0), [-1.0, 2,3])```","user":"UP95S4864","ts":"1616179708.051600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"W2DMx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ODEProblem()","style":{"code":true}},{"type":"text","text":"  is also unstable\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"@code_warntype ODEProblem((du,u,p,t)->du.=0.0, [-1.0, 2, 3], (0.0,1.0), [-1.0, 2,3])"}]}]}],"thread_ts":"1616179641.051500","parent_user_id":"UP95S4864"},{"client_msg_id":"e4f202e5-d488-46ed-8fc7-ce6f9712822e","type":"message","text":"It relies on constant prop","user":"U69BL50BF","ts":"1616179748.051800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4fRDJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It relies on constant prop"}]}]}],"thread_ts":"1616179641.051500","parent_user_id":"UP95S4864"},{"client_msg_id":"f6d54757-17c0-491f-a633-2a58fb2e9a1b","type":"message","text":"if you put it in a function it should change?","user":"U69BL50BF","ts":"1616179756.052000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SXy2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"if you put it in a function it should change?"}]}]}],"thread_ts":"1616179641.051500","parent_user_id":"UP95S4864"},{"client_msg_id":"1353c1b4-5130-4389-99b4-332ab2aa79af","type":"message","text":"```function qprob_test()\n    QuadratureProblem((x,p)-&gt;sin(x[1]), -1.0, 1.0)\nend\n\n@code_warntype qprob_test()\n\nariables\n  #self#::Core.Compiler.Const(qprob_test, false)\n  #108::var\"#108#109\"\n\nBody::Any\n1 ─      (#108 = %new(Main.:(var\"#108#109\")))\n│   %2 = #108::Core.Compiler.Const(var\"#108#109\"(), false)\n│   %3 = Main.QuadratureProblem(%2, -1.0, 1.0)::Any\n└──      return %3```","user":"UP95S4864","ts":"1616179834.052200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pye","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function qprob_test()\n    QuadratureProblem((x,p)->sin(x[1]), -1.0, 1.0)\nend\n\n@code_warntype qprob_test()\n\nariables\n  #self#::Core.Compiler.Const(qprob_test, false)\n  #108::var\"#108#109\"\n\nBody::Any\n1 ─      (#108 = %new(Main.:(var\"#108#109\")))\n│   %2 = #108::Core.Compiler.Const(var\"#108#109\"(), false)\n│   %3 = Main.QuadratureProblem(%2, -1.0, 1.0)::Any\n└──      return %3"}]}]}],"thread_ts":"1616179641.051500","parent_user_id":"UP95S4864"},{"client_msg_id":"be5cd6c1-bc4d-484c-972b-1677f3dc983a","type":"message","text":"IIRC it's type stable when you use `ODEProblem{true}` i.e. if you specify explicitly that it's an in-place function","user":"U8T9JUA5R","ts":"1616179852.052400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"c7oWG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"IIRC it's type stable when you use "},{"type":"text","text":"ODEProblem{true}","style":{"code":true}},{"type":"text","text":" i.e. if you specify explicitly that it's an in-place function"}]}]}],"thread_ts":"1616179641.051500","parent_user_id":"UP95S4864"},{"client_msg_id":"5b1f1473-ca0f-4c50-ad14-3aeb00c16419","type":"message","text":"oh yes, forgot that piece.","user":"U69BL50BF","ts":"1616179864.052600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"iOSX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh yes, forgot that piece."}]}]}],"thread_ts":"1616179641.051500","parent_user_id":"UP95S4864"},{"client_msg_id":"1d41c45c-c6c8-49d6-aff2-dcebf12b18fc","type":"message","text":"ahhh.. that does it. Thanks","user":"UP95S4864","ts":"1616180067.052800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"X8q9s","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ahhh.. that does it. Thanks"}]}]}],"thread_ts":"1616179641.051500","parent_user_id":"UP95S4864"}]