[{"client_msg_id":"aec3a243-ca8d-42c1-8ef3-7aa588b5354d","type":"message","text":"Hi there! I’m using OrdinaryDiffEq to integrate incremental constitutive laws in solid mechanics. I have a state variable `D` that should only be allowed to grow and whose value must be higher or equal to some initial value `D0`. My derivatives update function is built so that `D` can only increase with time, but I keep facing solves returning me `AssertionError` relative to `D` being lower than `D0` at some point during integration. Any clue on what may happen?","user":"UNJ3U7TRB","ts":"1614167305.174900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wge8c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi there! I’m using OrdinaryDiffEq to integrate incremental constitutive laws in solid mechanics. I have a state variable "},{"type":"text","text":"D","style":{"code":true}},{"type":"text","text":" that should only be allowed to grow and whose value must be higher or equal to some initial value "},{"type":"text","text":"D0","style":{"code":true}},{"type":"text","text":". My derivatives update function is built so that "},{"type":"text","text":"D","style":{"code":true}},{"type":"text","text":" can only increase with time, but I keep facing solves returning me "},{"type":"text","text":"AssertionError","style":{"code":true}},{"type":"text","text":" relative to "},{"type":"text","text":"D","style":{"code":true}},{"type":"text","text":" being lower than "},{"type":"text","text":"D0","style":{"code":true}},{"type":"text","text":" at some point during integration. Any clue on what may happen?"}]}]}],"thread_ts":"1614167305.174900","reply_count":17,"reply_users_count":2,"latest_reply":"1614170849.178900","reply_users":["U9MD78Z9N","UNJ3U7TRB"],"subscribed":false},{"type":"message","text":"Can you share code?","user":"U9MD78Z9N","ts":"1614167844.175300","team":"T68168MUP","thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"client_msg_id":"0ff025ed-6fa5-4960-8897-fa374f2737c1","type":"message","text":"The code dependencies of my update function are quite large. I don’t see how to provide any meaningful MWE.","user":"UNJ3U7TRB","ts":"1614169393.175500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fhVKM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The code dependencies of my update function are quite large. I don’t see how to provide any meaningful MWE."}]}]}],"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"type":"message","text":"What in your code throws that assertion?","user":"U9MD78Z9N","ts":"1614169525.175700","team":"T68168MUP","thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"client_msg_id":"51b82be7-70e5-4c00-8f2c-6ac0f672138a","type":"message","text":"I’ll think about making one and post it if I get something. Nonetheless, could this behavior come from the integration algorithm?","user":"UNJ3U7TRB","ts":"1614169587.175900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"B2NJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I’ll think about making one and post it if I get something. Nonetheless, could this behavior come from the integration algorithm?"}]}]}],"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"client_msg_id":"93a7fdc3-afde-4222-bd04-b0505093af14","type":"message","text":"a function evaluating the derivative of the state variable contains the assertion of positivity of the derivative","user":"UNJ3U7TRB","ts":"1614169653.176100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"C8g1L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"a function evaluating the derivative of the state variable contains the assertion of positivity of the derivative"}]}]}],"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"client_msg_id":"da9fdf4a-3d86-4737-be8e-3f6eda3630cd","type":"message","text":"Then any update of the state variable that did not error out should have increased it","user":"UNJ3U7TRB","ts":"1614169723.176300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TCPp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Then any update of the state variable that did not error out should have increased it"}]}]}],"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"type":"message","text":"I would make no assumption with what values your right hand side get's called with. Can you remove that assertion and just see if you get the right behavior by looking at the solution?","user":"U9MD78Z9N","ts":"1614169748.176500","team":"T68168MUP","edited":{"user":"U9MD78Z9N","ts":"1614169767.000000"},"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"client_msg_id":"70c8544a-db07-4b14-be07-52915d1f6652","type":"message","text":"I’ll try that, thanks! Could you elaborate further on not making such assumptions?","user":"UNJ3U7TRB","ts":"1614169824.176800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aCQe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I’ll try that, thanks! Could you elaborate further on not making such assumptions?"}]}]}],"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"client_msg_id":"81248631-e1c1-4393-8108-a3fd2ed48598","type":"message","text":"when doing that I get DomainError with square roots of negative numbers arising from allowing `D &lt; D0`","user":"UNJ3U7TRB","ts":"1614170046.177000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"upA/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"when doing that I get DomainError with square roots of negative numbers arising from allowing "},{"type":"text","text":"D < D0","style":{"code":true}}]}]}],"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"type":"message","text":"The integration algorithm makes no promise what it calls your RHS with. I don't see why an integration algorithm would do what you see it doing.","user":"U9MD78Z9N","ts":"1614170062.177200","team":"T68168MUP","thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"type":"message","text":"Does the problem persist when you try different integration algorithms?","user":"U9MD78Z9N","ts":"1614170112.177400","team":"T68168MUP","thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"type":"message","text":"(At diffenrent precision, running like 3 different configuration and see if you have the same problem in all of them would be helpfull)","user":"U9MD78Z9N","ts":"1614170152.177600","team":"T68168MUP","thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"client_msg_id":"443d8278-01c3-43be-82f2-e0e5c603cee7","type":"message","text":"I thought the same, I had to ask though since i can’t explain this otherwise..","user":"UNJ3U7TRB","ts":"1614170171.177800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E2a","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I thought the same, I had to ask though since i can’t explain this otherwise.."}]}]}],"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"type":"message","text":"I suspect that your RHS is incorrect.","user":"U9MD78Z9N","ts":"1614170215.178000","team":"T68168MUP","thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"client_msg_id":"af0aa277-76ff-4f52-b780-1602fd884689","type":"message","text":"OK, I come back if I can get you some more information. Thanks again","user":"UNJ3U7TRB","ts":"1614170236.178200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OPq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"OK, I come back if I can get you some more information. Thanks again"}]}]}],"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"type":"message","text":"I would try `AutoTsit5(Rosenbrock23())`, `Midpoint()`, `Vern9()`, `ABM54()`, `QBDF()` if you need some ideas which algorithms to try.","user":"U9MD78Z9N","ts":"1614170438.178400","team":"T68168MUP","edited":{"user":"U9MD78Z9N","ts":"1614170552.000000"},"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB"},{"client_msg_id":"a7fb11cf-d61e-47c4-8463-97b889ad1ebd","type":"message","text":"I’ll try `ABM54()`, `QBDF()` , that I didn’t try before","user":"UNJ3U7TRB","ts":"1614170849.178900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Y/r","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I’ll try "},{"type":"text","text":"ABM54()","style":{"code":true}},{"type":"text","text":", "},{"type":"text","text":"QBDF()","style":{"code":true}},{"type":"text","text":" , that I didn’t try before"}]}]}],"thread_ts":"1614167305.174900","parent_user_id":"UNJ3U7TRB","reactions":[{"name":"+1","users":["U9MD78Z9N"],"count":1}]}]