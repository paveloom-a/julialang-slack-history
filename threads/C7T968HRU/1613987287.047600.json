[{"client_msg_id":"ec6135a5-b496-45dd-9d06-95d2ad01f959","type":"message","text":"<@U69BL50BF> Quick question: I'm seeing a 10x increase in number of timesteps returned by an ODE solution (using solver `Vern7`) when simply adding a `VectorContinuousCallback`. This is even with `interp_points=0` and `save_positions=(false, false)`. The callback does nothing in its `affect!`. Any idea what could be causing the timesteps to increase so much?","user":"U013L06JN15","ts":"1613987287.047600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+YYT","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U69BL50BF"},{"type":"text","text":" Quick question: I'm seeing a 10x increase in number of timesteps returned by an ODE solution (using solver "},{"type":"text","text":"Vern7","style":{"code":true}},{"type":"text","text":") when simply adding a "},{"type":"text","text":"VectorContinuousCallback","style":{"code":true}},{"type":"text","text":". This is even with "},{"type":"text","text":"interp_points=0","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"save_positions=(false, false)","style":{"code":true}},{"type":"text","text":". The callback does nothing in its "},{"type":"text","text":"affect!","style":{"code":true}},{"type":"text","text":". Any idea what could be causing the timesteps to increase so much?"}]}]}],"thread_ts":"1613987287.047600","reply_count":35,"reply_users_count":2,"latest_reply":"1614000540.059100","reply_users":["U013L06JN15","U69BL50BF"],"subscribed":false},{"client_msg_id":"38f19457-8ce8-41a6-9e52-44e7997b7c4a","type":"message","text":"So this seems to be happening because my initial state triggers the event function. This seems to be causing the initial time step to be tiny, such that 90% of the total timesteps are between `t=0` and `t=6e-5`  and the remaining 10% are the same timesteps as taken without the callback.","user":"U013L06JN15","ts":"1613993815.047700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jdXK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So this seems to be happening because my initial state triggers the event function. This seems to be causing the initial time step to be tiny, such that 90% of the total timesteps are between "},{"type":"text","text":"t=0","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"t=6e-5","style":{"code":true}},{"type":"text","text":"  and the remaining 10% are the same timesteps as taken without the callback."}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"f2d6e2c2-4094-4839-89ff-c26b7ba69370","type":"message","text":"Changing `interp_points`, `save_positions`, `abstol` or `reltol` in the Callback object don't seem to do anything to affect this :confused:","user":"U013L06JN15","ts":"1613993918.047900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E=F","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Changing "},{"type":"text","text":"interp_points","style":{"code":true}},{"type":"text","text":", "},{"type":"text","text":"save_positions","style":{"code":true}},{"type":"text","text":", "},{"type":"text","text":"abstol","style":{"code":true}},{"type":"text","text":" or "},{"type":"text","text":"reltol","style":{"code":true}},{"type":"text","text":" in the Callback object don't seem to do anything to affect this "},{"type":"emoji","name":"confused"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"26930d8f-24e4-47df-955e-3a5f09bb5afb","type":"message","text":"Think this might be a bug? I'll try to replicate in a minimum example.","user":"U013L06JN15","ts":"1613994144.048100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NGk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Think this might be a bug? I'll try to replicate in a minimum example."}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"265531dc-2db6-44ac-82bc-75f35b5e8409","type":"message","text":"Is it triggering exactly at zero?","user":"U69BL50BF","ts":"1613996381.052200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RPZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is it triggering exactly at zero?"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"9f76485b-3ccd-4f5a-ad23-ef756add406d","type":"message","text":"No it seems to trigger only from the second timestep onwards","user":"U013L06JN15","ts":"1613996404.052400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CvZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No it seems to trigger only from the second timestep onwards"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"dcb99601-3146-48bc-86a9-e893ea9e54da","type":"message","text":"My initial condition is supposed to be an event trigger, but I think it's out of the tolerance a little.","user":"U013L06JN15","ts":"1613996433.052600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Np7NL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"My initial condition is supposed to be an event trigger, but I think it's out of the tolerance a little."}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"6f1bd2ac-2fd5-487d-93ca-8ee349e6bee5","type":"message","text":"i.e. the event check is basically just `u[5]`, where the initial value is `u0[5] = 1e-5`  or so.","user":"U013L06JN15","ts":"1613996489.052800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Bnu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"i.e. the event check is basically just "},{"type":"text","text":"u[5]","style":{"code":true}},{"type":"text","text":", where the initial value is "},{"type":"text","text":"u0[5] = 1e-5","style":{"code":true}},{"type":"text","text":"  or so."}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"c1eab5f5-c7e1-4deb-a922-87eedde54321","type":"message","text":"I'd give some specific examples here but I've currently got everything broken trying to hunt it down, sorry xD","user":"U013L06JN15","ts":"1613996757.053000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3AkmK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'd give some specific examples here but I've currently got everything broken trying to hunt it down, sorry xD"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"4afea51a-f2dd-4d7c-8359-6cd18feb6d20","type":"message","text":"did you set `initialize` ?","user":"U69BL50BF","ts":"1613997612.053200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xC5d","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"did you set "},{"type":"text","text":"initialize","style":{"code":true}},{"type":"text","text":" ?"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"1c6f69a6-49e7-40bd-81f1-7a6f26ab8482","type":"message","text":"No, should I be doing so?","user":"U013L06JN15","ts":"1613997629.053400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+Ia/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No, should I be doing so?"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"e955b501-278d-440d-8b15-f0db50f9b4a4","type":"message","text":"```return VectorContinuousCallback(\n        (integrator, idx) -&gt; begin\n        end, 3;\n        interp_points=10, save_positions=(false, false)) do du, u, t, integrator\n            du[1] = 1 # doesn't matter\n            du[2] = 1 # doesn't matter\n            du[3] = some_function(u, t) # essentially returns u[5]\n        end```\nThis is my callback specification.","user":"U013L06JN15","ts":"1613997973.053600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"R3D","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"return VectorContinuousCallback(\n        (integrator, idx) -> begin\n        end, 3;\n        interp_points=10, save_positions=(false, false)) do du, u, t, integrator\n            du[1] = 1 # doesn't matter\n            du[2] = 1 # doesn't matter\n            du[3] = some_function(u, t) # essentially returns u[5]\n        end"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"This is my callback specification."}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"299534b9-763a-4795-9153-92116f30e55a","type":"message","text":"timesteps when solving *without* the callback:\n```sol.t\n83-element Vector{Float64}:\n     0.0\n     0.04975759415894778\n     0.3650914791419515 \n     2.182113167236009  \n    11.637352226859338\n     ⋮```\n","user":"U013L06JN15","ts":"1613997999.053800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KGNDS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"timesteps when solving "},{"type":"text","text":"without","style":{"bold":true}},{"type":"text","text":" the callback:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"sol.t\n83-element Vector{Float64}:\n     0.0\n     0.04975759415894778\n     0.3650914791419515 \n     2.182113167236009  \n    11.637352226859338\n     ⋮"}]},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"8d1242d3-30f5-460b-94a1-bd811be6654c","type":"message","text":"When solving *with* the callback:\n```813-element Vector{Float64}:\n     0.0\n     6.675757191599309e-5\n     6.675757197412525e-5\n     6.675757199350262e-5\n     6.675757201288e-5\n     ⋮```\nThe last 83 elements approximately match the no-callback version.","user":"U013L06JN15","ts":"1613998093.054000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gaG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"When solving "},{"type":"text","text":"with","style":{"bold":true}},{"type":"text","text":" the callback:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"813-element Vector{Float64}:\n     0.0\n     6.675757191599309e-5\n     6.675757197412525e-5\n     6.675757199350262e-5\n     6.675757201288e-5\n     ⋮"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"The last 83 elements approximately match the no-callback version."}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"8e0290bc-0e34-4b05-9636-471ca85ac1b2","type":"message","text":"Hmm, if I set the `affect!` function to `nothing`, the callback version is only 83 timesteps. But if it's as above, where it's just an empty function, I get this issue.","user":"U013L06JN15","ts":"1613998205.054200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Elaxt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmm, if I set the "},{"type":"text","text":"affect!","style":{"code":true}},{"type":"text","text":" function to "},{"type":"text","text":"nothing","style":{"code":true}},{"type":"text","text":", the callback version is only 83 timesteps. But if it's as above, where it's just an empty function, I get this issue."}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"0e3cfce9-aa44-4232-b64e-724995df61a9","type":"message","text":"I think you need an initialize","user":"U69BL50BF","ts":"1613998341.054400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZkMWN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think you need an initialize"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"020a3dd6-caf3-458f-827c-86caea918d76","type":"message","text":"it will not trigger at 0","user":"U69BL50BF","ts":"1613998345.054600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xhjtT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it will not trigger at 0"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"c34d0b3d-8d64-411d-b942-0f5493aa09a6","type":"message","text":"I don't want it to trigger at 0 anyway, I just want it to not affect the number of timesteps","user":"U013L06JN15","ts":"1613998363.054800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+2lM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don't want it to trigger at 0 anyway, I just want it to not affect the number of timesteps"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"1159dec8-93ea-4763-837c-199f1ac68e69","type":"message","text":"It seems that setting the `affect!` argument to a function, even if that function does nothing, causes this issue; whereas if it's `nothing`, it doesn't.","user":"U013L06JN15","ts":"1613998386.055000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"b6j","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It seems that setting the "},{"type":"text","text":"affect!","style":{"code":true}},{"type":"text","text":" argument to a function, even if that function does nothing, causes this issue; whereas if it's "},{"type":"text","text":"nothing","style":{"code":true}},{"type":"text","text":", it doesn't."}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"51e41e29-516e-4928-a112-8cacdce56a6b","type":"message","text":"interesting","user":"U69BL50BF","ts":"1613998634.055200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NRn","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"interesting"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"ce6c7b7f-03c3-43e8-9b5a-e30cbfe98497","type":"message","text":"Ok","user":"U013L06JN15","ts":"1613998637.055400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sosE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ok"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"36625778-d8ac-4ad4-a623-9f8edd6e368f","type":"message","text":"I've tracked it down I think","user":"U013L06JN15","ts":"1613998641.055600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WkP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I've tracked it down I think"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"04b6aa2a-e8ea-495a-9d4b-9105cf94a645","type":"message","text":"```integrator.u_modified = true\n  if prev_sign &lt; 0\n    if callback.affect! === nothing\n      integrator.u_modified = false\n    else\n      callback isa VectorContinuousCallback ? callback.affect!(integrator,event_idx) : callback.affect!(integrator)\n    end\n  elseif prev_sign &gt; 0\n    if callback.affect_neg! === nothing\n      integrator.u_modified = false\n    else\n      callback isa VectorContinuousCallback ? callback.affect_neg!(integrator,event_idx) : callback.affect_neg!(integrator)\n    end\n  end```","user":"U013L06JN15","ts":"1613998643.055800","team":"T68168MUP","edited":{"user":"U013L06JN15","ts":"1613998654.000000"},"blocks":[{"type":"rich_text","block_id":"Ur2","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"integrator.u_modified = true\n  if prev_sign < 0\n    if callback.affect! === nothing\n      integrator.u_modified = false\n    else\n      callback isa VectorContinuousCallback ? callback.affect!(integrator,event_idx) : callback.affect!(integrator)\n    end\n  elseif prev_sign > 0\n    if callback.affect_neg! === nothing\n      integrator.u_modified = false\n    else\n      callback isa VectorContinuousCallback ? callback.affect_neg!(integrator,event_idx) : callback.affect_neg!(integrator)\n    end\n  end"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"854d939c-6e84-443b-946f-05166bdb9040","type":"message","text":"If the `affect!`  is nothing, then `u_modified &lt;- false` , but it remains `true` otherwise","user":"U013L06JN15","ts":"1613998683.056100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9cM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If the "},{"type":"text","text":"affect!","style":{"code":true}},{"type":"text","text":"  is nothing, then "},{"type":"text","text":"u_modified <- false","style":{"code":true}},{"type":"text","text":" , but it remains "},{"type":"text","text":"true","style":{"code":true}},{"type":"text","text":" otherwise"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"b9c0aa36-681f-444f-9add-04ec590b44d7","type":"message","text":"I think those `else` statements are supposed to be storing the return value in `integrator.u_modified` perhaps?","user":"U013L06JN15","ts":"1613998723.056300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xtVPr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think those "},{"type":"text","text":"else","style":{"code":true}},{"type":"text","text":" statements are supposed to be storing the return value in "},{"type":"text","text":"integrator.u_modified","style":{"code":true}},{"type":"text","text":" perhaps?"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"96a78805-dedc-40b5-8e87-d5554b086768","type":"message","text":"then `u_modified!(integrator,false)` in your affect!","user":"U69BL50BF","ts":"1613998726.056500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YZ2Wm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"then "},{"type":"text","text":"u_modified!(integrator,false)","style":{"code":true}},{"type":"text","text":" in your affect!"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"afb55780-15f2-42a6-8f96-3f3019c7edf6","type":"message","text":"Hmmm nope that's not the issue","user":"U013L06JN15","ts":"1613998834.056700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Y2v","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmmm nope that's not the issue"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"e3a0254e-5f8e-461b-a43e-8d502502d3bb","type":"message","text":"Still returns 813 timesteps","user":"U013L06JN15","ts":"1613998853.056900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Pfv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Still returns 813 timesteps"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"f474967f-30e9-43d0-b53b-26f200ee4d0e","type":"message","text":"```function findall_events(affect!,affect_neg!,prev_sign,next_sign)\n  findall(x-&gt; ((prev_sign[x] &lt; 0 &amp;&amp; affect! !== nothing) || (prev_sign[x] &gt; 0 &amp;&amp; affect_neg! !== nothing)) &amp;&amp; prev_sign[x]*next_sign[x]&lt;=0, keys(prev_sign))\nend```\nSo `findall_events` returns `[]` with `affect!=nothing`, but `[3]` with the empty `affect!` function","user":"U013L06JN15","ts":"1613999128.057500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CBG","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function findall_events(affect!,affect_neg!,prev_sign,next_sign)\n  findall(x-> ((prev_sign[x] < 0 && affect! !== nothing) || (prev_sign[x] > 0 && affect_neg! !== nothing)) && prev_sign[x]*next_sign[x]<=0, keys(prev_sign))\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"So "},{"type":"text","text":"findall_events","style":{"code":true}},{"type":"text","text":" returns "},{"type":"text","text":"[]","style":{"code":true}},{"type":"text","text":" with "},{"type":"text","text":"affect!=nothing","style":{"code":true}},{"type":"text","text":", but "},{"type":"text","text":"[3]","style":{"code":true}},{"type":"text","text":" with the empty "},{"type":"text","text":"affect!","style":{"code":true}},{"type":"text","text":" function"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"0b412e07-c78a-49d5-82d3-35bdf1318a88","type":"message","text":"Interesting","user":"U013L06JN15","ts":"1613999661.057700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qRC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Interesting"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"b84b37ad-c10e-400e-be80-76d696df59d5","type":"message","text":"I think `integrator.tprev` might not be getting set appropriately","user":"U013L06JN15","ts":"1613999670.057900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+RTy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think "},{"type":"text","text":"integrator.tprev","style":{"code":true}},{"type":"text","text":" might not be getting set appropriately"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"717f44d5-2ef3-408a-a863-361c073233fb","type":"message","text":"hmm","user":"U69BL50BF","ts":"1614000283.058300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"o3F","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"hmm"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"3728784e-0027-4f47-ac74-45e87e7f2de9","type":"message","text":"This is what I'm seeing:","user":"U013L06JN15","ts":"1614000377.058500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"m/t","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"This is what I'm seeing:"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"ced0088b-3643-4d13-821a-0f118f85b0e0","type":"message","text":"```julia&gt;     sol2 = solve(state; callback)\n[ Info: top_t=0.04975759415894778, bottom_t=0.0\n[ Info: integrator.event_last_time = 0 counter=1, integrator.vector_event_last_time=1 idx=3\n[ Info: top_t=0.04982435172902839, bottom_t=6.675757008061116e-5\n[ Info: integrator.event_last_time = 1 counter=1, integrator.vector_event_last_time=3 idx=3\n[ Info: top_t=0.04982435172908957, bottom_t=6.675757014179055e-5\n[ Info: integrator.event_last_time = 1 counter=1, integrator.vector_event_last_time=3 idx=3\n[ Info: top_t=0.04982435172915075, bottom_t=6.675757020296994e-5\n[ Info: integrator.event_last_time = 1 counter=1, integrator.vector_event_last_time=3 idx=3\n[ Info: top_t=0.04982435172917013, bottom_t=6.675757022234731e-5\n\n[~700 steps worth of this ...]\n\n[ Info: top_t=0.04982435179673008, bottom_t=6.675763778229731e-5\n[ Info: integrator.event_last_time = 1 counter=1, integrator.vector_event_last_time=3 idx=3\n[ Info: top_t=13902.999374999572, bottom_t=13422.552551517061\n[ Info: integrator.event_last_time = 0 counter=1, integrator.vector_event_last_time=1 idx=3```\nThat last one is a real event I want to detect (and of course there's an event at `t=0` which is causing this issue, although I don't care if that's detected or not)","user":"U013L06JN15","ts":"1614000485.058700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"iEY","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia>     sol2 = solve(state; callback)\n[ Info: top_t=0.04975759415894778, bottom_t=0.0\n[ Info: integrator.event_last_time = 0 counter=1, integrator.vector_event_last_time=1 idx=3\n[ Info: top_t=0.04982435172902839, bottom_t=6.675757008061116e-5\n[ Info: integrator.event_last_time = 1 counter=1, integrator.vector_event_last_time=3 idx=3\n[ Info: top_t=0.04982435172908957, bottom_t=6.675757014179055e-5\n[ Info: integrator.event_last_time = 1 counter=1, integrator.vector_event_last_time=3 idx=3\n[ Info: top_t=0.04982435172915075, bottom_t=6.675757020296994e-5\n[ Info: integrator.event_last_time = 1 counter=1, integrator.vector_event_last_time=3 idx=3\n[ Info: top_t=0.04982435172917013, bottom_t=6.675757022234731e-5\n\n[~700 steps worth of this ...]\n\n[ Info: top_t=0.04982435179673008, bottom_t=6.675763778229731e-5\n[ Info: integrator.event_last_time = 1 counter=1, integrator.vector_event_last_time=3 idx=3\n[ Info: top_t=13902.999374999572, bottom_t=13422.552551517061\n[ Info: integrator.event_last_time = 0 counter=1, integrator.vector_event_last_time=1 idx=3"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"That last one is a real event I want to detect (and of course there's an event at "},{"type":"text","text":"t=0","style":{"code":true}},{"type":"text","text":" which is causing this issue, although I don't care if that's detected or not)"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"40139fc8-ed84-4154-989a-6cd7c5c21977","type":"message","text":"In these cases, `top_t` seems to be set correctly to the next timestep that it should be","user":"U013L06JN15","ts":"1614000511.058900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"PW/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In these cases, "},{"type":"text","text":"top_t","style":{"code":true}},{"type":"text","text":" seems to be set correctly to the next timestep that it should be"}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"},{"client_msg_id":"d63b5ba1-0881-4a83-beb7-24722075e531","type":"message","text":"the bottom will just be a subinterval where an event was detected.","user":"U69BL50BF","ts":"1614000540.059100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QgpY+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the bottom will just be a subinterval where an event was detected."}]}]}],"thread_ts":"1613987287.047600","parent_user_id":"U013L06JN15"}]