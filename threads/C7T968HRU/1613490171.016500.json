[{"client_msg_id":"7969ae71-e2e9-4b7e-be5d-9f1c01306187","type":"message","text":"Is there some reason why it wouldn't work to use a callable struct as the function for `ODEProblem` ? Would be a nice alternative to closures, but I'm getting weird errors.","user":"U01H36BUDJB","ts":"1613490171.016500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"B5Hjk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there some reason why it wouldn't work to use a callable struct as the function for "},{"type":"text","text":"ODEProblem","style":{"code":true}},{"type":"text","text":" ? Would be a nice alternative to closures, but I'm getting weird errors."}]}]}],"thread_ts":"1613490171.016500","reply_count":34,"reply_users_count":4,"latest_reply":"1613497857.028400","reply_users":["U69BL50BF","U01H36BUDJB","UAUPJLBQX","US4A6G6B0"],"subscribed":false},{"client_msg_id":"244644dc-476b-47b1-bb44-94ed6c420483","type":"message","text":"it should be fine. What are the errors?","user":"U69BL50BF","ts":"1613490409.016900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"O+A6/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it should be fine. What are the errors?"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"353a33be-6325-4c73-b905-4030528c08f8","type":"message","text":"Yeah nevermind, it works. The error is unrelated. Seems to be a problem with `ComponentArray` missing a dispatch that trips up certain solvers:\n```no method matching _strides(::ComponentMatrix{Float64,SubArray...}, ::Tuple{Int64,Int64}, ::Nothing)```","user":"U01H36BUDJB","ts":"1613490531.017700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3FQaP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah nevermind, it works. The error is unrelated. Seems to be a problem with "},{"type":"text","text":"ComponentArray","style":{"code":true}},{"type":"text","text":" missing a dispatch that trips up certain solvers:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"no method matching _strides(::ComponentMatrix{Float64,SubArray...}, ::Tuple{Int64,Int64}, ::Nothing)"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"dd16c431-2ee1-4828-97c8-a105e6b1f64b","type":"message","text":"it would need strides if it's using BLAS","user":"U69BL50BF","ts":"1613490566.017900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZEQD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it would need strides if it's using BLAS"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"6288f960-7599-418a-a2c6-8fec879c592e","type":"message","text":"I assume that's if you use an implicit method?","user":"U69BL50BF","ts":"1613490575.018100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sR+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I assume that's if you use an implicit method?"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"bf197bd0-d4fc-4dd9-a9e8-fd895ea6d6fd","type":"message","text":"TRBDF2?","user":"U01H36BUDJB","ts":"1613490583.018300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"G9r","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"TRBDF2?"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"f36eba38-c1fc-4e41-8fe8-6db1a78eaf5e","type":"message","text":"yup","user":"U69BL50BF","ts":"1613490587.018500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"eUEo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yup"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"35a2cfbf-1851-410d-b0b6-6bbb74c9770f","type":"message","text":"ok good to know","user":"U01H36BUDJB","ts":"1613490596.018700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QsU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ok good to know"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"c918a378-cc13-474d-8904-b0a568ba3ca5","type":"message","text":"<@US4A6G6B0> that would be good to handle","user":"U69BL50BF","ts":"1613490599.018900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KXhN","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"US4A6G6B0"},{"type":"text","text":" that would be good to handle"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"76376df6-0523-462e-913f-4fdd4c81fcb8","type":"message","text":"it might be good to make an MWE for an issue","user":"U69BL50BF","ts":"1613490607.019100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7=b","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it might be good to make an MWE for an issue"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB","reactions":[{"name":"+1","users":["U01H36BUDJB"],"count":1}]},{"client_msg_id":"16fa7dd4-c443-45cb-8a83-002bf6c0253d","type":"message","text":"<@UAUPJLBQX> is there a clear documentation of what's all needed for the BLAS interface?","user":"U69BL50BF","ts":"1613490620.019400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Vzv4","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UAUPJLBQX"},{"type":"text","text":" is there a clear documentation of what's all needed for the BLAS interface?"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"7b96d8be-0cde-4f8f-80d7-7087c5c197c7","type":"message","text":"on the original subject, using a callable struct is a really nice workaround for including extra parameters, state variables, etc. that aren't integrated and can't be included in `p` (in the case where you don't need their Jacobians). I think we should add an example to the docs.","user":"U01H36BUDJB","ts":"1613490738.019600","team":"T68168MUP","edited":{"user":"U01H36BUDJB","ts":"1613490764.000000"},"blocks":[{"type":"rich_text","block_id":"FrSX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"on the original subject, using a callable struct is a really nice workaround for including extra parameters, state variables, etc. that aren't integrated and can't be included in "},{"type":"text","text":"p","style":{"code":true}},{"type":"text","text":" (in the case where you don't need their Jacobians). I think we should add an example to the docs."}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"804e0b4f-3868-4230-9147-1bac35e6cb3d","type":"message","text":"i.e. I wish I had realized this sooner.","user":"U01H36BUDJB","ts":"1613490744.019800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=/gzL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"i.e. I wish I had realized this sooner."}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"dcf07cd3-1854-4a40-9e7f-0db7246c0668","type":"message","text":"It was the first way all parameters were done :wink:","user":"U69BL50BF","ts":"1613490775.020100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Sor","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It was the first way all parameters were done "},{"type":"emoji","name":"wink"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"028f8e8b-51b6-41d8-9e51-23dc975d5ce8","type":"message","text":"before p existed?","user":"U01H36BUDJB","ts":"1613490787.020300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9uIs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"before p existed?"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"b0c12a4c-1d3f-49b4-a0d6-a9bfd33bda02","type":"message","text":"that would explain why the docs from four years ago have no `p` :joy:","user":"U01H36BUDJB","ts":"1613490813.020500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Kl3QZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that would explain why the docs from four years ago have no "},{"type":"text","text":"p","style":{"code":true}},{"type":"text","text":" "},{"type":"emoji","name":"joy"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"e0ee175d-4930-4400-95eb-d36473f145c4","type":"message","text":"yup. `p` was added later to assist differentiation methods, because then it was impossible to know whether someone had parameters or where they were otherwise.","user":"U69BL50BF","ts":"1613490813.020700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"v1o","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yup. "},{"type":"text","text":"p","style":{"code":true}},{"type":"text","text":" was added later to assist differentiation methods, because then it was impossible to know whether someone had parameters or where they were otherwise."}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB","reactions":[{"name":"+1","users":["U01H36BUDJB"],"count":1}]},{"client_msg_id":"0f1cd1f0-4b50-4195-9386-9674bdd9da01","type":"message","text":"it all makes sense now haha","user":"U01H36BUDJB","ts":"1613490834.021000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UZ9CC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it all makes sense now haha"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"b8b01fa0-03bd-49a7-8e60-81e972024584","type":"message","text":"ParameterizedFunctions.jl was then made to make it easy to generate a callable struct with a macro, hence the name :wink:","user":"U69BL50BF","ts":"1613490840.021200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"taJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ParameterizedFunctions.jl was then made to make it easy to generate a callable struct with a macro, hence the name "},{"type":"emoji","name":"wink"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"1167ec2f-5a10-4242-875d-2f01c3c5440c","type":"message","text":"but yeah, I've not done many examples using callable structs, but in almost everything I do there's callable struct functions.","user":"U69BL50BF","ts":"1613490889.021400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GVPI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but yeah, I've not done many examples using callable structs, but in almost everything I do there's callable struct functions."}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"09c43f03-b9a7-4b58-9512-502c4f8125bf","type":"message","text":"that's probably not good.","user":"U69BL50BF","ts":"1613490896.021600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OvyP/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that's probably not good."}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"8dd3ad9a-9edf-4f54-9354-3bae0ff39f6c","type":"message","text":"I'll try to make some time soon to add one and submit a PR to `DifferentialEquations.jl` .","user":"U01H36BUDJB","ts":"1613491071.021800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wW/W","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'll try to make some time soon to add one and submit a PR to "},{"type":"text","text":"DifferentialEquations.jl","style":{"code":true}},{"type":"text","text":" ."}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"b8ce5823-8afd-4460-b7df-8eb3c3d5a15b","type":"message","text":"wait does it cause an allocation because of the struct pointer?","user":"U01H36BUDJB","ts":"1613491231.022000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"k18u","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"wait does it cause an allocation because of the struct pointer?"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"b70e4492-cd6a-48c9-9c5a-a2859f189c27","type":"message","text":"`@benchmark` ing it seems to suggest so","user":"U01H36BUDJB","ts":"1613491242.022200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vAyj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"@benchmark","style":{"code":true}},{"type":"text","text":" ing it seems to suggest so"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"6c1b9c00-5450-4399-9541-1d197e5b8b83","type":"message","text":"it shouldn't?","user":"U69BL50BF","ts":"1613491386.022400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"En+W","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it shouldn't?"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"74f20521-ad4e-4c2a-97ee-72a70d7a40d4","type":"message","text":"nevermind, just a bug on my end, phew :sweat_smile:","user":"U01H36BUDJB","ts":"1613491561.022600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"U59","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"nevermind, just a bug on my end, phew "},{"type":"emoji","name":"sweat_smile"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"413dad5e-d165-4d8b-9ddd-d594709edf75","type":"message","text":"No docs yet, but ArtayInterface has a PR. I'll add some somewhere.\nDefining `Base.strides` should solve that problem.","user":"UAUPJLBQX","ts":"1613494475.022800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WzAv4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No docs yet, but ArtayInterface has a PR. I'll add some somewhere.\nDefining "},{"type":"text","text":"Base.strides","style":{"code":true}},{"type":"text","text":" should solve that problem."}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"3861b446-26a6-41a1-9d13-c40047a8a835","type":"message","text":"<https://github.com/SciML/ArrayInterface.jl/pull/113#issuecomment-770298008|https://github.com/SciML/ArrayInterface.jl/pull/113#issuecomment-770298008>\nI describe what's needed for `@avx` support, but you may instead want to set `ArrayInterface.device` to return `CPUIndex` to opt out.","user":"UAUPJLBQX","ts":"1613494722.025400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sDwZ","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/SciML/ArrayInterface.jl/pull/113#issuecomment-770298008","text":"https://github.com/SciML/ArrayInterface.jl/pull/113#issuecomment-770298008"},{"type":"text","text":"\nI describe what's needed for "},{"type":"text","text":"@avx","style":{"code":true}},{"type":"text","text":" support, but you may instead want to set "},{"type":"text","text":"ArrayInterface.device","style":{"code":true}},{"type":"text","text":" to return "},{"type":"text","text":"CPUIndex","style":{"code":true}},{"type":"text","text":" to opt out."}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"662E00FD-6E1F-4681-85CE-2289EAEBD852","type":"message","text":"Weird. I have `Base.strides` and `Base.stride` overloaded to pass on to the underlying array.","user":"US4A6G6B0","ts":"1613494722.025600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QLRn","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Weird. I have "},{"type":"text","text":"Base.strides","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"Base.stride","style":{"code":true}},{"type":"text","text":" overloaded to pass on to the underlying array."}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"da2f8506-e6c9-4d8c-bf0d-74637ed3a2df","type":"message","text":"Okay","user":"UAUPJLBQX","ts":"1613494730.025800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OKFW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Okay"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"5d6c9708-a68f-4862-bcca-2ca6501eb7e5","type":"message","text":"Where is component matrix defined?","user":"UAUPJLBQX","ts":"1613494744.026000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9VUfe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Where is component matrix defined?"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"dec9aa4f-fdaa-44b6-b847-5d00b2aa83b9","type":"message","text":"I'll have to check what is going wrong","user":"UAUPJLBQX","ts":"1613494759.026200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wA8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'll have to check what is going wrong"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"15FB7733-178D-46AD-905D-5DA24AEAC7D0","type":"message","text":"It’s just an alias for `ComponentArray{T,2,A,Axes}`\n<https://github.com/jonniedie/ComponentArrays.jl/blob/9b8fc97e368a66b72d0b417ce0c07f177950d2d8/src/componentarray.jl#L103|https://github.com/jonniedie/ComponentArrays.jl/blob/9b8fc97e368a66b72d0b417ce0c07f177950d2d8/src/componentarray.jl#L103>","user":"US4A6G6B0","ts":"1613494990.027200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YdlG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It’s just an alias for "},{"type":"text","text":"ComponentArray{T,2,A,Axes}","style":{"code":true}},{"type":"text","text":"\n"},{"type":"link","url":"https://github.com/jonniedie/ComponentArrays.jl/blob/9b8fc97e368a66b72d0b417ce0c07f177950d2d8/src/componentarray.jl#L103","text":"https://github.com/jonniedie/ComponentArrays.jl/blob/9b8fc97e368a66b72d0b417ce0c07f177950d2d8/src/componentarray.jl#L103"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"0236C96E-A9EA-4F86-8F47-02143FDB9624","type":"message","text":"Here is where the `strides` stuff is:\n\n<https://github.com/jonniedie/ComponentArrays.jl/blob/9b8fc97e368a66b72d0b417ce0c07f177950d2d8/src/math.jl#L6|https://github.com/jonniedie/ComponentArrays.jl/blob/9b8fc97e368a66b72d0b417ce0c07f177950d2d8/src/math.jl#L6>","user":"US4A6G6B0","ts":"1613495043.027900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3+1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Here is where the "},{"type":"text","text":"strides","style":{"code":true}},{"type":"text","text":" stuff is:\n"},{"type":"text","text":"\n"},{"type":"link","url":"https://github.com/jonniedie/ComponentArrays.jl/blob/9b8fc97e368a66b72d0b417ce0c07f177950d2d8/src/math.jl#L6","text":"https://github.com/jonniedie/ComponentArrays.jl/blob/9b8fc97e368a66b72d0b417ce0c07f177950d2d8/src/math.jl#L6"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"},{"client_msg_id":"0e7641d7-d745-4231-aac7-dab8d75c892e","type":"message","text":"<https://github.com/jonniedie/ComponentArrays.jl/pull/64>","user":"UAUPJLBQX","ts":"1613497857.028400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1ER1S","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/jonniedie/ComponentArrays.jl/pull/64"}]}]}],"thread_ts":"1613490171.016500","parent_user_id":"U01H36BUDJB"}]