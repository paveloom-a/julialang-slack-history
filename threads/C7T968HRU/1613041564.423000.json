[{"client_msg_id":"8a897efa-2e58-44b7-bbe7-01d25917d30f","type":"message","text":"do you have an example?I","user":"U69BL50BF","ts":"1613041564.423000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+1BiX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"do you have an example?I"}]}]}],"thread_ts":"1613041564.423000","reply_count":7,"reply_users_count":2,"latest_reply":"1613049315.425600","reply_users":["U01H36BUDJB","U69BL50BF"],"subscribed":false},{"client_msg_id":"859d9991-e29d-4541-9dcf-a5a1ab3bd3b0","type":"message","text":"Sure. Forgive the messiness of this code... I'm using it to test various different things. I can try to strip it down if it's not understandable enough.\n\n```p = ComponentArray(lv=ComponentArray(α=2.2,β=1.0,δ=2.0,γ=0.4),a=1.0,b=1.0)\nu0 = ComponentArray(state=ComponentArray(x=1.0,y=1.0))\nax_p = getaxes(p)\nax_u = getaxes(u0)\n\nglobal d_cache = dualcache(zeros(2),Val{length(p)})\n\nfunction lotka_volterra(du,u,p,t)\n  d = get_tmp(c_cache, u)\n  u = ComponentArray(u,ax_u)\n  p = ComponentArray(p,ax_p)\n  @unpack x,y = u.state\n  @unpack lv, a, b = p\n  @unpack α, β, δ, γ = lv\n  d .= (2.0*a,3.0*b)\n  du[1] = dx = (α - β*y)x + d[1]\n  du[2] = dy = (δ*x - γ)y + d[2]\nend\nu0 = Array(u0)\np = Array(p)\nprob = ODEProblem(lotka_volterra,u0,(0.0,10.0),p)\n\nfunction predict_rd(p)\nArray(solve(prob,Tsit5(),p=p,saveat=0.1,reltol=1e-4, sensealg=ForwardDiffSensitivity(chunk_size=2)))\nend\nloss_rd(p) = sum(abs2,x-1 for x in predict_rd(p))\n\nopt = ADAM(0.1)\n@time res = DiffEqFlux.sciml_train(loss_rd, p, opt, maxiters=100)```","user":"U01H36BUDJB","ts":"1613045821.423900","team":"T68168MUP","edited":{"user":"U01H36BUDJB","ts":"1613046324.000000"},"blocks":[{"type":"rich_text","block_id":"qnT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Sure. Forgive the messiness of this code... I'm using it to test various different things. I can try to strip it down if it's not understandable enough.\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"p = ComponentArray(lv=ComponentArray(α=2.2,β=1.0,δ=2.0,γ=0.4),a=1.0,b=1.0)\nu0 = ComponentArray(state=ComponentArray(x=1.0,y=1.0))\nax_p = getaxes(p)\nax_u = getaxes(u0)\n\nglobal d_cache = dualcache(zeros(2),Val{length(p)})\n\nfunction lotka_volterra(du,u,p,t)\n  d = get_tmp(c_cache, u)\n  u = ComponentArray(u,ax_u)\n  p = ComponentArray(p,ax_p)\n  @unpack x,y = u.state\n  @unpack lv, a, b = p\n  @unpack α, β, δ, γ = lv\n  d .= (2.0*a,3.0*b)\n  du[1] = dx = (α - β*y)x + d[1]\n  du[2] = dy = (δ*x - γ)y + d[2]\nend\nu0 = Array(u0)\np = Array(p)\nprob = ODEProblem(lotka_volterra,u0,(0.0,10.0),p)\n\nfunction predict_rd(p)\nArray(solve(prob,Tsit5(),p=p,saveat=0.1,reltol=1e-4, sensealg=ForwardDiffSensitivity(chunk_size=2)))\nend\nloss_rd(p) = sum(abs2,x-1 for x in predict_rd(p))\n\nopt = ADAM(0.1)\n@time res = DiffEqFlux.sciml_train(loss_rd, p, opt, maxiters=100)"}]}]}],"thread_ts":"1613041564.423000","parent_user_id":"U69BL50BF"},{"client_msg_id":"1f1eca90-c7f6-4386-b8b4-d860a194b737","type":"message","text":"notice that I set `chunk_size=2` so this should fail because the chunk sizes don't line up. But it works. And if you check the type in `lotka_volterra` , it's still `Dual` with `N=6`","user":"U01H36BUDJB","ts":"1613045868.424100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OgT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"notice that I set "},{"type":"text","text":"chunk_size=2","style":{"code":true}},{"type":"text","text":" so this should fail because the chunk sizes don't line up. But it works. And if you check the type in "},{"type":"text","text":"lotka_volterra","style":{"code":true}},{"type":"text","text":" , it's still "},{"type":"text","text":"Dual","style":{"code":true}},{"type":"text","text":" with "},{"type":"text","text":"N=6","style":{"code":true}}]}]}],"thread_ts":"1613041564.423000","parent_user_id":"U69BL50BF"},{"client_msg_id":"d1452e1a-436d-4b40-acb1-5471a47e7dfd","type":"message","text":"also this is obviously a meaningless variant of Lotka Volterra.... just for helping me figure out how to use the autodiff.","user":"U01H36BUDJB","ts":"1613045957.424500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fq6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"also this is obviously a meaningless variant of Lotka Volterra.... just for helping me figure out how to use the autodiff."}]}]}],"thread_ts":"1613041564.423000","parent_user_id":"U69BL50BF"},{"client_msg_id":"6631bc94-1a2f-4ebb-aebd-762f35d7f730","type":"message","text":"oh interesting","user":"U69BL50BF","ts":"1613048081.425000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fp3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh interesting"}]}]}],"thread_ts":"1613041564.423000","parent_user_id":"U69BL50BF"},{"client_msg_id":"2abe03e5-2388-44e6-a7e6-e2dc5667118c","type":"message","text":"It looks like chunking might be overloooked there for now","user":"U69BL50BF","ts":"1613048091.425200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OPV=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It looks like chunking might be overloooked there for now"}]}]}],"thread_ts":"1613041564.423000","parent_user_id":"U69BL50BF"},{"client_msg_id":"e3a4e020-05cf-4a87-9c9b-139d7d9b82ba","type":"message","text":"open an issue? This is a good test case.","user":"U69BL50BF","ts":"1613048099.425400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"S8F","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"open an issue? This is a good test case."}]}]}],"thread_ts":"1613041564.423000","parent_user_id":"U69BL50BF"},{"client_msg_id":"6cc4d12d-cc9c-4389-80d1-ee70a1fae7bc","type":"message","text":"is the code OK as is?","user":"U01H36BUDJB","ts":"1613049315.425600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wc0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"is the code OK as is?"}]}]}],"thread_ts":"1613041564.423000","parent_user_id":"U69BL50BF"}]