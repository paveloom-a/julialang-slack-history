[{"client_msg_id":"fafab707-71cd-4c2c-b402-b85d2ebd2414","type":"message","text":"Thought experiment.\nWhat's the worst that could happen if we allowed anyone to use Registror to trigger a release of a package?\nRather than just people with permissions. :thread:","user":"U6A936746","ts":"1609099430.121200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"15ljs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thought experiment.\nWhat's the worst that could happen if we allowed anyone to use Registror to trigger a release of a package?\nRather than just people with permissions. "},{"type":"emoji","name":"thread"}]}]}],"thread_ts":"1609099430.121200","reply_count":11,"reply_users_count":3,"latest_reply":"1609105782.125800","reply_users":["U6A936746","U7THT3TM3","UBVE598BC"],"subscribed":false},{"client_msg_id":"ed642a1d-37cb-46c6-9be0-e62607f50580","type":"message","text":"If the version hasn't been incremented since last release but changes have been pushed.\n\nSo triggering a release will just be rejected as that release already has been made","user":"U6A936746","ts":"1609099533.121300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cmYq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If the version hasn't been incremented since last release but changes have been pushed.\n\nSo triggering a release will just be rejected as that release already has been made"}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"92454157-977c-47fe-86ba-13e4440fb4cd","type":"message","text":"If the version number has been incremented to and given a `-DEV` prerelease suffix. Like Julia does, and like ColPrac recommends.\nAnd changes have been pushed.\n\nThen release will be rejected since can't register releases with a SemVer prerelease suffix","user":"U6A936746","ts":"1609099655.121500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=9OMH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If the version number has been incremented to and given a "},{"type":"text","text":"-DEV","style":{"code":true}},{"type":"text","text":" prerelease suffix. Like Julia does, and like ColPrac recommends.\nAnd changes have been pushed.\n\nThen release will be rejected since can't register releases with a SemVer prerelease suffix"}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"a6e98d33-a25b-42e1-97eb-bbd95e3bccba","type":"message","text":"I thought maybe there could be a problem where some bad actor creates a branch that doesn't get merged to master, and they register that branch.\nBut that would be rejected since that branch would not be on the registered repo, it would be on the bad actor's fork.\nUnless the bad actor had rights to create branches on the main repo.\nBut at that point they would also have rights to use Registror today","user":"U6A936746","ts":"1609099866.121700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ly4o/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I thought maybe there could be a problem where some bad actor creates a branch that doesn't get merged to master, and they register that branch.\nBut that would be rejected since that branch would not be on the registered repo, it would be on the bad actor's fork.\nUnless the bad actor had rights to create branches on the main repo.\nBut at that point they would also have rights to use Registror today"}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"656da0f1-935b-4540-9916-0619110a7c26","type":"message","text":"One case is if you incremented the version number.\nBut did not tag a release yet and did not add a prerelease suffix.\nA bad actor here could register something while you were still in the middle of making a series of changes that you wanted to register all at once.\n\nIdk if anyone does this way of incrementing. Seems bad and confusing.\nBut I guess some people might \n\nThat would be pretty bad.\nEspecially since it would trigger CompatHelper.","user":"U6A936746","ts":"1609100014.121900","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1609100106.000000"},"blocks":[{"type":"rich_text","block_id":"1mVM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"One case is if you incremented the version number.\nBut did not tag a release yet and did not add a prerelease suffix.\nA bad actor here could register something while you were still in the middle of making a series of changes that you wanted to register all at once.\n\nIdk if anyone does this way of incrementing. Seems bad and confusing.\nBut I guess some people might \n\nThat would be pretty bad.\nEspecially since it would trigger CompatHelper."}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"1fa2d15d-73cf-4b0d-ad19-f0b0bb58fab5","type":"message","text":"Another case is if you mistakenly over-increment the version number.\nTrigger release.\nAnd then cancel it before it goes through. Either because Automerge said it was non-sequential.\nOr because you changed your mind.\nThis is particularly bad if it's a major release.\n\n\nThen a bad actor could go later (before that version number is used) and trigger a release on that commit from history.\nAt a time that it is legal\n\n\nI guess we could defend from that with git history checks.\nLike not Automerging commits that are not from the head of the repo.\nProbably reasonable\nCos while people can have legit reasons to do so, they are rare and probably want manually insight anyway","user":"U6A936746","ts":"1609100266.122300","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1609100411.000000"},"blocks":[{"type":"rich_text","block_id":"Y6uZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Another case is if you mistakenly over-increment the version number.\nTrigger release.\nAnd then cancel it before it goes through. Either because Automerge said it was non-sequential.\nOr because you changed your mind.\nThis is particularly bad if it's a major release.\n\n\nThen a bad actor could go later (before that version number is used) and trigger a release on that commit from history.\nAt a time that it is legal\n\n\nI guess we could defend from that with git history checks.\nLike not Automerging commits that are not from the head of the repo.\nProbably reasonable\nCos while people can have legit reasons to do so, they are rare and probably want manually insight anyway"}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"FAEA2BC1-41A4-4D83-A464-B22B7C972029","type":"message","text":"Plenty of people have master in a non-stable state","user":"U7THT3TM3","ts":"1609104810.123100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TKvu1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Plenty of people have master in a non-stable state"}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"D85D1046-B4C2-4560-A559-6641F0B5C1F3","type":"message","text":"It would be chaotic if just anyone could register a new version off of your package's master branch ","user":"U7THT3TM3","ts":"1609104838.124000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9qW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It would be chaotic if just anyone could register a new version off of your package's master branch "}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"38138324-eba9-4a3f-9042-81fecd89478d","type":"message","text":"Yes, but think about it carefully.\nWork through all the paths, and situations.\nThat is the point of the thought experiment.\nWhat happens when they trigger Registror.\nUnder what circumstances does a release actually get made?\n\nThe thought experiment is to understand they system we have.\nBy removing 1 part of it and seeing how it acts.","user":"U6A936746","ts":"1609104939.124200","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1609105278.000000"},"blocks":[{"type":"rich_text","block_id":"iVqA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes, but think about it carefully.\nWork through all the paths, and situations.\nThat is the point of the thought experiment.\nWhat happens when they trigger Registror.\nUnder what circumstances does a release actually get made?\n\nThe thought experiment is to understand they system we have.\nBy removing 1 part of it and seeing how it acts."}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"ceead3e2-c12f-4f1a-bcd2-085f4972ca83","type":"message","text":"Another path.\nThe package has never been registered.\nBut it has a Project.toml with all the fields.\nIncluding version set to `0.1.0`\n(I think this is the default from PkgTemplates).\nThis is a place where you probably will make a series of PRs before registering\nThis one is pretty bad.\n\nHere though we do have the 3 day window.\nAnd we could e.g. automatically ping everyone who has made a commit in that first registration PR.\n\nBut I don't think that is enough, since they could be on holidays etc","user":"U6A936746","ts":"1609105406.124800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Hi5m","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Another path.\nThe package has never been registered.\nBut it has a Project.toml with all the fields.\nIncluding version set to "},{"type":"text","text":"0.1.0","style":{"code":true}},{"type":"text","text":"\n(I think this is the default from PkgTemplates).\nThis is a place where you probably will make a series of PRs before registering\nThis one is pretty bad.\n\nHere though we do have the 3 day window.\nAnd we could e.g. automatically ping everyone who has made a commit in that first registration PR.\n\nBut I don't think that is enough, since they could be on holidays etc"}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"a2092ba9-d84e-42cd-a53d-1317fe1f9da9","type":"message","text":"I think first registration should be much stricter than subsequent versions. There also other inconvenient attack vectors against a package that hasn't been registered yet, such as stealing the name or the uuid and register another repo.","user":"UBVE598BC","ts":"1609105709.125600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ygVTy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think first registration should be much stricter than subsequent versions. There also other inconvenient attack vectors against a package that hasn't been registered yet, such as stealing the name or the uuid and register another repo."}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"},{"client_msg_id":"c006cd60-a158-4ab1-b932-d946d01dd084","type":"message","text":"But generally I don't see that there is that much harm that really can be done with unsolicited registrations.","user":"UBVE598BC","ts":"1609105782.125800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"rcdH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But generally I don't see that there is that much harm that really can be done with unsolicited registrations."}]}]}],"thread_ts":"1609099430.121200","parent_user_id":"U6A936746"}]