[{"client_msg_id":"14ac7401-c651-4826-93a3-49a15f314411","type":"message","text":"Is there any documentation/explanation anywhere of what exactly was changed about `Base.llvmcall` in 1.6?\n\nI’m curious why exactly it is that Julia 1.6 breaks, e.g., <https://github.com/chriselrod/SIMDPirates.jl/blob/master/src/special.jl#L283-L871> and if there’s anything that would help explain what has to be done to get an equivalent function working in 1.6, without bugging Chris","user":"UGU761DU2","ts":"1611285282.054700","team":"T68168MUP","edited":{"user":"UGU761DU2","ts":"1611285312.000000"},"blocks":[{"type":"rich_text","block_id":"64fG0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there any documentation/explanation anywhere of what exactly was changed about "},{"type":"text","text":"Base.llvmcall","style":{"code":true}},{"type":"text","text":" in 1.6?\n\nI’m curious why exactly it is that Julia 1.6 breaks, e.g., "},{"type":"link","url":"https://github.com/chriselrod/SIMDPirates.jl/blob/master/src/special.jl#L283-L871"},{"type":"text","text":" and if there’s anything that would help explain what has to be done to get an equivalent function working in 1.6, without bugging Chris"}]}]}],"thread_ts":"1611285282.054700","reply_count":20,"reply_users_count":5,"latest_reply":"1611301062.064600","reply_users":["U0179G7FG4F","UGU761DU2","U67BJLYCS","UAUPJLBQX","U68A3ASP9"],"subscribed":false},{"client_msg_id":"17f19080-f33d-4b75-ac10-640b662c2280","type":"message","text":"Isn't SIMDPirates deprecated to VectorizationBase?","user":"U0179G7FG4F","ts":"1611286197.059600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OSHtR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Isn't SIMDPirates deprecated to VectorizationBase?"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"7583d929-b493-48db-99e9-6ed9e384ab2f","type":"message","text":"Yeah, but not everything in SIMDPirates has a replacement in VectorizationBase, particularly including `verf`","user":"UGU761DU2","ts":"1611286341.060100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MQak","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, but not everything in SIMDPirates has a replacement in VectorizationBase, particularly including "},{"type":"text","text":"verf","style":{"code":true}}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"b5c27564-04f5-450c-903a-ef6e4f7e884d","type":"message","text":"And also I’m just curious why 1.6 broke it","user":"UGU761DU2","ts":"1611286364.060300","team":"T68168MUP","edited":{"user":"UGU761DU2","ts":"1611286441.000000"},"blocks":[{"type":"rich_text","block_id":"vcH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And also I’m just curious why 1.6 broke it"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"3478c590-63d8-46b8-9c0c-85fd28b35d90","type":"message","text":"Possibly <@U68A3ASP9>, since I see your name on what I think is a relevant commit?\n\n<https://github.com/JuliaLang/julia/commit/96d36737d2afa618cae61c9979d02ea3adf37ebe>\n\nbut which I can’t quite make head nor tails of","user":"UGU761DU2","ts":"1611286636.060600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tlpR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Possibly "},{"type":"user","user_id":"U68A3ASP9"},{"type":"text","text":", since I see your name on what I think is a relevant commit?\n\n"},{"type":"link","url":"https://github.com/JuliaLang/julia/commit/96d36737d2afa618cae61c9979d02ea3adf37ebe"},{"type":"text","text":"\n\nbut which I can’t quite make head nor tails of"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"40182219-1c37-4749-816b-ab788edf66c7","type":"message","text":"See <https://github.com/eschnett/SIMD.jl/pull/70> as an example of what needs changing","user":"U67BJLYCS","ts":"1611287636.060800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"iYg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"See "},{"type":"link","url":"https://github.com/eschnett/SIMD.jl/pull/70"},{"type":"text","text":" as an example of what needs changing"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2","reactions":[{"name":"thankyou","users":["UGU761DU2"],"count":1}]},{"client_msg_id":"5bf247b8-e80e-499a-b2a4-ba6307cbeaea","type":"message","text":"so instead of functions you now have to embed modules","user":"U67BJLYCS","ts":"1611287667.061000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/fCoj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so instead of functions you now have to embed modules"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"4db4fa75-ebad-485d-9b6f-c305724b6de5","type":"message","text":"and then tell it which function from the module it is supposed to be calling","user":"U67BJLYCS","ts":"1611287706.061200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Fmg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and then tell it which function from the module it is supposed to be calling"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"3230cb5a-a1d1-4ba1-862d-dd24d25ed1f4","type":"message","text":"<@UAUPJLBQX> do you have a reference for where you got the implementation for erf from? I would be interested in writing a scalar version for `SpecialFunctions`","user":"U0179G7FG4F","ts":"1611289171.061500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"COpCO","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UAUPJLBQX"},{"type":"text","text":" do you have a reference for where you got the implementation for erf from? I would be interested in writing a scalar version for "},{"type":"text","text":"SpecialFunctions","style":{"code":true}}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"4df73c7b-bcb0-46ff-95a6-a81e79bc49d3","type":"message","text":"Shoot, there should have been copyright statements on those.\nI did have it in the <https://github.com/chriselrod/SLEEFPirates.jl/blob/5b82e4f5607cb5252a4f25e6d92275a178432e98/src/xsimd.jl#L1|xsimd.jl> inside SLEEFPirates, but that files been deleted and should have had it in SIMDPirates too.\n<https://github.com/xtensor-stack/xsimd/blob/4dd2482908de2e90aa6b9ad004ae90036216a945/include/xsimd/math/xsimd_error.hpp>","user":"UAUPJLBQX","ts":"1611296370.061800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dP+3Z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Shoot, there should have been copyright statements on those.\nI did have it in the "},{"type":"link","url":"https://github.com/chriselrod/SLEEFPirates.jl/blob/5b82e4f5607cb5252a4f25e6d92275a178432e98/src/xsimd.jl#L1","text":"xsimd.jl"},{"type":"text","text":" inside SLEEFPirates, but that files been deleted and should have had it in SIMDPirates too.\n"},{"type":"link","url":"https://github.com/xtensor-stack/xsimd/blob/4dd2482908de2e90aa6b9ad004ae90036216a945/include/xsimd/math/xsimd_error.hpp"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"e3603a93-7502-470b-af8e-35a710db02e2","type":"message","text":"I was really lazy and just compiled it into .ll files, and then copy and pasted the code.\nI should work on an actual Julia translation of either the C++ source or the llvm.\nI'd also like a SIMD `erf`.","user":"UAUPJLBQX","ts":"1611296434.062000","team":"T68168MUP","edited":{"user":"UAUPJLBQX","ts":"1611296603.000000"},"blocks":[{"type":"rich_text","block_id":"m6n","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I was really lazy and just compiled it into .ll files, and then copy and pasted the code.\nI should work on an actual Julia translation of either the C++ source or the llvm.\nI'd also like a SIMD "},{"type":"text","text":"erf","style":{"code":true}},{"type":"text","text":"."}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"0fdd7075-1e89-4368-813b-87d0b33e85dd","type":"message","text":"what's the license on that code? I don't want to look at it if it could cause issues","user":"U0179G7FG4F","ts":"1611296781.062300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"AN6ND","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what's the license on that code? I don't want to look at it if it could cause issues"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2","reactions":[{"name":"+1","users":["U7THT3TM3"],"count":1}]},{"client_msg_id":"412f90e8-9abf-445d-9e5f-63b286563bdf","type":"message","text":"BSD 3-cluase (MIT compatible)","user":"UAUPJLBQX","ts":"1611296807.062500","team":"T68168MUP","edited":{"user":"UAUPJLBQX","ts":"1611296848.000000"},"blocks":[{"type":"rich_text","block_id":"CMaqm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"BSD 3-cluase (MIT compatible)"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2","reactions":[{"name":"+1","users":["U0179G7FG4F","U7THT3TM3"],"count":2}]},{"client_msg_id":"3ad7cf63-bd61-4212-a3d9-410449135d02","type":"message","text":"Thanks for the link <@U67BJLYCS> - I think I got it to work following that!\n<https://gist.github.com/brenhinkeller/86af694cb0acf9201effcfcc025ee9ec>","user":"UGU761DU2","ts":"1611299038.062900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sH7H","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks for the link "},{"type":"user","user_id":"U67BJLYCS"},{"type":"text","text":" - I think I got it to work following that!\n"},{"type":"link","url":"https://gist.github.com/brenhinkeller/86af694cb0acf9201effcfcc025ee9ec"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"6d179861-65a8-4448-a27b-e139dd33f939","type":"message","text":"For anyone else who wants to try this, the switch from functions to modules also seems to mean that you also have to decrement all the register numbers by one, which requires more than a little bit of regexing","user":"UGU761DU2","ts":"1611299074.063100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bdUnO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For anyone else who wants to try this, the switch from functions to modules also seems to mean that you also have to decrement all the register numbers by one, which requires more than a little bit of regexing"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"f2a963f5-6925-4cf7-9ab8-a83d3d122751","type":"message","text":"or just use non-numbered variables, e.g. if you do `%var1` LLVM won't complain about the numbering.","user":"U68A3ASP9","ts":"1611299129.063300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"JlXv6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"or just use non-numbered variables, e.g. if you do "},{"type":"text","text":"%var1","style":{"code":true}},{"type":"text","text":" LLVM won't complain about the numbering."}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2","reactions":[{"name":"+1","users":["UGU761DU2"],"count":1}]},{"client_msg_id":"2e2047e4-ee19-4404-b944-96e9daa07530","type":"message","text":"The 512-bit wide ones still error for me, but I think that’s just because  I only have avx2 and not avx512","user":"UGU761DU2","ts":"1611299256.063600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Y+7Qc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The 512-bit wide ones still error for me, but I think that’s just because  I only have avx2 and not avx512"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"803dcac0-2931-4834-b8ff-367b312e5150","type":"message","text":"<@UAUPJLBQX> if that gist looks good to you, would you like me to PR that anywhere?","user":"UGU761DU2","ts":"1611299266.063800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"uGnq","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UAUPJLBQX"},{"type":"text","text":" if that gist looks good to you, would you like me to PR that anywhere?"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2"},{"client_msg_id":"1e1e8dfb-78c1-4bf5-b1fb-a4ee3e950d09","type":"message","text":"if you want these functions to be inlined, be sure to attach the `alwaysinline` attribute","user":"U68A3ASP9","ts":"1611299356.064000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NDS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"if you want these functions to be inlined, be sure to attach the "},{"type":"text","text":"alwaysinline","style":{"code":true}},{"type":"text","text":" attribute"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2","reactions":[{"name":"+1","users":["UGU761DU2","U7THT3TM3"],"count":2}]},{"client_msg_id":"2c8dfa99-cf3f-4214-afa0-ec54406b4e56","type":"message","text":"You could make a PR to either VectorizationBase.jl or SLEEFPirates.jl.","user":"UAUPJLBQX","ts":"1611301027.064300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3AF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You could make a PR to either VectorizationBase.jl or SLEEFPirates.jl."}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2","reactions":[{"name":"+1","users":["UGU761DU2"],"count":1}]},{"client_msg_id":"b8176353-1159-4ca8-b4c7-a668d79e9af9","type":"message","text":"Mind adding a copy attributing the code to the original source: <https://github.com/xtensor-stack/xsimd/blob/master/LICENSE> ?","user":"UAUPJLBQX","ts":"1611301062.064600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7Gr4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Mind adding a copy attributing the code to the original source: "},{"type":"link","url":"https://github.com/xtensor-stack/xsimd/blob/master/LICENSE"},{"type":"text","text":" ?"}]}]}],"thread_ts":"1611285282.054700","parent_user_id":"UGU761DU2","reactions":[{"name":"+1","users":["UGU761DU2","U7THT3TM3"],"count":2}]}]