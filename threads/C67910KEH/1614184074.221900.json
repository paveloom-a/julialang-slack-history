[{"client_msg_id":"504ca837-fac0-4146-b0c5-0d0d57b32254","type":"message","text":"on 1.6, precompile throws:\n``````\n(@v1.6) pkg&gt; precompile\nPrecompiling┌ Error: Pkg.precompile error\n│   exception =\n│    IOError: could not spawn `\n\nresource temporarily unavailable (EAGAIN)\n``````\nis this a over spawn issue Julia should try to avoid or is the hosting server mis-configured?","user":"UH8A351DJ","ts":"1614184074.221900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0fVp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"on 1.6, precompile throws:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"```\n(@v1.6) pkg> precompile\nPrecompiling┌ Error: Pkg.precompile error\n│   exception =\n│    IOError: could not spawn `\n\nresource temporarily unavailable (EAGAIN)\n```"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"is this a over spawn issue Julia should try to avoid or is the hosting server mis-configured?"}]}]}],"thread_ts":"1614184074.221900","reply_count":20,"reply_users_count":2,"latest_reply":"1614187828.227700","reply_users":["U8MPCDJAY","UH8A351DJ"],"subscribed":false},{"client_msg_id":"66eff5b3-9085-477a-8c28-1b3d95053c52","type":"message","text":"Is that the full error message? Looks malformed","user":"U8MPCDJAY","ts":"1614186575.222800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qXs2S","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is that the full error message? Looks malformed"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"d67e2181-5e0f-46e6-8cae-3f63e884a117","type":"message","text":"no, I hide the error where bunch of paths are involved","user":"UH8A351DJ","ts":"1614186948.223000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pxqbl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"no, I hide the error where bunch of paths are involved"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"494a43a5-926b-4d4f-bfeb-94ed26a5cd1c","type":"message","text":"does loading the packages work? The way subprocesses are launched hasn’t actually changed from the way packages are precompiled during code load, just the scheduling of it","user":"U8MPCDJAY","ts":"1614187082.223200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6UB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"does loading the packages work? The way subprocesses are launched hasn’t actually changed from the way packages are precompiled during code load, just the scheduling of it"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"dfc446f6-adeb-4aae-b579-328553d93e90","type":"message","text":"yeah, loading packages work","user":"UH8A351DJ","ts":"1614187098.223400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pJD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah, loading packages work"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"9c03431c-e2a6-4921-8607-4f4c5f2e1cab","type":"message","text":"just can't precompile all of them at once","user":"UH8A351DJ","ts":"1614187103.223600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"K72","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"just can't precompile all of them at once"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"1970e501-f183-44aa-9669-561299b37494","type":"message","text":"you on windows?","user":"U8MPCDJAY","ts":"1614187122.223800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BEG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"you on windows?"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"1d743154-3c8f-415b-a75e-9f6d69634834","type":"message","text":"nope, Linux 64bits","user":"UH8A351DJ","ts":"1614187129.224000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"mXXah","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"nope, Linux 64bits"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"c505b9cd-5e6d-48d3-80aa-d0f5139d5b3a","type":"message","text":"once I've manually compiled enough of them, `]precompile` works again","user":"UH8A351DJ","ts":"1614187154.224200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e/1x","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"once I've manually compiled enough of them, "},{"type":"text","text":"]precompile","style":{"code":true}},{"type":"text","text":" works again"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"4c4bb5d9-8088-4fad-bc56-48c9e5828dd8","type":"message","text":"Does `Base.Sys.CPU_THREADS` give you an accurate number for the number of threads that the CPU can run concurrently?","user":"U8MPCDJAY","ts":"1614187218.224400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UKa","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does "},{"type":"text","text":"Base.Sys.CPU_THREADS","style":{"code":true}},{"type":"text","text":" give you an accurate number for the number of threads that the CPU can run concurrently?"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"5a46816e-fe88-46c7-82aa-e4959097c8b6","type":"message","text":"If that’s not reliable, you can set the max number of tasks manually with `ENV[\"JULIA_NUM_PRECOMPILE_TASKS\"]=4` etc.","user":"U8MPCDJAY","ts":"1614187327.224600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MfP0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If that’s not reliable, you can set the max number of tasks manually with "},{"type":"text","text":"ENV[\"JULIA_NUM_PRECOMPILE_TASKS\"]=4","style":{"code":true}},{"type":"text","text":" etc."}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"795a0802-edb3-4d44-9d58-89cc650c3b85","type":"message","text":"yes. this is a shared environment with 2 CPU, 28 cores. But I suspect there's some limitation by either sysadmin or the fact that 56 threads are across 2 cpus","user":"UH8A351DJ","ts":"1614187365.224800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hoN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes. this is a shared environment with 2 CPU, 28 cores. But I suspect there's some limitation by either sysadmin or the fact that 56 threads are across 2 cpus"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"172b8a32-0d66-4613-b6ae-1c62c4990dcc","type":"message","text":"yeah, so you might just have to manually limit it","user":"U8MPCDJAY","ts":"1614187396.225000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GSoD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah, so you might just have to manually limit it"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"6754cd36-96e9-46ef-80ac-7120b91444c9","type":"message","text":"*should we limit it to max = core count instead of core count x2?","user":"UH8A351DJ","ts":"1614187407.225200","team":"T68168MUP","edited":{"user":"UH8A351DJ","ts":"1614187426.000000"},"blocks":[{"type":"rich_text","block_id":"J+FNV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"*should we limit it to max = core count instead of core count x2?"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"5be5e706-9609-47e6-b0a9-fb38fd3302c1","type":"message","text":"`ENV[\"JULIA_NUM_PRECOMPILE_TASKS\"]=28` seems to work","user":"UH8A351DJ","ts":"1614187458.225600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5N1U","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ENV[\"JULIA_NUM_PRECOMPILE_TASKS\"]=28","style":{"code":true}},{"type":"text","text":" seems to work"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"306b91f1-2f75-4272-8e35-1c7cb3ddc27f","type":"message","text":"I think your case is more of an outlier. Its the first report I’ve seen other than 2 reports on windows that we defensively protect against by halving the number of tasks on windows","user":"U8MPCDJAY","ts":"1614187507.225800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"eq=pj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think your case is more of an outlier. Its the first report I’ve seen other than 2 reports on windows that we defensively protect against by halving the number of tasks on windows"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ","reactions":[{"name":"+1","users":["UH8A351DJ"],"count":1}]},{"client_msg_id":"c909b57e-44f0-424c-b5d9-f0fad5e2e976","type":"message","text":"the windows issue seems like a julia bug, but there aren’t any leads on the source, so for 1.6 we just limit windows tasks","user":"U8MPCDJAY","ts":"1614187549.226200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SF58t","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the windows issue seems like a julia bug, but there aren’t any leads on the source, so for 1.6 we just limit windows tasks"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"015fbb7b-f204-4366-94ac-e772fc442bf3","type":"message","text":"I would also think it's an idea to limit to &lt;= `JULIA_NUM_THREADS` since if user don't want to occupy that much resources in computation, they probably don't want to during precompilation either.","user":"UH8A351DJ","ts":"1614187581.226400","team":"T68168MUP","edited":{"user":"UH8A351DJ","ts":"1614187597.000000"},"blocks":[{"type":"rich_text","block_id":"21E6B","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I would also think it's an idea to limit to <= "},{"type":"text","text":"JULIA_NUM_THREADS","style":{"code":true}},{"type":"text","text":" since if user don't want to occupy that much resources in computation, they probably don't want to during precompilation either."}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"994850ca-b227-4620-84ac-6e5037037bd8","type":"message","text":"It’s an interesting point, but so far this is the only complaint I’ve seen. Perhaps worth opening a Pkg issue to see if others agree?","user":"U8MPCDJAY","ts":"1614187706.226800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"K/C8=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It’s an interesting point, but so far this is the only complaint I’ve seen. Perhaps worth opening a Pkg issue to see if others agree?"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ","reactions":[{"name":"+1","users":["UH8A351DJ"],"count":1}]},{"client_msg_id":"20a92cdb-82ed-4ddb-a449-0ef098936804","type":"message","text":"There was a complaint about using too much power while running on battery, for which I made <https://github.com/IanButterworth/PowerMonitor.jl>","user":"U8MPCDJAY","ts":"1614187750.227400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LAQm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"There was a complaint about using too much power while running on battery, for which I made "},{"type":"link","url":"https://github.com/IanButterworth/PowerMonitor.jl"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ"},{"client_msg_id":"5acd9a4e-8dae-44e3-b90f-5a88365f287a","type":"message","text":"Also, if you wanted to do a PR to improve the docstring for `Pkg.precompile` to highlight that in some situations, the user might want to limit tasks with the above setting, that might be helpful","user":"U8MPCDJAY","ts":"1614187828.227700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5m3M","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also, if you wanted to do a PR to improve the docstring for "},{"type":"text","text":"Pkg.precompile","style":{"code":true}},{"type":"text","text":" to highlight that in some situations, the user might want to limit tasks with the above setting, that might be helpful"}]}]}],"thread_ts":"1614184074.221900","parent_user_id":"UH8A351DJ","reactions":[{"name":"+1","users":["UH8A351DJ"],"count":1}]}]