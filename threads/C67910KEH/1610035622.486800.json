[{"client_msg_id":"d8c05d8a-5a48-43de-bebb-19a61dadba3a","type":"message","text":"In what cases would pre-allocated versions of functions yield higher execution times (with lower allocations, of course)?\n\ne.g. Pre-allocated:\n```BenchmarkTools.Trial: \n  memory estimate:  3.07 MiB\n  allocs estimate:  865\n  --------------\n  minimum time:     98.070 ms (0.00% GC)\n  median time:      102.907 ms (0.00% GC)\n  mean time:        102.901 ms (0.15% GC)\n  maximum time:     108.438 ms (0.00% GC)\n  --------------\n  samples:          49\n  evals/sample:     1```\nvs. \"Functional\" (i.e. temporary array creations in matrix assembly by calling functions that return arrays):\n```BenchmarkTools.Trial: \n  memory estimate:  8.04 MiB\n  allocs estimate:  3142\n  --------------\n  minimum time:     83.709 ms (0.00% GC)\n  median time:      95.407 ms (0.00% GC)\n  mean time:        95.292 ms (0.53% GC)\n  maximum time:     106.211 ms (4.97% GC)\n  --------------\n  samples:          53\n  evals/sample:     1```","user":"U01G1P8A46S","ts":"1610035622.486800","team":"T68168MUP","edited":{"user":"U01G1P8A46S","ts":"1610035892.000000"},"blocks":[{"type":"rich_text","block_id":"XQRb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In what cases would pre-allocated versions of functions yield higher execution times (with lower allocations, of course)?\n\ne.g. Pre-allocated:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"BenchmarkTools.Trial: \n  memory estimate:  3.07 MiB\n  allocs estimate:  865\n  --------------\n  minimum time:     98.070 ms (0.00% GC)\n  median time:      102.907 ms (0.00% GC)\n  mean time:        102.901 ms (0.15% GC)\n  maximum time:     108.438 ms (0.00% GC)\n  --------------\n  samples:          49\n  evals/sample:     1"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"vs. \"Functional\" (i.e. temporary array creations in matrix assembly by calling functions that return arrays):\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"BenchmarkTools.Trial: \n  memory estimate:  8.04 MiB\n  allocs estimate:  3142\n  --------------\n  minimum time:     83.709 ms (0.00% GC)\n  median time:      95.407 ms (0.00% GC)\n  mean time:        95.292 ms (0.53% GC)\n  maximum time:     106.211 ms (4.97% GC)\n  --------------\n  samples:          53\n  evals/sample:     1"}]}]}],"thread_ts":"1610035622.486800","reply_count":7,"reply_users_count":3,"latest_reply":"1610037382.488600","reply_users":["UH24GRBLL","U01G1P8A46S","U67D54KS8"],"subscribed":false},{"client_msg_id":"f161f055-35d9-43be-b9f7-7837f5dc6d7f","type":"message","text":"should be in pretty much all cases, but if your functions allocate then they are mostly going to be slower","user":"UH24GRBLL","ts":"1610035714.487000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Kvs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"should be in pretty much all cases, but if your functions allocate then they are mostly going to be slower"}]}]}],"thread_ts":"1610035622.486800","parent_user_id":"U01G1P8A46S"},{"client_msg_id":"15472482-e395-48e4-99a3-1797e7442ac7","type":"message","text":"But my results are showing a lower mean time for the allocated functions case? Is it due to the garbage collector doing a good job?","user":"U01G1P8A46S","ts":"1610035780.487200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kZW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But my results are showing a lower mean time for the allocated functions case? Is it due to the garbage collector doing a good job?"}]}]}],"thread_ts":"1610035622.486800","parent_user_id":"U01G1P8A46S"},{"client_msg_id":"fb6e594a-a399-481e-a1d9-a8e7804f30cd","type":"message","text":"Pretty much impossible to say without seeing the two functions.","user":"U67D54KS8","ts":"1610035968.487500","team":"T68168MUP","edited":{"user":"U67D54KS8","ts":"1610035970.000000"},"blocks":[{"type":"rich_text","block_id":"AvxeH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Pretty much impossible to say without seeing the two functions."}]}]}],"thread_ts":"1610035622.486800","parent_user_id":"U01G1P8A46S"},{"client_msg_id":"22841242-f1ac-4cb7-bfd6-391d113c5a87","type":"message","text":"The algorithms in my case are exactly the same, just with different ways of assembling the matrices. I don't know if it helps, but I've pasted the salient differences here: <https://pastebin.com/jayE8bK1>\n\nSo is it possible that lower memory consumption and reduced allocations are not necessarily correlated to lower execution times?","user":"U01G1P8A46S","ts":"1610036351.487900","team":"T68168MUP","attachments":[{"service_name":"Pastebin","title":"# Matrix assembly#============================================================ - Pastebin.com","title_link":"https://pastebin.com/jayE8bK1","text":"<http://Pastebin.com|Pastebin.com> is the number one paste tool since 2002. Pastebin is a website where you can store text online for a set period of time.","fallback":"Pastebin: # Matrix assembly#============================================================ - Pastebin.com","from_url":"https://pastebin.com/jayE8bK1","service_icon":"https://pastebin.com/favicon.ico","id":1,"original_url":"https://pastebin.com/jayE8bK1"}],"blocks":[{"type":"rich_text","block_id":"+dh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The algorithms in my case are exactly the same, just with different ways of assembling the matrices. I don't know if it helps, but I've pasted the salient differences here: "},{"type":"link","url":"https://pastebin.com/jayE8bK1"},{"type":"text","text":"\n\nSo is it possible that lower memory consumption and reduced allocations are not necessarily correlated to lower execution times?"}]}]}],"thread_ts":"1610035622.486800","parent_user_id":"U01G1P8A46S"},{"client_msg_id":"758c890b-4841-47b1-b86a-051db2b03f97","type":"message","text":"they generally are, but I think in both cases execution time is dominated by `\\` and its allocation","user":"UH24GRBLL","ts":"1610036719.488200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yY9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"they generally are, but I think in both cases execution time is dominated by "},{"type":"text","text":"\\","style":{"code":true}},{"type":"text","text":" and its allocation"}]}]}],"thread_ts":"1610035622.486800","parent_user_id":"U01G1P8A46S"},{"client_msg_id":"7f2d868e-3fe1-4583-b681-d4761e2b7462","type":"message","text":"no way for us to check though, `doublet_influence` is missing","user":"UH24GRBLL","ts":"1610037040.488400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jHKe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"no way for us to check though, "},{"type":"text","text":"doublet_influence","style":{"code":true}},{"type":"text","text":" is missing"}]}]}],"thread_ts":"1610035622.486800","parent_user_id":"U01G1P8A46S"},{"client_msg_id":"dabbc638-577b-402f-9b58-91b56501de8e","type":"message","text":"`doublet_influence` calls some other functions and deals with my `Panel2D` type; you'd have to read most of my large codebase. I thought the problem would be localised to what I pasted, but I guess not. Thanks for taking a look!","user":"U01G1P8A46S","ts":"1610037382.488600","team":"T68168MUP","edited":{"user":"U01G1P8A46S","ts":"1610037404.000000"},"blocks":[{"type":"rich_text","block_id":"rO0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"doublet_influence","style":{"code":true}},{"type":"text","text":" calls some other functions and deals with my "},{"type":"text","text":"Panel2D","style":{"code":true}},{"type":"text","text":" type; you'd have to read most of my large codebase. I thought the problem would be localised to what I pasted, but I guess not. Thanks for taking a look!"}]}]}],"thread_ts":"1610035622.486800","parent_user_id":"U01G1P8A46S"}]