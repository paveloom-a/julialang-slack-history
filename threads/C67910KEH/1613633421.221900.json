[{"client_msg_id":"c44702c1-d24d-4bd1-8864-1f28b2e3a4a3","type":"message","text":"Running CI scripts on every pull request when the project contains the CI scripts themselves is considered harmful. <https://sprocketfox.io/xssfox/2021/01/18/pipeline/|https://sprocketfox.io/xssfox/2021/01/18/pipeline/>","user":"U9MD78Z9N","ts":"1613633421.221900","team":"T68168MUP","attachments":[{"title":"Build Pipeline Security","title_link":"https://sprocketfox.io/xssfox/2021/01/18/pipeline/","text":"Security concerns with PR build systems","fallback":"Build Pipeline Security","from_url":"https://sprocketfox.io/xssfox/2021/01/18/pipeline/","service_name":"sprocketfox.io","id":1,"original_url":"https://sprocketfox.io/xssfox/2021/01/18/pipeline/"}],"blocks":[{"type":"rich_text","block_id":"M=WjJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Running CI scripts on every pull request when the project contains the CI scripts themselves is considered harmful. "},{"type":"link","url":"https://sprocketfox.io/xssfox/2021/01/18/pipeline/","text":"https://sprocketfox.io/xssfox/2021/01/18/pipeline/"}]}]}],"thread_ts":"1613633421.221900","reply_count":3,"reply_users_count":1,"latest_reply":"1613648970.227100","reply_users":["U6A936746"],"subscribed":false},{"client_msg_id":"21b82479-8098-475c-a1fe-3adc0c120e97","type":"message","text":"Like yes this is something to be aware of.\nBut its not that straight forward, and there are other solutions with different upsides and downsides to just moving your config out of the repo.","user":"U6A936746","ts":"1613648099.226400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3Ri","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Like yes this is something to be aware of.\nBut its not that straight forward, and there are other solutions with different upsides and downsides to just moving your config out of the repo."}]}]}],"thread_ts":"1613633421.221900","parent_user_id":"U9MD78Z9N"},{"client_msg_id":"4d6a2558-fb48-4d92-a78d-127dc847368d","type":"message","text":"for one, your CI deployment scripts,\nand other things that can escape the container, are almost certainly using Secrets. E.g. secured enviroment variables.\nYour CI server should be configured to only share those Secrets with PRs coming from trusted branches.\n(otherwise they can simply `println(DEPLOY_KEY)`  *even if the CI script is on another branch*.)\n\nTravisCI for example only trusts PRs from your own repo. It doesn’t give secrets to PRs from forks.\n<https://docs.travis-ci.com/user/pull-requests/#pull-requests-and-security-restrictions>","user":"U6A936746","ts":"1613648630.226600","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1613648642.000000"},"blocks":[{"type":"rich_text","block_id":"0+5z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"for one, your CI deployment scripts,\nand other things that can escape the container, are almost certainly using Secrets. E.g. secured enviroment variables.\nYour CI server should be configured to only share those Secrets with PRs coming from trusted branches.\n(otherwise they can simply "},{"type":"text","text":"println(DEPLOY_KEY)","style":{"code":true}},{"type":"text","text":"  "},{"type":"text","text":"even if the CI script is on another branch","style":{"bold":true}},{"type":"text","text":".)\n\nTravisCI for example only trusts PRs from your own repo. It doesn’t give secrets to PRs from forks.\n"},{"type":"link","url":"https://docs.travis-ci.com/user/pull-requests/#pull-requests-and-security-restrictions"}]}]}],"thread_ts":"1613633421.221900","parent_user_id":"U9MD78Z9N"},{"client_msg_id":"092a27e7-8026-4d35-a895-827582c12e96","type":"message","text":"I feel like it is a thing to not use the CI configuration of the branch, but to always use the CI configuration of master/main.\nAt least for untrusted branches.\nThis ensures that someone has code-reviewed the CI config before it runs.\n(Still doesn’t help with malicious tests though, but nor does a seperate repo. But see above re: secrets that allow escaping container)\n\nI thought this was the default for TravisCI but it seems not.\nYou can turn it on though, it is the same mechanism as for a seperate repo.\n<https://docs.travis-ci.com/user/build-config-imports#importing-configs-from-the-same-repository>","user":"U6A936746","ts":"1613648970.227100","team":"T68168MUP","attachments":[{"title":"Travis CI Documentation","title_link":"https://docs.travis-ci.com/user/build-config-imports#importing-configs-from-the-same-repository","text":"Importing Shared Build Configuration","fallback":"Travis CI Documentation","thumb_url":"https://docs.travis-ci.com/images/TravisCI-Full-Color.png","from_url":"https://docs.travis-ci.com/user/build-config-imports#importing-configs-from-the-same-repository","thumb_width":642,"thumb_height":201,"service_icon":"https://docs.travis-ci.com/favicon.ico","service_name":"docs.travis-ci.com","id":1,"original_url":"https://docs.travis-ci.com/user/build-config-imports#importing-configs-from-the-same-repository"}],"blocks":[{"type":"rich_text","block_id":"F84","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I feel like it is a thing to not use the CI configuration of the branch, but to always use the CI configuration of master/main.\nAt least for untrusted branches.\nThis ensures that someone has code-reviewed the CI config before it runs.\n(Still doesn’t help with malicious tests though, but nor does a seperate repo. But see above re: secrets that allow escaping container)\n\nI thought this was the default for TravisCI but it seems not.\nYou can turn it on though, it is the same mechanism as for a seperate repo.\n"},{"type":"link","url":"https://docs.travis-ci.com/user/build-config-imports#importing-configs-from-the-same-repository"}]}]}],"thread_ts":"1613633421.221900","parent_user_id":"U9MD78Z9N"}]