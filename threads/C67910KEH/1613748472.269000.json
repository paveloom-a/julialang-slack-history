[{"client_msg_id":"0aee2e15-b56a-42bc-8234-e593ab05d2c2","type":"message","text":"Good morning everyone! a newbie question, I need to search a text (MPS) file to find some key word to locate the section “RHS”; then check the next line to see if that line has the word “obj”. If there is, then remove that line and save the file. Since the file is large, e.g., 30 mb, what is the most efficient way to implement this task? Thanks!","user":"U014ABSBL3A","ts":"1613748472.269000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QXL75","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Good morning everyone! a newbie question, I need to search a text (MPS) file to find some key word to locate the section “RHS”; then check the next line to see if that line has the word “obj”. If there is, then remove that line and save the file. Since the file is large, e.g., 30 mb, what is the most efficient way to implement this task? Thanks!"}]}]}],"thread_ts":"1613748472.269000","reply_count":20,"reply_users_count":2,"latest_reply":"1613755344.275000","reply_users":["U7HAYKY9X","U014ABSBL3A"],"subscribed":false},{"client_msg_id":"921ffdda-0f69-4fe6-9f9d-d825b57f87ee","type":"message","text":"Is the keyword guaranteed to be on one single line, and not split across two lines?","user":"U7HAYKY9X","ts":"1613748674.269100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6U2P=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is the keyword guaranteed to be on one single line, and not split across two lines?"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"8029585c-e610-4ab3-bb07-e9d90ad4d2f0","type":"message","text":"RHS the only word on that line, starting the section. Then the next line is the first row in this section with multiple words. I just need to see if the first line has “obj” and then remove that line.","user":"U014ABSBL3A","ts":"1613748810.269300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=s4Y","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"RHS the only word on that line, starting the section. Then the next line is the first row in this section with multiple words. I just need to see if the first line has “obj” and then remove that line."}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"5428e383-6917-43cb-acc9-8444ea709d18","type":"message","text":"Ah, that should be pretty easy then.","user":"U7HAYKY9X","ts":"1613748830.269500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hxUDe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah, that should be pretty easy then."}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"14169a25-a2e8-4e1d-98e5-abb112883796","type":"message","text":"glad to hear","user":"U014ABSBL3A","ts":"1613748860.269700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Z6q","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"glad to hear"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"0b3eb529-3169-44a4-bee5-6ce842bcf4e3","type":"message","text":"Something like\n```function foo(inpath, outpath)\n    infile = open(inpath)\n    outfile = open(outpath, \"w\")\n    skip_next = false\n    for line in eachline(file)\n        if line == \"RHS\"\n            skip_next = true\n        else\n            skip_next = false\n            if skip_next\n                continue\n            end\n        end\n        println(outfile, line)\n    end\nend```","user":"U7HAYKY9X","ts":"1613748938.269900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Sl1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Something like\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function foo(inpath, outpath)\n    infile = open(inpath)\n    outfile = open(outpath, \"w\")\n    skip_next = false\n    for line in eachline(file)\n        if line == \"RHS\"\n            skip_next = true\n        else\n            skip_next = false\n            if skip_next\n                continue\n            end\n        end\n        println(outfile, line)\n    end\nend"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"4705c7ba-f392-4fc3-9578-90eebe7f9c2d","type":"message","text":"I could read line by line, but the file has several million lines, kind of concerned of efficiency","user":"U014ABSBL3A","ts":"1613748953.270100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xdYv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I could read line by line, but the file has several million lines, kind of concerned of efficiency"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"c594dcc9-64f3-4a7f-927d-fe332bc5ad91","type":"message","text":"How can it have millions of lines if it's 30 mb? :thinking_face:","user":"U7HAYKY9X","ts":"1613748974.270300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kHrH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How can it have millions of lines if it's 30 mb? "},{"type":"emoji","name":"thinking_face"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"fd685aeb-0125-430a-98ef-47ec5f34594c","type":"message","text":"The file I’m looking at has nearly 1 million lines. each line has only 2-5 words","user":"U014ABSBL3A","ts":"1613749025.270500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3U=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The file I’m looking at has nearly 1 million lines. each line has only 2-5 words"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"7789b6b7-4f4e-427e-aba9-2252abdc6dd6","type":"message","text":"Thanks for the code.","user":"U014ABSBL3A","ts":"1613749123.270700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9=R","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks for the code."}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"84c1e403-aaf8-4bb2-a8be-2229bf192286","type":"message","text":"If it's that small, you can load the entire file into a vector and search for the bytes \"\\nRHS\\n\", to find the position","user":"U7HAYKY9X","ts":"1613749127.270900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6GK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If it's that small, you can load the entire file into a vector and search for the bytes \"\\nRHS\\n\", to find the position"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"c19e66b2-67e9-426f-a36d-a0d960a325a1","type":"message","text":"Then you can search for `obj` in the next line, and if you find it, print out the vector before that line, and after that line","user":"U7HAYKY9X","ts":"1613749150.271100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"q/2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Then you can search for "},{"type":"text","text":"obj","style":{"code":true}},{"type":"text","text":" in the next line, and if you find it, print out the vector before that line, and after that line"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"a0f8c517-374c-4321-ad1f-c83aaac25d69","type":"message","text":"This might be a better solution for this kind of files. Would you mind putting the sample code here? Thanks.","user":"U014ABSBL3A","ts":"1613749224.271300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZOIA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"This might be a better solution for this kind of files. Would you mind putting the sample code here? Thanks."}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"08942766-0676-4ff1-b22f-e05eabef08e4","type":"message","text":"Does this work? DIdn't check it\n```function foo(inpath, outpath)\n    data = open(read, inpath)\n    range = findfirst(r\"RHS\\n[^\\n]*obj\", s)\n    if range === nothing\n        cp(inpath, outpath)\n    end\n    open(outpath) do writer\n        write(@view data[1:first(range)+3])\n        write(@view data[last(range):end])\n    end\nend```","user":"U7HAYKY9X","ts":"1613749731.271500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nRq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does this work? DIdn't check it\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function foo(inpath, outpath)\n    data = open(read, inpath)\n    range = findfirst(r\"RHS\\n[^\\n]*obj\", s)\n    if range === nothing\n        cp(inpath, outpath)\n    end\n    open(outpath) do writer\n        write(@view data[1:first(range)+3])\n        write(@view data[last(range):end])\n    end\nend"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"6bf50c19-842a-4771-a622-014756ec0b05","type":"message","text":"Thanks <@U7HAYKY9X> It will take me a while to understand the code.  I will try both of them and let you know the efficiency difference.","user":"U014ABSBL3A","ts":"1613749897.271700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CO/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks "},{"type":"user","user_id":"U7HAYKY9X"},{"type":"text","text":" It will take me a while to understand the code.  I will try both of them and let you know the efficiency difference."}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"557de2fe-0083-43e6-bb54-8edff9fc457c","type":"message","text":"OK, tested it a bit. Try this:\n```function foo(inpath, outpath)\n    data = open(io -&gt; String(read(io)), inpath)\n    range = findfirst(r\"RHS\\n[^\\n]*obj[^\\n]*\\n\", data)\n    if range === nothing\n        cp(inpath, outpath)\n    end\n    open(outpath, \"w\") do writer\n        write(writer, @view data[1:first(range)+3])\n        write(writer, @view data[last(range)+1:end])\n    end\nend```","user":"U7HAYKY9X","ts":"1613750001.271900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Mw14","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"OK, tested it a bit. Try this:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function foo(inpath, outpath)\n    data = open(io -> String(read(io)), inpath)\n    range = findfirst(r\"RHS\\n[^\\n]*obj[^\\n]*\\n\", data)\n    if range === nothing\n        cp(inpath, outpath)\n    end\n    open(outpath, \"w\") do writer\n        write(writer, @view data[1:first(range)+3])\n        write(writer, @view data[last(range)+1:end])\n    end\nend"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"1765586f-305e-4c52-b4c8-e6207f1eb37a","type":"message","text":"Thanks! trying it out.","user":"U014ABSBL3A","ts":"1613750103.272100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QIEY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks! trying it out."}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"558dc3ed-0556-48ff-bd55-f33519da9102","type":"message","text":"hi <@U7HAYKY9X> I was reading preliminary articles to understand your code. Several questions: 1. the “r” in your findfirst() function call was a typo? I didn’t see this parameter in findfirst documentation. 2. what [^\\n] means ? 3. what does * do ?","user":"U014ABSBL3A","ts":"1613754336.274400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"uyxc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"hi "},{"type":"user","user_id":"U7HAYKY9X"},{"type":"text","text":" I was reading preliminary articles to understand your code. Several questions: 1. the “r” in your findfirst() function call was a typo? I didn’t see this parameter in findfirst documentation. 2. what [^\\n] means ? 3. what does * do ?"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"e937daf1-9b09-4a1d-8744-7ea43fe87e34","type":"message","text":"Thanks","user":"U014ABSBL3A","ts":"1613754367.274600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cuFf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks"}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"type":"message","text":"Here are the lines in the file. I first find ``RHS`` as the section starting point; and then check if the line following ``RHS`` has ``obj``. If there is, then remove that line.","files":[{"id":"F01P3CFSS3T","created":1613754642,"timestamp":1613754642,"name":"Untitled","title":"Untitled","mimetype":"text/plain","filetype":"text","pretty_type":"Plain Text","user":"U014ABSBL3A","editable":true,"size":519,"mode":"snippet","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01P3CFSS3T/untitled","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01P3CFSS3T/download/untitled","permalink":"https://julialang.slack.com/files/U014ABSBL3A/F01P3CFSS3T/untitled","permalink_public":"https://slack-files.com/T68168MUP-F01P3CFSS3T-5ac0cccfdf","edit_link":"https://julialang.slack.com/files/U014ABSBL3A/F01P3CFSS3T/untitled/edit","preview":"    curtail[b1715,36]            r100                           -0.000238882280415145\n    curtail[b1715,36]            m167                            -0.00161052784745746\nRHS\n    rhs                          obj                                   -1018447463.52\n    rhs                          min_downtime[g4,1]                                 1","preview_highlight":"<div class=\"CodeMirror cm-s-default CodeMirrorServer\" oncopy=\"if(event.clipboardData){event.clipboardData.setData('text/plain',window.getSelection().toString().replace(/\\u200b/g,''));event.preventDefault();event.stopPropagation();}\">\n<div class=\"CodeMirror-code\">\n<div><pre>    curtail[b1715,36]            r100                           -0.000238882280415145</pre></div>\n<div><pre>    curtail[b1715,36]            m167                            -0.00161052784745746</pre></div>\n<div><pre>RHS</pre></div>\n<div><pre>    rhs                          obj                                   -1018447463.52</pre></div>\n<div><pre>    rhs                          min_downtime[g4,1]                                 1</pre></div>\n</div>\n</div>\n","lines":7,"lines_more":2,"preview_is_truncated":false,"is_starred":false,"has_rich_preview":false}],"upload":true,"blocks":[{"type":"rich_text","block_id":"KI4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Here are the lines in the file. I first find ``RHS`` as the section starting point; and then check if the line following ``RHS`` has ``obj``. If there is, then remove that line."}]}]}],"user":"U014ABSBL3A","display_as_bot":false,"ts":"1613754642.274800","client_msg_id":"fcb31957-3c47-46c3-ac46-93a7246da139","thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"},{"client_msg_id":"a83552f6-cf69-417c-b952-9ad8fef2d562","type":"message","text":"I just copied and pasted your code, the r in findfirst() seems to be fine. But error reported at @view.\n*julia&gt;* open(“cuts/newmodel.mps”, “w”) do writer\n    write(writer, @view data[1:first(range)+3])\n    write(writer, @view data[last(range)+1:end])\n    end\n*ERROR:* MethodError: no method matching view(::String, ::UnitRange{Int64})\nClosest candidates are:\n view(::AbstractUnitRange, ::AbstractUnitRange{var”#s91\"} where var”#s91\"&lt;:Integer) at subarray.jl:167\n view(::StepRange, ::AbstractRange{var”#s91\"} where var”#s91\"&lt;:Integer) at subarray.jl:175\n view(::StepRangeLen, ::OrdinalRange{var”#s91\",S} where S where var”#s91\"&lt;:Integer) at subarray.jl:179\n ...\nStacktrace:\n [1] *(::var”#9#10\")(*::IOStream*)* at *./REPL[185]:2*\n [2] *open(*::var”#9#10\", ::String, ::Vararg{String,N} where N; kwargs::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}*)* at *./io.jl:325*\n [3] *open(*::Function, ::String, ::String*)* at *./io.jl:323*\n [4] top-level scope at *REPL[185]:1*","user":"U014ABSBL3A","ts":"1613755344.275000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"PA8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I just copied and pasted your code, the r in findfirst() seems to be fine. But error reported at @view.\n"},{"type":"text","text":"julia> ","style":{"bold":true}},{"type":"text","text":"open(“cuts/newmodel.mps”, “w”) do writer\n    write(writer, @view data[1:first(range)+3])\n    write(writer, @view data[last(range)+1:end])\n    end\n"},{"type":"text","text":"ERROR: ","style":{"bold":true}},{"type":"text","text":"MethodError: no method matching view(::String, ::UnitRange{Int64})\nClosest candidates are:\n view(::AbstractUnitRange, ::AbstractUnitRange{var”#s91\"} where var”#s91\"<:Integer) at subarray.jl:167\n view(::StepRange, ::AbstractRange{var”#s91\"} where var”#s91\"<:Integer) at subarray.jl:175\n view(::StepRangeLen, ::OrdinalRange{var”#s91\",S} where S where var”#s91\"<:Integer) at subarray.jl:179\n ...\nStacktrace:\n [1] "},{"type":"text","text":"(::var”#9#10\")(","style":{"bold":true}},{"type":"text","text":"::IOStream"},{"type":"text","text":")","style":{"bold":true}},{"type":"text","text":" at "},{"type":"text","text":"./REPL[185]:2","style":{"bold":true}},{"type":"text","text":"\n [2] "},{"type":"text","text":"open(","style":{"bold":true}},{"type":"text","text":"::var”#9#10\", ::String, ::Vararg{String,N} where N; kwargs::Base.Iterators.Pairs{Union{},Union{},Tuple{},NamedTuple{(),Tuple{}}}"},{"type":"text","text":")","style":{"bold":true}},{"type":"text","text":" at "},{"type":"text","text":"./io.jl:325","style":{"bold":true}},{"type":"text","text":"\n [3] "},{"type":"text","text":"open(","style":{"bold":true}},{"type":"text","text":"::Function, ::String, ::String"},{"type":"text","text":")","style":{"bold":true}},{"type":"text","text":" at "},{"type":"text","text":"./io.jl:323","style":{"bold":true}},{"type":"text","text":"\n [4] top-level scope at "},{"type":"text","text":"REPL[185]:1","style":{"bold":true}}]}]}],"thread_ts":"1613748472.269000","parent_user_id":"U014ABSBL3A"}]