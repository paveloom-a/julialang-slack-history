[{"client_msg_id":"1f4f2656-10b9-4405-a77c-b7ec58c49f35","type":"message","text":"I am looking for an efficient way to implement some fifo memory, similar to `Queue` from `DataStructures.jl` but I would like to not reallocate memory when adding the `m+1`th element (where `m` is the memory size) but dequeue one element and requeue the next on the same allocated memory. What is the best way to do this?","user":"UPJ6Q2SQY","ts":"1608569220.328700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DCFN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I am looking for an efficient way to implement some fifo memory, similar to "},{"type":"text","text":"Queue","style":{"code":true}},{"type":"text","text":" from "},{"type":"text","text":"DataStructures.jl","style":{"code":true}},{"type":"text","text":" but I would like to not reallocate memory when adding the "},{"type":"text","text":"m+1","style":{"code":true}},{"type":"text","text":"th element (where "},{"type":"text","text":"m","style":{"code":true}},{"type":"text","text":" is the memory size) but dequeue one element and requeue the next on the same allocated memory. What is the best way to do this?"}]}]}],"thread_ts":"1608569220.328700","reply_count":84,"reply_users_count":3,"latest_reply":"1608583690.351500","reply_users":["UPJ6Q2SQY","UH24GRBLL","U6A936746"],"subscribed":false},{"client_msg_id":"35493157-593f-4417-9e68-72872108d7ba","type":"message","text":"Oh maybe this is more for the helpdesk?","user":"UPJ6Q2SQY","ts":"1608569253.328800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"v4bZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Oh maybe this is more for the helpdesk?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"0ce0925b-7c2d-4fdb-b9ca-46ef33115529","type":"message","text":"sounds like you want a circular buffer with dequeuing if it's full","user":"UH24GRBLL","ts":"1608569454.329000","team":"T68168MUP","edited":{"user":"UH24GRBLL","ts":"1608569473.000000"},"blocks":[{"type":"rich_text","block_id":"es9=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"sounds like you want a circular buffer with dequeuing if it's full"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"7a66318f-f992-49a7-9572-3c46030aa83b","type":"message","text":"Thanks, I see that in DataStructures and will check :slightly_smiling_face:","user":"UPJ6Q2SQY","ts":"1608569510.329300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6OSF0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks, I see that in DataStructures and will check "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"d381ff3f-93ef-43af-9c08-13189b996125","type":"message","text":"I don't know if CircularDeque already automatically dequeues if it's full, but you probably want a small wrapper around that if it doesn't","user":"UH24GRBLL","ts":"1608569573.329500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RRpl1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don't know if CircularDeque already automatically dequeues if it's full, but you probably want a small wrapper around that if it doesn't"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"3ea22917-27ad-46b4-a08d-dfc9dce9d75a","type":"message","text":"<https://juliacollections.github.io/DataStructures.jl/latest/circ_deque/>","user":"UH24GRBLL","ts":"1608569573.329700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"mILbZ","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://juliacollections.github.io/DataStructures.jl/latest/circ_deque/"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"98b8b9ef-b270-483b-af5f-66b6d541f99f","type":"message","text":"I checked CircularBuffer, it seems to spare me one line, namely the pop, but the amount of allocations, which I try to reduce currently, seems to stay the same","user":"UPJ6Q2SQY","ts":"1608570822.330000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QWT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I checked CircularBuffer, it seems to spare me one line, namely the pop, but the amount of allocations, which I try to reduce currently, seems to stay the same"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"7dd52608-9ce8-4f87-b8a4-f7b04d3aee19","type":"message","text":"did you check circular dequeue as well?","user":"UH24GRBLL","ts":"1608570854.330200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"H/=h","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"did you check circular dequeue as well?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"af95cee9-cb47-436f-909e-6007b07f6151","type":"message","text":"No CurciularBuffer seems more fitting since it's really a cache of the last m entries","user":"UPJ6Q2SQY","ts":"1608570861.330400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nBa","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No CurciularBuffer seems more fitting since it's really a cache of the last m entries"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"c273046b-ee08-4c46-839f-82a675bc3be3","type":"message","text":"not yet","user":"UPJ6Q2SQY","ts":"1608570866.330600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"s4py","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"not yet"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"5f0d2144-9527-4f35-a466-7a09ffb5dcd4","type":"message","text":"reworking my code to a new structure always takes a while","user":"UPJ6Q2SQY","ts":"1608570883.330800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"83Om","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"reworking my code to a new structure always takes a while"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"e9094863-d7bf-467d-bcf6-06abb8ea639d","type":"message","text":"are you sure the allocations stem from operations on the buffer and not from how you type behaves?","user":"UH24GRBLL","ts":"1608570900.331000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ckD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"are you sure the allocations stem from operations on the buffer and not from how you type behaves?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"cc6f0221-8a7b-46f7-a3f0-4b8b918f4c80","type":"message","text":"Why should the CircularDequeue be diffferent from the CircularBuffer?","user":"UPJ6Q2SQY","ts":"1608570914.331200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tuM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Why should the CircularDequeue be diffferent from the CircularBuffer?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"33d6d469-9147-4729-8cdc-b7f4add2b0d4","type":"message","text":"That's whaat I also check currently, but it seems that it stems from the buffer","user":"UPJ6Q2SQY","ts":"1608570947.331800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"A/2Z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That's whaat I also check currently, but it seems that it stems from the buffer"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"cc96892c-50ba-4f13-a04f-a5151094a22a","type":"message","text":"my datatype is just an array","user":"UPJ6Q2SQY","ts":"1608570954.332000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FIc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"my datatype is just an array"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"4d21ad0f-daeb-4194-a403-43b02c9fcda7","type":"message","text":"what's the type of the array?","user":"UH24GRBLL","ts":"1608570971.332200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vbD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what's the type of the array?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"6e25df83-1a13-4157-90c7-e016b2748ceb","type":"message","text":"simply putting the data into the existing buffer shouldn't affect allocations at all","user":"UH24GRBLL","ts":"1608570990.332400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=E4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"simply putting the data into the existing buffer shouldn't affect allocations at all"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"d64d7c32-63f7-4729-b48a-f814cc34a691","type":"message","text":"`Array{Float64,2}`?","user":"UPJ6Q2SQY","ts":"1608570991.332600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Z3Hxx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Array{Float64,2}","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"42f4f49b-9241-496c-8900-0c05ecd3b502","type":"message","text":"are you maybe not using views somewhere?","user":"UH24GRBLL","ts":"1608571000.332800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ee0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"are you maybe not using views somewhere?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"4a83ebd1-7605-45aa-8fdc-7af583535db4","type":"message","text":"no","user":"UPJ6Q2SQY","ts":"1608571004.333000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oLya","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"no"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"d87923b1-4eff-452f-8116-2536da4a5130","type":"message","text":"can you share some small example that shows the behaviour?","user":"UH24GRBLL","ts":"1608571026.333200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SwT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"can you share some small example that shows the behaviour?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"446ff1c0-7e52-4969-901f-8c2409c414da","type":"message","text":"I can link the code, it is on a public branch but not yet a PR, but an example is a little difficult maybe","user":"UPJ6Q2SQY","ts":"1608571050.333400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"h8eaN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I can link the code, it is on a public branch but not yet a PR, but an example is a little difficult maybe"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"511595c1-3b5f-4ccb-90f5-d8af5536f373","type":"message","text":"sure","user":"UH24GRBLL","ts":"1608571077.333600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oL/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"sure"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"61e095ef-9c63-4ee6-908f-1ddfd8c6f40d","type":"message","text":"Context: I am adding a Quasi Newton LBFGS variant for Manopt.jl. Here's the memory data type <https://github.com/JuliaManifolds/Manopt.jl/blob/d4681dad74a05b53ce9c25dca59374f3fe49ca54/src/plans/gradient_plan.jl#L1110> , same file 1134 is the two loop recursion, but that only accesses the memory, and here's <https://github.com/JuliaManifolds/Manopt.jl/blob/d4681dad74a05b53ce9c25dca59374f3fe49ca54/src/solvers/quasi_Newton.jl#L175> the memory update","user":"UPJ6Q2SQY","ts":"1608571360.333800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aef","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Context: I am adding a Quasi Newton LBFGS variant for Manopt.jl. Here's the memory data type "},{"type":"link","url":"https://github.com/JuliaManifolds/Manopt.jl/blob/d4681dad74a05b53ce9c25dca59374f3fe49ca54/src/plans/gradient_plan.jl#L1110"},{"type":"text","text":" , same file 1134 is the two loop recursion, but that only accesses the memory, and here's "},{"type":"link","url":"https://github.com/JuliaManifolds/Manopt.jl/blob/d4681dad74a05b53ce9c25dca59374f3fe49ca54/src/solvers/quasi_Newton.jl#L175"},{"type":"text","text":" the memory update"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"b6405737-ffc4-4859-8024-48ed3da560d9","type":"message","text":"But an example, well there's <https://github.com/JuliaManifolds/Manopt.jl/blob/quasiNewton/examples/Quasi_Newton/Brockett_Benchmark.jl>","user":"UPJ6Q2SQY","ts":"1608571489.334000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UHe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But an example, well there's "},{"type":"link","url":"https://github.com/JuliaManifolds/Manopt.jl/blob/quasiNewton/examples/Quasi_Newton/Brockett_Benchmark.jl"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"dfbd4e0e-5062-47e6-b7d4-1cdcf18e79c8","type":"message","text":"But maybe run only the first few if you actually check it out (the `1000,2,4` example for example allocates 90 GB of data, most of it in the memory lines)","user":"UPJ6Q2SQY","ts":"1608571538.334200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sM8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But maybe run only the first few if you actually check it out (the "},{"type":"text","text":"1000,2,4","style":{"code":true}},{"type":"text","text":" example for example allocates 90 GB of data, most of it in the memory lines)"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"9b5dbdd4-caf0-4074-8170-7efa73cb68c2","type":"message","text":"yeah, I don't think the deque is the problem here","user":"UH24GRBLL","ts":"1608572401.334400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"19Z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah, I don't think the deque is the problem here"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"8f35f8b2-ffa1-45d5-ab55-080508f3e8b8","type":"message","text":"`F` allocates on each invocation","user":"UH24GRBLL","ts":"1608572411.334600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XUQ3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"F","style":{"code":true}},{"type":"text","text":" allocates on each invocation"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"782ff316-bd74-48a7-ab70-c75c4e26e0ce","type":"message","text":"same goes for `∇F`","user":"UH24GRBLL","ts":"1608572433.334800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"13nZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"same goes for "},{"type":"text","text":"∇F","style":{"code":true}}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"43d240fa-0f17-4f46-b0d9-95b4a3df2dfa","type":"message","text":"where is `quasi_Newton` from?","user":"UH24GRBLL","ts":"1608572506.335000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Gtl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"where is "},{"type":"text","text":"quasi_Newton","style":{"code":true}},{"type":"text","text":" from?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"13db9396-312f-46cc-bb15-8e8604991f51","type":"message","text":"For F and the gradient that's fine","user":"UPJ6Q2SQY","ts":"1608572545.335200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/Y3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For F and the gradient that's fine"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"27417ba5-d352-44d3-95b3-b7cb9f0a8e53","type":"message","text":"first link at the very top","user":"UPJ6Q2SQY","ts":"1608572561.335400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"am=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"first link at the very top"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"f6872283-fcb8-4972-b968-989d6ab669dc","type":"message","text":"Or phrased differently neither F nor nabla F are the problem, the most allocations occur in the memory loops/functions mentioned above","user":"UPJ6Q2SQY","ts":"1608572602.335600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vPhG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Or phrased differently neither F nor nabla F are the problem, the most allocations occur in the memory loops/functions mentioned above"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"d03a7a9c-b5d1-4ee5-8d74-af2c190b3b86","type":"message","text":"Well, after a whole afternoon without any progress, I'll leave it at the queue for now and maybe come back to it later. I am also not that expiererienced in memory hunting, thats for the tipps","user":"UPJ6Q2SQY","ts":"1608573923.335800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"U0DEL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Well, after a whole afternoon without any progress, I'll leave it at the queue for now and maybe come back to it later. I am also not that expiererienced in memory hunting, thats for the tipps"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"5e5f5aa4-13ea-4e5f-8ef5-5668f7a74957","type":"message","text":"ah","user":"UH24GRBLL","ts":"1608573929.336000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xT+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ah"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"01bd4886-cbb7-4d86-aaec-0a2ef611a664","type":"message","text":"`Iterators.zip` instead of `zip`?","user":"UH24GRBLL","ts":"1608573939.336200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9XlE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Iterators.zip","style":{"code":true}},{"type":"text","text":" instead of "},{"type":"text","text":"zip","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"2e1cecbc-bf76-49d2-9d7a-91914fe5cea9","type":"message","text":"Are they different and if so, why?","user":"UPJ6Q2SQY","ts":"1608573964.336400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qHu0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Are they different and if so, why?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"890ac24b-0cdf-4b03-9327-62b2366529c7","type":"message","text":"the Iterators version is lazy and doesn't copy","user":"UH24GRBLL","ts":"1608573994.336600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tp39l","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the Iterators version is lazy and doesn't copy"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"91594d39-8a86-4b44-aef5-cad5a06b558e","type":"message","text":"but both return the same docstring?","user":"UPJ6Q2SQY","ts":"1608574028.336800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"uqQfC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but both return the same docstring?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"a95c54a5-3304-4864-a851-dd6013973d2c","type":"message","text":"huh","user":"UH24GRBLL","ts":"1608574082.337000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"trAFz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"huh"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"691bc336-132e-4def-9cb4-28bcf14074f0","type":"message","text":"thought they were different :thinking_face:","user":"UH24GRBLL","ts":"1608574164.337200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hpviE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"thought they were different "},{"type":"emoji","name":"thinking_face"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"967cef68-4831-482d-b09a-faab3b2946b7","type":"message","text":"I will shortly check whether that changes something but I think it won't :wink:","user":"UPJ6Q2SQY","ts":"1608574172.337400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tQRvk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I will shortly check whether that changes something but I think it won't "},{"type":"emoji","name":"wink"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"92c93745-81c2-41ad-af87-5cdae9c8efb4","type":"message","text":"no, doesn't change anything","user":"UPJ6Q2SQY","ts":"1608574198.337600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Z0TFH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"no, doesn't change anything"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"ed77480d-d1fe-4c60-91a3-c2fd30097efa","type":"message","text":"how are you initializing the queue?","user":"UH24GRBLL","ts":"1608574269.337800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Bu/J","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"how are you initializing the queue?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"ac0e805e-7312-423e-b224-220bb7c29e90","type":"message","text":"and do the allocations you observe also happen in a small example that does just the de-/enqueueing of some arrays?","user":"UH24GRBLL","ts":"1608574300.338000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Q/Pm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and do the allocations you observe also happen in a small example that does just the de-/enqueueing of some arrays?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"547055f6-fe3e-4141-ac63-142b4c160f4f","type":"message","text":"empty, that is one of the points. Sure that means during filling I will have allocations but I get far more allocations","user":"UPJ6Q2SQY","ts":"1608574395.338200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6bYx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"empty, that is one of the points. Sure that means during filling I will have allocations but I get far more allocations"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"fde620b5-9dfc-4af2-b969-e289fbf76c5f","type":"message","text":"I will not try smaller examples for now, I've been working on this fpor 5 hours straight and my head hurts","user":"UPJ6Q2SQY","ts":"1608574419.338400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Z97g","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I will not try smaller examples for now, I've been working on this fpor 5 hours straight and my head hurts"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"bcc3255f-7610-4498-a5cd-656da608ef4e","type":"message","text":"so I will stop for now, thanks for the tipps though","user":"UPJ6Q2SQY","ts":"1608574429.338600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0IwK7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so I will stop for now, thanks for the tipps though"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"6ada2d54-afa0-4446-849a-911da956bdf8","type":"message","text":"empty should be fine as long as you've specified the capacity and it won't change","user":"UH24GRBLL","ts":"1608575104.338800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FSymY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"empty should be fine as long as you've specified the capacity and it won't change"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"ec2d9f49-857a-43e0-9d0d-1e1f46d1fa06","type":"message","text":"sure, exactly that.","user":"UPJ6Q2SQY","ts":"1608575115.339000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xe+x","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"sure, exactly that."}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"495f0489-bf4e-495a-833d-8d0d4a95ad64","type":"message","text":"well if I simply time popfirst!/pop! on a circularbuffer and a CircularDeque, I don't get any allocations","user":"UH24GRBLL","ts":"1608575811.339300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pgRj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"well if I simply time popfirst!/pop! on a circularbuffer and a CircularDeque, I don't get any allocations"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"c83d7c33-724e-47ab-8067-adc1a5d9334d","type":"message","text":"so I suspect there's some type instablity going on that causes allocations","user":"UH24GRBLL","ts":"1608575828.339500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZT=qk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so I suspect there's some type instablity going on that causes allocations"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"337bfc0b-2c90-43bb-a635-af63aa243930","type":"message","text":"oh i never do pops, just pushes","user":"UPJ6Q2SQY","ts":"1608575833.339700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vBx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh i never do pops, just pushes"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"75d33260-1759-446f-8f2a-4b12a167a441","type":"message","text":"well the code you showed me has `enqueue!` and `dequeue!`, that's basically the same as push and pop","user":"UH24GRBLL","ts":"1608575869.339900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jHu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"well the code you showed me has "},{"type":"text","text":"enqueue!","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"dequeue!","style":{"code":true}},{"type":"text","text":", that's basically the same as push and pop"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"4137a542-6186-485e-830b-ea9765da6b6f","type":"message","text":"Well for the Queue I do but for the Ciurcular Buffer I don't and both have roughly the same allocations in the experiment (well that one has 1 GB of allocations, so I can't say much more)","user":"UPJ6Q2SQY","ts":"1608575873.340100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IYPiy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Well for the Queue I do but for the Ciurcular Buffer I don't and both have roughly the same allocations in the experiment (well that one has 1 GB of allocations, so I can't say much more)"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"8971a462-d348-427d-9214-370b04c865be","type":"message","text":"does ProfileView or something similar show those allocations at the pushes?","user":"UH24GRBLL","ts":"1608575894.340300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dSl=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"does ProfileView or something similar show those allocations at the pushes?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"d026dd28-aa35-46aa-b05f-7053347acd80","type":"message","text":"are you certain?","user":"UH24GRBLL","ts":"1608575897.340600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Qps4c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"are you certain?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"5ccbcd71-ba5a-4a92-8f67-b20685246950","type":"message","text":"ProfileView?","user":"UPJ6Q2SQY","ts":"1608575913.340800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VxdBQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ProfileView?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"17ccf576-e8dc-40d6-b7e9-26eec0fa1f94","type":"message","text":"ProfileView.jl","user":"UH24GRBLL","ts":"1608575918.341000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wp+6Z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ProfileView.jl"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"9d460c67-9b8b-4087-af8c-b9364b33740c","type":"message","text":"visualises profiling data","user":"UH24GRBLL","ts":"1608575927.341200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e2F9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"visualises profiling data"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"ae082d7f-7fa3-425e-ab47-f0db24ac33ba","type":"message","text":"how else are you investigating those allocations?","user":"UH24GRBLL","ts":"1608575945.341400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"16UD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"how else are you investigating those allocations?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"2d98c8b6-5ce9-46e4-80cb-d6916e31c06d","type":"message","text":"Well, I'll try that tomorrow then, for now I just did a Coverage rund and have mem files that mention lines with alloocations","user":"UPJ6Q2SQY","ts":"1608575945.341600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"usam","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Well, I'll try that tomorrow then, for now I just did a Coverage rund and have mem files that mention lines with alloocations"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"0711c16c-6598-4553-aea7-d9fef8406473","type":"message","text":"but really, I am a little out of ideas for now","user":"UPJ6Q2SQY","ts":"1608575992.341800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tmPG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but really, I am a little out of ideas for now"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"8c819303-a530-46e0-ab2a-ef2921d2d16a","type":"message","text":"and tired (first time I am investigating code for allocations)","user":"UPJ6Q2SQY","ts":"1608576005.342000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"awZ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and tired (first time I am investigating code for allocations)"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"4dc1aee2-6cb0-42c3-81bc-c4d7fdac92ef","type":"message","text":"I'll continue tomorrow","user":"UPJ6Q2SQY","ts":"1608576012.342200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"n0Sk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'll continue tomorrow"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"9b676d1c-5440-4bc0-8dbe-136c1d5b6b40","type":"message","text":"I see","user":"UH24GRBLL","ts":"1608576040.342400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"3qG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I see"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"273b5cee-4c88-40f6-9a75-3c4638187da4","type":"message","text":"a good night's sleep is certainly a good idea","user":"UH24GRBLL","ts":"1608576052.342600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cSyV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"a good night's sleep is certainly a good idea"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"938d340e-ae90-4d5b-a2c8-8e8859adb256","type":"message","text":"for tomorrow, try investigating the smallest building blocks first, with BenchmarkTools for example","user":"UH24GRBLL","ts":"1608576077.342800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"H+Y","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"for tomorrow, try investigating the smallest building blocks first, with BenchmarkTools for example"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"dee33e95-c808-456d-bda3-8498669a5edf","type":"message","text":"Will do that, Still I am surprised that the enqueue and dequeue lines are the ones shown in mem","user":"UPJ6Q2SQY","ts":"1608576296.343000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"uWAcK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Will do that, Still I am surprised that the enqueue and dequeue lines are the ones shown in mem"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"851841c7-77dc-472a-a6de-24682d538cbd","type":"message","text":"iirc the track allocation thing was a little bugged some time ago and showed the wrong lines, not sure if that's ever been fixed","user":"UH24GRBLL","ts":"1608576603.343200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"PGo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"iirc the track allocation thing was a little bugged some time ago and showed the wrong lines, not sure if that's ever been fixed"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"7847f934-cd78-47ab-865f-639a6988fa7c","type":"message","text":"aggressive inlining makes those indicators a little wonky to reason about","user":"UH24GRBLL","ts":"1608576619.343400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Umd=X","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"aggressive inlining makes those indicators a little wonky to reason about"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"9604a771-8c10-4edc-85ea-3b2a941d34e6","type":"message","text":"The whole point about CircularBuffer is that it is basically a CircularDeque that overwrites the oldest item when it is full, rather than erroring.\nIt *should* be what you want","user":"U6A936746","ts":"1608576754.343600","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1608576806.000000"},"blocks":[{"type":"rich_text","block_id":"Xvp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The whole point about CircularBuffer is that it is basically a CircularDeque that overwrites the oldest item when it is full, rather than erroring.\nIt "},{"type":"text","text":"should","style":{"bold":true}},{"type":"text","text":" be what you want"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"8fd04f2b-4997-4fc7-9712-bdfce9e6c6f0","type":"message","text":"I don’t love having both.","user":"U6A936746","ts":"1608576864.343900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Sp5oY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don’t love having both."}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"a438bf56-26f2-47e7-85c9-567f9da47efd","type":"message","text":"I can think of use cases where that behaviour is very much wanted though","user":"UH24GRBLL","ts":"1608576934.344100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Y0J","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I can think of use cases where that behaviour is very much wanted though"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"34da6c84-b5eb-47a0-ba1a-de18ddcfb8ed","type":"message","text":"like when you have a lot of data coming in, you always want to process the most recent one and missing a few is fine (but old data is not)","user":"UH24GRBLL","ts":"1608576987.344300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"R1qXz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"like when you have a lot of data coming in, you always want to process the most recent one and missing a few is fine (but old data is not)"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"d19456e0-7e23-42c0-a6cf-453496754854","type":"message","text":"Sure, it's a classic buffer","user":"U6A936746","ts":"1608579748.345600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"D=1kp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Sure, it's a classic buffer"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"8B6E364B-C29C-40FB-95A1-12583D1719D9","type":"message","text":"Yes I’ll switch to CircularBuffer for sure :)","user":"UPJ6Q2SQY","ts":"1608582807.347500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gLwf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes I’ll switch to CircularBuffer for sure :)"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"1fe6280d-a46e-49cf-8652-737205fe1d18","type":"message","text":"CircularDeque != CircularBuffer - the deque version has the exact behaviour you're looking for","user":"UH24GRBLL","ts":"1608583089.347700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oG1e","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"CircularDeque != CircularBuffer - the deque version has the exact behaviour you're looking for"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY","reactions":[{"name":"this-is-false","users":["U6A936746"],"count":1}]},{"client_msg_id":"75D7BF7E-9EBB-4DBD-B18F-8AB25D6DE27B","type":"message","text":"Why? Now you confuse me. For the Buffer I just have to push and have the last n ones available. That’s what I want.","user":"UPJ6Q2SQY","ts":"1608583158.348900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0+N","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Why? Now you confuse me. For the Buffer I just have to push and have the last n ones available. That’s what I want."}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"655C98A2-CE88-48FB-80C4-6B8F1C6CC540","type":"message","text":"Also while buffer works, I get bounds errors when trying to push! To the deque; so I seem to have a major misunderstanding on circular deque still","user":"UPJ6Q2SQY","ts":"1608583507.350500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"v4GO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also while buffer works, I get bounds errors when trying to push! To the deque; so I seem to have a major misunderstanding on circular deque still"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"55013e39-18ad-4a10-b340-f7728f0b7e85","type":"message","text":"didn't the deque overwrite on full capacity and the buffer errored?","user":"UH24GRBLL","ts":"1608583560.350700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"x0RD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"didn't the deque overwrite on full capacity and the buffer errored?"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY","reactions":[{"name":"this-is-false","users":["U6A936746"],"count":1}]},{"client_msg_id":"d137f39c-2147-49e0-b4dc-9908f7eef203","type":"message","text":"or did I mix them up","user":"UH24GRBLL","ts":"1608583564.350900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e/bE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"or did I mix them up"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY","reactions":[{"name":"this-is-true","users":["U6A936746"],"count":1}]},{"client_msg_id":"b6310eb7-c843-4283-8c71-f41ddb719af1","type":"message","text":"no the other way around","user":"UPJ6Q2SQY","ts":"1608583596.351100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Yf6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"no the other way around"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY","reactions":[{"name":"point_up","users":["U6A936746"],"count":1}]},{"client_msg_id":"28630ab1-54ce-439c-a1f1-64c073f8dbaf","type":"message","text":"the buffer works fine, the deque gives me a bounds error","user":"UPJ6Q2SQY","ts":"1608583607.351300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZO1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the buffer works fine, the deque gives me a bounds error"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"},{"client_msg_id":"6fddecb5-a862-46f4-ab1a-5c8e30ece442","type":"message","text":"but the docs also read quite similar,... I'll stick with the CircularBuffer, since it does what I expect","user":"UPJ6Q2SQY","ts":"1608583690.351500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"x=N","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but the docs also read quite similar,... I'll stick with the CircularBuffer, since it does what I expect"}]}]}],"thread_ts":"1608569220.328700","parent_user_id":"UPJ6Q2SQY"}]