[{"client_msg_id":"63D46F05-C39D-4B95-984C-000CFBE5F51C","type":"message","text":"I was reading some machine learning code and wanted to understand the mathematics of calculating the gradient of the error function for a hypothesis *h* equal to the dot product of an input matrix *X* and weight matrix *θ*. \n\nThe code says that the gradient is the dot product of *X* transpose and *h* - *y*, where *y* is the value of the training data.  Reviewing the traditional notation of an error function, which is the sum of (wX - y)^2 for N terms, I can’t convince myself that this code is correct.  Would anyone please enlighten me?","user":"U01GC3N3ZJT","ts":"1610059611.004300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"D/l","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I was reading some machine learning code and wanted to understand the mathematics of calculating the gradient of the error function for a hypothesis "},{"type":"text","text":"h","style":{"bold":true}},{"type":"text","text":" equal to the dot product of an input matrix "},{"type":"text","text":"X","style":{"bold":true}},{"type":"text","text":" and weight matrix "},{"type":"text","text":"θ","style":{"bold":true}},{"type":"text","text":". \n"},{"type":"text","text":"\n"},{"type":"text","text":"The code says that the gradient is the dot product of "},{"type":"text","text":"X","style":{"bold":true}},{"type":"text","text":" transpose and "},{"type":"text","text":"h","style":{"bold":true}},{"type":"text","text":" - "},{"type":"text","text":"y","style":{"bold":true}},{"type":"text","text":", where "},{"type":"text","text":"y","style":{"bold":true}},{"type":"text","text":" is the value of the training data.  Reviewing the traditional notation of an error function, which is the sum of (wX - y)^2 for N terms, I can’t convince myself that this code is correct.  Would anyone please enlighten me?"}]}]}],"thread_ts":"1610059611.004300","reply_count":9,"reply_users_count":3,"latest_reply":"1610071019.019400","reply_users":["U6A936746","U01GC3N3ZJT","UJB9LTG5V"],"subscribed":false},{"type":"message","text":"Checks out fine in 1D","files":[{"id":"F01JM0LHF89","created":1610060654,"timestamp":1610060654,"name":"IMG_20210107_230404.jpg","title":"IMG_20210107_230404.jpg","mimetype":"image/jpeg","filetype":"jpg","pretty_type":"JPEG","user":"U6A936746","editable":false,"size":386573,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01JM0LHF89/img_20210107_230404.jpg","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01JM0LHF89/download/img_20210107_230404.jpg","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01JM0LHF89-5a2648d73e/img_20210107_230404_64.jpg","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01JM0LHF89-5a2648d73e/img_20210107_230404_80.jpg","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01JM0LHF89-5a2648d73e/img_20210107_230404_360.jpg","thumb_360_w":270,"thumb_360_h":360,"thumb_480":"https://files.slack.com/files-tmb/T68168MUP-F01JM0LHF89-5a2648d73e/img_20210107_230404_480.jpg","thumb_480_w":360,"thumb_480_h":480,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01JM0LHF89-5a2648d73e/img_20210107_230404_160.jpg","thumb_720":"https://files.slack.com/files-tmb/T68168MUP-F01JM0LHF89-5a2648d73e/img_20210107_230404_720.jpg","thumb_720_w":540,"thumb_720_h":720,"thumb_800":"https://files.slack.com/files-tmb/T68168MUP-F01JM0LHF89-5a2648d73e/img_20210107_230404_800.jpg","thumb_800_w":800,"thumb_800_h":1067,"thumb_960":"https://files.slack.com/files-tmb/T68168MUP-F01JM0LHF89-5a2648d73e/img_20210107_230404_960.jpg","thumb_960_w":720,"thumb_960_h":960,"thumb_1024":"https://files.slack.com/files-tmb/T68168MUP-F01JM0LHF89-5a2648d73e/img_20210107_230404_1024.jpg","thumb_1024_w":768,"thumb_1024_h":1024,"original_w":3024,"original_h":4032,"thumb_tiny":"AwAwACR32SId2/Oj7LD6H86mNJn2pDIvskH90n8TTvskH9z9TUmfSloAj+yQf88x+Zo+yQf88x+ZqWigCMnmlzSE0maBjhml5popQcCgBQTjnrRSA0tAiOkHTpSnrTR3oGOHPtThxUYXpT6AHUUlFIR//9k=","permalink":"https://julialang.slack.com/files/U6A936746/F01JM0LHF89/img_20210107_230404.jpg","permalink_public":"https://slack-files.com/T68168MUP-F01JM0LHF89-612b41afd0","is_starred":false,"has_rich_preview":false}],"upload":false,"blocks":[{"type":"rich_text","block_id":"Me8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Checks out fine in 1D"}]}]}],"user":"U6A936746","display_as_bot":false,"ts":"1610060659.004800","client_msg_id":"01985d67-dd6f-43a8-aa3d-ca6dee416047","thread_ts":"1610059611.004300","parent_user_id":"U01GC3N3ZJT"},{"client_msg_id":"3CABF009-1288-409C-A851-A352BEDCACF2","type":"message","text":"<@U6A936746> Alright, I’ve convinced myself that x can be the coefficient of the answer, but wouldn’t applying the chain rule to a squared binomial leave a factor of two?\n\n```df/dw = (d/dw (wx - y))(d/du u^2) where u = wx - y\n\n= x(2u)\n= 2x(wx-y)\n= 2x(h-y)\n```","user":"U01GC3N3ZJT","ts":"1610063070.008100","team":"T68168MUP","edited":{"user":"U01GC3N3ZJT","ts":"1610063180.000000"},"blocks":[{"type":"rich_text","block_id":"YOgwU","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U6A936746"},{"type":"text","text":" Alright, I’ve convinced myself that x can be the coefficient of the answer, but wouldn’t applying the chain rule to a squared binomial leave a factor of two?\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"df/dw = (d/dw (wx - y))(d/du u^2) where u = wx - y\n\n= x(2u)\n= 2x(wx-y)"},{"type":"text","text":"\n"},{"type":"text","text":"= 2x(h-y)"},{"type":"text","text":"\n"}]}]}],"thread_ts":"1610059611.004300","parent_user_id":"U01GC3N3ZJT"},{"client_msg_id":"640794f5-e16b-4141-94e8-cc854f5f378d","type":"message","text":"Ah, yes, my bad","user":"U6A936746","ts":"1610063245.008500","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1610063326.000000"},"blocks":[{"type":"rich_text","block_id":"uCY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah, yes, my bad"}]}]}],"thread_ts":"1610059611.004300","parent_user_id":"U01GC3N3ZJT"},{"client_msg_id":"928a4369-2dfa-4787-a867-d10bebe5f48d","type":"message","text":"if it is them applying gradient descent then that wouldn't matter much.","user":"U6A936746","ts":"1610063317.008900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bVlCH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"if it is them applying gradient descent then that wouldn't matter much."}]}]}],"thread_ts":"1610059611.004300","parent_user_id":"U01GC3N3ZJT"},{"client_msg_id":"45CA9520-19CE-42B5-BBC2-D37E389C7BF1","type":"message","text":"Interestingly, the cost function ends up divided by two.  I wonder if the author noticed he needed to compensate.  I should write him.","user":"U01GC3N3ZJT","ts":"1610063448.010400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yDe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Interestingly, the cost function ends up divided by two.  I wonder if the author noticed he needed to compensate.  I should write him."}]}]}],"thread_ts":"1610059611.004300","parent_user_id":"U01GC3N3ZJT"},{"client_msg_id":"ee9b7ab1-6ffb-4256-b153-8167ba9a781b","type":"message","text":"I have seen this done before intentionally to make the gradient not.\nIt does matter for purposes of optimization. The optima are still at the same point","user":"U6A936746","ts":"1610064491.010600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UWI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have seen this done before intentionally to make the gradient not.\nIt does matter for purposes of optimization. The optima are still at the same point"}]}]}],"thread_ts":"1610059611.004300","parent_user_id":"U01GC3N3ZJT"},{"client_msg_id":"5766E0A8-EA1A-43F4-8AEF-BEC595D2E681","type":"message","text":"I don’t understand.  Would you please rephrase, especially what do you mean by “gradient not”?","user":"U01GC3N3ZJT","ts":"1610066839.011900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cHWo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don’t understand.  Would you please rephrase, especially what do you mean by “gradient not”?"}]}]}],"thread_ts":"1610059611.004300","parent_user_id":"U01GC3N3ZJT"},{"client_msg_id":"C2A7092C-50E1-48A0-B38D-D27CDD7ABE2E","type":"message","text":"The plot thickens.  He defined the cost function as the dot product of the gradient transpose and the gradient and divided it by two rather than four.  Were the coefficient irrelevant, why would he have included a division—by the wrong number, no less? :face_with_raised_eyebrow:","user":"U01GC3N3ZJT","ts":"1610067252.015000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Q9k","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The plot thickens.  He defined the cost function as the dot product of the gradient transpose and the gradient and divided it by two rather than four.  Were the coefficient irrelevant, why would he have included a division—by the wrong number, no less? "},{"type":"emoji","name":"face_with_raised_eyebrow"}]}]}],"thread_ts":"1610059611.004300","parent_user_id":"U01GC3N3ZJT"},{"client_msg_id":"CB261240-19FF-4027-AA1E-2C8EAE127D84","type":"message","text":"Solve the equation `x-1 = 0` and `2(x-1) = 0`. The answer is the same. If only one term is multiples by a constant (say in a lagrangian) then it does matter.","user":"UJB9LTG5V","ts":"1610071019.019400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tbG47","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Solve the equation "},{"type":"text","text":"x-1 = 0","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"2(x-1) = 0","style":{"code":true}},{"type":"text","text":". The answer is the same. If only one term is multiples by a constant (say in a lagrangian) then it does matter."}]}]}],"thread_ts":"1610059611.004300","parent_user_id":"U01GC3N3ZJT"}]