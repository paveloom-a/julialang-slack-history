[{"client_msg_id":"208b9db1-1e54-4b1e-9ee8-0d6495b23c2b","type":"message","text":"is that not fast enough?","user":"UH24GRBLL","ts":"1610196016.399000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zNbU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"is that not fast enough?"}]}]}],"thread_ts":"1610196016.399000","reply_count":12,"reply_users_count":4,"latest_reply":"1610207500.406600","reply_users":["U01GXNFKY6R","UH24GRBLL","U67431ELR","UBF9YRB6H"],"subscribed":false},{"client_msg_id":"da31c07e-b801-4821-ad98-f40bd0911dd3","type":"message","text":"It’s pretty fast but my dataset is huuuuuge","user":"U01GXNFKY6R","ts":"1610196213.400000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lmyk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It’s pretty fast but my dataset is huuuuuge"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"e3169072-348f-4cf2-94ab-7d1e0be9a836","type":"message","text":"I have a 64 core machine that would like to make this 64 times faster","user":"U01GXNFKY6R","ts":"1610196232.400200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VOM0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have a 64 core machine that would like to make this 64 times faster"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"46600b32-ea8d-4395-9bf7-a5b4f6d68d46","type":"message","text":"I think the idiomatic way to write this would be `transform!(df, :target =&gt; (x -&gt; ifelse(x == \"item\", 1, 0)) =&gt; :target_num)`, though depending on  what you need those 1/0 for, just `==(\"item\")` may be enough","user":"UH24GRBLL","ts":"1610196263.400400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YJQw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think the idiomatic way to write this would be "},{"type":"text","text":"transform!(df, :target => (x -> ifelse(x == \"item\", 1, 0)) => :target_num)","style":{"code":true}},{"type":"text","text":", though depending on  what you need those 1/0 for, just "},{"type":"text","text":"==(\"item\")","style":{"code":true}},{"type":"text","text":" may be enough"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"b1eedcf6-af56-44b3-bb04-a305601665e0","type":"message","text":"I'm not sure if that's threaded under the hood, but I think it is","user":"UH24GRBLL","ts":"1610196277.400600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZOp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm not sure if that's threaded under the hood, but I think it is"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"0974a69a-d42d-4f47-8703-94b20722ff38","type":"message","text":"`transform` doesn't use threads currently. You could try `ThreadsX.map`. But it will be 64× faster only if the dataset is really really huge. How long does that operation take currently?","user":"U67431ELR","ts":"1610196351.400800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"N28JO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"transform","style":{"code":true}},{"type":"text","text":" doesn't use threads currently. You could try "},{"type":"text","text":"ThreadsX.map","style":{"code":true}},{"type":"text","text":". But it will be 64× faster only if the dataset is really really huge. How long does that operation take currently?"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL","reactions":[{"name":"+1","users":["U01GXNFKY6R"],"count":1}]},{"client_msg_id":"66560eae-d72d-485d-9da4-9892fe9b9457","type":"message","text":"Haven’t timed it yet. I’m working on a subset of the data before I run the big script.","user":"U01GXNFKY6R","ts":"1610196604.401400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XuA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Haven’t timed it yet. I’m working on a subset of the data before I run the big script."}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"ecce9155-3300-48fe-911a-a06c76b98b8c","type":"message","text":"Dataset is being loaded from a 50gb parquet file","user":"U01GXNFKY6R","ts":"1610196659.401800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vwe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Dataset is being loaded from a 50gb parquet file"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"131f2fde-03c0-4cd0-9dfd-96850b994aba","type":"message","text":"<@UH24GRBLL> that might be idiomatic but it’s also a bit slower for some reason","user":"U01GXNFKY6R","ts":"1610197296.402100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Xr7U","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UH24GRBLL"},{"type":"text","text":" that might be idiomatic but it’s also a bit slower for some reason"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"a4087403-3cac-448e-a570-3ae274bb1c82","type":"message","text":"I think I’ll go with the ThreadsX approach. Thank you very much!","user":"U01GXNFKY6R","ts":"1610197315.402300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"X2oMr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think I’ll go with the ThreadsX approach. Thank you very much!"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"0fe5d8ac-f177-4dc5-92e6-41fe5330b7de","type":"message","text":"yeah, if it's not threaded in the background the ThreadsX approach is definitely better","user":"UH24GRBLL","ts":"1610197364.402500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QmOUp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah, if it's not threaded in the background the ThreadsX approach is definitely better"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"cb688b76-45f3-4cbf-9e71-4eabb7eb45fc","type":"message","text":"when you need really performant code in DataFrames, just write functions that accept vectors and optimize those. a  main benefit of DataFrames is that you can forget about data frames when you need to","user":"UBF9YRB6H","ts":"1610203763.406200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ex/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"when you need really performant code in DataFrames, just write functions that accept vectors and optimize those. a  main benefit of DataFrames is that you can forget about data frames when you need to"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"},{"client_msg_id":"b67f79f0-a605-45de-a9f5-e1d78b9b3ab0","type":"message","text":"So the ThreadsX approach is not much faster, maybe because of something SIMD related, but I’m not too certain about these things","user":"U01GXNFKY6R","ts":"1610207500.406600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lqB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So the ThreadsX approach is not much faster, maybe because of something SIMD related, but I’m not too certain about these things"}]}]}],"thread_ts":"1610196016.399000","parent_user_id":"UH24GRBLL"}]