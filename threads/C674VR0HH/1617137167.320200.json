[{"client_msg_id":"549d632f-464a-4b80-9c28-7ce0e76722cd","type":"message","text":"which changes the layout internally to assume that `duration` can't be undef","user":"U67BJLYCS","ts":"1617137167.320200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"alaR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"which changes the layout internally to assume that "},{"type":"text","text":"duration","style":{"code":true}},{"type":"text","text":" can't be undef"}]}]}],"thread_ts":"1617137167.320200","reply_count":9,"reply_users_count":2,"latest_reply":"1617140468.325500","reply_users":["U681ELA87","U67BJLYCS"],"is_locked":false,"subscribed":false},{"client_msg_id":"575a4662-5e90-4657-ae7c-04addccef4a3","type":"message","text":"Yeah, I think `Union{Nothing, String}` is the best option. For the mutable case, I usually will provide default values, like `System() = new(0, nothing, nothing)`.","user":"U681ELA87","ts":"1617138590.322100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pD0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, I think "},{"type":"text","text":"Union{Nothing, String}","style":{"code":true}},{"type":"text","text":" is the best option. For the mutable case, I usually will provide default values, like "},{"type":"text","text":"System() = new(0, nothing, nothing)","style":{"code":true}},{"type":"text","text":"."}]}]}],"thread_ts":"1617137167.320200","parent_user_id":"U67BJLYCS"},{"client_msg_id":"6800d192-0470-4064-9a87-6ad47ac8abab","type":"message","text":"This is the most ergonomic variant I came up with sofar","user":"U67BJLYCS","ts":"1617139963.324000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WxSw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"This is the most ergonomic variant I came up with sofar"}]}]}],"thread_ts":"1617137167.320200","parent_user_id":"U67BJLYCS"},{"client_msg_id":"6e89efc1-6f86-4680-b3ac-f4777ea7b8c7","type":"message","text":"```Base.@kwdef mutable struct System\n    duration::Real = 0\n    cwd::Union{Nothing, String} = nothing\n    environment::Union{Nothing, Dict} = nothing\nend\nStructTypes.StructType(::Type{System}) = StructTypes.Mutable()\nStructTypes.omitempties(::Type{System}) = (:cwd, :environment)```","user":"U67BJLYCS","ts":"1617139966.324200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"15hzJ","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"Base.@kwdef mutable struct System\n    duration::Real = 0\n    cwd::Union{Nothing, String} = nothing\n    environment::Union{Nothing, Dict} = nothing\nend\nStructTypes.StructType(::Type{System}) = StructTypes.Mutable()\nStructTypes.omitempties(::Type{System}) = (:cwd, :environment)"}]}]}],"thread_ts":"1617137167.320200","parent_user_id":"U67BJLYCS"},{"client_msg_id":"4f653e7e-27e6-4684-a0f5-b0d163a8acfb","type":"message","text":"Ah yes, I forgot that `@kwdef` allows specifying default values. I’ve never really used it myself. But yeah, that’s pretty nice.","user":"U681ELA87","ts":"1617140166.324400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"h83","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah yes, I forgot that "},{"type":"text","text":"@kwdef","style":{"code":true}},{"type":"text","text":" allows specifying default values. I’ve never really used it myself. But yeah, that’s pretty nice."}]}]}],"thread_ts":"1617137167.320200","parent_user_id":"U67BJLYCS"},{"client_msg_id":"3bfa4488-bafe-4d49-8b25-1d9176dbc9ab","type":"message","text":"Only thing I am missing from that is the requirement that `duration` is required","user":"U67BJLYCS","ts":"1617140207.324600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cj7u","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Only thing I am missing from that is the requirement that "},{"type":"text","text":"duration","style":{"code":true}},{"type":"text","text":" is required"}]}]}],"thread_ts":"1617137167.320200","parent_user_id":"U67BJLYCS"},{"client_msg_id":"3a874908-4aa3-4cc1-b232-e4e0bca49153","type":"message","text":"```    \"attributes\": {\n      \"description\": \"system and user attributes\",\n      \"type\": [\"object\"],\n      \"required\": [\"system\"],\n      \"properties\": {\n        \"system\": {\n          \"type\": \"object\",\n          \"required\": [\"duration\"],\n          \"properties\": {\n            \"duration\": { \"type\": \"number\", \"minimum\": 0 },\n            \"cwd\": { \"type\": \"string\" },\n            \"environment\": { \"type\": \"object\" }\n          }\n        },\n        \"user\": {\n          \"type\": \"object\"\n        }\n      },\n      \"additionalProperties\": false\n    },```","user":"U67BJLYCS","ts":"1617140233.324800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"W8HD2","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"    \"attributes\": {\n      \"description\": \"system and user attributes\",\n      \"type\": [\"object\"],\n      \"required\": [\"system\"],\n      \"properties\": {\n        \"system\": {\n          \"type\": \"object\",\n          \"required\": [\"duration\"],\n          \"properties\": {\n            \"duration\": { \"type\": \"number\", \"minimum\": 0 },\n            \"cwd\": { \"type\": \"string\" },\n            \"environment\": { \"type\": \"object\" }\n          }\n        },\n        \"user\": {\n          \"type\": \"object\"\n        }\n      },\n      \"additionalProperties\": false\n    },"}]}]}],"thread_ts":"1617137167.320200","parent_user_id":"U67BJLYCS"},{"client_msg_id":"7e62ad22-6b62-4745-a6c5-94511fd5e920","type":"message","text":"is the schema I am working off","user":"U67BJLYCS","ts":"1617140240.325000","team":"T68168MUP","edited":{"user":"U67BJLYCS","ts":"1617140242.000000"},"blocks":[{"type":"rich_text","block_id":"UOw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"is the schema I am working off"}]}]}],"thread_ts":"1617137167.320200","parent_user_id":"U67BJLYCS"},{"client_msg_id":"4cbe16fc-07ab-4ecc-ba1a-074250b225a2","type":"message","text":"Yeah, I guess that’s where we need to fix the bug you just filed. Then it would make `duration` a hard requirement. I guess that’s a current downside of the `Mutable()` approach overall is that you can’t really enforce any kind of field requirements/validation. We could perhaps add a `StructTypes.validate(x)` optional overload that would be called after we were “done” constructing the mutable object.","user":"U681ELA87","ts":"1617140447.325300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xXa8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, I guess that’s where we need to fix the bug you just filed. Then it would make "},{"type":"text","text":"duration","style":{"code":true}},{"type":"text","text":" a hard requirement. I guess that’s a current downside of the "},{"type":"text","text":"Mutable()","style":{"code":true}},{"type":"text","text":" approach overall is that you can’t really enforce any kind of field requirements/validation. We could perhaps add a "},{"type":"text","text":"StructTypes.validate(x)","style":{"code":true}},{"type":"text","text":" optional overload that would be called after we were “done” constructing the mutable object."}]}]}],"thread_ts":"1617137167.320200","parent_user_id":"U67BJLYCS"},{"client_msg_id":"9a7cef01-2035-4bb4-a57a-d8b14e8dcfda","type":"message","text":":heart:","user":"U67BJLYCS","ts":"1617140468.325500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Vh+","elements":[{"type":"rich_text_section","elements":[{"type":"emoji","name":"heart"}]}]}],"thread_ts":"1617137167.320200","parent_user_id":"U67BJLYCS"}]