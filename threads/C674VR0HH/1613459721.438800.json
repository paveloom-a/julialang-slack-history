[{"client_msg_id":"4e22010d-729e-4169-aaa7-ea02cb6d6794","type":"message","text":"I'm thinking of experimenting with something we could potentially do to make untyped tables/dataframes fast for operations like `map(f, eachrow(df))` - we can use reflection to look inside `f`, determine which fields are required, and make a temporary, narrow, named tuple iterator and `map` over that instead. For simple anonymous functions like `f = row -&gt; row.x + row.y` it should be pretty easy to determine from the IR we only need columns `:x`  and `:y`. Whenever it gets too hard to determine we could bail and just use whatever currently happens.\n\nIt turns out you can do all kinds of magic in generated functions and add custom backedges to make sure it stays in sync, like this:\n\n<https://github.com/oxinabox/Tricks.jl/blob/master/src/Tricks.jl>","user":"U66QZ3QF3","ts":"1613459721.438800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5BY/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm thinking of experimenting with something we could potentially do to make untyped tables/dataframes fast for operations like "},{"type":"text","text":"map(f, eachrow(df))","style":{"code":true}},{"type":"text","text":" - we can use reflection to look inside "},{"type":"text","text":"f","style":{"code":true}},{"type":"text","text":", determine which fields are required, and make a temporary, narrow, named tuple iterator and "},{"type":"text","text":"map","style":{"code":true}},{"type":"text","text":" over that instead. For simple anonymous functions like "},{"type":"text","text":"f = row -> row.x + row.y","style":{"code":true}},{"type":"text","text":" it should be pretty easy to determine from the IR we only need columns "},{"type":"text","text":":x","style":{"code":true}},{"type":"text","text":"  and "},{"type":"text","text":":y","style":{"code":true}},{"type":"text","text":". Whenever it gets too hard to determine we could bail and just use whatever currently happens.\n\nIt turns out you can do all kinds of magic in generated functions and add custom backedges to make sure it stays in sync, like this:\n\n"},{"type":"link","url":"https://github.com/oxinabox/Tricks.jl/blob/master/src/Tricks.jl"}]}]}],"thread_ts":"1613459721.438800","reply_count":6,"reply_users_count":3,"latest_reply":"1613473887.440700","reply_users":["U6A936746","U66QZ3QF3","U01GXNFKY6R"],"subscribed":false},{"client_msg_id":"24cd88c4-2388-4b1f-bb0d-1b9b077de571","type":"message","text":"I should not have unleashed this upon the world.","user":"U6A936746","ts":"1613466721.439200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SulU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I should not have unleashed this upon the world."}]}]}],"thread_ts":"1613459721.438800","parent_user_id":"U66QZ3QF3"},{"client_msg_id":"8c7acadd-d90c-4a8c-9787-1c2182026e8b","type":"message","text":"Lol. Yes - you are to blame :slightly_smiling_face:","user":"U66QZ3QF3","ts":"1613466933.439400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MxKpv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Lol. Yes - you are to blame "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1613459721.438800","parent_user_id":"U66QZ3QF3"},{"client_msg_id":"f9bb7af5-3266-40c3-9691-401f22eec5df","type":"message","text":"Tricks seems nice. I should resurrect Traitor while we are at it!","user":"U66QZ3QF3","ts":"1613467029.439600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YX=K","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Tricks seems nice. I should resurrect Traitor while we are at it!"}]}]}],"thread_ts":"1613459721.438800","parent_user_id":"U66QZ3QF3","reactions":[{"name":"heart","users":["UDGT4PM41","U6A936746"],"count":2},{"name":"dagger_knife","users":["U6A936746"],"count":1}]},{"client_msg_id":"c19990ad-141c-4984-af5a-720300a21191","type":"message","text":"Sometimes broadcasting works much better","user":"U01GXNFKY6R","ts":"1613473655.440300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8LoIR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Sometimes broadcasting works much better"}]}]}],"thread_ts":"1613459721.438800","parent_user_id":"U66QZ3QF3"},{"client_msg_id":"87514171-040e-47f5-a829-94c4ba6681a2","type":"message","text":"f.(df.x, df.y) for example","user":"U01GXNFKY6R","ts":"1613473689.440500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"o7N","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"f.(df.x, df.y) for example"}]}]}],"thread_ts":"1613459721.438800","parent_user_id":"U66QZ3QF3"},{"client_msg_id":"fea2e101-ad41-4f82-a8d6-a65dd1c8c72f","type":"message","text":"because it introduces a function barrier.","user":"U6A936746","ts":"1613473887.440700","team":"T68168MUP","edited":{"user":"U6A936746","ts":"1613473894.000000"},"blocks":[{"type":"rich_text","block_id":"87j","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"because it introduces a function barrier."}]}]}],"thread_ts":"1613459721.438800","parent_user_id":"U66QZ3QF3"}]