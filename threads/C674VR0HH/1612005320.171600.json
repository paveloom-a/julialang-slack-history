[{"client_msg_id":"4c4c4a44-27ee-4027-bc49-b14d6649f004","type":"message","text":"Why does this function (PercentageChange) allocate?\n```function PercentageChange(input,output)\n    N = length(input)\n    output[1] = missing\n    output[2:N] = @view(input[2:N]) ./ @view(input[1:N-1]) .- 1\nend\n\nfunction test()\n    N = 10^8\n    d = Normal()\n    df = DataFrame(:data =&gt; rand(d, N))\n    df.PctChange = Vector{Union{Missing, Float64}}(undef, nrow(df))\n    @btime PercentageChange($df[!,:data], $df[!,:PctChange])\nend```\n407.100 ms (2 allocations: 762.94 MiB)","user":"U019S5MR0EN","ts":"1612005320.171600","team":"T68168MUP","edited":{"user":"U019S5MR0EN","ts":"1612005727.000000"},"blocks":[{"type":"rich_text","block_id":"i3P","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Why does this function (PercentageChange) allocate?\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function PercentageChange(input,output)\n    N = length(input)\n    output[1] = missing\n    output[2:N] = @view(input[2:N]) ./ @view(input[1:N-1]) .- 1\nend\n\nfunction test()\n    N = 10^8\n    d = Normal()\n    df = DataFrame(:data => rand(d, N))\n    df.PctChange = Vector{Union{Missing, Float64}}(undef, nrow(df))\n    @btime PercentageChange($df[!,:data], $df[!,:PctChange])\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"407.100 ms (2 allocations: 762.94 MiB)"}]}]}],"thread_ts":"1612005320.171600","reply_count":4,"reply_users_count":2,"latest_reply":"1612006593.172500","reply_users":["U8JAMQGQY","U019S5MR0EN"],"subscribed":false},{"client_msg_id":"e49c288e-5e88-4c0e-a56c-d4f3033d6216","type":"message","text":"You need to write (note `.` before `=`):\n```output[2:N] .= @view(input[2:N]) ./ @view(input[1:N-1]) .- 1```\n","user":"U8JAMQGQY","ts":"1612006336.171800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HAoQm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You need to write (note "},{"type":"text","text":".","style":{"code":true}},{"type":"text","text":" before "},{"type":"text","text":"=","style":{"code":true}},{"type":"text","text":"):\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"output[2:N] .= @view(input[2:N]) ./ @view(input[1:N-1]) .- 1"}]},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1612005320.171600","parent_user_id":"U019S5MR0EN","reactions":[{"name":"correct_answer","users":["UB197FRCL"],"count":1}]},{"client_msg_id":"461684e4-20cf-492d-a26e-6190e9177b47","type":"message","text":"<@U8JAMQGQY> I copied the code from your answer here:\n<https://stackoverflow.com/questions/56325202/julia-dataframes-equivalent-of-pandas-pct-change>\nIs there a reason why there is not a dot before the = in your answer?","user":"U019S5MR0EN","ts":"1612006487.172000","team":"T68168MUP","attachments":[{"service_name":"Stack Overflow","title":"Julia DataFrames equivalent of pandas pct_change()","title_link":"https://stackoverflow.com/questions/56325202/julia-dataframes-equivalent-of-pandas-pct-change","text":"Currently, I have written the below function for percent change calculation: function pct_change(input::AbstractVector{&lt;:Number})::AbstractVector{Number} result = [NaN] for i in 2:length(","fallback":"Stack Overflow: Julia DataFrames equivalent of pandas pct_change()","thumb_url":"https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded","from_url":"https://stackoverflow.com/questions/56325202/julia-dataframes-equivalent-of-pandas-pct-change","thumb_width":316,"thumb_height":316,"service_icon":"https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon.png?v=c78bd457575a","id":1,"original_url":"https://stackoverflow.com/questions/56325202/julia-dataframes-equivalent-of-pandas-pct-change"}],"blocks":[{"type":"rich_text","block_id":"CPTl","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U8JAMQGQY"},{"type":"text","text":" I copied the code from your answer here:\n"},{"type":"link","url":"https://stackoverflow.com/questions/56325202/julia-dataframes-equivalent-of-pandas-pct-change"},{"type":"text","text":"\nIs there a reason why there is not a dot before the = in your answer?"}]}]}],"thread_ts":"1612005320.171600","parent_user_id":"U019S5MR0EN"},{"client_msg_id":"78f8c592-7961-4a74-95c0-1a8b2afef3ff","type":"message","text":"Yes - because on SO I do not pre-allocate the output array, while in your code you preallocate it.","user":"U8JAMQGQY","ts":"1612006558.172300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8kDL7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yes - because on SO I do not pre-allocate the output array, while in your code you preallocate it."}]}]}],"thread_ts":"1612005320.171600","parent_user_id":"U019S5MR0EN","reactions":[{"name":"thumbsup_all","users":["U019S5MR0EN"],"count":1}]},{"client_msg_id":"05ad908a-940d-4944-8803-e2a69a2db7b8","type":"message","text":"Note that the code on SO and here is not the same.","user":"U8JAMQGQY","ts":"1612006593.172500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"43X","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Note that the code on SO and here is not the same."}]}]}],"thread_ts":"1612005320.171600","parent_user_id":"U019S5MR0EN","reactions":[{"name":"thumbsup_all","users":["U019S5MR0EN"],"count":1}]}]