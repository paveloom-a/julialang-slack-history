[{"client_msg_id":"ddb7ccc1-c8bf-44cc-ad8d-a08f8589934f","type":"message","text":"I’m trying to collapse the time dimension in a longitudinal dataset. For some columns, I just want the first value but some of the columns begin with a missing so there I’d like the first non-missing value. After reading the docs, <https://dataframes.juliadata.org/stable/man/split_apply_combine/>, I thought I could do something like this\n```datetime_df = combine(\n    groupby(df, :id),\n    AsTable([\"datetime\", \"Gender\"]) =&gt; (t -&gt; (datetime=first(t.datetime), Gender=first(t.Gender))) =&gt; AsTable)```\nbut it gives me\n```ERROR: ArgumentError: Unrecognized column selector: AsTable([\"datetime\", \"Gender\"]) =&gt; (var\"#283#284\"() =&gt; AsTable)```\nAm I doing something obviously wrong here?","user":"U680T6770","ts":"1608413892.211400","team":"T68168MUP","edited":{"user":"U680T6770","ts":"1608413920.000000"},"blocks":[{"type":"rich_text","block_id":"y=a1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I’m trying to collapse the time dimension in a longitudinal dataset. For some columns, I just want the first value but some of the columns begin with a missing so there I’d like the first non-missing value. After reading the docs, "},{"type":"link","url":"https://dataframes.juliadata.org/stable/man/split_apply_combine/"},{"type":"text","text":", I thought I could do something like this\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"datetime_df = combine(\n    groupby(df, :id),\n    AsTable([\"datetime\", \"Gender\"]) => (t -> (datetime=first(t.datetime), Gender=first(t.Gender))) => AsTable)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"but it gives me\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: ArgumentError: Unrecognized column selector: AsTable([\"datetime\", \"Gender\"]) => (var\"#283#284\"() => AsTable)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Am I doing something obviously wrong here?"}]}]}],"thread_ts":"1608413892.211400","reply_count":15,"reply_users_count":2,"latest_reply":"1608418100.217500","reply_users":["U8JAMQGQY","U680T6770"],"subscribed":false},{"client_msg_id":"0272beae-67e1-4e0a-84a4-0d848a05bc79","type":"message","text":"are you on 0.22?","user":"U8JAMQGQY","ts":"1608414446.211800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ypJSl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"are you on 0.22?"}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"eb3243ad-b61f-48e7-9fc1-ba24e76d309e","type":"message","text":"No. I’m using 0.21.8. I hadn’t realized that there had been changes wrt split-apply-combine.","user":"U680T6770","ts":"1608415115.212500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6rF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No. I’m using 0.21.8. I hadn’t realized that there had been changes wrt split-apply-combine."}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"cad207d1-cc51-45f0-82e4-2e929147632c","type":"message","text":"It might be a bit tricky to upgrade right now because I have a lot of dependencies in this project so is there a way to write this in 0.21.x? If I remove the last `AsTable`, it looks very much like the\n```combine([:PetalLength, :SepalLength] =&gt; (p, s) -&gt; (a=mean(p)/mean(s), b=sum(p)),\n               gdf)```\nexample from the 0.21.x docs but I’m then getting\n```ArgumentError: a single value or vector result is required when passing multiple functions```","user":"U680T6770","ts":"1608415336.212700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NS0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It might be a bit tricky to upgrade right now because I have a lot of dependencies in this project so is there a way to write this in 0.21.x? If I remove the last "},{"type":"text","text":"AsTable","style":{"code":true}},{"type":"text","text":", it looks very much like the\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"combine([:PetalLength, :SepalLength] => (p, s) -> (a=mean(p)/mean(s), b=sum(p)),\n               gdf)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"example from the 0.21.x docs but I’m then getting\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ArgumentError: a single value or vector result is required when passing multiple functions"}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"8a4b8806-f8d1-4e5e-8865-285ae796074a","type":"message","text":"Note to the othr readers: do not use the advice I give below, as it is for 0.21.","user":"U8JAMQGQY","ts":"1608415465.213100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LspH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Note to the othr readers: do not use the advice I give below, as it is for 0.21."}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"1fc67c9a-237b-49bb-937b-412fe106a835","type":"message","text":"In 0.21 release `combine` had a limited support for `src =&gt; fun =&gt; dst` syntax. In particular it DID NOT allow to create multiple columns in an output from a single function UNLESS you wrote `combine(fun, gdf)`  or `combine(src =&gt; fun, gdf)`","user":"U8JAMQGQY","ts":"1608415523.213300","team":"T68168MUP","edited":{"user":"U8JAMQGQY","ts":"1608415550.000000"},"blocks":[{"type":"rich_text","block_id":"lslLQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In 0.21 release "},{"type":"text","text":"combine","style":{"code":true}},{"type":"text","text":" had a limited support for "},{"type":"text","text":"src => fun => dst","style":{"code":true}},{"type":"text","text":" syntax. In particular it DID NOT allow to create multiple columns in an output from a single function UNLESS you wrote "},{"type":"text","text":"combine(fun, gdf)","style":{"code":true}},{"type":"text","text":"  or "},{"type":"text","text":"combine(src => fun, gdf)","style":{"code":true}}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"ce362a17-181a-4ee6-ac27-e3351fcb3e98","type":"message","text":"Now the latter, i.e. `combine(src =&gt; fun, gdf)` is removed in 0.22 release as it was inconsistent with the rest of the ecosystem (in 0.22 you can specify all transformations in a style where transformation follows `gdf` in the argument list)","user":"U8JAMQGQY","ts":"1608415619.213700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e53o0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Now the latter, i.e. "},{"type":"text","text":"combine(src => fun, gdf)","style":{"code":true}},{"type":"text","text":" is removed in 0.22 release as it was inconsistent with the rest of the ecosystem (in 0.22 you can specify all transformations in a style where transformation follows "},{"type":"text","text":"gdf","style":{"code":true}},{"type":"text","text":" in the argument list)"}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"b66a4f6b-72fa-4a52-ba0d-fb9cf8f09581","type":"message","text":"Having said that in 0.21 this should work:\n```combine(AsTable([\"datetime\", \"Gender\"]) =&gt; (t -&gt; (datetime=first(t.datetime), Gender=first(t.Gender))), groupby(df, :id))```","user":"U8JAMQGQY","ts":"1608415658.213900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0DDSn","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Having said that in 0.21 this should work:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"combine(AsTable([\"datetime\", \"Gender\"]) => (t -> (datetime=first(t.datetime), Gender=first(t.Gender))), groupby(df, :id))"}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"26de22a2-0413-4a0d-9386-67148e0c59e3","type":"message","text":"However, your original problem can be more easily expressed as:","user":"U8JAMQGQY","ts":"1608415717.214100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CZx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"However, your original problem can be more easily expressed as:"}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"88784ed1-9169-49bf-a815-5122cd1775b2","type":"message","text":"```combine(groupby(df, :id), [\"datetime\", \"Gender\"] .=&gt; first∘skipmissing .=&gt; [\"datetime\", \"Gender\"])```","user":"U8JAMQGQY","ts":"1608415783.214300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"U7hnF","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"combine(groupby(df, :id), [\"datetime\", \"Gender\"] .=> first∘skipmissing .=> [\"datetime\", \"Gender\"])"}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"0eec0391-8a89-4764-b352-9f597b72bcca","type":"message","text":"assuming you guarantee that no group has only `missing` values in the respective columns.","user":"U8JAMQGQY","ts":"1608415800.214500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Sqo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"assuming you guarantee that no group has only "},{"type":"text","text":"missing","style":{"code":true}},{"type":"text","text":" values in the respective columns."}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"2df60f7d-59ed-4a2d-8ece-e88fe4fdb272","type":"message","text":"Also in 0.22 you have a `renamecols` kwarg which would allow you to avoid repeating output column names","user":"U8JAMQGQY","ts":"1608415823.214800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vaON","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also in 0.22 you have a "},{"type":"text","text":"renamecols","style":{"code":true}},{"type":"text","text":" kwarg which would allow you to avoid repeating output column names"}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"4940a6d0-c18e-489e-bb51-bb79f5f8790f","type":"message","text":"Continuing with 0.22 release the `AsTable` as destination column specifier was added in that release and it tells `combine` that the function returns an object that has multiple columns and automatic extraction of column names should be done. This feature is not present in 0.21 release.","user":"U8JAMQGQY","ts":"1608415944.215000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"F8=Og","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Continuing with 0.22 release the "},{"type":"text","text":"AsTable","style":{"code":true}},{"type":"text","text":" as destination column specifier was added in that release and it tells "},{"type":"text","text":"combine","style":{"code":true}},{"type":"text","text":" that the function returns an object that has multiple columns and automatic extraction of column names should be done. This feature is not present in 0.21 release."}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"ca59fc5d-d20d-4d4b-8813-33862829b6d1","type":"message","text":"Does what I have written here help you solve your problem?","user":"U8JAMQGQY","ts":"1608415973.215200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vXVr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does what I have written here help you solve your problem?"}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"24abb187-be84-4da0-89d5-7cde9541a236","type":"message","text":"A final note is that 0.22 was the last breaking release :smile:. The next release is 1.0 and it will not introduce any breaking changes but will only remove deprecations and add new functionalities  (0.22 is treated as kind of 0.7 for JuliaBase). Then, for at least several years, there will be no breaking changes until we hit 2.0 release.","user":"U8JAMQGQY","ts":"1608416085.215400","team":"T68168MUP","edited":{"user":"U8JAMQGQY","ts":"1608416101.000000"},"blocks":[{"type":"rich_text","block_id":"oHl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"A final note is that 0.22 was the last breaking release "},{"type":"emoji","name":"smile"},{"type":"text","text":". The next release is 1.0 and it will not introduce any breaking changes but will only remove deprecations and add new functionalities  (0.22 is treated as kind of 0.7 for JuliaBase). Then, for at least several years, there will be no breaking changes until we hit 2.0 release."}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"},{"client_msg_id":"42A80DE3-158F-4387-B613-8C63DEDD3380","type":"message","text":"Thanks a lot. I believe this is all I need. I’ll try it out tomorrow.","user":"U680T6770","ts":"1608418100.217500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"R76Q","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks a lot. I believe this is all I need. I’ll try it out tomorrow."}]}]}],"thread_ts":"1608413892.211400","parent_user_id":"U680T6770"}]