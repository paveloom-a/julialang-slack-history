[{"client_msg_id":"39c15eb3-a9c6-48d8-9b9f-aa25234d66c2","type":"message","text":"Hey guys, I am a little stuck here. I have 3 annotators that are labelling the same sample of 1000 text (denoted as observations id) with 5 kinds of discrete labels (1,...5). The DataFrame looks like this:\n\n```6×3 DataFrame\n Row │ annotator  id     label \n     │ Int64      Int64  Int64 \n─────┼─────────────────────────\n   1 │         1    111      0\n   2 │         1    112      1\n   3 │         2    111      0\n   4 │         2    112      1\n   5 │         3    111      2\n   6 │         3    112      3```\nHow would I make an empirical confusion matrix by counting all the pairs of labels (a, b) that show up together and displaying as a matrix.\n\nFor instance, if three annotators provide labels (1, 1, 2), then increment count for cells (1, 1), (1, 2), (1,2).\n\nI am stuck, and would love some guidance.\n\nIn the example you'll see that annotator 1 and 2 agree with the labels of 111 and 112. But annotator 3 disagrees with both, labelling 111 as 2 and 112 as 3.\n\nPS: If it helps somehow I've made the examples using `df = DataFrame(annotator = repeat(1:3, inner=2), id = repeat(111:112, outer =3), label = [0,1,0,1,2,3])`","user":"U01QBF4PHKP","ts":"1617884254.456300","team":"T68168MUP","edited":{"user":"U01QBF4PHKP","ts":"1617884910.000000"},"blocks":[{"type":"rich_text","block_id":"Ve6af","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hey guys, I am a little stuck here. I have 3 annotators that are labelling the same sample of 1000 text (denoted as observations id) with 5 kinds of discrete labels (1,...5). The DataFrame looks like this:\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"6×3 DataFrame\n Row │ annotator  id     label \n     │ Int64      Int64  Int64 \n─────┼─────────────────────────\n   1 │         1    111      0\n   2 │         1    112      1\n   3 │         2    111      0\n   4 │         2    112      1\n   5 │         3    111      2\n   6 │         3    112      3"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nHow would I make an empirical confusion matrix by counting all the pairs of labels (a, b) that show up together and displaying as a matrix.\n\nFor instance, if three annotators provide labels (1, 1, 2), then increment count for cells (1, 1), (1, 2), (1,2).\n\nI am stuck, and would love some guidance.\n\nIn the example you'll see that annotator 1 and 2 agree with the labels of 111 and 112. But annotator 3 disagrees with both, labelling 111 as 2 and 112 as 3.\n\nPS: If it helps somehow I've made the examples using "},{"type":"text","text":"df = DataFrame(annotator = repeat(1:3, inner=2), id = repeat(111:112, outer =3), label = [0,1,0,1,2,3])","style":{"code":true}}]}]}],"thread_ts":"1617884254.456300","reply_count":10,"reply_users_count":2,"latest_reply":"1617920283.469100","reply_users":["U7JQGPGCQ","U01QBF4PHKP"],"is_locked":false,"subscribed":false},{"client_msg_id":"e2dcbe49-2c64-46ae-8540-5d4abab65f37","type":"message","text":"I'm no sure if this is what you're after, but here's a way to get a count of labels for each id:\n```julia&gt; combine(groupby(df, :id), :label =&gt; countmap)\n2×2 DataFrame\n Row │ id     label_countmap   \n     │ Int64  Dict…\n─────┼─────────────────────────\n   1 │   111  Dict(0=&gt;2, 2=&gt;1)\n   2 │   112  Dict(3=&gt;1, 1=&gt;2)```","user":"U7JQGPGCQ","ts":"1617885370.456800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QbYw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm no sure if this is what you're after, but here's a way to get a count of labels for each id:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> combine(groupby(df, :id), :label => countmap)\n2×2 DataFrame\n Row │ id     label_countmap   \n     │ Int64  Dict…\n─────┼─────────────────────────\n   1 │   111  Dict(0=>2, 2=>1)\n   2 │   112  Dict(3=>1, 1=>2)"}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"},{"client_msg_id":"3f880073-083f-4f2a-a47f-1a27bacffdc5","type":"message","text":"Then I would need to expand this and make this matrix square. I was thinking in something using cartesian products and somehow a reduce...","user":"U01QBF4PHKP","ts":"1617886562.458700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5MOp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Then I would need to expand this and make this matrix square. I was thinking in something using cartesian products and somehow a reduce..."}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"},{"client_msg_id":"402266e2-320f-414b-82eb-1d8b6f839a2f","type":"message","text":"What do you mean by square here? What do you want the output to look like?","user":"U7JQGPGCQ","ts":"1617893268.459600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"x052","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What do you mean by square here? What do you want the output to look like?"}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"},{"client_msg_id":"8b3820e0-2960-46c6-9c52-7597888a5297","type":"message","text":"It is a square symmetric (or lower-triangular if you wish) K x K matrix with K as the number of labels (in my case 8.\n\nIt would have the following structure. The diagonal would be the agreement and the off-diagonals would flag disagreement and we would see the count and identify what labels are being most disagreed with in a pair-wise comparison. Like this for a 3 x 3 matrix (with 3 labels)\n\n```|         | label 1 | label 2 | label 3 |\n|---------|---------|---------|---------|\n| label 1 | 10      | 2       | 5       |\n| label 2 | 2       | 15      | 0       |\n| label 3 | 5       | 0       | 25      |```","user":"U01QBF4PHKP","ts":"1617898429.462800","team":"T68168MUP","edited":{"user":"U01QBF4PHKP","ts":"1617898568.000000"},"blocks":[{"type":"rich_text","block_id":"SyW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It is a square symmetric (or lower-triangular if you wish) K x K matrix with K as the number of labels (in my case 8.\n\nIt would have the following structure. The diagonal would be the agreement and the off-diagonals would flag disagreement and we would see the count and identify what labels are being most disagreed with in a pair-wise comparison. Like this for a 3 x 3 matrix (with 3 labels)\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"|         | label 1 | label 2 | label 3 |\n|---------|---------|---------|---------|\n| label 1 | 10      | 2       | 5       |\n| label 2 | 2       | 15      | 0       |\n| label 3 | 5       | 0       | 25      |"}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"},{"client_msg_id":"2ce29c4d-ebcf-43dd-827b-82e4956637f7","type":"message","text":"Sorry I can't seem to connect your example to the output - what does `id` have to do with the result?","user":"U7JQGPGCQ","ts":"1617910075.466700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0pYI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Sorry I can't seem to connect your example to the output - what does "},{"type":"text","text":"id","style":{"code":true}},{"type":"text","text":" have to do with the result?"}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"},{"client_msg_id":"09DC4CAF-7607-4D6C-892B-D420A5639707","type":"message","text":"Text id of the text that annotator has labeled.","user":"U01QBF4PHKP","ts":"1617914009.468100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7UA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Text id of the text that annotator has labeled."}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"},{"client_msg_id":"d299cb29-2de3-4596-873b-41a03c8b6955","type":"message","text":"But how would your \"square matrix\" look based on the example above?","user":"U7JQGPGCQ","ts":"1617914072.468400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FsyyX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But how would your \"square matrix\" look based on the example above?"}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"},{"client_msg_id":"5e57b91c-6914-49e5-a08b-6d1824011207","type":"message","text":"Is it one matrix for each item that's being labeled?","user":"U7JQGPGCQ","ts":"1617914200.468600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"26opj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is it one matrix for each item that's being labeled?"}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"},{"client_msg_id":"d80f3930-ab12-4b8e-b037-6ede3ae7676c","type":"message","text":"I have a bunch of text (1000 tweets) that are labelled as `id` and 3 undergraduates students (`annotator`) gave labels 1, ... 8 of those texts (`label 1` ... `label 8`).\n\nI need to have a confusion matrix that display annotator agreement. Whenever all of the annotator agree in the same label it would increase the diagonal values. Whenever an annotator disagrees with another we would increase the off-diagonal value of the ith row with the jth column (and vice versa) of those labels.\n\nThat is the idea.","user":"U01QBF4PHKP","ts":"1617919913.468800","team":"T68168MUP","edited":{"user":"U01QBF4PHKP","ts":"1617919947.000000"},"blocks":[{"type":"rich_text","block_id":"vUOu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I have a bunch of text (1000 tweets) that are labelled as "},{"type":"text","text":"id","style":{"code":true}},{"type":"text","text":" and 3 undergraduates students ("},{"type":"text","text":"annotator","style":{"code":true}},{"type":"text","text":") gave labels 1, ... 8 of those texts ("},{"type":"text","text":"label 1","style":{"code":true}},{"type":"text","text":" ... "},{"type":"text","text":"label 8","style":{"code":true}},{"type":"text","text":").\n\nI need to have a confusion matrix that display annotator agreement. Whenever all of the annotator agree in the same label it would increase the diagonal values. Whenever an annotator disagrees with another we would increase the off-diagonal value of the ith row with the jth column (and vice versa) of those labels.\n\nThat is the idea."}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"},{"client_msg_id":"c71b1558-ab9c-4849-9090-c0e0b322dd8b","type":"message","text":"On the example above it would be a 4 x 4 matrix with\n```4×4 Matrix{Int64}:\n 1  0  1  0\n 0  1  0  1\n 1  0  0  0\n 0  1  0  0```\nBecause both labellers 1 and 2 agree on labels 0 and 1 for ids 111 and 112. But labeller 3 disagrees with both and them we have two disagreements (0 - 2) for id 111 and (1-3) for id 112.","user":"U01QBF4PHKP","ts":"1617920283.469100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"eRX7m","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"On the example above it would be a 4 x 4 matrix with\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"4×4 Matrix{Int64}:\n 1  0  1  0\n 0  1  0  1\n 1  0  0  0\n 0  1  0  0"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nBecause both labellers 1 and 2 agree on labels 0 and 1 for ids 111 and 112. But labeller 3 disagrees with both and them we have two disagreements (0 - 2) for id 111 and (1-3) for id 112."}]}]}],"thread_ts":"1617884254.456300","parent_user_id":"U01QBF4PHKP"}]