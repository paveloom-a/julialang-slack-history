[{"client_msg_id":"26f0c804-5b44-413a-b546-7c3cffdb7a82","type":"message","text":"For a julia process occupying 225 MB I see\n```julia&gt; Base.format_bytes.(Base.summarysize.([Main, Base, Core]))\n3-element Vector{String}:\n \"56.181 MiB\"\n \"56.179 MiB\"\n \"17.228 MiB\"```\nSo Main + Core leaves 65% of memory uncounted.\nIs there anything that can be done to make this reporting more accurate?\nI’m guessing the main mismatch is in Core?\n\nI saw this TODO, could the stacks of Tasks not being counted be significant? <https://github.com/JuliaLang/julia/blob/5fab42ac868f70d1edc6fe85b65a2df6442722b7/base/summarysize.jl#L177>","user":"U8MPCDJAY","ts":"1615050104.178700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BuN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For a julia process occupying 225 MB I see\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> Base.format_bytes.(Base.summarysize.([Main, Base, Core]))\n3-element Vector{String}:\n \"56.181 MiB\"\n \"56.179 MiB\"\n \"17.228 MiB\""}]},{"type":"rich_text_section","elements":[{"type":"text","text":"So Main + Core leaves 65% of memory uncounted.\nIs there anything that can be done to make this reporting more accurate?\nI’m guessing the main mismatch is in Core?\n\nI saw this TODO, could the stacks of Tasks not being counted be significant? "},{"type":"link","url":"https://github.com/JuliaLang/julia/blob/5fab42ac868f70d1edc6fe85b65a2df6442722b7/base/summarysize.jl#L177"}]}]}],"thread_ts":"1615050104.178700","reply_count":14,"reply_users_count":2,"latest_reply":"1615051486.181400","reply_users":["U6A0PD8CR","U8MPCDJAY"],"subscribed":false},{"client_msg_id":"70b3c1c5-ea7b-4aec-a76e-bfe50d016d8f","type":"message","text":"How big is your sysimage on disk?","user":"U6A0PD8CR","ts":"1615050559.178800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"08d2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How big is your sysimage on disk?"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"52ab24a8-ddd6-48f8-86b6-dfc282b1aa39","type":"message","text":"Stupid question.. but which is the default sysimage file? I don’t see any `.so` files in the julia repo after build","user":"U8MPCDJAY","ts":"1615051006.179000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"N7b","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Stupid question.. but which is the default sysimage file? I don’t see any "},{"type":"text","text":".so","style":{"code":true}},{"type":"text","text":" files in the julia repo after build"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"182211ca-56f5-4bed-9a4b-6879a5493f70","type":"message","text":"`usr/lib/julia/sys.so`","user":"U6A0PD8CR","ts":"1615051041.179200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Ij45","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"usr/lib/julia/sys.so","style":{"code":true}}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"b907f095-c6cd-4a55-985c-b0d7b377a6de","type":"message","text":"My sysimage is 152MB on disk","user":"U6A0PD8CR","ts":"1615051069.179400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qBQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"My sysimage is 152MB on disk"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"c537c2d3-d986-447d-881a-cdeab406d4dc","type":"message","text":"145MB","user":"U8MPCDJAY","ts":"1615051076.179600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vMNVM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"145MB"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"f849dc05-fd7e-4544-9fff-4a46c0c0b9ea","type":"message","text":"ok.. so that plus Main + Core gets close","user":"U8MPCDJAY","ts":"1615051095.179800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6wJ/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ok.. so that plus Main + Core gets close"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"e02f1b82-ffc5-4a60-a5c6-f26afcb650a2","type":"message","text":"I'm pretty sure Main and Core come from the sysimage too","user":"U6A0PD8CR","ts":"1615051142.180000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"En6v","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm pretty sure Main and Core come from the sysimage too"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"b1579e06-51b9-40cd-aa31-3e75cee52172","type":"message","text":"So everything else is things like BLAS buffers, stacks, and runtime heap allocations, I would guess","user":"U6A0PD8CR","ts":"1615051166.180200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"e50","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So everything else is things like BLAS buffers, stacks, and runtime heap allocations, I would guess"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"7b660e0b-2da2-4b76-b15c-b2e6d1b681cc","type":"message","text":"I see","user":"U8MPCDJAY","ts":"1615051187.180400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"V1rDE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I see"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"fcb7f1e9-8691-45d8-950a-2dd9325f6776","type":"message","text":"Although I'm not sure everything shows up to the OS as resident memory, because we mmap things","user":"U6A0PD8CR","ts":"1615051215.180600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hYxZM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Although I'm not sure everything shows up to the OS as resident memory, because we mmap things"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"8dc78a5e-d64a-4cdc-a004-ebc0920ea244","type":"message","text":"ah ok","user":"U8MPCDJAY","ts":"1615051225.180800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1eu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ah ok"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"1b429da4-320f-4aa0-86eb-a9898a0b692f","type":"message","text":"For context, I’m trying to track down where a whole load of untracked memory is being used in the vscode language process <https://github.com/julia-vscode/julia-vscode/pull/2001>","user":"U8MPCDJAY","ts":"1615051277.181000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"loW5h","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For context, I’m trying to track down where a whole load of untracked memory is being used in the vscode language process "},{"type":"link","url":"https://github.com/julia-vscode/julia-vscode/pull/2001"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"53731623-1c74-481b-b4a5-47d9a89ff3b3","type":"message","text":"trying to double check that it’s not just a memory leak","user":"U8MPCDJAY","ts":"1615051302.181200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/ForH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"trying to double check that it’s not just a memory leak"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"1c797909-780f-482f-a063-040a781faa0f","type":"message","text":"If you're on Linux, you could check `/proc/PID/maps`. It might give you some extra insight","user":"U6A0PD8CR","ts":"1615051486.181400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vWbX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If you're on Linux, you could check "},{"type":"text","text":"/proc/PID/maps","style":{"code":true}},{"type":"text","text":". It might give you some extra insight"}]}]}],"thread_ts":"1615050104.178700","parent_user_id":"U8MPCDJAY"}]