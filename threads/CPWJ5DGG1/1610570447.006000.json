[{"client_msg_id":"2132926f-3f37-475d-a541-da007d29962d","type":"message","text":"Is `Pkg.precompile` / auto precomp intentionally not used in `julia-runtest` on 1.6..?\nI don’t see it in the output here <https://github.com/r3tex/ObjectDetector.jl/pull/51/checks?check_run_id=1697641522#step:4:10>","user":"U8MPCDJAY","ts":"1610570447.006000","team":"T68168MUP","edited":{"user":"U8MPCDJAY","ts":"1610570462.000000"},"blocks":[{"type":"rich_text","block_id":"WXqY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is "},{"type":"text","text":"Pkg.precompile","style":{"code":true}},{"type":"text","text":" / auto precomp intentionally not used in "},{"type":"text","text":"julia-runtest","style":{"code":true}},{"type":"text","text":" on 1.6..?\nI don’t see it in the output here "},{"type":"link","url":"https://github.com/r3tex/ObjectDetector.jl/pull/51/checks?check_run_id=1697641522#step:4:10"}]}]}],"thread_ts":"1610570447.006000","reply_count":31,"reply_users_count":2,"latest_reply":"1610573135.012200","reply_users":["U67SCG4HG","U8MPCDJAY"],"subscribed":false},{"client_msg_id":"898b61df-b5ee-4338-84d1-a7a28738b030","type":"message","text":"Does it leave a trace though? Unless you watch the logs in real-time?","user":"U67SCG4HG","ts":"1610570665.006200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WHDQv","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does it leave a trace though? Unless you watch the logs in real-time?"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"24586aed-50b6-417d-8211-d34b9e886abf","type":"message","text":"When on CI it prints in a basic form, which doesn’t remove lines etc.","user":"U8MPCDJAY","ts":"1610570704.006400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xIlC3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"When on CI it prints in a basic form, which doesn’t remove lines etc."}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"507cc1fe-86b7-446b-8ced-7747956e6750","type":"message","text":"so the linear progression through the packages should be shown","user":"U8MPCDJAY","ts":"1610570714.006600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6RN3J","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so the linear progression through the packages should be shown"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"a6e7c05f-29ee-40f9-ae79-805955abe404","type":"message","text":"Maybe that detection is broken?","user":"U67SCG4HG","ts":"1610570728.006800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"slDYM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Maybe that detection is broken?"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"b88a8361-0cb9-447b-a34d-b900dc9be51a","type":"message","text":"At least we’d see `Precompiling project...` in both forms","user":"U8MPCDJAY","ts":"1610570736.007000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VELl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"At least we’d see "},{"type":"text","text":"Precompiling project...","style":{"code":true}},{"type":"text","text":" in both forms"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"55276524-ff83-4255-99cc-9a4c9cb97177","type":"message","text":"which we don’t see","user":"U8MPCDJAY","ts":"1610570744.007200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"u3Bvk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"which we don’t see"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"5eb02029-9545-460e-98a3-60bdbe422192","type":"message","text":"That could also have been overwritten though","user":"U67SCG4HG","ts":"1610570748.007400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MW6Gg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That could also have been overwritten though"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"6f011ec3-66c9-4ecd-8d39-8ff2f8202c5e","type":"message","text":"By what?","user":"U8MPCDJAY","ts":"1610570758.007600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YT+6p","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"By what?"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"34f208ed-5489-48f3-bcf1-32530fa5ad4e","type":"message","text":"<https://github.com/JuliaLang/Pkg.jl/issues/2306>","user":"U67SCG4HG","ts":"1610570767.007800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"mCS","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/JuliaLang/Pkg.jl/issues/2306"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"df9adf6c-0919-4f5b-9ec0-6d94ea5ef458","type":"message","text":"for example","user":"U67SCG4HG","ts":"1610570780.008000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OJui","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"for example"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"a6d7732d-6772-4a9a-bf61-6a52959e6ae7","type":"message","text":"hmm I see","user":"U8MPCDJAY","ts":"1610570794.008200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZrBO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"hmm I see"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"013d1511-79d8-4bb4-959a-8196f869b3ef","type":"message","text":"```can_fancyprint(io::IO) = (io isa Base.TTY) &amp;&amp; (get(ENV, \"CI\", nothing) != \"true\")```","user":"U8MPCDJAY","ts":"1610570863.008400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"x/4M","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"can_fancyprint(io::IO) = (io isa Base.TTY) && (get(ENV, \"CI\", nothing) != \"true\")"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"fc728d23-ea4d-48f3-a26a-82407086bbe7","type":"message","text":"that’s what Pkg tests for","user":"U8MPCDJAY","ts":"1610570868.008600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Saz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that’s what Pkg tests for"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"ac2bc698-f337-45bb-bcc8-96755181d9ad","type":"message","text":"So I appear to have intentionally disabled auto precomp during `Pkg.test`\n<https://github.com/JuliaLang/Pkg.jl/blame/c1e31abe4c14b995c9511fc573dc5acfc7e75789/src/Operations.jl#L1536>","user":"U8MPCDJAY","ts":"1610571248.008800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hSo3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So I appear to have intentionally disabled auto precomp during "},{"type":"text","text":"Pkg.test","style":{"code":true}},{"type":"text","text":"\n"},{"type":"link","url":"https://github.com/JuliaLang/Pkg.jl/blame/c1e31abe4c14b995c9511fc573dc5acfc7e75789/src/Operations.jl#L1536"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"e3e4ec7c-a86b-4cae-81b5-419b7a9f0b3b","type":"message","text":"Is that `instantiate` where the install happens?","user":"U8MPCDJAY","ts":"1610571289.009000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Mr5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is that "},{"type":"text","text":"instantiate","style":{"code":true}},{"type":"text","text":" where the install happens?"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"92a9a58f-e404-41d3-824a-9c5d2323ddd5","type":"message","text":"or is there something before that in the action? I don’t see anything","user":"U8MPCDJAY","ts":"1610571304.009200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xfh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"or is there something before that in the action? I don’t see anything"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"db35f90c-6c4d-4ba7-829c-5d82650c1e03","type":"message","text":"maybe we need to expose `allow_autoprecomp` as a `Pkg.test` arg, then let `julia-runtest` decide whether it’s allowed or not","user":"U8MPCDJAY","ts":"1610571392.009400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CUIe6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"maybe we need to expose "},{"type":"text","text":"allow_autoprecomp","style":{"code":true}},{"type":"text","text":" as a "},{"type":"text","text":"Pkg.test","style":{"code":true}},{"type":"text","text":" arg, then let "},{"type":"text","text":"julia-runtest","style":{"code":true}},{"type":"text","text":" decide whether it’s allowed or not"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"1e02715a-3d10-463d-85c0-dce639336889","type":"message","text":"Why did you disable it in the first place?","user":"U67SCG4HG","ts":"1610571513.009600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"22t","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Why did you disable it in the first place?"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"8120095e-f629-4440-997a-921baec8c4b0","type":"message","text":"great question.. it may have slipped through.. or maybe there was some logic behind tests defaulting to the standard code-load precomp back when `Pkg.precomp` didn’t have decent stack trace reporting","user":"U8MPCDJAY","ts":"1610571584.009800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"04q","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"great question.. it may have slipped through.. or maybe there was some logic behind tests defaulting to the standard code-load precomp back when "},{"type":"text","text":"Pkg.precomp","style":{"code":true}},{"type":"text","text":" didn’t have decent stack trace reporting"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"10b529c7-c3d3-462a-a863-42c99762e961","type":"message","text":"Because I complained apparently: <https://github.com/JuliaLang/Pkg.jl/issues/2110>","user":"U67SCG4HG","ts":"1610571584.010000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Sdgzz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Because I complained apparently: "},{"type":"link","url":"https://github.com/JuliaLang/Pkg.jl/issues/2110"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"0f10496a-068d-4f4b-9fb5-df596b182b1b","type":"message","text":"But yea, that `instantiate` is before resolving the test env, so it should not do it there.","user":"U67SCG4HG","ts":"1610571622.010200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"r0x4F","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But yea, that "},{"type":"text","text":"instantiate","style":{"code":true}},{"type":"text","text":" is before resolving the test env, so it should not do it there."}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"bb714295-d474-49b3-9d67-87f3cb5021d4","type":"message","text":"There has to be another place where new deps are collected","user":"U67SCG4HG","ts":"1610571641.010400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FH2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"There has to be another place where new deps are collected"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"9637659b-e2b1-45c7-9631-10feb5b8a3e4","type":"message","text":"goodness, there’s been so many PRs.. good thing there’s a record of all this","user":"U8MPCDJAY","ts":"1610571677.010600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=Dwp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"goodness, there’s been so many PRs.. good thing there’s a record of all this"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"8b0fd3d4-6c22-4bee-8043-0eda585c0191","type":"message","text":"I think you could insert a call here: <https://github.com/JuliaLang/Pkg.jl/blame/c1e31abe4c14b995c9511fc573dc5acfc7e75789/src/Operations.jl#L1452>","user":"U67SCG4HG","ts":"1610571733.010800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"asy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think you could insert a call here: "},{"type":"link","url":"https://github.com/JuliaLang/Pkg.jl/blame/c1e31abe4c14b995c9511fc573dc5acfc7e75789/src/Operations.jl#L1452"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"792e01de-17d0-4dad-8780-43edee74e3fb","type":"message","text":"or something","user":"U67SCG4HG","ts":"1610571735.011000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ta+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"or something"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"da430a3e-5d60-4e92-8f6b-53de3d3556e6","type":"message","text":"after that last write_env","user":"U67SCG4HG","ts":"1610571761.011200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LuUuJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"after that last write_env"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"f5632fa9-73be-4202-af17-5e22840d5cd5","type":"message","text":"ok","user":"U8MPCDJAY","ts":"1610571783.011400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7Sa","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ok"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"4731d58e-48e9-4765-a346-d42e2520ecb7","type":"message","text":"it’s a testament to how much faster 1.6 is without parallel precomp, because I was assuming the much faster CI run time was largely because of precomp!","user":"U8MPCDJAY","ts":"1610571834.011600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"o2vyl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it’s a testament to how much faster 1.6 is without parallel precomp, because I was assuming the much faster CI run time was largely because of precomp!"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"46d18068-d311-4f0e-afa4-5071bd9ccfa8","type":"message","text":"maybe not largely, but somewhat","user":"U8MPCDJAY","ts":"1610571854.011800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bje","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"maybe not largely, but somewhat"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"005eb9d0-559b-4154-a4bc-061319830d53","type":"message","text":"btw, for some reason I thought the github action did the package installation before `Pkg.test`.. hence a lot of my confusion here","user":"U8MPCDJAY","ts":"1610572061.012000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oHA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"btw, for some reason I thought the github action did the package installation before "},{"type":"text","text":"Pkg.test","style":{"code":true}},{"type":"text","text":".. hence a lot of my confusion here"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"},{"client_msg_id":"cddc5561-826c-44cd-b753-46c51446a009","type":"message","text":"<https://github.com/JuliaLang/Pkg.jl/pull/2335>","user":"U8MPCDJAY","ts":"1610573135.012200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Ns4","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/JuliaLang/Pkg.jl/pull/2335"}]}]}],"thread_ts":"1610570447.006000","parent_user_id":"U8MPCDJAY"}]