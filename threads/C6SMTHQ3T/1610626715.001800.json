[{"client_msg_id":"3b061f39-51ef-4754-8cef-bf7551db5b5b","type":"message","text":"Can I ask whether anyone knows what library provides the underlying pthreads implementation for Julia, and whether it is statically linked? We're doing some profiling of our code (using extrae), and we're successfully hooking into the MPI libraries and profiling them, but we're not succeeding with our threading code (yet!)...","user":"U7C8KRZKL","ts":"1610626715.001800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6LcUy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Can I ask whether anyone knows what library provides the underlying pthreads implementation for Julia, and whether it is statically linked? We're doing some profiling of our code (using extrae), and we're successfully hooking into the MPI libraries and profiling them, but we're not succeeding with our threading code (yet!)..."}]}]}],"thread_ts":"1610626715.001800","reply_count":6,"reply_users_count":3,"latest_reply":"1610709433.015700","reply_users":["U7C8KRZKL","U67BJLYCS","UDB26738Q"],"subscribed":false},{"type":"message","subtype":"thread_broadcast","text":"It's disappointing that the speed tests so far shows that multiprocess MPI code runs faster than multithreaded using julia threads - it would be great to be able to understand why, so help with profiling the pthreads code would be appreciated...","user":"U7C8KRZKL","ts":"1610665497.006700","thread_ts":"1610626715.001800","root":{"client_msg_id":"3b061f39-51ef-4754-8cef-bf7551db5b5b","type":"message","text":"Can I ask whether anyone knows what library provides the underlying pthreads implementation for Julia, and whether it is statically linked? We're doing some profiling of our code (using extrae), and we're successfully hooking into the MPI libraries and profiling them, but we're not succeeding with our threading code (yet!)...","user":"U7C8KRZKL","ts":"1610626715.001800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6LcUy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Can I ask whether anyone knows what library provides the underlying pthreads implementation for Julia, and whether it is statically linked? We're doing some profiling of our code (using extrae), and we're successfully hooking into the MPI libraries and profiling them, but we're not succeeding with our threading code (yet!)..."}]}]}],"thread_ts":"1610626715.001800","reply_count":6,"reply_users_count":3,"latest_reply":"1610709433.015700","reply_users":["U7C8KRZKL","U67BJLYCS","UDB26738Q"],"subscribed":false},"blocks":[{"type":"rich_text","block_id":"FVdd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It's disappointing that the speed tests so far shows that multiprocess MPI code runs faster than multithreaded using julia threads - it would be great to be able to understand why, so help with profiling the pthreads code would be appreciated..."}]}]}],"client_msg_id":"db3c939d-9cff-48fa-86fe-e235a34f55cd"},{"client_msg_id":"07cc9525-f165-43aa-935e-c97d8ff12be1","type":"message","text":"We use `libuv` for creating the pthreads iirc","user":"U67BJLYCS","ts":"1610667769.007000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+ROU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"We use "},{"type":"text","text":"libuv","style":{"code":true}},{"type":"text","text":" for creating the pthreads iirc"}]}]}],"thread_ts":"1610626715.001800","parent_user_id":"U7C8KRZKL"},{"client_msg_id":"575dabc2-5e8d-428d-89d6-97f1943ecb40","type":"message","text":"What are the Speedtests that you are using?","user":"U67BJLYCS","ts":"1610667781.007200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5Iqf6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What are the Speedtests that you are using?"}]}]}],"thread_ts":"1610626715.001800","parent_user_id":"U7C8KRZKL"},{"client_msg_id":"40D9169C-1B6C-4786-8506-E05C21588530","type":"message","text":"Thanks <@U67BJLYCS>. Is that dynamically linked, or will we have to recompile julia if we want to use our own pthreads library so we can do the profiling? We’re lucky enough to have NAG doing a whole bunch of profiling of the code to see how efficient our parallelisation is (answer, pretty good so far), so I’m not exactly sure the details of what they’re doing - we mostly just see the graphs, but they’re doing tests on strong and weak scaling efficiency, and lots of exciting measures of efficiency of different aspects of the code that I’m a bit hazy on tbh.","user":"U7C8KRZKL","ts":"1610707338.014300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"wa5K","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks "},{"type":"user","user_id":"U67BJLYCS"},{"type":"text","text":". Is that dynamically linked, or will we have to recompile julia if we want to use our own pthreads library so we can do the profiling? We’re lucky enough to have NAG doing a whole bunch of profiling of the code to see how efficient our parallelisation is (answer, pretty good so far), so I’m not exactly sure the details of what they’re doing - we mostly just see the graphs, but they’re doing tests on strong and weak scaling efficiency, and lots of exciting measures of efficiency of different aspects of the code that I’m a bit hazy on tbh."}]}]}],"thread_ts":"1610626715.001800","parent_user_id":"U7C8KRZKL"},{"client_msg_id":"f8178655-94bf-4aef-ba50-79a3658bafaa","type":"message","text":"I think libuv is dynamically loaded by julia","user":"UDB26738Q","ts":"1610708478.015500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"J4Lf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think libuv is dynamically loaded by julia"}]}]}],"thread_ts":"1610626715.001800","parent_user_id":"U7C8KRZKL"},{"client_msg_id":"6d2300d8-b18a-4461-a0f9-af6408dd7836","type":"message","text":"I don't know what julia does internally with threads (and I'd tend to trust Valentin), but the executable links to libpthreads:\n```% ldd julia \n        linux-vdso.so.1 (0x00007ffd54caa000)\n        libdl.so.2 =&gt; /usr/lib/libdl.so.2 (0x00007f9861e8e000)\n        libpthread.so.0 =&gt; /usr/lib/libpthread.so.0 (0x00007f9861e6c000)\n        libc.so.6 =&gt; /usr/lib/libc.so.6 (0x00007f9861ca3000)\n        /lib64/ld-linux-x86-64.so.2 =&gt; /usr/lib64/ld-linux-x86-64.so.2 (0x00007f9861ed8000)```","user":"UDB26738Q","ts":"1610709433.015700","team":"T68168MUP","edited":{"user":"UDB26738Q","ts":"1610709450.000000"},"blocks":[{"type":"rich_text","block_id":"/ad4h","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don't know what julia does internally with threads (and I'd tend to trust Valentin), but the executable links to libpthreads:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"% ldd julia \n        linux-vdso.so.1 (0x00007ffd54caa000)\n        libdl.so.2 => /usr/lib/libdl.so.2 (0x00007f9861e8e000)\n        libpthread.so.0 => /usr/lib/libpthread.so.0 (0x00007f9861e6c000)\n        libc.so.6 => /usr/lib/libc.so.6 (0x00007f9861ca3000)\n        /lib64/ld-linux-x86-64.so.2 => /usr/lib64/ld-linux-x86-64.so.2 (0x00007f9861ed8000)"}]}]}],"thread_ts":"1610626715.001800","parent_user_id":"U7C8KRZKL"}]