[{"client_msg_id":"FCA87329-566F-40A1-9336-DB65D80F442E","type":"message","text":"How does Julia’s profiler interact with having multiple threads? I assume the profiler is just showing time for the main thread, including time the main thread spends blocked? In my flame graph I see something separate from my computation called task_done_hook taking up a significant amount of time. Clearly it has something to do with the threaded task system, but what is it exactly?","user":"ULD19UCPK","ts":"1612393496.024000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Yi=Y","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How does Julia’s profiler interact with having multiple threads? I assume the profiler is just showing time for the main thread, including time the main thread spends blocked? In my flame graph I see something separate from my computation called task_done_hook taking up a significant amount of time. Clearly it has something to do with the threaded task system, but what is it exactly?"}]}]}],"thread_ts":"1612393496.024000","reply_count":1,"reply_users_count":1,"latest_reply":"1612445571.028100","reply_users":["U6A0PD8CR"],"subscribed":false},{"client_msg_id":"b98c000e-5138-46e6-ae31-15a5408a696a","type":"message","text":"My understanding of this is: When there is work available for non-main threads to run, they spin-sleep-spin waiting for work to become runnable, which manifests as calls to/execution within `task_done_hook`. As Valentin said, the profiler samples all threads, but it doesn't distinguish what ran where.","user":"U6A0PD8CR","ts":"1612445571.028100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hm1EC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"My understanding of this is: When there is work available for non-main threads to run, they spin-sleep-spin waiting for work to become runnable, which manifests as calls to/execution within "},{"type":"text","text":"task_done_hook","style":{"code":true}},{"type":"text","text":". As Valentin said, the profiler samples all threads, but it doesn't distinguish what ran where."}]}]}],"thread_ts":"1612393496.024000","parent_user_id":"ULD19UCPK"}]