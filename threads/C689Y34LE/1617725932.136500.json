[{"client_msg_id":"3d50100b-bb2b-4620-9c5f-861903317cd4","type":"message","text":"How do people generally patch other peoples packages to work on the GPU?  For example, I am currently waiting on &lt;<https://github.com/JuliaArrays/StructArrays.jl/pull/177>&gt;.  Will the new context aware dispatch in GPUCompiler help us to not have to push all the changes upstream?  Further, sometimes what you want to do on the GPU may be different than what you want on the CPU.  Should one add package specific cassette pass to KernelAbstractions?","user":"UBJUA1YAV","ts":"1617725932.136500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1PH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How do people generally patch other peoples packages to work on the GPU?  For example, I am currently waiting on <"},{"type":"link","url":"https://github.com/JuliaArrays/StructArrays.jl/pull/177"},{"type":"text","text":">.  Will the new context aware dispatch in GPUCompiler help us to not have to push all the changes upstream?  Further, sometimes what you want to do on the GPU may be different than what you want on the CPU.  Should one add package specific cassette pass to KernelAbstractions?"}]}]}],"thread_ts":"1617725932.136500","reply_count":6,"reply_users_count":3,"latest_reply":"1617812095.146900","reply_users":["U68A3ASP9","UBJUA1YAV","U6BJ9E351"],"is_locked":false,"subscribed":false},{"client_msg_id":"d8541c3a-7585-4e79-9c0f-350be178359e","type":"message","text":"contextual dispatch should help, but here it looks like avoiding dynamic dispatch would be generally a useful thing for a package like StaticArrays.jl?","user":"U68A3ASP9","ts":"1617726169.136900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sl/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"contextual dispatch should help, but here it looks like avoiding dynamic dispatch would be generally a useful thing for a package like StaticArrays.jl?"}]}]}],"thread_ts":"1617725932.136500","parent_user_id":"UBJUA1YAV"},{"client_msg_id":"31f582f6-f6ae-4438-9932-4da5f99ef647","type":"message","text":"Yea, in this case I think it is a useful patch for both the CPU and GPU code paths.","user":"UBJUA1YAV","ts":"1617726709.137100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FTZ3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yea, in this case I think it is a useful patch for both the CPU and GPU code paths."}]}]}],"thread_ts":"1617725932.136500","parent_user_id":"UBJUA1YAV"},{"client_msg_id":"b2cdced9-872c-474c-b8c2-235edf9a4937","type":"message","text":"Thanks for working on this! I haven't had time to check the PR yet, but unless it causes regressions with compile time it should be fine to merge.","user":"U6BJ9E351","ts":"1617744509.138000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IH3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks for working on this! I haven't had time to check the PR yet, but unless it causes regressions with compile time it should be fine to merge."}]}]}],"thread_ts":"1617725932.136500","parent_user_id":"UBJUA1YAV"},{"client_msg_id":"22f7cad3-0eab-4ea4-b47e-5867dc40159f","type":"message","text":"Other things are less obvious, for example it'd be great to store static arrays in a smarter format (with the custom layout), but that would require depending on StaticArrays, which is not ideal. Same goes for broadcasting in combination with StaticArrays or CuArrays: it can work but requires some custom rules and it is not super clear where those should live (see <https://github.com/JuliaArrays/StructArrays.jl/pull/136#issuecomment-774473926>)","user":"U6BJ9E351","ts":"1617744704.138200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DyHo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Other things are less obvious, for example it'd be great to store static arrays in a smarter format (with the custom layout), but that would require depending on StaticArrays, which is not ideal. Same goes for broadcasting in combination with StaticArrays or CuArrays: it can work but requires some custom rules and it is not super clear where those should live (see "},{"type":"link","url":"https://github.com/JuliaArrays/StructArrays.jl/pull/136#issuecomment-774473926"},{"type":"text","text":")"}]}]}],"thread_ts":"1617725932.136500","parent_user_id":"UBJUA1YAV"},{"client_msg_id":"aeee73ba-33ab-403a-97e8-f0b762518359","type":"message","text":"a possible solution, given that CUDA uses Requires already, may be to add broadcast compatibility with StructArrays in a Requires block","user":"U6BJ9E351","ts":"1617744807.138400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HRG=a","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"a possible solution, given that CUDA uses Requires already, may be to add broadcast compatibility with StructArrays in a Requires block"}]}]}],"thread_ts":"1617725932.136500","parent_user_id":"UBJUA1YAV"},{"client_msg_id":"4791e05b-75fc-449b-af24-3bb55cd16929","type":"message","text":"<@U6BJ9E351> Thanks for merging the change!  Yea, I have more changes here <https://github.com/lcw/Bennu.jl/blob/main/src/structarrays.jl> but as you said it is unclear where some of this code should live.  So I have hesitated making more pull requests.","user":"UBJUA1YAV","ts":"1617812095.146900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7hIZ","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U6BJ9E351"},{"type":"text","text":" Thanks for merging the change!  Yea, I have more changes here "},{"type":"link","url":"https://github.com/lcw/Bennu.jl/blob/main/src/structarrays.jl"},{"type":"text","text":" but as you said it is unclear where some of this code should live.  So I have hesitated making more pull requests."}]}]}],"thread_ts":"1617725932.136500","parent_user_id":"UBJUA1YAV"}]