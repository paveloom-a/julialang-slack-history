[{"client_msg_id":"774ddbd0-d50f-40f0-8604-533e28e6a45d","type":"message","text":"Don't think this is possible using just `AveragedField` and `FieldSlicer` as field slicing acts on the final result (in this case, it acts after the average has been computed).","user":"UEP056STX","ts":"1613592512.049200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"X/hY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Don't think this is possible using just "},{"type":"text","text":"AveragedField","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"FieldSlicer","style":{"code":true}},{"type":"text","text":" as field slicing acts on the final result (in this case, it acts after the average has been computed)."}]}]}],"thread_ts":"1613592512.049200","reply_count":15,"reply_users_count":2,"latest_reply":"1613593010.054500","reply_users":["U01E0U2RJJ2","UEP056STX"],"subscribed":false},{"client_msg_id":"3b4f7dba-c190-446b-a6a4-f798087a7c6a","type":"message","text":"Hmm, that's what I was afraid of","user":"U01E0U2RJJ2","ts":"1613592621.050900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0/To","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmm, that's what I was afraid of"}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"e304ad39-432c-4290-b41a-51cb0f0c1f14","type":"message","text":"I'm trying to avoid as much post-processing as possible","user":"U01E0U2RJJ2","ts":"1613592645.051100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hP8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm trying to avoid as much post-processing as possible"}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"9c48b23c-4706-444a-93f0-d293fece178d","type":"message","text":"Yeah same here...","user":"UEP056STX","ts":"1613592663.051300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SfeRF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah same here..."}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"63e97517-c428-48f7-86b1-2ca6d0238c1b","type":"message","text":"Is there any workaround at the moment? So that FieldSlicer can be applied before averaging?","user":"U01E0U2RJJ2","ts":"1613592681.051500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fpA","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there any workaround at the moment? So that FieldSlicer can be applied before averaging?"}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"2910a42f-9575-4a11-9e9f-06527414a2f8","type":"message","text":"I think <@UMZQBQU67> has proposed adding a `WindowedField` or `SlicedField` that represents some slice of a larger 3D field.","user":"UEP056STX","ts":"1613592711.051700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"b6d","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think "},{"type":"user","user_id":"UMZQBQU67"},{"type":"text","text":" has proposed adding a "},{"type":"text","text":"WindowedField","style":{"code":true}},{"type":"text","text":" or "},{"type":"text","text":"SlicedField","style":{"code":true}},{"type":"text","text":" that represents some slice of a larger 3D field."}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"bda6a3e2-1542-4d41-9a17-8366248b5293","type":"message","text":"Part of the `SlicedField` functionality could be that if you pass it to `AveragedField`, it'll only average the particular slice.","user":"UEP056STX","ts":"1613592739.051900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ujD9t","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Part of the "},{"type":"text","text":"SlicedField","style":{"code":true}},{"type":"text","text":" functionality could be that if you pass it to "},{"type":"text","text":"AveragedField","style":{"code":true}},{"type":"text","text":", it'll only average the particular slice."}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"f5639dfb-5d4a-4bed-9377-1ff6c4e572e1","type":"message","text":"It can be done as part of the simulation script","user":"UEP056STX","ts":"1613592777.052100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sj9Rc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It can be done as part of the simulation script"}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"dd24e320-fff3-4ffd-b22f-ba43c32868df","type":"message","text":"Yeah, I agree","user":"U01E0U2RJJ2","ts":"1613592777.052300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jnno","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, I agree"}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"b27ceaaa-cc10-4fe5-a23f-f1c2f7c1fed5","type":"message","text":"That would be super useful","user":"U01E0U2RJJ2","ts":"1613592782.052500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4mGU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That would be super useful"}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"dfd62176-e37b-451e-a649-491ea1e4a2f5","type":"message","text":"Also I think the way it is done right now might be misleading. I have been using the example AveragedFields+Slicer I sent on the channel for a while before I realized that it might not be doing what I thought it was doing","user":"U01E0U2RJJ2","ts":"1613592846.052700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vos","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also I think the way it is done right now might be misleading. I have been using the example AveragedFields+Slicer I sent on the channel for a while before I realized that it might not be doing what I thought it was doing"}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"8dbeef77-32b6-4949-b099-e0671adc0a59","type":"message","text":"Is there a comment/warning about that in the docs?","user":"U01E0U2RJJ2","ts":"1613592888.053200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+Az","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there a comment/warning about that in the docs?"}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"46f74c83-2353-4fc4-bc72-322873773df7","type":"message","text":"I think you'll have to define a custom function that does something like\n```function custom_average(model)\n    U = AveragedField(model.velocities.u, dims=1)\n    compute!(U)    \n    U_slice_averaged = mean(U.data[1, 20:50, 1:<http://grid.Nz|grid.Nz>], dims=2)\n    return U_slice_averaged\nend```\nbut this is pretty hacky...","user":"UEP056STX","ts":"1613592912.053900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bI7lB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think you'll have to define a custom function that does something like\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function custom_average(model)\n    U = AveragedField(model.velocities.u, dims=1)\n    compute!(U)    \n    U_slice_averaged = mean(U.data[1, 20:50, 1:grid.Nz], dims=2)\n    return U_slice_averaged\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"but this is pretty hacky..."}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"54813d33-7ad6-459a-93dc-e35105d80011","type":"message","text":"`custom_average` can be passed to a `JLD2OutputWriter` or a `NetCDFOutputWriter` (but you probably have to specify the dimensions manually for NetCDF).","user":"UEP056STX","ts":"1613592957.054100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KGH1d","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"custom_average","style":{"code":true}},{"type":"text","text":" can be passed to a "},{"type":"text","text":"JLD2OutputWriter","style":{"code":true}},{"type":"text","text":" or a "},{"type":"text","text":"NetCDFOutputWriter","style":{"code":true}},{"type":"text","text":" (but you probably have to specify the dimensions manually for NetCDF)."}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"d79eb3d1-fa86-4e25-84c9-abbc913ac115","type":"message","text":"Yeah, I guess we didn't really anticipate `AveragedField` and `FieldSlicer` being used together so a warning or a note in the docstring could be useful.","user":"UEP056STX","ts":"1613593002.054300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5xbX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, I guess we didn't really anticipate "},{"type":"text","text":"AveragedField","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"FieldSlicer","style":{"code":true}},{"type":"text","text":" being used together so a warning or a note in the docstring could be useful."}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"},{"client_msg_id":"f983b427-0f04-4dc6-b37d-3d4490a827cd","type":"message","text":"I see. Thanks for the suggestion!","user":"U01E0U2RJJ2","ts":"1613593010.054500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"C186","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I see. Thanks for the suggestion!"}]}]}],"thread_ts":"1613592512.049200","parent_user_id":"UEP056STX"}]