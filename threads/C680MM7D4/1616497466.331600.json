[{"client_msg_id":"9c5865eb-125f-4f6f-8275-6d15b0aa8b1a","type":"message","text":"How can I extract the parameters of my model created in the following way ?\n\n`function linear(in, out )`\n    `W = randn(out, in)`\n    `b = randn(out)`\n    `x -&gt; W * x .+ b`\n  `end` \n\n`function simplenet()`\n    `linear1 = linear(784, 30) # we can access linear1.W etc`\n    `linear2 = linear(30, 10)`\n    `model(x) = linear2(σ.(linear1(x)))`\n    `return model`\n  `end`\n\n`model = CustomizeNet.simplenet()`","user":"U01FTFACYJ0","ts":"1616497466.331600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"n=2ck","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How can I extract the parameters of my model created in the following way ?\n\n"},{"type":"text","text":"function linear(in, out )","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    W = randn(out, in)","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    b = randn(out)","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    x -> W * x .+ b","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"  end ","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"function simplenet()","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    linear1 = linear(784, 30) # we can access linear1.W etc","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    linear2 = linear(30, 10)","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    model(x) = linear2(σ.(linear1(x)))","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    return model","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"  end","style":{"code":true}},{"type":"text","text":"\n\n"},{"type":"text","text":"model = CustomizeNet.simplenet()","style":{"code":true}}]}]}],"thread_ts":"1616497466.331600","reply_count":7,"reply_users_count":4,"latest_reply":"1616930436.102300","reply_users":["U7HAYKY9X","U01J62981NK","U6BNE7LTZ","URN898S15"],"is_locked":false,"subscribed":false,"reactions":[{"name":"slack-on-fire","users":["U6A936746","U68RVK2D7","U9VG1AYSG","UGU761DU2"],"count":4}]},{"client_msg_id":"210f53b9-0769-405b-863e-761068b1342d","type":"message","text":"If I understand you correctly, you want to access `W`. ~You can't, not in that way. If you put something in a function and then don't return it out of the function, it's lost (this is actually a good thing, because it means some computations can be simplified).~\nEdit: You can. See <@U6BNE7LTZ>’s comment below","user":"U7HAYKY9X","ts":"1616497803.331700","team":"T68168MUP","edited":{"user":"U7HAYKY9X","ts":"1616498783.000000"},"blocks":[{"type":"rich_text","block_id":"cu6m","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If I understand you correctly, you want to access "},{"type":"text","text":"W","style":{"code":true}},{"type":"text","text":". "},{"type":"text","text":"You can't, not in that way. If you put something in a function and then don't return it out of the function, it's lost (this is actually a good thing, because it means some computations can be simplified).","style":{"strike":true}},{"type":"text","text":"\nEdit: You can. See "},{"type":"user","user_id":"U6BNE7LTZ"},{"type":"text","text":"’s comment below"}]}]}],"thread_ts":"1616497466.331600","parent_user_id":"U01FTFACYJ0"},{"client_msg_id":"4e9cffef-e37f-47d8-8b07-3f1a875af807","type":"message","text":"The way to solve it is to either:\n1. Return `W`  and `b` from the function, or\n2. Pass in `W` and `b` to the function, such that you create it outside the funciton and have that variabled saved where you create it.","user":"U7HAYKY9X","ts":"1616497843.331900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6uXH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The way to solve it is to either:\n"}]},{"type":"rich_text_list","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Return "},{"type":"text","text":"W","style":{"code":true}},{"type":"text","text":"  and "},{"type":"text","text":"b","style":{"code":true}},{"type":"text","text":" from the function, or"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Pass in "},{"type":"text","text":"W","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"b","style":{"code":true}},{"type":"text","text":" to the function, such that you create it outside the funciton and have that variabled saved where you create it."}]}],"style":"ordered","indent":0}]}],"thread_ts":"1616497466.331600","parent_user_id":"U01FTFACYJ0"},{"client_msg_id":"b4acc264-5038-4593-8b3b-d45f65a6ebc3","type":"message","text":"I think you can actually do `model.linear1.W`  etc., though it gets a bit unwieldy.","user":"U01J62981NK","ts":"1616498428.332400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gS0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think you can actually do "},{"type":"text","text":"model.linear1.W","style":{"code":true}},{"type":"text","text":"  etc., though it gets a bit unwieldy."}]}]}],"thread_ts":"1616497466.331600","parent_user_id":"U01FTFACYJ0"},{"client_msg_id":"827d1d9d-4b21-4049-a3e9-7ca9eb2956dd","type":"message","text":"I presume this comes from a Flux tutorial?\n\nThe cleanest way to define custom layers in Flux is to define a callable struct and then make it into a <https://fluxml.ai/Flux.jl/stable/models/basics/#Layer-helpers-1|Functor.>\n\nYou can then pull out parameters using `Flux.params`.","user":"U01J62981NK","ts":"1616498657.332800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cDGB4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I presume this comes from a Flux tutorial?\n\nThe cleanest way to define custom layers in Flux is to define a callable struct and then make it into a "},{"type":"link","url":"https://fluxml.ai/Flux.jl/stable/models/basics/#Layer-helpers-1","text":"Functor."},{"type":"text","text":"\n\nYou can then pull out parameters using "},{"type":"text","text":"Flux.params","style":{"code":true}},{"type":"text","text":"."}]}]}],"thread_ts":"1616497466.331600","parent_user_id":"U01FTFACYJ0"},{"client_msg_id":"f469150c-511f-46b5-b4e4-af7897abd6b9","type":"message","text":"<@U7HAYKY9X> Sure you do that since closures are anonymous structs:\n```julia&gt; factory(W,b) = x -&gt; W*x .+ b;\n\njulia&gt; m = factory(rand(10,10), rand(10));\n\njulia&gt; m.b\n10-element Array{Float64,1}:\n 0.5526266000447999\n 0.6092395587827288\n 0.6210189051683266\n 0.11604110899721332\n 0.18510673385110543\n 0.6611790054658404\n 0.9851556896375888\n 0.000749720285028399\n 0.3963015255941109\n 0.5509840282495986```","user":"U6BNE7LTZ","ts":"1616498704.333000","team":"T68168MUP","edited":{"user":"U6BNE7LTZ","ts":"1616498783.000000"},"blocks":[{"type":"rich_text","block_id":"u0zo","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U7HAYKY9X"},{"type":"text","text":" Sure you do that since closures are anonymous structs:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> factory(W,b) = x -> W*x .+ b;\n\njulia> m = factory(rand(10,10), rand(10));\n\njulia> m.b\n10-element Array{Float64,1}:\n 0.5526266000447999\n 0.6092395587827288\n 0.6210189051683266\n 0.11604110899721332\n 0.18510673385110543\n 0.6611790054658404\n 0.9851556896375888\n 0.000749720285028399\n 0.3963015255941109\n 0.5509840282495986"}]}]}],"thread_ts":"1616497466.331600","parent_user_id":"U01FTFACYJ0"},{"client_msg_id":"4d9e28f2-da58-46af-9b8e-35d1093385c2","type":"message","text":"Woah, you are right!","user":"U7HAYKY9X","ts":"1616498759.333700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QNg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Woah, you are right!"}]}]}],"thread_ts":"1616497466.331600","parent_user_id":"U01FTFACYJ0"},{"client_msg_id":"ad615ba2-34d9-433b-b2f3-22732d44fa88","type":"message","text":"You can also use ModelParameters.jl `Param` wrappers to get any fields you want from any object - as a table or a tuple - without having to specify the nesting. You wont be able to rebuild your model with diferent values if there are fields in an anonymous struct, because they don't have constructors... its a pet gripe of mine","user":"URN898S15","ts":"1616930436.102300","team":"T68168MUP","edited":{"user":"URN898S15","ts":"1616930517.000000"},"blocks":[{"type":"rich_text","block_id":"+QOx7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You can also use ModelParameters.jl "},{"type":"text","text":"Param","style":{"code":true}},{"type":"text","text":" wrappers to get any fields you want from any object - as a table or a tuple - without having to specify the nesting. You wont be able to rebuild your model with diferent values if there are fields in an anonymous struct, because they don't have constructors... its a pet gripe of mine"}]}]}],"thread_ts":"1616497466.331600","parent_user_id":"U01FTFACYJ0"}]