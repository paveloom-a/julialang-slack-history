[{"client_msg_id":"9d7d9b5a-57e7-4775-a46c-f500cea15b07","type":"message","text":"I started typing algorithms in Julia pseudocode a bit liberally\n```function backward(Kernel(μ, Q), message, c*Dirac(x))\n   ...\nend```\nand I start to wish that Julia would go all in with argument destructuring","user":"U6C937ENB","ts":"1613159340.403400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Lv7=x","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I started typing algorithms in Julia pseudocode a bit liberally\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function backward(Kernel(μ, Q), message, c*Dirac(x))\n   ...\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"and I start to wish that Julia would go all in with argument destructuring"}]}]}],"thread_ts":"1613159340.403400","reply_count":22,"reply_users_count":5,"latest_reply":"1613173055.430300","reply_users":["UM30MT6RF","U8D9768Q6","U6C937ENB","U6C1MMAAJ","UPUBAM63X"],"subscribed":false,"reactions":[{"name":"haskell","users":["U6A936746","UPUBAM63X","U015CQ83YBD"],"count":3},{"name":"+1","users":["U8D9768Q6"],"count":1}]},{"client_msg_id":"240b4411-62d9-41f1-b818-9664979834ef","type":"message","text":"We can't do destructuring with `Kernel(μ, Q) = ...` because that already defines a function","user":"UM30MT6RF","ts":"1613160170.403800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0xdvN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"We can't do destructuring with "},{"type":"text","text":"Kernel(μ, Q) = ...","style":{"code":true}},{"type":"text","text":" because that already defines a function"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"162690be-a71d-41f2-bf4c-af00c3428e59","type":"message","text":"Julia 1.7 will let you write it as `backward((; μ, Q)::Kernel, ...) = ...` though","user":"UM30MT6RF","ts":"1613160215.404000","team":"T68168MUP","edited":{"user":"UM30MT6RF","ts":"1613160233.000000"},"blocks":[{"type":"rich_text","block_id":"QIQ/e","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Julia 1.7 will let you write it as "},{"type":"text","text":"backward((; μ, Q)::Kernel, ...) = ...","style":{"code":true}},{"type":"text","text":" though"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB","reactions":[{"name":"heart_eyes","users":["U6C937ENB","U6A936746"],"count":2}]},{"client_msg_id":"07ad26e4-9a6d-44e8-bbd4-79fb6f64b1c2","type":"message","text":"```using MLStyle, ExprTools\n\nmacro destruct(fdef)\n    d = splitdef(fdef)\n    dargs = Tuple(deepcopy(d[:args]))\n    d[:args] = map(1:length(d[:args])) do i\n        arg = d[:args][i]\n        @match d[:args][i] begin\n            :($_ :: $T)              =&gt; :($(gensym(\"arg$i\")) :: $T)\n            :(   :: $T)              =&gt; :($(gensym(\"arg$i\")) :: $T)\n            Expr(:tuple, names...)   =&gt; :($(gensym(\"arg$i\")) :: NTuple{$(length(names)), Any})\n            Expr(:vect,  names...)   =&gt; :($(gensym(\"arg$i\")) :: Vector)\n            Expr(:hcat,  names...)   =&gt; :($(gensym(\"arg$i\")) :: Array)\n            Expr(:vcat,  names...)   =&gt; :($(gensym(\"arg$i\")) :: Array)\n            Expr(:call, T, names...) =&gt; :($(gensym(\"arg$i\")) :: $T)\n            _                        =&gt; :($(gensym(\"arg$i\")) :: Any)\n        end\n    end \n    d[:body] = :($(@__MODULE__).@match ($(d[:args]...),) begin ($(dargs...),) =&gt; $(d[:body]) end)\n    out = esc(combinedef(d))\nend```\n```struct Kernel\n    a\n    b\nend\n\nstruct Dirac\n    x\nend\n\n@as_record Kernel\n@as_record Dirac```\n```@destruct function backward(Kernel(μ, Q), message, Dirac(x))\n    μ, Q, x\nend\n\nbackward(Kernel(1, 2), \"hi\", Dirac(3))\n\n#+RESULTS:\n (1, 2, 3)```","user":"U8D9768Q6","ts":"1613160257.404600","team":"T68168MUP","edited":{"user":"U8D9768Q6","ts":"1613160491.000000"},"blocks":[{"type":"rich_text","block_id":"mxGaf","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"using MLStyle, ExprTools\n\nmacro destruct(fdef)\n    d = splitdef(fdef)\n    dargs = Tuple(deepcopy(d[:args]))\n    d[:args] = map(1:length(d[:args])) do i\n        arg = d[:args][i]\n        @match d[:args][i] begin\n            :($_ :: $T)              => :($(gensym(\"arg$i\")) :: $T)\n            :(   :: $T)              => :($(gensym(\"arg$i\")) :: $T)\n            Expr(:tuple, names...)   => :($(gensym(\"arg$i\")) :: NTuple{$(length(names)), Any})\n            Expr(:vect,  names...)   => :($(gensym(\"arg$i\")) :: Vector)\n            Expr(:hcat,  names...)   => :($(gensym(\"arg$i\")) :: Array)\n            Expr(:vcat,  names...)   => :($(gensym(\"arg$i\")) :: Array)\n            Expr(:call, T, names...) => :($(gensym(\"arg$i\")) :: $T)\n            _                        => :($(gensym(\"arg$i\")) :: Any)\n        end\n    end \n    d[:body] = :($(@__MODULE__).@match ($(d[:args]...),) begin ($(dargs...),) => $(d[:body]) end)\n    out = esc(combinedef(d))\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"struct Kernel\n    a\n    b\nend\n\nstruct Dirac\n    x\nend\n\n@as_record Kernel\n@as_record Dirac"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"@destruct function backward(Kernel(μ, Q), message, Dirac(x))\n    μ, Q, x\nend\n\nbackward(Kernel(1, 2), \"hi\", Dirac(3))\n\n#+RESULTS:\n (1, 2, 3)"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB","reactions":[{"name":"cool","users":["U6A936746","U6QGE7S86"],"count":2}]},{"client_msg_id":"6ca9a93a-781a-4a79-b958-275863f7c7af","type":"message","text":"If not all of Julia, perhaps _I_ could go all in…","user":"U6C937ENB","ts":"1613160360.404900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aU2c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If not all of Julia, perhaps "},{"type":"text","text":"I","style":{"italic":true}},{"type":"text","text":" could go all in…"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"24c20d88-14d9-45c6-876c-c404984f8af9","type":"message","text":"And it plays nice with multiple dispatch:\n```methods(backward) \n\n#+RESULTS:\n # 1 method for generic function \"backward\":\n [1] backward(arg1::Kernel, arg2, arg3::Dirac) in Main```","user":"U8D9768Q6","ts":"1613160699.405200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EeV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And it plays nice with multiple dispatch:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"methods(backward) \n\n#+RESULTS:\n # 1 method for generic function \"backward\":\n [1] backward(arg1::Kernel, arg2, arg3::Dirac) in Main"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"86b76fa4-1791-404b-ae18-089d2e48dcd3","type":"message","text":"It'd be interesting to get the `c*Dirac(x)` part to work","user":"U8D9768Q6","ts":"1613160765.405400","team":"T68168MUP","edited":{"user":"U8D9768Q6","ts":"1613160791.000000"},"blocks":[{"type":"rich_text","block_id":"6Xt5X","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It'd be interesting to get the "},{"type":"text","text":"c*Dirac(x)","style":{"code":true}},{"type":"text","text":" part to work"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"27fdbf63-82e8-4be7-b8fe-4bb69b856f40","type":"message","text":"What does 1.7 change or what does this do?\n```backward((; μ, Q)::Kernel, ...) = ...```\n","user":"U6C1MMAAJ","ts":"1613160852.405800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yHcUG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What does 1.7 change or what does this do?\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"backward((; μ, Q)::Kernel, ...) = ..."}]},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"4156aa99-49ab-4ae5-956a-bddaacc3db68","type":"message","text":"essentially for\n```sumdiff(x,y) = x + y, x - y\nfunction (sumdiff(x,y))\n   ...\nend```\nto work you needed to define and call\n```inverse(sumdiff, Any, _)```\nSo you needed\n`inverse(*, Tuple{Any,Dirac}, y)`","user":"U6C937ENB","ts":"1613161111.406000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9oX6o","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"essentially for\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"sumdiff(x,y) = x + y, x - y\nfunction (sumdiff(x,y))\n   ...\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"to work you needed to define and call\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"inverse(sumdiff, Any, _)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"So you needed\n"},{"type":"text","text":"inverse(*, Tuple{Any,Dirac}, y)","style":{"code":true}}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"bfc4f87c-c2d6-4bc2-bb23-255232f0852d","type":"message","text":"Yeah. MLStyle.jl calls this `pattern_uncall` I think","user":"U8D9768Q6","ts":"1613161210.406200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Db2U","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah. MLStyle.jl calls this "},{"type":"text","text":"pattern_uncall","style":{"code":true}},{"type":"text","text":" I think"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"711d014f-aab2-4d86-8598-eb180e0f1096","type":"message","text":"I'd just need a clever way to support it in the macro. MLStyle already supports it","user":"U8D9768Q6","ts":"1613161234.406400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1f6D","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'd just need a clever way to support it in the macro. MLStyle already supports it"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"281b9255-cab3-4fa3-9ae9-b4259387cf86","type":"message","text":"<@U6C1MMAAJ> It's <https://github.com/JuliaLang/julia/pull/39285>, which allows destructuring by property names","user":"UM30MT6RF","ts":"1613161359.406800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"S11BH","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U6C1MMAAJ"},{"type":"text","text":" It's "},{"type":"link","url":"https://github.com/JuliaLang/julia/pull/39285"},{"type":"text","text":", which allows destructuring by property names"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB","reactions":[{"name":"+1","users":["U6C1MMAAJ"],"count":1}]},{"client_msg_id":"d0b123a1-e9a4-4775-a178-b4d1885cd5ca","type":"message","text":"Mason that's pretty insane and awesome.","user":"UPUBAM63X","ts":"1613162150.410700","team":"T68168MUP","edited":{"user":"UPUBAM63X","ts":"1613162156.000000"},"blocks":[{"type":"rich_text","block_id":"NTb6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Mason that's pretty insane and awesome."}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"92e8b678-1ee7-4ffc-a00d-ea1e0a148ddc","type":"message","text":"so basically let's make julia have a hask inside of it and julia will be even more delicious","user":"UPUBAM63X","ts":"1613162214.411000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"d9G15","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so basically let's make julia have a hask inside of it and julia will be even more delicious"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"d4342476-b9b4-4afe-909f-3d7566239845","type":"message","text":"I really like <https://github.com/thautwarm/MLStyle.jl>","user":"U8D9768Q6","ts":"1613162713.412100","team":"T68168MUP","edited":{"user":"U8D9768Q6","ts":"1613162748.000000"},"blocks":[{"type":"rich_text","block_id":"qRwL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I really like "},{"type":"link","url":"https://github.com/thautwarm/MLStyle.jl"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB","reactions":[{"name":"100","users":["UPUBAM63X"],"count":1}]},{"client_msg_id":"ddd264ca-daf2-4cd3-969d-1ccbf5f415a6","type":"message","text":"someone give them a medal","user":"UPUBAM63X","ts":"1613162759.412400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"L+b","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"someone give them a medal"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"286e7ba7-1d4b-4f13-8cb8-67cb1975565f","type":"message","text":"The destructing is cool, but the syntax really caught me confused, but now I get it","user":"U6C1MMAAJ","ts":"1613162784.412600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6ci","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The destructing is cool, but the syntax really caught me confused, but now I get it"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"173625bf-e43b-4394-b039-be20d6b592ce","type":"message","text":"Yeah. The author really appreciates help making the documentation more understandable. English is not her first language and she's very busy, so the docs can be a bit hard for the uninitiated to read.\n\nI revamped this section a while ago: <https://thautwarm.github.io/MLStyle.jl/latest/syntax/pattern.html> because I think it's the most important one for using MLStyle","user":"U8D9768Q6","ts":"1613162970.412900","team":"T68168MUP","edited":{"user":"U8D9768Q6","ts":"1613163024.000000"},"blocks":[{"type":"rich_text","block_id":"KcY5d","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah. The author really appreciates help making the documentation more understandable. English is not her first language and she's very busy, so the docs can be a bit hard for the uninitiated to read.\n\nI revamped this section a while ago: "},{"type":"link","url":"https://thautwarm.github.io/MLStyle.jl/latest/syntax/pattern.html"},{"type":"text","text":" because I think it's the most important one for using MLStyle"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB","reactions":[{"name":"10000","users":["UPUBAM63X"],"count":1}]},{"client_msg_id":"0e870053-3aa6-4bb8-8c3f-e1a8ca9130d0","type":"message","text":"But I think she'd really appreciate it if more people came and helped with the docs","user":"U8D9768Q6","ts":"1613162995.413200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"HEfH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But I think she'd really appreciate it if more people came and helped with the docs"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"22e9a6d9-9154-4fbe-9941-69847b99cec0","type":"message","text":"Good to know. Yeah I recall looking at MLStyle a while ago and was left more confused then enlightened, albeit I was impressed.","user":"U6C1MMAAJ","ts":"1613163022.413400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"nkH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Good to know. Yeah I recall looking at MLStyle a while ago and was left more confused then enlightened, albeit I was impressed."}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"4fa59e4e-beaa-4a1a-8116-791b18ba0e63","type":"message","text":"this is seriously impressive","user":"UPUBAM63X","ts":"1613163026.413700","team":"T68168MUP","edited":{"user":"UPUBAM63X","ts":"1613163226.000000"},"blocks":[{"type":"rich_text","block_id":"ZoL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"this is seriously impressive"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"685a96ab-7448-4ee7-975e-ebe3f6d691cb","type":"message","text":"On topic, I don't fully grasp what you are trying to do ?","user":"U6C1MMAAJ","ts":"1613163229.414000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"15H","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"On topic, I don't fully grasp what you are trying to do ?"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"b7614891-110a-4172-a732-2b3430299807","type":"message","text":"<@U6C1MMAAJ> Moritz wants to do something called 'destructuring'. The basic idea here is that he wants to write a function\n```backward(a, message, b) ```\nand then have a pattern matching system that automatically finds the `μ, Q` such that `a == Kernel(μ, Q)` and a `c, x` such that `b == c * Dirac(x)`.\n\nDoes that make more sense?","user":"U8D9768Q6","ts":"1613173055.430300","team":"T68168MUP","edited":{"user":"U8D9768Q6","ts":"1613173068.000000"},"blocks":[{"type":"rich_text","block_id":"WIs","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U6C1MMAAJ"},{"type":"text","text":" Moritz wants to do something called 'destructuring'. The basic idea here is that he wants to write a function\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"backward(a, message, b) "}]},{"type":"rich_text_section","elements":[{"type":"text","text":"and then have a pattern matching system that automatically finds the "},{"type":"text","text":"μ, Q","style":{"code":true}},{"type":"text","text":" such that "},{"type":"text","text":"a == Kernel(μ, Q)","style":{"code":true}},{"type":"text","text":" and a "},{"type":"text","text":"c, x","style":{"code":true}},{"type":"text","text":" such that "},{"type":"text","text":"b == c * Dirac(x)","style":{"code":true}},{"type":"text","text":".\n\nDoes that make more sense?"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB","reactions":[{"name":"heart","users":["U6C937ENB"],"count":1}]}]