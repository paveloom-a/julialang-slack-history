[{"client_msg_id":"9d7d9b5a-57e7-4775-a46c-f500cea15b07","type":"message","text":"I started typing algorithms in Julia pseudocode a bit liberally\n```function backward(Kernel(μ, Q), message, c*Dirac(x))\n   ...\nend```\nand I start to wish that Julia would go all in with argument destructuring","user":"U6C937ENB","ts":"1613159340.403400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Lv7=x","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I started typing algorithms in Julia pseudocode a bit liberally\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function backward(Kernel(μ, Q), message, c*Dirac(x))\n   ...\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"and I start to wish that Julia would go all in with argument destructuring"}]}]}],"thread_ts":"1613159340.403400","reply_count":10,"reply_users_count":4,"latest_reply":"1613161234.406400","reply_users":["UM30MT6RF","U8D9768Q6","U6C937ENB","U6C1MMAAJ"],"subscribed":false,"reactions":[{"name":"haskell","users":["U6A936746"],"count":1},{"name":"+1","users":["U8D9768Q6"],"count":1}]},{"client_msg_id":"240b4411-62d9-41f1-b818-9664979834ef","type":"message","text":"We can't do destructuring with `Kernel(μ, Q) = ...` because that already defines a function","user":"UM30MT6RF","ts":"1613160170.403800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0xdvN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"We can't do destructuring with "},{"type":"text","text":"Kernel(μ, Q) = ...","style":{"code":true}},{"type":"text","text":" because that already defines a function"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"162690be-a71d-41f2-bf4c-af00c3428e59","type":"message","text":"Julia 1.7 will let you write it as `backward((; μ, Q)::Kernel, ...) = ...` though","user":"UM30MT6RF","ts":"1613160215.404000","team":"T68168MUP","edited":{"user":"UM30MT6RF","ts":"1613160233.000000"},"blocks":[{"type":"rich_text","block_id":"QIQ/e","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Julia 1.7 will let you write it as "},{"type":"text","text":"backward((; μ, Q)::Kernel, ...) = ...","style":{"code":true}},{"type":"text","text":" though"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB","reactions":[{"name":"heart_eyes","users":["U6C937ENB","U6A936746"],"count":2}]},{"client_msg_id":"07ad26e4-9a6d-44e8-bbd4-79fb6f64b1c2","type":"message","text":"```using MLStyle, ExprTools\n\nmacro destruct(fdef)\n    d = splitdef(fdef)\n    dargs = Tuple(deepcopy(d[:args]))\n    d[:args] = map(1:length(d[:args])) do i\n        arg = d[:args][i]\n        @match d[:args][i] begin\n            :($_ :: $T)              =&gt; :($(gensym(\"arg$i\")) :: $T)\n            :(   :: $T)              =&gt; :($(gensym(\"arg$i\")) :: $T)\n            Expr(:tuple, names...)   =&gt; :($(gensym(\"arg$i\")) :: NTuple{$(length(names)), Any})\n            Expr(:vect,  names...)   =&gt; :($(gensym(\"arg$i\")) :: Vector)\n            Expr(:hcat,  names...)   =&gt; :($(gensym(\"arg$i\")) :: Array)\n            Expr(:vcat,  names...)   =&gt; :($(gensym(\"arg$i\")) :: Array)\n            Expr(:call, T, names...) =&gt; :($(gensym(\"arg$i\")) :: $T)\n            _                        =&gt; :($(gensym(\"arg$i\")) :: Any)\n        end\n    end \n    d[:body] = :($(@__MODULE__).@match ($(d[:args]...),) begin ($(dargs...),) =&gt; $(d[:body]) end)\n    out = esc(combinedef(d))\nend```\n```struct Kernel\n    a\n    b\nend\n\nstruct Dirac\n    x\nend\n\n@as_record Kernel\n@as_record Dirac```\n```@destruct function backward(Kernel(μ, Q), message, Dirac(x))\n    μ, Q, x\nend\n\nbackward(Kernel(1, 2), \"hi\", Dirac(3))\n\n#+RESULTS:\n (1, 2, 3)```","user":"U8D9768Q6","ts":"1613160257.404600","team":"T68168MUP","edited":{"user":"U8D9768Q6","ts":"1613160491.000000"},"blocks":[{"type":"rich_text","block_id":"mxGaf","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"using MLStyle, ExprTools\n\nmacro destruct(fdef)\n    d = splitdef(fdef)\n    dargs = Tuple(deepcopy(d[:args]))\n    d[:args] = map(1:length(d[:args])) do i\n        arg = d[:args][i]\n        @match d[:args][i] begin\n            :($_ :: $T)              => :($(gensym(\"arg$i\")) :: $T)\n            :(   :: $T)              => :($(gensym(\"arg$i\")) :: $T)\n            Expr(:tuple, names...)   => :($(gensym(\"arg$i\")) :: NTuple{$(length(names)), Any})\n            Expr(:vect,  names...)   => :($(gensym(\"arg$i\")) :: Vector)\n            Expr(:hcat,  names...)   => :($(gensym(\"arg$i\")) :: Array)\n            Expr(:vcat,  names...)   => :($(gensym(\"arg$i\")) :: Array)\n            Expr(:call, T, names...) => :($(gensym(\"arg$i\")) :: $T)\n            _                        => :($(gensym(\"arg$i\")) :: Any)\n        end\n    end \n    d[:body] = :($(@__MODULE__).@match ($(d[:args]...),) begin ($(dargs...),) => $(d[:body]) end)\n    out = esc(combinedef(d))\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"struct Kernel\n    a\n    b\nend\n\nstruct Dirac\n    x\nend\n\n@as_record Kernel\n@as_record Dirac"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"@destruct function backward(Kernel(μ, Q), message, Dirac(x))\n    μ, Q, x\nend\n\nbackward(Kernel(1, 2), \"hi\", Dirac(3))\n\n#+RESULTS:\n (1, 2, 3)"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB","reactions":[{"name":"cool","users":["U6A936746"],"count":1}]},{"client_msg_id":"6ca9a93a-781a-4a79-b958-275863f7c7af","type":"message","text":"If not all of Julia, perhaps _I_ could go all in…","user":"U6C937ENB","ts":"1613160360.404900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aU2c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If not all of Julia, perhaps "},{"type":"text","text":"I","style":{"italic":true}},{"type":"text","text":" could go all in…"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"24c20d88-14d9-45c6-876c-c404984f8af9","type":"message","text":"And it plays nice with multiple dispatch:\n```methods(backward) \n\n#+RESULTS:\n # 1 method for generic function \"backward\":\n [1] backward(arg1::Kernel, arg2, arg3::Dirac) in Main```","user":"U8D9768Q6","ts":"1613160699.405200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EeV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And it plays nice with multiple dispatch:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"methods(backward) \n\n#+RESULTS:\n # 1 method for generic function \"backward\":\n [1] backward(arg1::Kernel, arg2, arg3::Dirac) in Main"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"86b76fa4-1791-404b-ae18-089d2e48dcd3","type":"message","text":"It'd be interesting to get the `c*Dirac(x)` part to work","user":"U8D9768Q6","ts":"1613160765.405400","team":"T68168MUP","edited":{"user":"U8D9768Q6","ts":"1613160791.000000"},"blocks":[{"type":"rich_text","block_id":"6Xt5X","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It'd be interesting to get the "},{"type":"text","text":"c*Dirac(x)","style":{"code":true}},{"type":"text","text":" part to work"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"27fdbf63-82e8-4be7-b8fe-4bb69b856f40","type":"message","text":"What does 1.7 change or what does this do?\n```backward((; μ, Q)::Kernel, ...) = ...```\n","user":"U6C1MMAAJ","ts":"1613160852.405800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"yHcUG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What does 1.7 change or what does this do?\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"backward((; μ, Q)::Kernel, ...) = ..."}]},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"4156aa99-49ab-4ae5-956a-bddaacc3db68","type":"message","text":"essentially for\n```sumdiff(x,y) = x + y, x - y\nfunction (sumdiff(x,y))\n   ...\nend```\nto work you needed to define and call\n```inverse(sumdiff, Any, _)```\nSo you needed\n`inverse(*, Tuple{Any,Dirac}, y)`","user":"U6C937ENB","ts":"1613161111.406000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9oX6o","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"essentially for\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"sumdiff(x,y) = x + y, x - y\nfunction (sumdiff(x,y))\n   ...\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"to work you needed to define and call\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"inverse(sumdiff, Any, _)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"So you needed\n"},{"type":"text","text":"inverse(*, Tuple{Any,Dirac}, y)","style":{"code":true}}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"bfc4f87c-c2d6-4bc2-bb23-255232f0852d","type":"message","text":"Yeah. MLStyle.jl calls this `pattern_uncall` I think","user":"U8D9768Q6","ts":"1613161210.406200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Db2U","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah. MLStyle.jl calls this "},{"type":"text","text":"pattern_uncall","style":{"code":true}},{"type":"text","text":" I think"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"},{"client_msg_id":"711d014f-aab2-4d86-8598-eb180e0f1096","type":"message","text":"I'd just need a clever way to support it in the macro. MLStyle already supports it","user":"U8D9768Q6","ts":"1613161234.406400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1f6D","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'd just need a clever way to support it in the macro. MLStyle already supports it"}]}]}],"thread_ts":"1613159340.403400","parent_user_id":"U6C937ENB"}]