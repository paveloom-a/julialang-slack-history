[{"client_msg_id":"ee59aa0e-0dc6-4ca2-b230-7b59ab4b0326","type":"message","text":"Anyone have any experience running Julia 'in anger' for a microservice/microservices? And if so, have you run into many/any issues with packages leaking memory? Finding that Python libraries seem to be pretty bad in that regard","user":"U017J1FHTSA","ts":"1611083241.298600","team":"T68168MUP","edited":{"user":"U017J1FHTSA","ts":"1611083268.000000"},"blocks":[{"type":"rich_text","block_id":"e1c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Anyone have any experience running Julia 'in anger' for a microservice/microservices? And if so, have you run into many/any issues with packages leaking memory? Finding that Python libraries seem to be pretty bad in that regard"}]}]}],"thread_ts":"1611083241.298600","reply_count":18,"reply_users_count":5,"latest_reply":"1611156681.339600","reply_users":["UDB26738Q","U017J1FHTSA","U6795JH6H","U69J94HT9","U017JTQFNEQ"],"subscribed":false},{"client_msg_id":"89ccd5df-8e89-4619-b049-400c9d88a7f2","type":"message","text":"did you see <https://www.youtube.com/watch?v=uLhXgt_gKJc>?","user":"UDB26738Q","ts":"1611083368.298800","team":"T68168MUP","attachments":[{"service_name":"YouTube","service_url":"https://www.youtube.com/","title":"JuliaCon 2020 |  Building Microservices and Applications in Julia","title_link":"https://www.youtube.com/watch?v=uLhXgt_gKJc","author_name":"The Julia Programming Language","author_link":"https://www.youtube.com/user/JuliaLanguage","thumb_url":"https://i.ytimg.com/vi/uLhXgt_gKJc/hqdefault.jpg","thumb_width":480,"thumb_height":360,"fallback":"YouTube Video: JuliaCon 2020 |  Building Microservices and Applications in Julia","video_html":"<iframe width=\"400\" height=\"225\" src=\"https://www.youtube.com/embed/uLhXgt_gKJc?feature=oembed&autoplay=1&iv_load_policy=3\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>","video_html_width":400,"video_html_height":225,"from_url":"https://www.youtube.com/watch?v=uLhXgt_gKJc","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/youtube.png","id":1,"original_url":"https://www.youtube.com/watch?v=uLhXgt_gKJc"}],"blocks":[{"type":"rich_text","block_id":"XD6+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"did you see "},{"type":"link","url":"https://www.youtube.com/watch?v=uLhXgt_gKJc"},{"type":"text","text":"?"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"09e5c350-d234-46d7-807f-5a80995fdf6f","type":"message","text":"Thanks, I think I caught a little of this over the summer. I guess my question is kind of broad, but I wonder whether people experience Julia packages generally to be 'leaky' or not, especially for people using Julia for their microservices.\n\nI've had a lot of frustration recently debugging dying clusters because of leaky Python libraries and I wonder whether things might be better with Julia","user":"U017J1FHTSA","ts":"1611084310.300000","team":"T68168MUP","edited":{"user":"U017J1FHTSA","ts":"1611084496.000000"},"blocks":[{"type":"rich_text","block_id":"cG3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks, I think I caught a little of this over the summer. I guess my question is kind of broad, but I wonder whether people experience Julia packages generally to be 'leaky' or not, especially for people using Julia for their microservices.\n\nI've had a lot of frustration recently debugging dying clusters because of leaky Python libraries and I wonder whether things might be better with Julia"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"e1881662-cbfb-49c4-930f-fe1b4b0f9ea7","type":"message","text":"it’s generally better, yes","user":"U6795JH6H","ts":"1611084845.300600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WeMB9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it’s generally better, yes"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"55393327-57d8-4cca-94d3-a2a9b2cd1304","type":"message","text":"so many Python libraries have to be written in C and it’s very easy to leak memory in C","user":"U6795JH6H","ts":"1611084868.300800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cJ2P","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so many Python libraries have to be written in C and it’s very easy to leak memory in C"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"eed3803a-0366-4e77-aefe-dce22d720500","type":"message","text":"since so many fewer packages need C in Julia, it’s much better in that regard","user":"U6795JH6H","ts":"1611084887.301000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Uz+5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"since so many fewer packages need C in Julia, it’s much better in that regard"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"5ad8fe06-9561-446f-8ab2-f719dddec643","type":"message","text":"the only memory leak issue I had in the past few years was due to a bad wrapping of a C library such that memory was not reclaimed in the finalizer (this was in the TranscodingStreams codec packages; I’ve been meaning to fix, but it’s not high on my list of priorities)","user":"U6795JH6H","ts":"1611084962.301400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zbG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the only memory leak issue I had in the past few years was due to a bad wrapping of a C library such that memory was not reclaimed in the finalizer (this was in the TranscodingStreams codec packages; I’ve been meaning to fix, but it’s not high on my list of priorities)"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA","reactions":[{"name":"+1::skin-tone-6","users":["U017J1FHTSA","UPUBAM63X"],"count":2}]},{"client_msg_id":"f908b3db-9529-4cfd-b7ba-a067d0d5b695","type":"message","text":"That beats my three in the past week. I guess I'm sold :slightly_smiling_face:","user":"U017J1FHTSA","ts":"1611085202.301600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5E1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"That beats my three in the past week. I guess I'm sold "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"564425af-1abc-4714-875e-c96f399b7e4e","type":"message","text":"We're deploying a service right now and it has a memory leak that's not clear. Luckily it's a queue consumer so when it crashes and comes back up a minute later it's not a huge issue","user":"U69J94HT9","ts":"1611089926.305400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5xK8+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"We're deploying a service right now and it has a memory leak that's not clear. Luckily it's a queue consumer so when it crashes and comes back up a minute later it's not a huge issue"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"be632e8c-ae9f-4f72-823b-d6b9c9bc89c3","type":"message","text":"Hmm, interesting. I guess I'll have to have a play and see how I fare","user":"U017J1FHTSA","ts":"1611093427.306000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"voG9","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmm, interesting. I guess I'll have to have a play and see how I fare"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"208332f2-5b94-4284-b577-a176591ed9b5","type":"message","text":"I just use systemd or cron to watch my python services and restart them if they fail","user":"U017JTQFNEQ","ts":"1611155780.337600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KOjmm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I just use systemd or cron to watch my python services and restart them if they fail"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"d35bf02a-0c2e-4b6f-bbd6-64d2aa8bfb2d","type":"message","text":"hacky… but effective","user":"U017JTQFNEQ","ts":"1611155790.337800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dnJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"hacky… but effective"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"c964e001-1de5-41c4-bd6a-4ad9f776b670","type":"message","text":"the problem with memory leaks is that if the process consumes too much memory it’s not necessarily that process that gets killed","user":"U6795JH6H","ts":"1611156441.338300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NZC2+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the problem with memory leaks is that if the process consumes too much memory it’s not necessarily that process that gets killed"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA","reactions":[{"name":"point_up::skin-tone-6","users":["U017J1FHTSA"],"count":1}]},{"client_msg_id":"4e10a247-5ba1-481e-8d71-7e5c69bb1cae","type":"message","text":"it also doesn’t necessarily happen when a process asks for more memory","user":"U6795JH6H","ts":"1611156456.338600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=qS4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it also doesn’t necessarily happen when a process asks for more memory"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"23b04dce-ad10-4bdb-b571-1cdf2dce1783","type":"message","text":"because the kernel gives out virtual memory very liberally and it isn’t actually backed by real memory pages until it is written to or read from, which happens at an arbitrary point in program execution","user":"U6795JH6H","ts":"1611156543.338800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Is+L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"because the kernel gives out virtual memory very liberally and it isn’t actually backed by real memory pages until it is written to or read from, which happens at an arbitrary point in program execution"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"dc3e9a4c-c31d-4a35-9b1d-412a457dbf5b","type":"message","text":"and at that point, all the kernel knows is that it needs a physical memory page to back this virtual memory page and it doesn’t have any","user":"U6795JH6H","ts":"1611156589.339000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EXDyg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and at that point, all the kernel knows is that it needs a physical memory page to back this virtual memory page and it doesn’t have any"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"92b08675-0e6f-4f93-944a-cabd56fbdd11","type":"message","text":"which process do you kill? it’s unclear which one is “at fault”","user":"U6795JH6H","ts":"1611156606.339200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"csxb1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"which process do you kill? it’s unclear which one is “at fault”"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"72288482-a9ef-4abc-a8e2-efa3e7e2cc4c","type":"message","text":"that’s where the OOM killer comes in — it picks a process by some policy, kills it, and uses one of the physical memory pages it has freed up by killing it","user":"U6795JH6H","ts":"1611156657.339400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KXhM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that’s where the OOM killer comes in — it picks a process by some policy, kills it, and uses one of the physical memory pages it has freed up by killing it"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"},{"client_msg_id":"abf74543-c2cb-4fd7-8c29-e31fff7b6366","type":"message","text":"at least this is my understanding of the process, but I am not a kernel expert","user":"U6795JH6H","ts":"1611156681.339600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"i4gn","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"at least this is my understanding of the process, but I am not a kernel expert"}]}]}],"thread_ts":"1611083241.298600","parent_user_id":"U017J1FHTSA"}]