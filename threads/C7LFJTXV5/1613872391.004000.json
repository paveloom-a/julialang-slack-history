[{"client_msg_id":"e8db1518-5a59-4900-a896-733a6d88cdbc","type":"message","text":"Hi I'm try the `ExpDecay` of Flux and seems it doesn't work.\n`opt = Flux.Optimiser(ExpDecay(0.001, 0.1, 1, 1e-4), Descent())`\n`for i=1:10`\n    `println(opt.os[2].eta)`\n    `Flux.train!(loss,θ,trainData,opt)`     \n`end`\nHere's my toy example. I thought the learning rate should decrease by 0.1 after each training following the document, but the toy return me same learning rate for 10 training. Am I missing anything here?","user":"U01977X150R","ts":"1613872391.004000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dxd3z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi I'm try the "},{"type":"text","text":"ExpDecay","style":{"code":true}},{"type":"text","text":" of Flux and seems it doesn't work.\n"},{"type":"text","text":"opt = Flux.Optimiser(ExpDecay(0.001, 0.1, 1, 1e-4), Descent())","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"for i=1:10","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    println(opt.os[2].eta)","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"    Flux.train!(loss,θ,trainData,opt)     ","style":{"code":true}},{"type":"text","text":"\n"},{"type":"text","text":"end","style":{"code":true}},{"type":"text","text":"\nHere's my toy example. I thought the learning rate should decrease by 0.1 after each training following the document, but the toy return me same learning rate for 10 training. Am I missing anything here?"}]}]}],"thread_ts":"1613872391.004000","reply_count":11,"reply_users_count":3,"latest_reply":"1613885267.012100","reply_users":["UH9KWTTD3","UMY1LV01G","U01977X150R"],"subscribed":false},{"client_msg_id":"4A81C961-9B85-425D-9BC9-AD5213DDC11B","type":"message","text":"It should just be `ExpDecay(0.1)`. But that will decay every iteration of training. Not every epoch like you are trying to do here.","user":"UH9KWTTD3","ts":"1613873524.004700","team":"T68168MUP","edited":{"user":"UH9KWTTD3","ts":"1613873687.000000"},"blocks":[{"type":"rich_text","block_id":"G5g","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It should just be "},{"type":"text","text":"ExpDecay(0.1)","style":{"code":true}},{"type":"text","text":". But that will decay every iteration of training. Not every epoch like you are trying to do here."}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"2CFAF90D-1F92-4F56-99B9-EF0A7C2AB094","type":"message","text":"Shameless plug: <https://darsnack.github.io/ParameterSchedulers.jl/dev/docs/tutorials/basic-schedules.html|https://darsnack.github.io/ParameterSchedulers.jl/dev/docs/tutorials/basic-schedules.html>","user":"UH9KWTTD3","ts":"1613873584.005100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"AvHJc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Shameless plug: "},{"type":"link","url":"https://darsnack.github.io/ParameterSchedulers.jl/dev/docs/tutorials/basic-schedules.html","text":"https://darsnack.github.io/ParameterSchedulers.jl/dev/docs/tutorials/basic-schedules.html"}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"6a35253e-f96a-40dd-88d9-f3b2ba8f4833","type":"message","text":"ExpDecay does not change Descent's eta","user":"UMY1LV01G","ts":"1613874113.005400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/m+p","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ExpDecay does not change Descent's eta"}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"6b98ef00-e29d-4112-b9a5-3b4277a66a8b","type":"message","text":"Many thanks, I've tried ExpDecay(0.1) and got same eta again. It's very interesting that Descent is the example for ExpDecay in Flux's documentation.","user":"U01977X150R","ts":"1613874250.005600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1Gc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Many thanks, I've tried ExpDecay(0.1) and got same eta again. It's very interesting that Descent is the example for ExpDecay in Flux's documentation."}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"26143951-6962-47d4-91c5-0e5f6b5ee457","type":"message","text":"ExpDecay doesn't change optimizer hyperparams","user":"UMY1LV01G","ts":"1613874292.005800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Alpy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ExpDecay doesn't change optimizer hyperparams"}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"BA373F47-5DDA-4070-B21D-268ADAC6FCD8","type":"message","text":"Oh yeah good catch <@UMY1LV01G>. `ExpDecay` and `InvDecay` don’t work by changing any of the optimizer’s parameters. It applies the decay when you update the model parameters by multiplying the update step by the decay factor.","user":"UH9KWTTD3","ts":"1613874536.008000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VRp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Oh yeah good catch "},{"type":"user","user_id":"UMY1LV01G"},{"type":"text","text":". "},{"type":"text","text":"ExpDecay","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"InvDecay","style":{"code":true}},{"type":"text","text":" don’t work by changing any of the optimizer’s parameters. It applies the decay when you update the model parameters by multiplying the update step by the decay factor."}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"33402D38-B371-4BD9-AB6A-ACFF970B903C","type":"message","text":"And apologies, you original code was correct <@U01977X150R>. ~`ExpDecay` has apparently changed since the last time I used it!~ Apparently it never had the API I thought it did? Not sure where I got it from.","user":"UH9KWTTD3","ts":"1613874674.009800","team":"T68168MUP","edited":{"user":"UH9KWTTD3","ts":"1613875015.000000"},"blocks":[{"type":"rich_text","block_id":"Xes","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And apologies, you original code was correct "},{"type":"user","user_id":"U01977X150R"},{"type":"text","text":". "},{"type":"text","text":"ExpDecay","style":{"strike":true,"code":true}},{"type":"text","text":" has apparently changed since the last time I used it! ","style":{"strike":true}},{"type":"text","text":"Apparently it never had the API I thought it did? Not sure where I got it from."}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"2b97ad8b-d696-4592-a48f-d68183e275fc","type":"message","text":"If you want the current eta, you can get it from the ExpDecay struct itself instead of the optimizer after it. IMO something like ParameterSchedulers is a more elegant approach though","user":"UMY1LV01G","ts":"1613874862.010300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"PzNOC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If you want the current eta, you can get it from the ExpDecay struct itself instead of the optimizer after it. IMO something like ParameterSchedulers is a more elegant approach though"}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"e14df8ba-8a8e-4cea-b311-6b576ccbc6c7","type":"message","text":"It's okay and many thanks for your reply, Kyle. It helps a lot to read your discussion with <@UMY1LV01G>.","user":"U01977X150R","ts":"1613874902.010500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MF2a","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It's okay and many thanks for your reply, Kyle. It helps a lot to read your discussion with "},{"type":"user","user_id":"UMY1LV01G"},{"type":"text","text":"."}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"c181d6cd-6653-4589-bd38-016b17d05211","type":"message","text":"I was actually responding to your question directly, but slack crashes after a certain character limit on my phone so it came out somewhat staccato :joy:","user":"UMY1LV01G","ts":"1613884520.011900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Lxj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I was actually responding to your question directly, but slack crashes after a certain character limit on my phone so it came out somewhat staccato "},{"type":"emoji","name":"joy"}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"},{"client_msg_id":"093e0c8c-8bfd-498a-98bc-f5bc83f88246","type":"message","text":"Many thanks, <@UMY1LV01G>, I just received your reply and indeed I did read the struct just like you suggested.","user":"U01977X150R","ts":"1613885267.012100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hbGJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Many thanks, "},{"type":"user","user_id":"UMY1LV01G"},{"type":"text","text":", I just received your reply and indeed I did read the struct just like you suggested."}]}]}],"thread_ts":"1613872391.004000","parent_user_id":"U01977X150R"}]