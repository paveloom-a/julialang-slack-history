[{"client_msg_id":"9cdea95b-88dd-448c-a204-c1d73d20b1b0","type":"message","text":"Let's say I train an NN model in Flux using batchsizse 100 and after some number of epochs I get 95% accuracy. How could I examine some of the failing 5% of testcases given that the batchsize is 100? It seems pretty easily doable with batchsize 1, but that runs very slow.","user":"U9RDM8ZGT","ts":"1612649267.076900","team":"T68168MUP","edited":{"user":"U9RDM8ZGT","ts":"1612649297.000000"},"blocks":[{"type":"rich_text","block_id":"Q1Pee","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Let's say I train an NN model in Flux using batchsizse 100 and after some number of epochs I get 95% accuracy. How could I examine some of the failing 5% of testcases given that the batchsize is 100? It seems pretty easily doable with batchsize 1, but that runs very slow."}]}]}],"thread_ts":"1612649267.076900","reply_count":17,"reply_users_count":2,"latest_reply":"1612659937.082400","reply_users":["UH9KWTTD3","U9RDM8ZGT"],"subscribed":false},{"client_msg_id":"EFBC17DE-CB99-463D-B150-A8A66224F78B","type":"message","text":"What do you mean by examine?","user":"UH9KWTTD3","ts":"1612650140.078800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sglkO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What do you mean by examine?"}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"c4e4a97c-c32b-4106-995c-1d4bb6c3f612","type":"message","text":"I want to take a look at what the inputs were that led to a failing case.","user":"U9RDM8ZGT","ts":"1612650194.079000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TEd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I want to take a look at what the inputs were that led to a failing case."}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"type":"message","subtype":"thread_broadcast","text":"I've setup a simple NN that counts the number of 1's in a 60 slot vector. What I found was that the failing testcases were cases where there was only one 1 in the vector and also the case where the input had nine 1's.","user":"U9RDM8ZGT","ts":"1612650280.079200","thread_ts":"1612649267.076900","root":{"client_msg_id":"9cdea95b-88dd-448c-a204-c1d73d20b1b0","type":"message","text":"Let's say I train an NN model in Flux using batchsizse 100 and after some number of epochs I get 95% accuracy. How could I examine some of the failing 5% of testcases given that the batchsize is 100? It seems pretty easily doable with batchsize 1, but that runs very slow.","user":"U9RDM8ZGT","ts":"1612649267.076900","team":"T68168MUP","edited":{"user":"U9RDM8ZGT","ts":"1612649297.000000"},"blocks":[{"type":"rich_text","block_id":"Q1Pee","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Let's say I train an NN model in Flux using batchsizse 100 and after some number of epochs I get 95% accuracy. How could I examine some of the failing 5% of testcases given that the batchsize is 100? It seems pretty easily doable with batchsize 1, but that runs very slow."}]}]}],"thread_ts":"1612649267.076900","reply_count":17,"reply_users_count":2,"latest_reply":"1612659937.082400","reply_users":["UH9KWTTD3","U9RDM8ZGT"],"subscribed":false},"blocks":[{"type":"rich_text","block_id":"5zs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I've setup a simple NN that counts the number of 1's in a 60 slot vector. What I found was that the failing testcases were cases where there was only one 1 in the vector and also the case where the input had nine 1's."}]}]}],"client_msg_id":"6b76f9a1-2f76-4967-894f-05b827e378a3"},{"type":"message","subtype":"thread_broadcast","text":"But I had to reload my testdata with DataLoader and batchsize=1 in order to figure this out. I'm hoping there's a nicer way to do that.","user":"U9RDM8ZGT","ts":"1612650349.079500","thread_ts":"1612649267.076900","root":{"client_msg_id":"9cdea95b-88dd-448c-a204-c1d73d20b1b0","type":"message","text":"Let's say I train an NN model in Flux using batchsizse 100 and after some number of epochs I get 95% accuracy. How could I examine some of the failing 5% of testcases given that the batchsize is 100? It seems pretty easily doable with batchsize 1, but that runs very slow.","user":"U9RDM8ZGT","ts":"1612649267.076900","team":"T68168MUP","edited":{"user":"U9RDM8ZGT","ts":"1612649297.000000"},"blocks":[{"type":"rich_text","block_id":"Q1Pee","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Let's say I train an NN model in Flux using batchsizse 100 and after some number of epochs I get 95% accuracy. How could I examine some of the failing 5% of testcases given that the batchsize is 100? It seems pretty easily doable with batchsize 1, but that runs very slow."}]}]}],"thread_ts":"1612649267.076900","reply_count":17,"reply_users_count":2,"latest_reply":"1612659937.082400","reply_users":["UH9KWTTD3","U9RDM8ZGT"],"subscribed":false},"blocks":[{"type":"rich_text","block_id":"zgX6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But I had to reload my testdata with DataLoader and batchsize=1 in order to figure this out. I'm hoping there's a nicer way to do that."}]}]}],"client_msg_id":"befdf432-c05b-4ddb-8dca-fbd3d25e9d2e"},{"client_msg_id":"e60f908a-126a-4e4c-82b7-1890754de527","type":"message","text":"Anyway, looking at some of your failed training and test cases can help get some intuition into the data and perhaps give you some ideas on how to improve the model.","user":"U9RDM8ZGT","ts":"1612650578.079800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gSp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Anyway, looking at some of your failed training and test cases can help get some intuition into the data and perhaps give you some ideas on how to improve the model."}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"247152d8-43b5-4c91-890b-f1e2899e072d","type":"message","text":"You could do something like\n```examine(x, y, ypred) = (y != ypred) &amp;&amp; @show(x, y, ypred)\n\nfor (x, y) in data\n  ypred = model(x)\n  examine.(eachcol(x), y, ypred)\nend```\nHere I assumed that `x` is a matrix of Feature x Batch, `y`/`ypred` are vectors. You can tweak according to your problem. Point is that you can still use batches of size 100 in the data loader and the model, then iterating the output of a batch is still fast for just examining.","user":"UH9KWTTD3","ts":"1612652520.080000","team":"T68168MUP","edited":{"user":"UH9KWTTD3","ts":"1612652613.000000"},"blocks":[{"type":"rich_text","block_id":"jD+j","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You could do something like\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"examine(x, y, ypred) = (y != ypred) && @show(x, y, ypred)\n\nfor (x, y) in data\n  ypred = model(x)\n  examine.(eachcol(x), y, ypred)\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Here I assumed that "},{"type":"text","text":"x","style":{"code":true}},{"type":"text","text":" is a matrix of Feature x Batch, "},{"type":"text","text":"y","style":{"code":true}},{"type":"text","text":"/"},{"type":"text","text":"ypred","style":{"code":true}},{"type":"text","text":" are vectors. You can tweak according to your problem. Point is that you can still use batches of size 100 in the data loader and the model, then iterating the output of a batch is still fast for just examining."}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"a45d9166-c04b-4082-857d-fb412bcc102a","type":"message","text":"Hmmm... getting array size mismatches with that. Seems like somehow it has to do `eachcol(x)` and `eachcol(y)` there maybe.","user":"U9RDM8ZGT","ts":"1612657330.080300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"enH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmmm... getting array size mismatches with that. Seems like somehow it has to do "},{"type":"text","text":"eachcol(x)","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"eachcol(y)","style":{"code":true}},{"type":"text","text":" there maybe."}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"8d11710b-b77d-497d-a6a7-8ba25fa62106","type":"message","text":"Though that doesn't work","user":"U9RDM8ZGT","ts":"1612657344.080500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TDA8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Though that doesn't work"}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"a28683d9-8a6b-449e-9d8d-79650ae0944d","type":"message","text":"Can you share `summary.(first(data))` for the data loader?","user":"UH9KWTTD3","ts":"1612659152.080700","team":"T68168MUP","edited":{"user":"UH9KWTTD3","ts":"1612659170.000000"},"blocks":[{"type":"rich_text","block_id":"CoW6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Can you share "},{"type":"text","text":"summary.(first(data))","style":{"code":true}},{"type":"text","text":" for the data loader?"}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"de963f52-e695-416d-ab8f-946ed8c13cce","type":"message","text":"I can do: `summary(train_data)`","user":"U9RDM8ZGT","ts":"1612659605.081000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aLM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I can do: "},{"type":"text","text":"summary(train_data)","style":{"code":true}}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"4756b6f4-4dea-4388-b067-08462c2aabf5","type":"message","text":"\"200-element Array{Tuple{CuArray{Bool,2},Flux.OneHotMatrix{CuArray{Flux.OneHotVector,1}}},1}\"","user":"U9RDM8ZGT","ts":"1612659619.081200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"S+P","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"\"200-element Array{Tuple{CuArray{Bool,2},Flux.OneHotMatrix{CuArray{Flux.OneHotVector,1}}},1}\""}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"a7e5c3b0-90af-49d5-8d85-97e23ed7636b","type":"message","text":"But I can't do: `summary(first(train_data))`","user":"U9RDM8ZGT","ts":"1612659643.081400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"AeSUk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But I can't do: "},{"type":"text","text":"summary(first(train_data))","style":{"code":true}}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"1853032a-719c-49d2-aadb-0ae306d5cf1d","type":"message","text":"ERROR: scalar getindex is disallowed","user":"U9RDM8ZGT","ts":"1612659661.081600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"==Cfs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ERROR: scalar getindex is disallowed"}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"00dd6669-7fa8-4d40-b3b1-ac9c6905a6f1","type":"message","text":"oh, this works: `summary(first(cpu(train_data)))`","user":"U9RDM8ZGT","ts":"1612659720.081800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4gexi","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh, this works: "},{"type":"text","text":"summary(first(cpu(train_data)))","style":{"code":true}}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"4551080a-bfc0-4b75-9154-bf374853dbf7","type":"message","text":"\"(Bool[0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1; 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0;... etc.","user":"U9RDM8ZGT","ts":"1612659754.082000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Cm2ZU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"\"(Bool[0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1; 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0;... etc."}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"6c9b2d18-b9e3-48ef-9afb-3061f4c8ea62","type":"message","text":"too many lines to post here","user":"U9RDM8ZGT","ts":"1612659801.082200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IHh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"too many lines to post here"}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"},{"client_msg_id":"c991e1c3-51d5-41e7-8298-6f7899211df7","type":"message","text":"julia&gt; typeof(first(cpu(train_data)))\nTuple{Array{Bool,2},Flux.OneHotMatrix{Array{Flux.OneHotVector,1}}}","user":"U9RDM8ZGT","ts":"1612659937.082400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7hRV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"julia> typeof(first(cpu(train_data)))\nTuple{Array{Bool,2},Flux.OneHotMatrix{Array{Flux.OneHotVector,1}}}"}]}]}],"thread_ts":"1612649267.076900","parent_user_id":"U9RDM8ZGT"}]