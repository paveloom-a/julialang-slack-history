[{"client_msg_id":"377581ef-465c-42d2-9ac9-26fd711eb1b3","type":"message","text":"I've successfully used Flux for multi-label classification several times, using this example from the model zoo as my starting point:\n\n<https://github.com/FluxML/model-zoo/blob/master/vision/mnist/mlp.jl>\n\nToday I needed binary classification. I naively assumed I could achieve this by not one-hot-encoding the labels, having just a single output from the final layer, and replacing the `logitcrossentropy` loss function with `Flux.Losses.logitbinarycrossentropy`, with no other changes. However, this does not work at all. The model is not learning.\n\nWhen I revert to multi-label classification (one-hot-encoded labels, two outputs from the final layer, logitcrossentropy loss) everything works as expected.\n\nI'm feeling really stupid. What am I missing?","user":"UGQRDMRCG","ts":"1612454297.055900","team":"T68168MUP","edited":{"user":"UGQRDMRCG","ts":"1612455395.000000"},"blocks":[{"type":"rich_text","block_id":"XHAHN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I've successfully used Flux for multi-label classification several times, using this example from the model zoo as my starting point:\n\n"},{"type":"link","url":"https://github.com/FluxML/model-zoo/blob/master/vision/mnist/mlp.jl"},{"type":"text","text":"\n\nToday I needed binary classification. I naively assumed I could achieve this by not one-hot-encoding the labels, having just a single output from the final layer, and replacing the "},{"type":"text","text":"logitcrossentropy","style":{"code":true}},{"type":"text","text":" loss function with "},{"type":"text","text":"Flux.Losses.logitbinarycrossentropy","style":{"code":true}},{"type":"text","text":", with no other changes. However, this does not work at all. The model is not learning.\n\nWhen I revert to multi-label classification (one-hot-encoded labels, two outputs from the final layer, logitcrossentropy loss) everything works as expected.\n\nI'm feeling really stupid. What am I missing?"}]}]}],"thread_ts":"1612454297.055900","reply_count":3,"reply_users_count":2,"latest_reply":"1612455430.056500","reply_users":["UMY1LV01G","UGQRDMRCG"],"subscribed":false},{"client_msg_id":"83d79a06-2c0f-46ed-abf1-872a61e445f8","type":"message","text":"Does your final layer have an activation function?  `logitbinarycrossentropy` expects an untransformed (no sigmoid or softmax) input","user":"UMY1LV01G","ts":"1612455244.056000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CbrY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does your final layer have an activation function?  "},{"type":"text","text":"logitbinarycrossentropy","style":{"code":true}},{"type":"text","text":" expects an untransformed (no sigmoid or softmax) input"}]}]}],"thread_ts":"1612454297.055900","parent_user_id":"UGQRDMRCG"},{"client_msg_id":"431c8666-2327-42f6-915a-a743e269a061","type":"message","text":"No activation function.\n\nI created a gist using the example from the model zoo with minimal modifications (modifying the example to guess whether a MNIST image is zero or not):\n\n<https://gist.github.com/romstad/0e6c9070e34e952a53c2e3f59b1d7bf1>","user":"UGQRDMRCG","ts":"1612455360.056200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QRat","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No activation function.\n\nI created a gist using the example from the model zoo with minimal modifications (modifying the example to guess whether a MNIST image is zero or not):\n\n"},{"type":"link","url":"https://gist.github.com/romstad/0e6c9070e34e952a53c2e3f59b1d7bf1"}]}]}],"thread_ts":"1612454297.055900","parent_user_id":"UGQRDMRCG"},{"client_msg_id":"8673aa42-9aed-467f-bec1-d17a2fc83554","type":"message","text":"I just discovered that I referred to the wrong example in the model zoo in my first post. Now edited.","user":"UGQRDMRCG","ts":"1612455430.056500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"87D22","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I just discovered that I referred to the wrong example in the model zoo in my first post. Now edited."}]}]}],"thread_ts":"1612454297.055900","parent_user_id":"UGQRDMRCG"}]