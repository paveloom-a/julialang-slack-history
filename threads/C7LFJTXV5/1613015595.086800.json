[{"client_msg_id":"0BBDE7A2-4CD8-4BC1-90EF-34ADD9C087D0","type":"message","text":"I think there's something weird about destructure and how it's adjoint interact with layers that don't use all the fields defined in a particular struct. ","user":"UPM0H43C7","ts":"1613015595.086800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"15b","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think there's something weird about destructure and how it's adjoint interact with layers that don't use all the fields defined in a particular struct. "}]}]}],"thread_ts":"1613015595.086800","reply_count":1,"reply_users_count":1,"latest_reply":"1613016091.095700","reply_users":["UPM0H43C7"],"subscribed":false},{"client_msg_id":"18958F30-A9FD-4E0C-83BB-E306D6C9152D","type":"message","text":"I'm on my phone, so please forgive any typos. Say i have a custom struct that defines fields W, b, z and define the method as W*x.+ b and destructure it then the forward call works just fine even though it doesn't necessarily preserve z. However, the zygote adjoint `dm-&gt;_restructure(dm,cache)` will contain a named tuple with W, b and z, where the two first arrays but the last one is of  type nothing. This causes the dimensions mismatch error reported on github both under flux and diffeqflux ","user":"UPM0H43C7","ts":"1613016091.095700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MPC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm on my phone, so please forgive any typos. Say i have a custom struct that defines fields W, b, z and define the method as W*x.+ b and destructure it then the forward call works just fine even though it doesn't necessarily preserve z. However, the zygote adjoint "},{"type":"text","text":"dm->_restructure(dm,cache)","style":{"code":true}},{"type":"text","text":" will contain a named tuple with W, b and z, where the two first arrays but the last one is of  type nothing. This causes the dimensions mismatch error reported on github both under flux and diffeqflux "}]}]}],"thread_ts":"1613015595.086800","parent_user_id":"UPM0H43C7"}]