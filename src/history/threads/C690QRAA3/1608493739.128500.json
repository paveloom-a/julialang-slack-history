[{"client_msg_id":"5cdad04b-500a-4bee-b19d-fb2da643553d","type":"message","text":"Anyone ever gotten `ERROR: LoadError: CUDA error: an illegal memory access was encountered (code 700, ERROR_ILLEGAL_ADDRESS)`  after loading a saved model and trying to continue training? The error is in the backwards pass. Any idea what is going wrong?","user":"U01EK81V5GF","ts":"1608493739.128500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"G8FK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Anyone ever gotten "},{"type":"text","text":"ERROR: LoadError: CUDA error: an illegal memory access was encountered (code 700, ERROR_ILLEGAL_ADDRESS)","style":{"code":true}},{"type":"text","text":"  after loading a saved model and trying to continue training? The error is in the backwards pass. Any idea what is going wrong?"}]}]}],"thread_ts":"1608493739.128500","reply_count":9,"reply_users_count":3,"latest_reply":"1608632626.146800","reply_users":["UM30MT6RF","UC4QQPG4A","U01EK81V5GF"],"subscribed":false},{"client_msg_id":"983abd4e-6c26-4976-b9cb-420ea3c8f22e","type":"message","text":"Try starting Julia with `--checkbounds=yes`. It could be that this is because you are accessing a `CuArray` out of bounds","user":"UM30MT6RF","ts":"1608494213.128900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tXS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Try starting Julia with "},{"type":"text","text":"--checkbounds=yes","style":{"code":true}},{"type":"text","text":". It could be that this is because you are accessing a "},{"type":"text","text":"CuArray","style":{"code":true}},{"type":"text","text":" out of bounds"}]}]}],"thread_ts":"1608493739.128500","parent_user_id":"U01EK81V5GF"},{"client_msg_id":"c15c4cf8-2b16-42e5-a9a0-549a780807ec","type":"message","text":"If you've saved the model while it was on the GPU, you need to first bring it to the cpu and then save it","user":"UC4QQPG4A","ts":"1608496375.129100","team":"T68168MUP","edited":{"user":"UC4QQPG4A","ts":"1608496393.000000"},"blocks":[{"type":"rich_text","block_id":"ly7N","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"If you've saved the model while it was on the GPU, you need to first bring it to the cpu and then save it"}]}]}],"thread_ts":"1608493739.128500","parent_user_id":"U01EK81V5GF"},{"type":"message","subtype":"thread_broadcast","text":"The error still occurs when I explicitly move the model to CPU before saving and use `--check-bounds=yes` to start Julia","user":"U01EK81V5GF","ts":"1608627982.135900","thread_ts":"1608493739.128500","root":{"client_msg_id":"5cdad04b-500a-4bee-b19d-fb2da643553d","type":"message","text":"Anyone ever gotten `ERROR: LoadError: CUDA error: an illegal memory access was encountered (code 700, ERROR_ILLEGAL_ADDRESS)`  after loading a saved model and trying to continue training? The error is in the backwards pass. Any idea what is going wrong?","user":"U01EK81V5GF","ts":"1608493739.128500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"G8FK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Anyone ever gotten "},{"type":"text","text":"ERROR: LoadError: CUDA error: an illegal memory access was encountered (code 700, ERROR_ILLEGAL_ADDRESS)","style":{"code":true}},{"type":"text","text":"  after loading a saved model and trying to continue training? The error is in the backwards pass. Any idea what is going wrong?"}]}]}],"thread_ts":"1608493739.128500","reply_count":9,"reply_users_count":3,"latest_reply":"1608632626.146800","reply_users":["UM30MT6RF","UC4QQPG4A","U01EK81V5GF"],"subscribed":false},"blocks":[{"type":"rich_text","block_id":"91RXp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The error still occurs when I explicitly move the model to CPU before saving and use "},{"type":"text","text":"--check-bounds=yes","style":{"code":true}},{"type":"text","text":" to start Julia"}]}]}],"client_msg_id":"09055d71-f9b4-46d4-8480-73762f99d746","edited":{"user":"U01EK81V5GF","ts":"1608628003.000000"}},{"client_msg_id":"7f47a7aa-4377-44a0-b87b-63be73e530bb","type":"message","text":"Did you move everything to the CPU? You shouldn't get CUDA errors if you are not using any `CuArrays`","user":"UM30MT6RF","ts":"1608628117.136300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"EquUx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Did you move everything to the CPU? You shouldn't get CUDA errors if you are not using any "},{"type":"text","text":"CuArrays","style":{"code":true}}]}]}],"thread_ts":"1608493739.128500","parent_user_id":"U01EK81V5GF"},{"client_msg_id":"8066e617-9fc3-4659-a152-367b81ae4d15","type":"message","text":"I move it back to GPU upon reloading","user":"U01EK81V5GF","ts":"1608629272.136500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"aYI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I move it back to GPU upon reloading"}]}]}],"thread_ts":"1608493739.128500","parent_user_id":"U01EK81V5GF"},{"client_msg_id":"69145b8a-3cd2-4f8e-b018-ea3cdc0f827d","type":"message","text":"What if you just run your whole model on the CPU? My guess is that you might be running out of GPU memory","user":"UM30MT6RF","ts":"1608629370.136700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"utpgB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What if you just run your whole model on the CPU? My guess is that you might be running out of GPU memory"}]}]}],"thread_ts":"1608493739.128500","parent_user_id":"U01EK81V5GF"},{"client_msg_id":"879fa6cd-80e9-410d-91bd-d80c8f4114cd","type":"message","text":"The model fit on this GPU during the initial training, so there is no reason it shouldn't fit upon reloading. The errors from running out of GPU memory are different from this error. This model is way too large and expensive to train on CPU.","user":"U01EK81V5GF","ts":"1608629611.136900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Z5fa+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The model fit on this GPU during the initial training, so there is no reason it shouldn't fit upon reloading. The errors from running out of GPU memory are different from this error. This model is way too large and expensive to train on CPU."}]}]}],"thread_ts":"1608493739.128500","parent_user_id":"U01EK81V5GF"},{"client_msg_id":"3b022f3d-fd89-4beb-8efd-d7607547f161","type":"message","text":"I think the MO goes like this\n```Flux.train!(..., CuArrays, ...)\nmodel = cpu(model)\n@save model\n@load model\nmodel = gpu(moldel)\ntrain!(...)```","user":"UC4QQPG4A","ts":"1608629701.137100","team":"T68168MUP","edited":{"user":"UC4QQPG4A","ts":"1608629748.000000"},"blocks":[{"type":"rich_text","block_id":"cKI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think the MO goes like this\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"Flux.train!(..., CuArrays, ...)\nmodel = cpu(model)\n@save model\n@load model\nmodel = gpu(moldel)\ntrain!(...)"}]}]}],"thread_ts":"1608493739.128500","parent_user_id":"U01EK81V5GF"},{"client_msg_id":"d2e9be11-6324-4333-8ae3-295b530c8012","type":"message","text":"Huh, it seems to work if I load my saved model, get its parameters with `Flux.params` , make another model object, and load the saved parameters to it with `Flux.loadparams!`. Might have something to do with my model's very complex structure","user":"U01EK81V5GF","ts":"1608632626.146800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8enWF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Huh, it seems to work if I load my saved model, get its parameters with "},{"type":"text","text":"Flux.params","style":{"code":true}},{"type":"text","text":" , make another model object, and load the saved parameters to it with "},{"type":"text","text":"Flux.loadparams!","style":{"code":true}},{"type":"text","text":". Might have something to do with my model's very complex structure"}]}]}],"thread_ts":"1608493739.128500","parent_user_id":"U01EK81V5GF"}]