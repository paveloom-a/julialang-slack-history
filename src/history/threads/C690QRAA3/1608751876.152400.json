[{"client_msg_id":"a85925e7-c9b4-41f0-baa4-945141602718","type":"message","text":"Is there a GPUified `LogSumExp` ?","user":"UKA81L34J","ts":"1608751876.152400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fM2W","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there a GPUified "},{"type":"text","text":"LogSumExp","style":{"code":true}},{"type":"text","text":" ?"}]}]}],"thread_ts":"1608751876.152400","reply_count":19,"reply_users_count":4,"latest_reply":"1608998831.175600","reply_users":["UD0NS8PDF","UKA81L34J","UC4QQPG4A","U8T9JUA5R"],"subscribed":false},{"client_msg_id":"702eedf2-1c3c-4cf7-97ad-4d985994c774","type":"message","text":"According to <https://github.com/FluxML/NNlib.jl/issues/252>, yes","user":"UD0NS8PDF","ts":"1608752188.152600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YQn7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"According to "},{"type":"link","url":"https://github.com/FluxML/NNlib.jl/issues/252"},{"type":"text","text":", yes"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"e070786e-9723-43f4-9ee1-f2d3dbe51839","type":"message","text":"of course - a function not in the docs :slightly_smiling_face:","user":"UKA81L34J","ts":"1608752376.152800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"QPJHj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"of course - a function not in the docs "},{"type":"emoji","name":"slightly_smiling_face"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"2ae418a0-72a2-4d09-9072-9cd058d18f6d","type":"message","text":"lol","user":"UKA81L34J","ts":"1608752377.153000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OKOyS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"lol"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"ec17726f-ca91-4726-97a7-c6a8016b2c6c","type":"message","text":"good catch","user":"UKA81L34J","ts":"1608752380.153200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Am5+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"good catch"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"397bc889-9650-483a-8bf0-d532db3d0635","type":"message","text":"The one in NNlib is just broadcasting, so I suppose it would work too:  <https://github.com/FluxML/NNlib.jl/blob/c2a2c84c8d689ebe74963a1eb59ba9ac4f0e60a8/src/softmax.jl#L127>","user":"UD0NS8PDF","ts":"1608752507.154000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1C8Hs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The one in NNlib is just broadcasting, so I suppose it would work too:  "},{"type":"link","url":"https://github.com/FluxML/NNlib.jl/blob/c2a2c84c8d689ebe74963a1eb59ba9ac4f0e60a8/src/softmax.jl#L127"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"16fb4ef5-cbad-4110-b5e1-8600742e6eaa","type":"message","text":"Have not understood what the various StatsFuns.jl implementations are.","user":"UD0NS8PDF","ts":"1608752659.154600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/fz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Have not understood what the various StatsFuns.jl implementations are."}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"203101ec-ff6b-4c55-be32-610910251579","type":"message","text":"A pr exporting it would be nice, I'm currently afk but that'd be what we can do.","user":"UC4QQPG4A","ts":"1608785466.155200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"F60zs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"A pr exporting it would be nice, I'm currently afk but that'd be what we can do."}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"4795225b-61af-4365-851e-6f58d54192e0","type":"message","text":"The StatsFuns implementation uses a faster one-pass algorithm and also handles underflow (see <https://github.com/JuliaStats/StatsFuns.jl/pull/97|https://github.com/JuliaStats/StatsFuns.jl/pull/97>). It works for arrays (CPU and GPU) and also general iterables. I was wondering if NNlib should just reexport it: <https://github.com/FluxML/NNlib.jl/issues/252|https://github.com/FluxML/NNlib.jl/issues/252>","user":"U8T9JUA5R","ts":"1608974137.170000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kIfS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The StatsFuns implementation uses a faster one-pass algorithm and also handles underflow (see "},{"type":"link","url":"https://github.com/JuliaStats/StatsFuns.jl/pull/97","text":"https://github.com/JuliaStats/StatsFuns.jl/pull/97"},{"type":"text","text":"). It works for arrays (CPU and GPU) and also general iterables. I was wondering if NNlib should just reexport it: "},{"type":"link","url":"https://github.com/FluxML/NNlib.jl/issues/252","text":"https://github.com/FluxML/NNlib.jl/issues/252"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J","reactions":[{"name":"heart","users":["UKA81L34J"],"count":1}]},{"client_msg_id":"B1CF204E-9277-448C-AE0D-BC8A188013FC","type":"message","text":"Thanks <@U8T9JUA5R> ","user":"UKA81L34J","ts":"1608987726.173300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"09dTm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks "},{"type":"user","user_id":"U8T9JUA5R"},{"type":"text","text":" "}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"6062fb19-eea5-4061-9d3f-d280766e8fea","type":"message","text":"Or just refer people to StatsFuns? It might be better not to couple the two packages, so that e.g. installing CUDA doesn’t require installing Rmath.","user":"UD0NS8PDF","ts":"1608989520.173700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"u2=W3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Or just refer people to StatsFuns? It might be better not to couple the two packages, so that e.g. installing CUDA doesn’t require installing Rmath."}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"4f1fd8e5-1567-4222-a912-845d72bd645b","type":"message","text":"I am not sure how much the Rmath dependency matters anymore with the artifacts system and Rmath_jll? In general, I think it is maybe a better idea to move the log/exp functions to a separate package and just reexport them in StatsFuns and possibly NNlib, as suggested in an issue in the StatsFuns repo.","user":"U8T9JUA5R","ts":"1608993342.173900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2mdMd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I am not sure how much the Rmath dependency matters anymore with the artifacts system and Rmath_jll? In general, I think it is maybe a better idea to move the log/exp functions to a separate package and just reexport them in StatsFuns and possibly NNlib, as suggested in an issue in the StatsFuns repo."}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"31dee39f-51d9-4f2a-9ad2-1853a632e36d","type":"message","text":"Oh I see, sorry I posted before reading the updated issues.","user":"UD0NS8PDF","ts":"1608993635.174100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lz+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Oh I see, sorry I posted before reading the updated issues."}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"5a65ce91-5134-4249-8910-9ada002291ba","type":"message","text":"Maybe reviving <https://github.com/tpapp/LogExpFunctions.jl> is the way forward?","user":"UD0NS8PDF","ts":"1608993676.174300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YLCuM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Maybe reviving "},{"type":"link","url":"https://github.com/tpapp/LogExpFunctions.jl"},{"type":"text","text":" is the way forward?"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"fef54665-a3dd-46e7-b895-1ba9e6318916","type":"message","text":"Yep, that's what I was referring to. Though maybe it would be easier to just extract the current implementation in StatsFuns since LogExpFunctions is a bit outdated and there were quite some changes in StatsFuns recently.","user":"U8T9JUA5R","ts":"1608994054.174500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bzlGL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yep, that's what I was referring to. Though maybe it would be easier to just extract the current implementation in StatsFuns since LogExpFunctions is a bit outdated and there were quite some changes in StatsFuns recently."}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"f3847b97-a6d7-4ade-ac8a-b12f2fe76fb6","type":"message","text":"OK. I guess softmax is another obvious candidate to be shared. Perhaps some similar reduce trick can make `softmax([1 Inf], dims=2)` work?","user":"UD0NS8PDF","ts":"1608994309.174700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"JHb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"OK. I guess softmax is another obvious candidate to be shared. Perhaps some similar reduce trick can make "},{"type":"text","text":"softmax([1 Inf], dims=2)","style":{"code":true}},{"type":"text","text":" work?"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"de304163-496d-4a66-b481-e769c7d6f6dd","type":"message","text":"(NNlib gives NaNs, and StatsFuns doesn’t seem to allow dims)","user":"UD0NS8PDF","ts":"1608994355.174900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"884V","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(NNlib gives NaNs, and StatsFuns doesn’t seem to allow dims)"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"6a29af58-6313-4ca4-8c63-1aad5e7718a2","type":"message","text":"I haven't thought about the details but I mentioned it in the NNlib issue :wink: Other duplicates are `sigmoid`/`logistic` and `softplus`","user":"U8T9JUA5R","ts":"1608994411.175100","team":"T68168MUP","edited":{"user":"U8T9JUA5R","ts":"1608994711.000000"},"blocks":[{"type":"rich_text","block_id":"1utKd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I haven't thought about the details but I mentioned it in the NNlib issue "},{"type":"emoji","name":"wink"},{"type":"text","text":" Other duplicates are "},{"type":"text","text":"sigmoid","style":{"code":true}},{"type":"text","text":"/"},{"type":"text","text":"logistic","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"softplus","style":{"code":true}}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"46476fdb-dd47-47e2-a7d6-0dc23e0e5c66","type":"message","text":"Oh you did say, sorry! Not a strong day for reading comprehension, it seems.","user":"UD0NS8PDF","ts":"1608994678.175300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tXf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Oh you did say, sorry! Not a strong day for reading comprehension, it seems."}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J"},{"client_msg_id":"e7232978-3c1e-46fe-bbd8-e8719b1d7d4e","type":"message","text":"<https://github.com/JuliaStats/StatsFuns.jl/issues/46#issuecomment-751369762>","user":"U8T9JUA5R","ts":"1608998831.175600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"L=wBo","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/JuliaStats/StatsFuns.jl/issues/46#issuecomment-751369762"}]}]}],"thread_ts":"1608751876.152400","parent_user_id":"UKA81L34J","reactions":[{"name":"+1","users":["UD0NS8PDF"],"count":1}]}]