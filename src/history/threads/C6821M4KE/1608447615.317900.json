[{"type":"message","text":"I noticed the `BinomialTest` function in `HypothesisTests.jl`   seems to be giving erroneous p-values. It reports a two sided p value but it does not agree with R even in simple cases. What is the reason for this?","files":[{"id":"F01H7Q8P8PP","created":1608447565,"timestamp":1608447565,"name":"image.png","title":"image.png","mimetype":"image/png","filetype":"png","pretty_type":"PNG","user":"U01EF0QVAB0","editable":false,"size":65615,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01H7Q8P8PP/image.png","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01H7Q8P8PP/download/image.png","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8P8PP-9966e20ea1/image_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8P8PP-9966e20ea1/image_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8P8PP-9966e20ea1/image_360.png","thumb_360_w":360,"thumb_360_h":152,"thumb_480":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8P8PP-9966e20ea1/image_480.png","thumb_480_w":480,"thumb_480_h":203,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8P8PP-9966e20ea1/image_160.png","thumb_720":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8P8PP-9966e20ea1/image_720.png","thumb_720_w":720,"thumb_720_h":304,"thumb_800":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8P8PP-9966e20ea1/image_800.png","thumb_800_w":800,"thumb_800_h":338,"thumb_960":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8P8PP-9966e20ea1/image_960.png","thumb_960_w":960,"thumb_960_h":406,"thumb_1024":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8P8PP-9966e20ea1/image_1024.png","thumb_1024_w":1024,"thumb_1024_h":433,"original_w":1050,"original_h":444,"thumb_tiny":"AwAUADCiM5wf5Uf56U80hxQAzNGadu9qTd7UAJRS7vagnPagAyfWjJpKKACiiigAooooA//Z","permalink":"https://julialang.slack.com/files/U01EF0QVAB0/F01H7Q8P8PP/image.png","permalink_public":"https://slack-files.com/T68168MUP-F01H7Q8P8PP-e99de67396","is_starred":false,"has_rich_preview":false},{"id":"F01H7Q8VC3X","created":1608447594,"timestamp":1608447594,"name":"image.png","title":"image.png","mimetype":"image/png","filetype":"png","pretty_type":"PNG","user":"U01EF0QVAB0","editable":false,"size":62587,"mode":"hosted","is_external":false,"external_type":"","is_public":true,"public_url_shared":false,"display_as_bot":false,"username":"","url_private":"https://files.slack.com/files-pri/T68168MUP-F01H7Q8VC3X/image.png","url_private_download":"https://files.slack.com/files-pri/T68168MUP-F01H7Q8VC3X/download/image.png","thumb_64":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8VC3X-e8aa2347e0/image_64.png","thumb_80":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8VC3X-e8aa2347e0/image_80.png","thumb_360":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8VC3X-e8aa2347e0/image_360.png","thumb_360_w":360,"thumb_360_h":221,"thumb_480":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8VC3X-e8aa2347e0/image_480.png","thumb_480_w":480,"thumb_480_h":294,"thumb_160":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8VC3X-e8aa2347e0/image_160.png","thumb_720":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8VC3X-e8aa2347e0/image_720.png","thumb_720_w":720,"thumb_720_h":441,"thumb_800":"https://files.slack.com/files-tmb/T68168MUP-F01H7Q8VC3X-e8aa2347e0/image_800.png","thumb_800_w":800,"thumb_800_h":490,"original_w":852,"original_h":522,"thumb_tiny":"AwAdADCrgY6UhHoooUgZ5pcjuaYDc+wpKcTn+KjPHDYoAbRTuf71IST1oAUEjqDQSDSBsds0bvagAyOwoBHcUFs9qCc0AGR6UUlFAH//2Q==","permalink":"https://julialang.slack.com/files/U01EF0QVAB0/F01H7Q8VC3X/image.png","permalink_public":"https://slack-files.com/T68168MUP-F01H7Q8VC3X-abb8e8fb6d","is_starred":false,"has_rich_preview":false}],"upload":false,"blocks":[{"type":"rich_text","block_id":"c6r7w","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I noticed the "},{"type":"text","text":"BinomialTest ","style":{"code":true}},{"type":"text","text":"function in "},{"type":"text","text":"HypothesisTests.jl ","style":{"code":true}},{"type":"text","text":"  seems to be giving erroneous p-values. It reports a two sided p value but it does not agree with R even in simple cases. What is the reason for this?"}]}]}],"user":"U01EF0QVAB0","ts":"1608447615.317900","thread_ts":"1608447615.317900","reply_count":7,"reply_users_count":3,"latest_reply":"1608570460.320600","reply_users":["U67431ELR","U680T6770","U01EF0QVAB0"],"subscribed":false},{"client_msg_id":"a886efdb-06ec-4ecd-8359-3cf01bcbb80b","type":"message","text":"Probably related: <https://github.com/JuliaStats/HypothesisTests.jl/issues/212>","user":"U67431ELR","ts":"1608487892.318600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"UbFx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Probably related: "},{"type":"link","url":"https://github.com/JuliaStats/HypothesisTests.jl/issues/212"}]}]}],"thread_ts":"1608447615.317900","parent_user_id":"U01EF0QVAB0"},{"client_msg_id":"91d86840-7659-446e-a78c-cf083892960a","type":"message","text":"Two-sided p-values are conceptually complicated. It’s been discussed a lot in the literature. See the introduction of <https://arxiv.org/pdf/0810.2124.pdf>","user":"U680T6770","ts":"1608491510.318800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"n1g0g","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Two-sided p-values are conceptually complicated. It’s been discussed a lot in the literature. See the introduction of "},{"type":"link","url":"https://arxiv.org/pdf/0810.2124.pdf"}]}]}],"thread_ts":"1608447615.317900","parent_user_id":"U01EF0QVAB0"},{"client_msg_id":"a064c0b1-f8c7-4f3f-94b1-dae1fe36c542","type":"message","text":"(ours is not more erroneous than the one used in R. It’s just different)","user":"U680T6770","ts":"1608491549.319000","team":"T68168MUP","edited":{"user":"U680T6770","ts":"1608491552.000000"},"blocks":[{"type":"rich_text","block_id":"TWqq=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(ours is not more erroneous than the one used in R. It’s just different)"}]}]}],"thread_ts":"1608447615.317900","parent_user_id":"U01EF0QVAB0","reactions":[{"name":"heart","users":["U68M6ERG8"],"count":1}]},{"client_msg_id":"72b860d1-412a-4b3b-a7e7-ea0dca54d6eb","type":"message","text":"See also <https://discourse.julialang.org/t/fishers-test-p-value-results-appear-to-differ-from-matlab-r/10630> and <https://github.com/JuliaStats/HypothesisTests.jl/issues/98>","user":"U680T6770","ts":"1608491987.319300","team":"T68168MUP","attachments":[{"service_name":"JuliaLang","title":"Fisher's test p-value results appear to differ from matlab, R","title_link":"https://discourse.julialang.org/t/fishers-test-p-value-results-appear-to-differ-from-matlab-r/10630","text":"Hi, I was using HypothesisTests.jl and noticed minor, but possibly important differences in the p-value estimate between julia and two other packages when using Fisher’s exact test. In this example, matlab and R users might claim a significant result, whereas the julia user might not. This is a fairly common test, and it would be great if there was agreement. Thanks for considering this comment for discussion. Scott julia (v0.6): julia&gt; FisherExactTest(59, 335, 172, 1366) Fisher's exact t...","fallback":"JuliaLang: Fisher's test p-value results appear to differ from matlab, R","thumb_url":"https://aws1.discourse-cdn.com/business5/uploads/julialang/original/2X/1/12829a7ba92b924d4ce81099cbf99785bee9b405.png","fields":[{"title":"Reading time","value":"1 mins :clock2:","short":true},{"title":"Likes","value":"12 :heart:","short":true}],"ts":1525134515,"from_url":"https://discourse.julialang.org/t/fishers-test-p-value-results-appear-to-differ-from-matlab-r/10630","thumb_width":408,"thumb_height":263,"service_icon":"https://aws1.discourse-cdn.com/business5/uploads/julialang/optimized/2X/6/6ca888e296f59ca2a599807f7d5edd489e3d1829_2_180x180.png","id":1,"original_url":"https://discourse.julialang.org/t/fishers-test-p-value-results-appear-to-differ-from-matlab-r/10630"}],"blocks":[{"type":"rich_text","block_id":"qdBr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"See also "},{"type":"link","url":"https://discourse.julialang.org/t/fishers-test-p-value-results-appear-to-differ-from-matlab-r/10630"},{"type":"text","text":" and "},{"type":"link","url":"https://github.com/JuliaStats/HypothesisTests.jl/issues/98"}]}]}],"thread_ts":"1608447615.317900","parent_user_id":"U01EF0QVAB0"},{"client_msg_id":"78e96405-b3f3-4cbf-a225-a6d5284dd2c6","type":"message","text":"Interesting, I didn't know this. Is there a way to get a result that matches R? I'm wondering because often times in Biostatistics, we have to justify things and could be an issue for regulators. I suppose the 95% CI matches at least though","user":"U01EF0QVAB0","ts":"1608536697.320100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Bfjc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Interesting, I didn't know this. Is there a way to get a result that matches R? I'm wondering because often times in Biostatistics, we have to justify things and could be an issue for regulators. I suppose the 95% CI matches at least though"}]}]}],"thread_ts":"1608447615.317900","parent_user_id":"U01EF0QVAB0"},{"client_msg_id":"4aa67b80-64f0-4641-8bcd-f38d939e9a73","type":"message","text":"We don’t support that but it should’t be too hard to get based on value of the test statistic. Alternatively, I hope it should be sufficient to cite the paper I linked or one of the references therein.","user":"U680T6770","ts":"1608540778.320300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"en4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"We don’t support that but it should’t be too hard to get based on value of the test statistic. Alternatively, I hope it should be sufficient to cite the paper I linked or one of the references therein."}]}]}],"thread_ts":"1608447615.317900","parent_user_id":"U01EF0QVAB0"},{"client_msg_id":"04889917-bd30-416b-a58c-660561eb214b","type":"message","text":"Thanks, yea maybe one of the references. arxiv I think is not \"officially\" published so in the clinical fields, they prefer real journals","user":"U01EF0QVAB0","ts":"1608570460.320600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"E4gRG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Thanks, yea maybe one of the references. arxiv I think is not \"officially\" published so in the clinical fields, they prefer real journals"}]}]}],"thread_ts":"1608447615.317900","parent_user_id":"U01EF0QVAB0"}]