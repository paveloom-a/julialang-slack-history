[{"client_msg_id":"cfa5da62-d75a-4fe8-ba70-d8a487243772","type":"message","text":"But the time step is ~15 minutes so if you're using Oceananigans v0.45.1+ (time steps are aligned with output writing and simulation stop time) then that will cause time steps to always be 2 minutes.","user":"UEP056STX","ts":"1608130926.251000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"iC0=U","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But the time step is ~15 minutes so if you're using Oceananigans v0.45.1+ (time steps are aligned with output writing and simulation stop time) then that will cause time steps to always be 2 minutes."}]}]}],"thread_ts":"1608130926.251000","reply_count":40,"reply_users_count":3,"latest_reply":"1608139447.267700","reply_users":["U01E0U2RJJ2","UEP056STX","UMZQBQU67"],"subscribed":false},{"client_msg_id":"5f7acd72-4f38-42e5-89ab-294d9e0f4407","type":"message","text":"Aahh I hadn't noticed that","user":"U01E0U2RJJ2","ts":"1608132171.257600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0IWf7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Aahh I hadn't noticed that"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"6673f51d-d733-458a-926b-2ca483d581b3","type":"message","text":"I was running a coarser test version and the time step was of course much larger than the actual simulation","user":"U01E0U2RJJ2","ts":"1608132205.257800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1z6bl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I was running a coarser test version and the time step was of course much larger than the actual simulation"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"2c28febb-e5df-4a45-acff-c2f93e23fa69","type":"message","text":"Ah nice haha.","user":"UEP056STX","ts":"1608132306.258000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OwP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah nice haha."}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"a9727917-0f13-4a9d-8dea-a7707bb00ab6","type":"message","text":"Yeah the warning could be made more intuitive for this case.","user":"UEP056STX","ts":"1608132316.258200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1cn","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah the warning could be made more intuitive for this case."}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"f1c139c3-70d0-46b1-9505-ed2d05d3c7ec","type":"message","text":"Hmmm... I'm getting the same warning when the timestep is smaller than the averaged window too","user":"U01E0U2RJJ2","ts":"1608132609.258400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"czS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmmm... I'm getting the same warning when the timestep is smaller than the averaged window too"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"fe989c2b-cfc6-4764-995e-2f0a921dcf2e","type":"message","text":"rn Δt=7 min and the averaging window is 20 minutes","user":"U01E0U2RJJ2","ts":"1608132691.258600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DUU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"rn Δt=7 min and the averaging window is 20 minutes"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"62ff1964-e1bd-4f70-89a9-73cc843e6697","type":"message","text":"Hmmm are you still using `stride=2`?","user":"UEP056STX","ts":"1608132754.258800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lDwMl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmmm are you still using "},{"type":"text","text":"stride=2","style":{"code":true}},{"type":"text","text":"?"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"619f1780-2b9d-4679-ac5b-1315b741be46","type":"message","text":"Ah wait a second, I don't know if I aligned output writing with `AveragedTimeInterval`... Shouldn't be a big problem though, just means the time step won't change to align time-averaged output with the simulation time","user":"UEP056STX","ts":"1608132791.259000","team":"T68168MUP","edited":{"user":"UEP056STX","ts":"1608132864.000000"},"blocks":[{"type":"rich_text","block_id":"UBY7/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah wait a second, I don't know if I aligned output writing with "},{"type":"text","text":"AveragedTimeInterval","style":{"code":true}},{"type":"text","text":"... Shouldn't be a big problem though, just means the time step won't change to align time-averaged output with the simulation time"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"fa0217f0-a65e-4e2b-8057-b232098e45c9","type":"message","text":"Ah, yes, stride=2 still","user":"U01E0U2RJJ2","ts":"1608132804.259200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/5oe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah, yes, stride=2 still"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"81776c28-367d-4e35-abc1-4de35fec4d42","type":"message","text":"Let me change that","user":"U01E0U2RJJ2","ts":"1608132806.259400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"op1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Let me change that"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"f2ceb056-4e68-4514-b3cf-c3b2fcc6dcf2","type":"message","text":"Yeah that might mean it only tries to accumulate the time average every 2 iterations (or 14 minutes of simulation time)","user":"UEP056STX","ts":"1608132829.259600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7wAs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah that might mean it only tries to accumulate the time average every 2 iterations (or 14 minutes of simulation time)"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"a9ab6214-0617-4271-8c15-601e5a0f6cc9","type":"message","text":"Nope, same thing with stride=1","user":"U01E0U2RJJ2","ts":"1608133638.259900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"js8=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Nope, same thing with stride=1"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"0402e41c-ae18-41b8-838e-6b4ca2d72053","type":"message","text":"Hmmmm I think to really get rid of the warning we might have to properly align the time step with `AveragedTimeInterval`","user":"UEP056STX","ts":"1608133925.260100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ooE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmmmm I think to really get rid of the warning we might have to properly align the time step with "},{"type":"text","text":"AveragedTimeInterval","style":{"code":true}}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"182c09a0-e8a0-4964-9042-77c1d766c336","type":"message","text":"Curiously when I set the interal to 20minutes","user":"U01E0U2RJJ2","ts":"1608134203.260300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"N2qqN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Curiously when I set the interal to 20minutes"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"87dafe7e-3fa6-45bb-af86-ed8b7087b759","type":"message","text":"and the window to 19.9 minutes","user":"U01E0U2RJJ2","ts":"1608134209.260500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"YON6f","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and the window to 19.9 minutes"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"0ef843b5-ca42-4c9b-bae2-a89a8e12e57d","type":"message","text":"it works","user":"U01E0U2RJJ2","ts":"1608134211.260700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"v41H","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it works"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"e9765f36-7893-4bfa-9548-c08623b068dc","type":"message","text":"And by that I mean it throws no warnings","user":"U01E0U2RJJ2","ts":"1608134229.260900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"T23S","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"And by that I mean it throws no warnings"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"18ecba66-a65e-4923-8803-eeb2e7b1d1de","type":"message","text":"I think this might have to do with the time step alignment","user":"UMZQBQU67","ts":"1608138786.261500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jSMKN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think this might have to do with the time step alignment"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"b9b39d31-c1e1-4d6e-8349-03e48d0da365","type":"message","text":"<@UEP056STX> does it align time-steps for diagnostics?","user":"UMZQBQU67","ts":"1608138797.261700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oKe3","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UEP056STX"},{"type":"text","text":" does it align time-steps for diagnostics?"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"c0d41af0-1e8d-4a13-ace5-ab29d9ad8d0e","type":"message","text":"Ah no I don't think I aligned the time step for time-averaging related stuff.","user":"UEP056STX","ts":"1608138845.261900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"AiR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah no I don't think I aligned the time step for time-averaging related stuff."}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"f9f18e0d-be85-4776-b23c-8347378217c4","type":"message","text":"the way averaging works is that we create a diagnostic to calculate the averages, and this diagnostic uses `TimeInterval`","user":"UMZQBQU67","ts":"1608138849.262100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ph6j","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the way averaging works is that we create a diagnostic to calculate the averages, and this diagnostic uses "},{"type":"text","text":"TimeInterval","style":{"code":true}}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"e7b539f9-ea72-4d20-9d39-293608dfc101","type":"message","text":"but the output still uses `AveragedTimeInterval`","user":"UMZQBQU67","ts":"1608138861.262300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"mAT8j","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but the output still uses "},{"type":"text","text":"AveragedTimeInterval","style":{"code":true}}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"73ec6556-7bf5-4d72-9df2-ad486ba9eeae","type":"message","text":"Hmmm, right. Yeah I don't think it looks in `simulation.diagnostics` for `TimeInterval`s","user":"UEP056STX","ts":"1608138874.262500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZA9lI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hmmm, right. Yeah I don't think it looks in "},{"type":"text","text":"simulation.diagnostics","style":{"code":true}},{"type":"text","text":" for "},{"type":"text","text":"TimeInterval","style":{"code":true}},{"type":"text","text":"s"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"892a25a5-b90f-40a0-83dc-aaa053ca93d7","type":"message","text":"i’m glad i kept the warning :stuck_out_tongue:","user":"UMZQBQU67","ts":"1608138881.262700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZePP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"i’m glad i kept the warning "},{"type":"emoji","name":"stuck_out_tongue"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"1ff084db-170d-41b3-a78d-329c4aa0780c","type":"message","text":"just to summarize","user":"UMZQBQU67","ts":"1608138910.262900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"p/Pt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"just to summarize"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"031c88df-9281-446a-a093-dd49647befec","type":"message","text":"`window` is the time-averaging window","user":"UMZQBQU67","ts":"1608138921.263100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kYSD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"window","style":{"code":true}},{"type":"text","text":" is the time-averaging window"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"87dda840-a830-4642-bd30-799026938f54","type":"message","text":"and the interval is the interval of output","user":"UMZQBQU67","ts":"1608138927.263300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RW+X","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and the interval is the interval of output"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"9176ece8-a029-4f1e-b08f-3307ac93f73c","type":"message","text":"so `window=interval` is an edge case that reveals minor inconsistencies","user":"UMZQBQU67","ts":"1608138943.263500","team":"T68168MUP","edited":{"user":"UMZQBQU67","ts":"1608138993.000000"},"blocks":[{"type":"rich_text","block_id":"9AjW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"so "},{"type":"text","text":"window=interval","style":{"code":true}},{"type":"text","text":" is an edge case that reveals minor inconsistencies"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"4c692b95-9484-4ccd-bbd5-ae7d1e9a1c47","type":"message","text":"also we should throw an error if `window &gt; interval` (separate issue)","user":"UMZQBQU67","ts":"1608139026.263800","team":"T68168MUP","edited":{"user":"UMZQBQU67","ts":"1608139034.000000"},"blocks":[{"type":"rich_text","block_id":"ra3I","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"also we should throw an error if "},{"type":"text","text":"window > interval","style":{"code":true}},{"type":"text","text":" (separate issue)"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"233ccdde-cfde-42b9-ac9d-e8613573b356","type":"message","text":"as for whether stride plays a role, that’s worth some careful thought","user":"UMZQBQU67","ts":"1608139063.264100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GBtnd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"as for whether stride plays a role, that’s worth some careful thought"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"0bb540ef-0044-4573-8832-0964bb8a654c","type":"message","text":"maybe we should add a test that fails if a warning is thrown to catch this","user":"UMZQBQU67","ts":"1608139116.264300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Lac","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"maybe we should add a test that fails if a warning is thrown to catch this"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"3193c523-0f1a-4927-aebf-0afe3036ad55","type":"message","text":"Yeah, that's kind of what I thought was happening","user":"U01E0U2RJJ2","ts":"1608139171.264500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"09Rew","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, that's kind of what I thought was happening"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"cd903ffb-6c68-4dff-bd56-11e1806ca7bb","type":"message","text":"The hint is that if I set window=0.99*interval it throws me no warning","user":"U01E0U2RJJ2","ts":"1608139193.264700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"L4Ax8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The hint is that if I set window=0.99*interval it throws me no warning"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"bad557d5-136e-4565-8714-c10ecad3f911","type":"message","text":"yeah","user":"UMZQBQU67","ts":"1608139214.264900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ug7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"99341973-2b38-433a-93c7-fcbd20268665","type":"message","text":"Which I think is what I'll do to avoid this","user":"U01E0U2RJJ2","ts":"1608139217.265100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"eZE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Which I think is what I'll do to avoid this"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"60b442cc-e8bd-476f-a394-9394fd352950","type":"message","text":"well, i think we shoul solve this problem","user":"UMZQBQU67","ts":"1608139236.265300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gmw3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"well, i think we shoul solve this problem"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"ac304fc4-da8a-4ddb-b5b3-c25156593155","type":"message","text":"its just arithmetic / code flow, nothing profound","user":"UMZQBQU67","ts":"1608139250.265500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cM7NU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"its just arithmetic / code flow, nothing profound"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"86079df2-635b-4f8f-84cf-b71d6a360df0","type":"message","text":"also the warning is out of date, because we use an averaging algorithm that is always correct","user":"UMZQBQU67","ts":"1608139406.267300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZlpJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"also the warning is out of date, because we use an averaging algorithm that is always correct"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"9f91b9be-349b-4c91-86d3-179c5374477d","type":"message","text":"although","user":"UMZQBQU67","ts":"1608139418.267500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"t/D","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"although"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"},{"client_msg_id":"bfcb1022-cf5d-47ae-9793-f7dfb8cf5d98","type":"message","text":"i guess you do need `collecting=false` to properly initialize averaging (zeroing out the previous result from the prior interval)","user":"UMZQBQU67","ts":"1608139447.267700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MuQvp","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"i guess you do need "},{"type":"text","text":"collecting=false","style":{"code":true}},{"type":"text","text":" to properly initialize averaging (zeroing out the previous result from the prior interval)"}]}]}],"thread_ts":"1608130926.251000","parent_user_id":"UEP056STX"}]