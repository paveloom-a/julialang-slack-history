{"cursor": 0, "messages": [{"client_msg_id":"afdb61b1-36a7-41c0-9e24-d11752dca829","type":"message","text":"Anyone interested in learning more about Cassette","user":"U67BJLYCS","ts":"1608582928.003800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"l0jN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Anyone interested in learning more about Cassette"}]}]}]},{"client_msg_id":"b73e3918-5c83-4133-beb7-f2d7fc82fb4e","type":"message","text":"and wanting to figure out why tests are failing on 1.6?","user":"U67BJLYCS","ts":"1608582940.004200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RDL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and wanting to figure out why tests are failing on 1.6?"}]}]}]},{"client_msg_id":"0111b443-88a7-44bc-a344-113aa05dc7c1","type":"message","text":"<https://github.com/jrevels/Cassette.jl>","user":"U67BJLYCS","ts":"1608582941.004400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XpSQK","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/jrevels/Cassette.jl"}]}]}]},{"client_msg_id":"13e79723-2349-40b3-b0bd-18d1f115d29a","type":"message","text":"At first glance looks like it might be caused by <https://github.com/JuliaLang/julia/pull/38835|https://github.com/JuliaLang/julia/pull/38835>, but don't really have time to look into it further atm.","user":"UM30MT6RF","ts":"1608583568.006400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1Sxi1","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"At first glance looks like it might be caused by "},{"type":"link","url":"https://github.com/JuliaLang/julia/pull/38835","text":"https://github.com/JuliaLang/julia/pull/38835"},{"type":"text","text":", but don't really have time to look into it further atm."}]}]}]},{"client_msg_id":"9c173093-c512-44b2-a10c-0ae725015789","type":"message","text":"Cassette has rejected Julia as the host compiler - it has become conscious ?","user":"UKA81L34J","ts":"1608584916.007400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"99630","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Cassette has rejected Julia as the host compiler - it has become conscious ?"}]}]}],"reactions":[{"name":"ahhhhhhh","users":["U674T0Y9Z"],"count":1}]},{"client_msg_id":"9FCA399F-D40F-4431-9586-D023D383B619","type":"message","text":"I think it was broken before that PR was merged ","user":"UC6SUUPRC","ts":"1608649837.008300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dpt4e","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think it was broken before that PR was merged "}]}]}]},{"client_msg_id":"7B072350-1F7E-4289-BF1D-57CEA7E01E20","type":"message","text":"I actually tried to spend half a hour to fix Cassette a while ago, didn’t make it...so I just write my own CodeInfo...","user":"UC6SUUPRC","ts":"1608649901.010000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"vJ=K","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I actually tried to spend half a hour to fix Cassette a while ago, didn’t make it...so I just write my own CodeInfo..."}]}]}]},{"client_msg_id":"a16937bf-ba9f-47d9-8dc3-3574063699aa","type":"message","text":"I'm trying to get a feel for cassette but the code below throws an error, could anyone tell me what I'm doing wrong?\nThanks\n```using Cassette\n\nCassette.@context Ctx\nctx = Cassette.enabletagging(Ctx(), 1)\n\nCassette.metadatatype(::Type{&lt;:Ctx}, ::Int) = Bool\n\na = 2\nCassette.tag(a, ctx, true) #ERROR: MethodError: Cannot `convert` an object of type Bool to an object of type Cassette.NoMetaData```","user":"UBGC95BDJ","ts":"1612276749.002000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ATq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm trying to get a feel for cassette but the code below throws an error, could anyone tell me what I'm doing wrong?\nThanks\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"using Cassette\n\nCassette.@context Ctx\nctx = Cassette.enabletagging(Ctx(), 1)\n\nCassette.metadatatype(::Type{<:Ctx}, ::Int) = Bool\n\na = 2\nCassette.tag(a, ctx, true) #ERROR: MethodError: Cannot `convert` an object of type Bool to an object of type Cassette.NoMetaData"}]}]}],"thread_ts":"1612276749.002000","reply_count":9,"reply_users_count":2,"latest_reply":"1612289252.003800","reply_users":["U6A936746","UBGC95BDJ"],"subscribed":false},{"client_msg_id":"f0325ed7-ad59-4c93-9cba-86c6c08d5786","type":"message","text":"<@UM30MT6RF> how sure that Cassette is not messing this up?","user":"U67BJLYCS","ts":"1613332132.004600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"CRYJ","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"UM30MT6RF"},{"type":"text","text":" how sure that Cassette is not messing this up?"}]}]}]},{"client_msg_id":"89ed1f81-8995-414e-8b2d-89a0ae4ef29a","type":"message","text":"<https://github.com/JuliaLang/julia/pull/37954#issuecomment-778794119|https://github.com/JuliaLang/julia/pull/37954#issuecomment-778794119>","user":"U67BJLYCS","ts":"1613332133.004700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KaPxD","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/JuliaLang/julia/pull/37954#issuecomment-778794119","text":"https://github.com/JuliaLang/julia/pull/37954#issuecomment-778794119"}]}]}]},{"client_msg_id":"68f47096-d0ff-4f87-9571-c0a6b2fb7019","type":"message","text":"E.g. Can we fix this by pushing the right line information during the Cassette pass?","user":"U67BJLYCS","ts":"1613332182.005600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cnAV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"E.g. Can we fix this by pushing the right line information during the Cassette pass?"}]}]}]},{"client_msg_id":"92c04e5a-7962-4ae3-a563-58cd9fb531ca","type":"message","text":"I haven't really looked into this further, that is certainly possible.","user":"UM30MT6RF","ts":"1613332406.007800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GTOx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I haven't really looked into this further, that is certainly possible."}]}]}]},{"client_msg_id":"6556bbcf-c417-4c1c-9941-3237773228dc","type":"message","text":"Yeah we might accidentally break the new scheme","user":"U67BJLYCS","ts":"1613338060.010300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"U4M","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah we might accidentally break the new scheme"}]}]}]},{"client_msg_id":"a1570b73-1b76-4f20-9a3c-d04c3d065c9e","type":"message","text":"So it might be as simple as pushing a new node","user":"U67BJLYCS","ts":"1613338082.011100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tjgT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So it might be as simple as pushing a new node"}]}]}]},{"client_msg_id":"eb170a6b-bd0c-4977-b3bd-a4b6d426e556","type":"message","text":"Coming to think of it, was the previous behavior here correct? I think this might have actually been a bug fix, but it is really unfortunate that it makes stack traces so much less useful. How hard do you reckon it would be to preserve the signature of inlined functions for stacktraces?","user":"UM30MT6RF","ts":"1613338168.012300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Wjxr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Coming to think of it, was the previous behavior here correct? I think this might have actually been a bug fix, but it is really unfortunate that it makes stack traces so much less useful. How hard do you reckon it would be to preserve the signature of inlined functions for stacktraces?"}]}]}]},{"client_msg_id":"c5ee20f9-2563-4ee6-a1e2-167ee469613a","type":"message","text":"I think the issue is that the we are not inlining","user":"U67BJLYCS","ts":"1613338342.012800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"w=z6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think the issue is that the we are not inlining"}]}]}]},{"client_msg_id":"e181dd9a-9e86-4e4a-9f0a-5c991eccf689","type":"message","text":"But reflecting on the method and then emitting code based of that reflection","user":"U67BJLYCS","ts":"1613338369.013700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"rTc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But reflecting on the method and then emitting code based of that reflection"}]}]}]},{"client_msg_id":"8ad925d8-f309-4ae7-a1ce-56cf30f96b65","type":"message","text":"So previously that looked like inlining to the compiler","user":"U67BJLYCS","ts":"1613338390.014400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NqC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So previously that looked like inlining to the compiler"}]}]}]},{"client_msg_id":"9acbfe77-ffc1-41bf-ba99-08ffdaeeb49f","type":"message","text":"But now it reflects what is happening accurately","user":"U67BJLYCS","ts":"1613338404.014900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MhrB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But now it reflects what is happening accurately"}]}]}]},{"client_msg_id":"6683492a-9b21-455b-bb69-eb358cec2c04","type":"message","text":"So we might need to inject an inlining frame into the reflected CodeInfo","user":"U67BJLYCS","ts":"1613338426.015600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MmmD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So we might need to inject an inlining frame into the reflected CodeInfo"}]}]}]},{"client_msg_id":"12721f28-28b0-4ccb-b778-b53213a6d23d","type":"message","text":"At least that is my looking into my crystal ball","user":"U67BJLYCS","ts":"1613338443.016100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"orX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"At least that is my looking into my crystal ball"}]}]}]},{"client_msg_id":"658e4af2-484a-4351-87b3-7564ffa1adee","type":"message","text":"There is a Mini-Cassette in the base test","user":"U67BJLYCS","ts":"1613338472.016600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BAi","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"There is a Mini-Cassette in the base test"}]}]}]},{"client_msg_id":"53e124b2-41cb-40e0-8a1b-1fb26226372e","type":"message","text":"So the thing to do would be to reproduce there, write a test for it and then fix it in the mini Cassette","user":"U67BJLYCS","ts":"1613338563.017600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Ilfsk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So the thing to do would be to reproduce there, write a test for it and then fix it in the mini Cassette"}]}]}]},{"client_msg_id":"baa9340d-774b-4656-8ce1-e31c898dedca","type":"message","text":"Then we can take that fix to Cassette proper and we can reasonably be certain that it won't regress","user":"U67BJLYCS","ts":"1613338598.018600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2T/j+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Then we can take that fix to Cassette proper and we can reasonably be certain that it won't regress"}]}]}]},{"client_msg_id":"a07a882a-2a4d-4a88-bf8e-ebc407b5cdef","type":"message","text":"Ah, I see, so we basically want to trick Julia into thinking this was a different function than the one actually called?","user":"UM30MT6RF","ts":"1613338724.020300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lSy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ah, I see, so we basically want to trick Julia into thinking this was a different function than the one actually called?"}]}]}]},{"client_msg_id":"515ba5aa-718a-4db6-9395-85ec718c2db1","type":"message","text":"Jup","user":"U67BJLYCS","ts":"1613339940.020500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"P+ydG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Jup"}]}]}]},{"client_msg_id":"0ef4d54c-f8d5-423d-b610-adc95c2e41fc","type":"message","text":"We could also teach the compiler more about Cassette","user":"U67BJLYCS","ts":"1613339976.021300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"v0=B","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"We could also teach the compiler more about Cassette"}]}]}]},{"client_msg_id":"eb007d6f-c57c-428b-9f2b-cdaee4791688","type":"message","text":"But if we can fix it on the Cassette level I would prefer that","user":"U67BJLYCS","ts":"1613340011.021900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MTg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But if we can fix it on the Cassette level I would prefer that"}]}]}]},{"client_msg_id":"5010e970-80b8-48ab-b5f3-cb50689e3020","type":"message","text":"In any case do open an issue on Cassette.jl","user":"U67BJLYCS","ts":"1613340055.022500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"N5g2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In any case do open an issue on Cassette.jl"}]}]}],"reactions":[{"name":"+1","users":["UM30MT6RF"],"count":1}]},{"client_msg_id":"a39f46e4-5d05-455a-9a0d-69cc8257a0a5","type":"message","text":"I won't have time to look at I immediately","user":"U67BJLYCS","ts":"1613340068.022900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dE/X","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I won't have time to look at I immediately"}]}]}]},{"client_msg_id":"e9327044-3d61-4886-ab9a-423549a149e6","type":"message","text":"But I think it's something we can fix there","user":"U67BJLYCS","ts":"1613340081.023400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LCnpK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"But I think it's something we can fix there"}]}]}]}]}