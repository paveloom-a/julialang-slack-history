{"cursor": 20, "messages": [{"client_msg_id":"87fc6acb-4e80-4377-8205-e5e698a19d56","type":"message","text":"MTK isn't quite there yet. It's getting really close though.","user":"U69BL50BF","ts":"1615747816.102900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"c3s9n","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"MTK isn't quite there yet. It's getting really close though."}]}]}]},{"client_msg_id":"e3d4a17f-a903-43c3-9709-e7b0d04033cf","type":"message","text":"<@U69BL50BF> Yes, seems like you guys are making really good progress. So no rush. So then is `ControlSystems.jl` the best plan for now, and then update to MTK in the future?","user":"UDDSTBX19","ts":"1615748033.104100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qgE","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U69BL50BF"},{"type":"text","text":" Yes, seems like you guys are making really good progress. So no rush. So then is "},{"type":"text","text":"ControlSystems.jl","style":{"code":true}},{"type":"text","text":" the best plan for now, and then update to MTK in the future?"}]}]}]},{"client_msg_id":"f9974ba1-03df-42b3-8498-7232fddf632c","type":"message","text":"yes, and ControlSystems.jl may be a group we work with as a top level interface too. It's hard to know how this part is going to evolve.","user":"U69BL50BF","ts":"1615748332.104800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"C33L","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes, and ControlSystems.jl may be a group we work with as a top level interface too. It's hard to know how this part is going to evolve."}]}]}],"reactions":[{"name":"heavy_check_mark","users":["UDDSTBX19"],"count":1}]},{"client_msg_id":"d00500cb-8620-4089-a2e7-2d0955ce213e","type":"message","text":"Controlsystems.jl almost exclusively concerns itself with linear control theory, for which it should correspond roughly to matlab control systems toolbox.","user":"UJ7DVTVQ8","ts":"1615752969.107300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"hUTa","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Controlsystems.jl almost exclusively concerns itself with linear control theory, for which it should correspond roughly to matlab control systems toolbox."}]}]}]},{"client_msg_id":"4477a353-0945-48fc-ac08-f4f7ac1c4d27","type":"message","text":"Matlab has more tools for robust synthesis, and we have more of typical Julia stuff, like support for ad, uncertainty propagation and good support for complex coefficient systems.","user":"UJ7DVTVQ8","ts":"1615753038.108900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+NY8","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Matlab has more tools for robust synthesis, and we have more of typical Julia stuff, like support for ad, uncertainty propagation and good support for complex coefficient systems."}]}]}]},{"client_msg_id":"587612f4-9d31-4174-a6c7-3cfcded221b6","type":"message","text":"<@U69BL50BF> On a related note, I've been messing around with having MTK symbolically build open loop optimal control problems from the necessary conditions for the Pontryagin minimum principle and then passing it off to the `TwoPointBVProblem` solver (basically just pulling the function, parameters, and initial conditions out of the `ODESystem` manually). It seems to do pretty well. I'm just happy that it worked, to be honest. Is this a method you guys are already using with the `ControlSystem` type? The only thing I saw in the docs was for the discretize-then-optimize method.\n\nAlso, how do you currently handle final conditions in the objective function for the `ControlSystem` type? Like for free final state problems and such.","user":"US4A6G6B0","ts":"1615762198.119800","team":"T68168MUP","edited":{"user":"US4A6G6B0","ts":"1615762749.000000"},"blocks":[{"type":"rich_text","block_id":"luP","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U69BL50BF"},{"type":"text","text":" On a related note, I've been messing around with having MTK symbolically build open loop optimal control problems from the necessary conditions for the Pontryagin minimum principle and then passing it off to the "},{"type":"text","text":"TwoPointBVProblem","style":{"code":true}},{"type":"text","text":" solver (basically just pulling the function, parameters, and initial conditions out of the "},{"type":"text","text":"ODESystem","style":{"code":true}},{"type":"text","text":" manually). It seems to do pretty well. I'm just happy that it worked, to be honest. Is this a method you guys are already using with the "},{"type":"text","text":"ControlSystem","style":{"code":true}},{"type":"text","text":" type? The only thing I saw in the docs was for the discretize-then-optimize method.\n\nAlso, how do you currently handle final conditions in the objective function for the "},{"type":"text","text":"ControlSystem","style":{"code":true}},{"type":"text","text":" type? Like for free final state problems and such."}]}]}]},{"client_msg_id":"30b85200-a7b7-4990-ba8a-a2357ab436e8","type":"message","text":"how are you discretizing to the two point BVP?","user":"U69BL50BF","ts":"1615762746.120600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qd+c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"how are you discretizing to the two point BVP?"}]}]}]},{"client_msg_id":"8f755919-aec8-4ac5-8acf-a2bf244d5008","type":"message","text":"```solve(bvp, MIRK4(), dt=0.05)```","user":"US4A6G6B0","ts":"1615762792.121000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/GXF","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"solve(bvp, MIRK4(), dt=0.05)"}]}]}]},{"client_msg_id":"c3fec95a-afb8-4c17-ab13-39a5551b3de0","type":"message","text":"Here's a gist:\n<https://gist.github.com/jonniedie/e02c0a8f82a10329eeeee66bcb262978>","user":"US4A6G6B0","ts":"1615763022.121900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"lvfe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Here's a gist:\n"},{"type":"link","url":"https://gist.github.com/jonniedie/e02c0a8f82a10329eeeee66bcb262978"}]}]}]},{"client_msg_id":"8863ffb4-054c-4215-a8d9-8357edd48857","type":"message","text":"I definitely didn't do it the cleanest way, with getting variables from the other system, though. The string thing is kinda a hack just to get it working because I was having a hard time doing the derivatives with respect to state variables of the other system without bringing those variables in directly.","user":"US4A6G6B0","ts":"1615763109.123600","team":"T68168MUP","edited":{"user":"US4A6G6B0","ts":"1615763208.000000"},"blocks":[{"type":"rich_text","block_id":"azzV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I definitely didn't do it the cleanest way, with getting variables from the other system, though. The string thing is kinda a hack just to get it working because I was having a hard time doing the derivatives with respect to state variables of the other system without bringing those variables in directly."}]}]}]},{"client_msg_id":"660460fb-7f71-4f5c-a325-85dc75398254","type":"message","text":"oh yes, that's a variational method","user":"U69BL50BF","ts":"1615763724.124100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zvJs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh yes, that's a variational method"}]}]}]},{"client_msg_id":"90e2a4a8-2fb0-42e4-9ec7-57fc4e9be557","type":"message","text":"it's different from the one we have so far which requires an optimization.","user":"U69BL50BF","ts":"1615763733.124400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"j8GK5","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it's different from the one we have so far which requires an optimization."}]}]}]},{"client_msg_id":"14e4734f-e461-4572-88bb-0e0f18420550","type":"message","text":"I don't know anything about Lie groups, but can these problem types not be used for faster sensitivity analysis?\n<https://diffeq.sciml.ai/stable/types/nonautonomous_linear_ode/#Note-About-Affine-Equations>","user":"UQEDP1Q5V","ts":"1615764058.126200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"zJZnq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I don't know anything about Lie groups, but can these problem types not be used for faster sensitivity analysis?\n"},{"type":"link","url":"https://diffeq.sciml.ai/stable/types/nonautonomous_linear_ode/#Note-About-Affine-Equations"}]}]}]},{"client_msg_id":"bde65b7a-3593-476c-9b4f-ba0933285a21","type":"message","text":"```function spring_mass_damper_system(;name)\n  @variables x(t)\n  D = Differential(t)\n  @parameters M b k\n  eqs = [D(D(x)) ~ b/M*D(x) + k/M*x] # equations defining the system\n  iv = t # the independent variable\n  states = [x] # the dependent (state) variables\n  ps = [M, b, k] # parameter variables\n  default_u0 = [D(x) =&gt; 0.0, x =&gt; 0.0] # default initial conditions\n  default_p = [M =&gt; 1.0, b =&gt; 1.0, k =&gt; 1.0] # default parameter values\n  sys = ODESystem(eqs, iv, states, ps, name=name, default_u0=default_u0, default_p=default_p)\n  ode_order_lowering(sys)\nend\n\nfunction spring_mass_damper_problem()\n  @named smd_sys = spring_mass_damper_system()\n  @show smd_sys\n  u0 = [] # initial conditions (empty = use defaults)\n  tspan = (0, 10.0) # time span\n  u0_kludge = Vector{Pair{Num, Float64}}() # <https://github.com/SciML/ModelingToolkit.jl/issues/869>\n  prob = ODEProblem(smd_sys, u0_kludge, tspan)\n  # return prob\n  sol = solve(prob, Tsit5())\nend\n\nsol = spring_mass_damper_problem()```\nGives me\n\n```ERROR: MethodError: no method matching promote_typeof()\nClosest candidates are:\n  promote_typeof(::Any) at promotion.jl:271\n  promote_typeof(::Any, ::Any...) at promotion.jl:272\nStacktrace:\n  [1] varmap_to_vars(varmap::Dict{Num, Float64}, varlist::Vector{Term{Real, Nothing}}; defaults::Dict{Any, Any})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/variables.jl:15\n  [2] varmap_to_vars\n    @ ~/.julia/dev/ModelingToolkit/src/variables.jl:8 [inlined]\n  [3] #varmap_to_vars#11\n    @ ~/.julia/dev/ModelingToolkit/src/variables.jl:28 [inlined]\n  [4] (::ModelingToolkit.var\"#varmap_to_vars##kw\")(::NamedTuple{(:defaults,), Tuple{Dict{Any, Any}}}, ::typeof(ModelingToolkit.varmap_to_vars), varmap::Vector{Pair{Num, Float64}}, varlist::Vector{Term{Real, Nothing}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/variables.jl:27\n  [5] process_DEProblem(constructor::Type, sys::ODESystem, u0map::Vector{Pair{Num, Float64}}, parammap::SciMLBase.NullParameters; version::Nothing, tgrad::Bool, jac::Bool, checkbounds::Bool, sparse::Bool, simplify::Bool, linenumbers::Bool, parallel::Symbolics.SerialForm, eval_expression::Bool, kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:277\n  [6] process_DEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:271 [inlined]\n  [7] (ODEProblem{true, tType, isinplace, P, F, K, PT} where {tType, isinplace, P, F, K, PT})(sys::ODESystem, u0map::Vector{Pair{Num, Float64}}, tspan::Tuple{Int64, Float64}, parammap::SciMLBase.NullParameters; kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323\n  [8] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323 [inlined]\n  [9] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323 [inlined]\n [10] #ODEProblem#162\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:303 [inlined]\n [11] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:303 [inlined]\n [12] spring_mass_damper_problem()\n    @ Main ~/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:78\n [13] top-level scope\n    @ ~/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:83\nin expression starting at /Users/patrick/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:83```\n","user":"U7ZNTQFLH","ts":"1615764328.128200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TO754","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function spring_mass_damper_system(;name)\n  @variables x(t)\n  D = Differential(t)\n  @parameters M b k\n  eqs = [D(D(x)) ~ b/M*D(x) + k/M*x] # equations defining the system\n  iv = t # the independent variable\n  states = [x] # the dependent (state) variables\n  ps = [M, b, k] # parameter variables\n  default_u0 = [D(x) => 0.0, x => 0.0] # default initial conditions\n  default_p = [M => 1.0, b => 1.0, k => 1.0] # default parameter values\n  sys = ODESystem(eqs, iv, states, ps, name=name, default_u0=default_u0, default_p=default_p)\n  ode_order_lowering(sys)\nend\n\nfunction spring_mass_damper_problem()\n  @named smd_sys = spring_mass_damper_system()\n  @show smd_sys\n  u0 = [] # initial conditions (empty = use defaults)\n  tspan = (0, 10.0) # time span\n  u0_kludge = Vector{Pair{Num, Float64}}() # "},{"type":"link","url":"https://github.com/SciML/ModelingToolkit.jl/issues/869"},{"type":"text","text":"\n  prob = ODEProblem(smd_sys, u0_kludge, tspan)\n  # return prob\n  sol = solve(prob, Tsit5())\nend\n\nsol = spring_mass_damper_problem()"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nGives me\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: MethodError: no method matching promote_typeof()\nClosest candidates are:\n  promote_typeof(::Any) at promotion.jl:271\n  promote_typeof(::Any, ::Any...) at promotion.jl:272\nStacktrace:\n  [1] varmap_to_vars(varmap::Dict{Num, Float64}, varlist::Vector{Term{Real, Nothing}}; defaults::Dict{Any, Any})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/variables.jl:15\n  [2] varmap_to_vars\n    @ ~/.julia/dev/ModelingToolkit/src/variables.jl:8 [inlined]\n  [3] #varmap_to_vars#11\n    @ ~/.julia/dev/ModelingToolkit/src/variables.jl:28 [inlined]\n  [4] (::ModelingToolkit.var\"#varmap_to_vars##kw\")(::NamedTuple{(:defaults,), Tuple{Dict{Any, Any}}}, ::typeof(ModelingToolkit.varmap_to_vars), varmap::Vector{Pair{Num, Float64}}, varlist::Vector{Term{Real, Nothing}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/variables.jl:27\n  [5] process_DEProblem(constructor::Type, sys::ODESystem, u0map::Vector{Pair{Num, Float64}}, parammap::SciMLBase.NullParameters; version::Nothing, tgrad::Bool, jac::Bool, checkbounds::Bool, sparse::Bool, simplify::Bool, linenumbers::Bool, parallel::Symbolics.SerialForm, eval_expression::Bool, kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:277\n  [6] process_DEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:271 [inlined]\n  [7] (ODEProblem{true, tType, isinplace, P, F, K, PT} where {tType, isinplace, P, F, K, PT})(sys::ODESystem, u0map::Vector{Pair{Num, Float64}}, tspan::Tuple{Int64, Float64}, parammap::SciMLBase.NullParameters; kwargs::Base.Iterators.Pairs{Union{}, Union{}, Tuple{}, NamedTuple{(), Tuple{}}})\n    @ ModelingToolkit ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323\n  [8] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323 [inlined]\n  [9] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:323 [inlined]\n [10] #ODEProblem#162\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:303 [inlined]\n [11] ODEProblem\n    @ ~/.julia/dev/ModelingToolkit/src/systems/diffeqs/abstractodesystem.jl:303 [inlined]\n [12] spring_mass_damper_problem()\n    @ Main ~/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:78\n [13] top-level scope\n    @ ~/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:83\nin expression starting at /Users/patrick/.julia/dev/ModelingToolkitExamples/examples/hellomtk.jl:83"}]},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1615764328.128200","reply_count":16,"reply_users_count":3,"latest_reply":"1615768157.133500","reply_users":["U69BL50BF","U6788D83U","U7ZNTQFLH"],"subscribed":false},{"client_msg_id":"72f5ea24-bea4-49b1-bb42-654c3f1ef154","type":"message","text":"it won't automatically construct a Lie group problem in reverse. That would be a good thing to add.","user":"U69BL50BF","ts":"1615764332.128400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"j3IYb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it won't automatically construct a Lie group problem in reverse. That would be a good thing to add."}]}]}]},{"client_msg_id":"11cc876f-230e-48de-9741-6187467c5652","type":"message","text":"Also, should it not be\" extend A by a column containing g, and furthermore a zero row, the corresponding state has initial condition 1.\"","user":"UQEDP1Q5V","ts":"1615764343.128500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/=T","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also, should it not be\" extend A by a column containing g, and furthermore a zero row, the corresponding state has initial condition 1.\""}]}]}]},{"client_msg_id":"541b9d4d-e5e9-4456-b04f-0b903873ca4f","type":"message","text":"Forward mode could benefit also by just adding zero rows to A? For example, for a reaction problem containing 500 u and 500 p?","user":"UQEDP1Q5V","ts":"1615765641.130000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"luFQi","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Forward mode could benefit also by just adding zero rows to A? For example, for a reaction problem containing 500 u and 500 p?"}]}]}]},{"client_msg_id":"01f606a5-58d9-4c23-a68b-496e296f602f","type":"message","text":"How can I create a step function of time to be included on the rhs of an ODE? My efforts so far all seem to result in `TypeError: non-boolean (Num) used in boolean context`.","user":"U7ZNTQFLH","ts":"1615770854.134800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bKAP/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How can I create a step function of time to be included on the rhs of an ODE? My efforts so far all seem to result in "},{"type":"text","text":"TypeError: non-boolean (Num) used in boolean context","style":{"code":true}},{"type":"text","text":"."}]}]}],"thread_ts":"1615770854.134800","reply_count":2,"reply_users_count":2,"latest_reply":"1615771658.135100","reply_users":["UQEDP1Q5V","U69BL50BF"],"subscribed":false},{"client_msg_id":"21dad35a-e2b7-436e-96b6-e0268ba9983a","type":"message","text":"Has anyone had success with Strang splitting for multidimensional PDEs in Julia?","user":"U01C2E6TYEM","ts":"1615839350.136900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"r7K","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Has anyone had success with Strang splitting for multidimensional PDEs in Julia?"}]}]}]},{"client_msg_id":"b11b83eb-d6a3-4f69-b05f-fc3fa3e558d5","type":"message","text":"doing it by hand?","user":"U69BL50BF","ts":"1615839417.137100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GP/c","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"doing it by hand?"}]}]}]},{"client_msg_id":"bf8ddab1-7f15-4485-b1e9-d812b122729d","type":"message","text":"Yeah","user":"U01C2E6TYEM","ts":"1615839457.137400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"isRlz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah"}]}]}]},{"client_msg_id":"d4607169-80e9-4d5a-aec9-c09d1c968182","type":"message","text":"I’m having some trouble setting up the underdamped langevin diffusion problem.","user":"UJVG2FBUJ","ts":"1615846893.138800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dUZrl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I’m having some trouble setting up the underdamped langevin diffusion problem."}]}]}]},{"client_msg_id":"7df66080-0025-41ac-8db1-437e2ed2c424","type":"message","text":"Here is my attempt.\n\n```function uld_f!(du, u, p, t)\n    γ, u = p\n    x = @view u[1:2]\n    v = @view u[3:4]\n    dx = @view du[1:2]\n    dv = @view du[3:4]\n    dx = v\n    dv = -γ*v -u*gradU(x)\nend\n\nfunction uld_g!(du, u, p, t)\n    γ, u = p\n    x = @view u[1:2]\n    v = @view u[3:4]\n    dx = @view du[1:2]\n    dv = @view du[3:4]\n    @. dx = 0.0\n    @. dv = sqrt(2*γ*u)*ones(2)\nend\n\nu0 = [1., 1., 0., 0.]\np = (0.1, 1)\ntspan = (0.0,1.0)\nULD = SDEProblem(uld_f!, uld_g!, u0, tspan, p)\n\nsol = solve(ULD, EM(), dt=0.0001)```\nI get the following error\n\n```MethodError: no method matching view(::Int64, ::UnitRange{Int64})\nClosest candidates are:\n  view(::AbstractAlgebra.Generic.Mat{T}, ::UnitRange{Int64}, ::UnitRange{Int64}) where T&lt;:AbstractAlgebra.RingElement at /Users/sivapvarma/.julia/packages/AbstractAlgebra/aF5Iw/src/generic/Matrix.jl:411\n  view(::StepRangeLen, ::OrdinalRange{var\"#s79\", S} where {var\"#s79\"&lt;:Integer, S}) at subarray.jl:198\n  view(::StepRange, ::AbstractRange{var\"#s79\"} where var\"#s79\"&lt;:Integer) at subarray.jl:194\n  ...\n\nStacktrace:\n  [1] uld_f!(du::Vector{Float64}, u::Vector{Float64}, p::Tuple{Float64, Int64}, t::Float64)```\nI think I setup the correct dimension of u by specifying u0. But it still considering u as a scalar, Int64 somehow.","user":"UJVG2FBUJ","ts":"1615847026.140500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"BhXJo","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Here is my attempt.\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function uld_f!(du, u, p, t)\n    γ, u = p\n    x = @view u[1:2]\n    v = @view u[3:4]\n    dx = @view du[1:2]\n    dv = @view du[3:4]\n    dx = v\n    dv = -γ*v -u*gradU(x)\nend\n\nfunction uld_g!(du, u, p, t)\n    γ, u = p\n    x = @view u[1:2]\n    v = @view u[3:4]\n    dx = @view du[1:2]\n    dv = @view du[3:4]\n    @. dx = 0.0\n    @. dv = sqrt(2*γ*u)*ones(2)\nend\n\nu0 = [1., 1., 0., 0.]\np = (0.1, 1)\ntspan = (0.0,1.0)\nULD = SDEProblem(uld_f!, uld_g!, u0, tspan, p)\n\nsol = solve(ULD, EM(), dt=0.0001)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nI get the following error\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"MethodError: no method matching view(::Int64, ::UnitRange{Int64})\nClosest candidates are:\n  view(::AbstractAlgebra.Generic.Mat{T}, ::UnitRange{Int64}, ::UnitRange{Int64}) where T<:AbstractAlgebra.RingElement at /Users/sivapvarma/.julia/packages/AbstractAlgebra/aF5Iw/src/generic/Matrix.jl:411\n  view(::StepRangeLen, ::OrdinalRange{var\"#s79\", S} where {var\"#s79\"<:Integer, S}) at subarray.jl:198\n  view(::StepRange, ::AbstractRange{var\"#s79\"} where var\"#s79\"<:Integer) at subarray.jl:194\n  ...\n\nStacktrace:\n  [1] uld_f!(du::Vector{Float64}, u::Vector{Float64}, p::Tuple{Float64, Int64}, t::Float64)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"I think I setup the correct dimension of u by specifying u0. But it still considering u as a scalar, Int64 somehow."}]}]}]},{"client_msg_id":"1f540201-80d0-4b0b-8736-f47c1b308d05","type":"message","text":"Found the issue, i’m redefining u when I unpack the parameters.","user":"UJVG2FBUJ","ts":"1615847464.141000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WRn0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Found the issue, i’m redefining u when I unpack the parameters."}]}]}]},{"client_msg_id":"8e33fb88-0f48-4d96-b255-e40559ab0c52","type":"message","text":"Hello!   I have a few questions about DiffEqFlux.sciml_train function.  I'm trying to use it to optimize some of the parameters of the ODE.\n• The ODE depends on 4 parameters and some function. Can I supply parameters and this additional functions to the \"solve\" method together somehow? Looks like DiffEqFlux.solve \"p\" argument can be only a vector....        \n            This ODe function supposed to be inside a module, could it be possible to pass another function as an argument to it (smth like  here <https://diffeq.sciml.ai/dev/tutorials/ode_example/#Example-3:-Solving-Nonhomogeneous-Equations-using-Parameterized-Functions> )\n• Can I use other packages inside ODE function? I was trying to use Dierckx   and then it tells me   `ERROR: MethodError: no method matching Float64(::ReverseDiff.TrackedReal{Float64, Float64, Nothing})`\n","user":"U01JZDCFD6H","ts":"1615855157.144600","team":"T68168MUP","edited":{"user":"U01JZDCFD6H","ts":"1615855479.000000"},"blocks":[{"type":"rich_text","block_id":"qde0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hello!   I have a few questions about DiffEqFlux.sciml_train function.  I'm trying to use it to optimize some of the parameters of the ODE.\n"}]},{"type":"rich_text_list","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"The ODE depends on 4 parameters and some function. Can I supply parameters and this additional functions to the \"solve\" method together somehow? Looks like DiffEqFlux.solve \"p\" argument can be only a vector....        "}]}],"style":"bullet","indent":0},{"type":"rich_text_section","elements":[{"type":"text","text":"            This ODe function supposed to be inside a module, could it be possible to pass another function as an argument to it (smth like  here "},{"type":"link","url":"https://diffeq.sciml.ai/dev/tutorials/ode_example/#Example-3:-Solving-Nonhomogeneous-Equations-using-Parameterized-Functions"},{"type":"text","text":" )\n"}]},{"type":"rich_text_list","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Can I use other packages inside ODE function? I was trying to use Dierckx   and then it tells me   "},{"type":"text","text":"ERROR: MethodError: no method matching Float64(::ReverseDiff.TrackedReal{Float64, Float64, Nothing})","style":{"code":true}}]}],"style":"bullet","indent":0},{"type":"rich_text_section","elements":[]}]}],"thread_ts":"1615855157.144600","reply_count":1,"reply_users_count":1,"latest_reply":"1615857754.003900","reply_users":["U69BL50BF"],"subscribed":false},{"type":"message","subtype":"bot_message","text":"Hello!   I have a question about DiffEqFlux.sciml_train  and solve functions: I have to have some interpolation inside my ODe function implementation... and trying to use Dierckx package for this. Then it tells me that  \"MethodError: no method matching Float64(::ReverseDiff.TrackedReal{Float64, Float64, Nothing})\". Are there any workarounds in this case?","ts":"1615856107.144800","username":"[gitter] <ig-or>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"Hello!   I have a question about DiffEqFlux.sciml_train  and solve functions: I have to have some interpolation inside my ODe function implementation... and trying to use Dierckx package for this. Then it tells me that  \"MethodError: no method matching Float64(::ReverseDiff.TrackedReal{Float64, Float64, Nothing})\". Are there any workarounds in this case?","verbatim":false}}]},{"client_msg_id":"7344fcac-d758-4315-ba00-7c18d92da5ac","type":"message","text":"<https://github.com/SciML/DiffEqSensitivity.jl/issues/395> even though it now gives the correct result, the number of partials is still still too high for zygote, making it a performance issue?","user":"UQEDP1Q5V","ts":"1615857500.002500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9CO","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/SciML/DiffEqSensitivity.jl/issues/395"},{"type":"text","text":" even though it now gives the correct result, the number of partials is still still too high for zygote, making it a performance issue?"}]}]}]},{"client_msg_id":"f26b039b-d809-47fc-acf8-5d9238ceec03","type":"message","text":"What do you mean?","user":"U69BL50BF","ts":"1615857682.003800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ft4K","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"What do you mean?"}]}]}]},{"client_msg_id":"9c5d48f4-be7f-43ff-9da3-a455f4d0eceb","type":"message","text":"ForwardDiff\n```ForwardDiff.Dual{ForwardDiff.Tag{typeof(cost),Float64},Float64,1}[Dual{ForwardDiff.Tag{typeof(cost),Float64}}(1.5,1.0), Dual{ForwardDiff.Tag{typeof(cost),Float64}}(1.0,0.0), Dual{ForwardDiff.Tag{typeof(cost),Float64}}(3.0,0.0), Dual{ForwardDiff.Tag{typeof(cost),Float64}}(1.0,0.0)]```\nZygote\n```ForwardDiff.Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64},Float64,4}[Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64}}(1.5,1.0,0.0,0.0,0.0), Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64}}(1.0,0.0,1.0,0.0,0.0), Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64}}(3.0,0.0,0.0,1.0,0.0), Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64}}(1.0,0.0,0.0,0.0,1.0)]```","user":"UQEDP1Q5V","ts":"1615857858.004500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KIyQG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ForwardDiff\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ForwardDiff.Dual{ForwardDiff.Tag{typeof(cost),Float64},Float64,1}[Dual{ForwardDiff.Tag{typeof(cost),Float64}}(1.5,1.0), Dual{ForwardDiff.Tag{typeof(cost),Float64}}(1.0,0.0), Dual{ForwardDiff.Tag{typeof(cost),Float64}}(3.0,0.0), Dual{ForwardDiff.Tag{typeof(cost),Float64}}(1.0,0.0)]"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Zygote\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ForwardDiff.Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64},Float64,4}[Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64}}(1.5,1.0,0.0,0.0,0.0), Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64}}(1.0,0.0,1.0,0.0,0.0), Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64}}(3.0,0.0,0.0,1.0,0.0), Dual{ForwardDiff.Tag{ODEFunction{true,typeof(fiip),UniformScaling{Bool},Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,Nothing,typeof(SciMLBase.DEFAULT_OBSERVED),Nothing},Float64}}(1.0,0.0,0.0,0.0,1.0)]"}]}]}]},{"client_msg_id":"76a20f5a-c2fe-4e9b-b611-72df4880766e","type":"message","text":"it's erroring after that?","user":"U69BL50BF","ts":"1615858146.004700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pIHt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it's erroring after that?"}]}]}]},{"client_msg_id":"a776bffd-a392-4787-a1cf-f6d6ca4b3b94","type":"message","text":"No it seems to work fine","user":"UQEDP1Q5V","ts":"1615858228.005100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cj4N","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No it seems to work fine"}]}]}]},{"client_msg_id":"e0d6533a-c251-4f50-9c0c-b8c20f6881f7","type":"message","text":"the issue is that I am only calculating the derivative towards the first parameter, yet there are 4 partials in the zygote implementation.","user":"UQEDP1Q5V","ts":"1615858319.006200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gn1S","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the issue is that I am only calculating the derivative towards the first parameter, yet there are 4 partials in the zygote implementation."}]}]}]},{"type":"message","subtype":"bot_message","text":"Thanks  chrisrackauckas, Looks like Interpolations.jl is working!","ts":"1615858322.006300","username":"[gitter] <ig-or>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"Thanks  chrisrackauckas, Looks like Interpolations.jl is working!","verbatim":false}}]},{"client_msg_id":"b03a39d6-9dcf-4bdf-bc7d-f5da03878f18","type":"message","text":"I'm having trouble overriding a default initial condition when constructing an ODEProblem","user":"U7ZNTQFLH","ts":"1615858355.007000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/j72P","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm having trouble overriding a default initial condition when constructing an ODEProblem"}]}]}]},{"client_msg_id":"2dc2b971-d817-4d36-a7d6-78beb14cec35","type":"message","text":"It should simply be something like `ODEProblem(sys, [sys.x =&gt; 42.0], (0.0, 10.0))`, right?","user":"U7ZNTQFLH","ts":"1615858413.007800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"y0ZUx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It should simply be something like "},{"type":"text","text":"ODEProblem(sys, [sys.x => 42.0], (0.0, 10.0))","style":{"code":true}},{"type":"text","text":", right?"}]}]}]},{"client_msg_id":"50ae4f09-c059-48f4-b08a-e0c886d143e4","type":"message","text":"Looks right","user":"U69BL50BF","ts":"1615861070.008500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Si0T","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Looks right"}]}]}]},{"client_msg_id":"e25737a8-d1e0-405a-b463-41c3b30467ef","type":"message","text":"It just silently ignores the updated value","user":"U7ZNTQFLH","ts":"1615861269.009200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NWyuL","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It just silently ignores the updated value"}]}]}],"thread_ts":"1615861269.009200","reply_count":1,"reply_users_count":1,"latest_reply":"1615861633.009300","reply_users":["UM8JUNJG7"],"subscribed":false},{"client_msg_id":"84e8e9e4-211c-457e-9c9f-87f487a423cf","type":"message","text":"100x accelerated uncertainty quantification of dynamical systems with Koopman Expectations? Come see how to use it with Pumas at the first Pumas 2.0 webinar at 12pm EST. Inviting the whole <https://twitter.com/hashtag/pharma?src=hashtag_click|#pharma>, <https://twitter.com/hashtag/julialang?src=hashtag_click|#julialang>, and <https://twitter.com/hashtag/sciml?src=hashtag_click|#sciml> community.\n\n<https://form.jotform.com/210605786318054>","user":"U69BL50BF","ts":"1615910088.010800","team":"T68168MUP","attachments":[{"title":"#pharma hashtag on Twitter","title_link":"https://twitter.com/hashtag/pharma?src=hashtag_click","text":"On Mar 15 @UPS_Healthcare tweeted: \"We recently added a 5,000 square foot co..\" - read what others are saying and join the conversation.","fallback":"#pharma hashtag on Twitter","from_url":"https://twitter.com/hashtag/pharma?src=hashtag_click","service_icon":"https://abs.twimg.com/icons/apple-touch-icon-192x192.png","service_name":"twitter.com","id":1,"original_url":"https://twitter.com/hashtag/pharma?src=hashtag_click"},{"title":"#julialang hashtag on Twitter","title_link":"https://twitter.com/hashtag/julialang?src=hashtag_click","text":"See Tweets about #julialang on Twitter. See what people are saying and join the conversation.","fallback":"#julialang hashtag on Twitter","from_url":"https://twitter.com/hashtag/julialang?src=hashtag_click","service_icon":"https://abs.twimg.com/icons/apple-touch-icon-192x192.png","service_name":"twitter.com","id":2,"original_url":"https://twitter.com/hashtag/julialang?src=hashtag_click"},{"title":"#sciml hashtag on Twitter","title_link":"https://twitter.com/hashtag/sciml?src=hashtag_click","text":"See Tweets about #sciml on Twitter. See what people are saying and join the conversation.","fallback":"#sciml hashtag on Twitter","from_url":"https://twitter.com/hashtag/sciml?src=hashtag_click","service_icon":"https://abs.twimg.com/icons/apple-touch-icon-192x192.png","service_name":"twitter.com","id":3,"original_url":"https://twitter.com/hashtag/sciml?src=hashtag_click"}],"blocks":[{"type":"rich_text","block_id":"GYdC3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"100x accelerated uncertainty quantification of dynamical systems with Koopman Expectations? Come see how to use it with Pumas at the first Pumas 2.0 webinar at 12pm EST. Inviting the whole "},{"type":"link","url":"https://twitter.com/hashtag/pharma?src=hashtag_click","text":"#pharma"},{"type":"text","text":", "},{"type":"link","url":"https://twitter.com/hashtag/julialang?src=hashtag_click","text":"#julialang"},{"type":"text","text":", and "},{"type":"link","url":"https://twitter.com/hashtag/sciml?src=hashtag_click","text":"#sciml"},{"type":"text","text":" community.\n\n"},{"type":"link","url":"https://form.jotform.com/210605786318054"}]}]}],"thread_ts":"1615910088.010800","reply_count":1,"reply_users_count":1,"latest_reply":"1615910568.011200","reply_users":["U69BL50BF"],"subscribed":false,"reactions":[{"name":"fast_parrot","users":["U9MED583T"],"count":1}]},{"client_msg_id":"1cd28455-f1d7-41a5-9d24-e6229030bc12","type":"message","text":"(i.e. 5 minutes!)","user":"U69BL50BF","ts":"1615910098.011100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MkiS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"(i.e. 5 minutes!)"}]}]}]},{"client_msg_id":"7d2e00ee-c08c-448f-baf3-de8012efef95","type":"message","text":"<https://discourse.julialang.org/t/new-julia-package-for-f16-aircraft-model/57323>","user":"U7ZNTQFLH","ts":"1615923982.012900","team":"T68168MUP","attachments":[{"service_name":"JuliaLang","title":"New Julia Package for F16 Aircraft Model","title_link":"https://discourse.julialang.org/t/new-julia-package-for-f16-aircraft-model/57323","text":"F16Model.jl is a Julia package for a nonlinear model of the F16 aircraft. The aerodynamics included in this model come from the NASA Technical Report 1538, Simulator Study of Stall/Post-Stall Characteristics of a Fighter Airplane with Relaxed Longitudinal Static Stability , by Nguyen, Ogburn, Gilbert, Kibler, Brown, and Deal, Dec 1979. The model is based on Aircraft Control and Simulations , by Brian Stevens and Frank Lewis, Wiley Inter-Science, New York, 1992. This Julia package is inspired by...","fallback":"JuliaLang: New Julia Package for F16 Aircraft Model","thumb_url":"https://aws1.discourse-cdn.com/business5/uploads/julialang/original/2X/1/12829a7ba92b924d4ce81099cbf99785bee9b405.png","fields":[{"title":"Reading time","value":"1 mins :clock2:","short":true},{"title":"Likes","value":"6 :heart:","short":true}],"ts":1615919070,"from_url":"https://discourse.julialang.org/t/new-julia-package-for-f16-aircraft-model/57323","thumb_width":408,"thumb_height":263,"service_icon":"https://aws1.discourse-cdn.com/business5/uploads/julialang/optimized/2X/6/6ca888e296f59ca2a599807f7d5edd489e3d1829_2_180x180.png","id":1,"original_url":"https://discourse.julialang.org/t/new-julia-package-for-f16-aircraft-model/57323"}],"blocks":[{"type":"rich_text","block_id":"uOgl","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://discourse.julialang.org/t/new-julia-package-for-f16-aircraft-model/57323"}]}]}]},{"client_msg_id":"1706e40b-f31b-46fe-8129-4b37a5501566","type":"message","text":"^ would love to see this interfaced with/implemented in MTK (and might take a stab at it)","user":"U7ZNTQFLH","ts":"1615924021.013800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LpdZT","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"^ would love to see this interfaced with/implemented in MTK (and might take a stab at it)"}]}]}]},{"client_msg_id":"94126892-b165-4b7b-a86c-e0fb90e9892f","type":"message","text":"Hi everyone, my name is Ilia, I’m a PhD student working on algorithms for structural identifiability of ODE models. I wanted to help out in implementing some local and/or global identifiability algorithms for MTK and Symbolics.jl.","user":"U01K1S5RZB9","ts":"1615949090.016800","team":"T68168MUP","edited":{"user":"U01K1S5RZB9","ts":"1615949118.000000"},"blocks":[{"type":"rich_text","block_id":"K0mM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hi everyone, my name is Ilia, I’m a PhD student working on algorithms for structural identifiability of ODE models. I wanted to help out in implementing some local and/or global identifiability algorithms for MTK and Symbolics.jl."}]}]}],"reactions":[{"name":"+1","users":["U69BL50BF"],"count":1},{"name":"+1::skin-tone-4","users":["U0138UTB7A4"],"count":1}]},{"client_msg_id":"81f54c4a-7932-43be-bfb7-d965e1a96f27","type":"message","text":"welcome!","user":"U69BL50BF","ts":"1615949148.017200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LBs","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"welcome!"}]}]}],"reactions":[{"name":"100","users":["U01K1S5RZB9"],"count":1}]},{"client_msg_id":"da37f246-63c6-40c0-a2e7-f45badadedcd","type":"message","text":"thank you! :slightly_smiling_face:","user":"U01K1S5RZB9","ts":"1615949228.017500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"r9g8l","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"thank you! "},{"type":"emoji","name":"slightly_smiling_face"}]}]}]},{"client_msg_id":"9ad4d191-5a4c-4cf8-a87e-6c7694c7b684","type":"message","text":"Is it possible or recommended to solve a secondary \"nested\" ODE system from within the step function of the outer system?","user":"U01H36BUDJB","ts":"1616075843.019300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8iYg","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is it possible or recommended to solve a secondary \"nested\" ODE system from within the step function of the outer system?"}]}]}]},{"client_msg_id":"ef087348-53da-4450-8765-f358f5391a02","type":"message","text":"what do you mean?","user":"U69BL50BF","ts":"1616076463.019700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=9z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"what do you mean?"}]}]}]},{"client_msg_id":"33064151-8b3b-486c-92be-26ca60e5ecf5","type":"message","text":"solve a separate system of equations at each time step from within f","user":"U01H36BUDJB","ts":"1616077433.020400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DEjP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"solve a separate system of equations at each time step from within f"}]}]}]},{"client_msg_id":"32a87548-98fe-420c-96e3-0cb2ca6ca436","type":"message","text":"You can do that","user":"U69BL50BF","ts":"1616077502.020600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"N7zRD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You can do that"}]}]}]},{"client_msg_id":"7fb186e0-29e6-4161-936b-8ee059f45a11","type":"message","text":"Ok. But I would imagine it causes issues with sensitivity analysis, right?","user":"U01H36BUDJB","ts":"1616077555.021100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"sIE","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Ok. But I would imagine it causes issues with sensitivity analysis, right?"}]}]}]},{"client_msg_id":"344ac38c-75a1-45de-a87f-2844835353ce","type":"message","text":"it should just nest the differentiation","user":"U69BL50BF","ts":"1616077802.021300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"u5Ut","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it should just nest the differentiation"}]}]}]},{"client_msg_id":"517ec533-56f6-403c-9566-d1559af6827a","type":"message","text":"I haven't tried it, but it sounds fun.","user":"U69BL50BF","ts":"1616077808.021500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xZ1j","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I haven't tried it, but it sounds fun."}]}]}]},{"client_msg_id":"2CB01824-BE21-422C-B17A-28E451A3F248","type":"message","text":"Wrap that inner solve in an optimizer and you’ve essentially got model predictive control.","user":"US4A6G6B0","ts":"1616081669.022600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"g2u","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Wrap that inner solve in an optimizer and you’ve essentially got model predictive control."}]}]}]},{"client_msg_id":"4B83C75F-BA46-4502-AF52-618354B10950","type":"message","text":"Although you really would want those inner solves to happen at longer fixed time steps with a callback, not at every step of the simulation.","user":"US4A6G6B0","ts":"1616081849.024100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"2qH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Although you really would want those inner solves to happen at longer fixed time steps with a callback, not at every step of the simulation."}]}]}]},{"client_msg_id":"f2850e1b-6ff3-47cc-9e54-3887dc3783a9","type":"message","text":"In ModelingToolkit, is there a way to define a parameter that has numbers as its fields, rather than being a number itself? e.g. I define a struct with fields `e` and `i` so that `@parameter A` (or whatever more complicated definition) can then be in an equation as `A.e + A.i` ?","user":"U7MU896SE","ts":"1616092559.026400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"siyx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In ModelingToolkit, is there a way to define a parameter that has numbers as its fields, rather than being a number itself? e.g. I define a struct with fields "},{"type":"text","text":"e","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"i","style":{"code":true}},{"type":"text","text":" so that "},{"type":"text","text":"@parameter A","style":{"code":true}},{"type":"text","text":" (or whatever more complicated definition) can then be in an equation as "},{"type":"text","text":"A.e + A.i","style":{"code":true}},{"type":"text","text":" ?"}]}]}]},{"client_msg_id":"fce16546-c359-4bd1-a27d-c6c5181d01f1","type":"message","text":"not right now","user":"U69BL50BF","ts":"1616092757.029000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=z1PB","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"not right now"}]}]}]},{"client_msg_id":"e28ff9bc-7a39-48b2-b08d-ff968f1da85d","type":"message","text":"Err, `FieldVector` from StaticArrays.jl","user":"U69BL50BF","ts":"1616092773.029400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1pX/0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Err, "},{"type":"text","text":"FieldVector","style":{"code":true}},{"type":"text","text":" from StaticArrays.jl"}]}]}],"thread_ts":"1616092773.029400","reply_count":1,"reply_users_count":1,"latest_reply":"1616094024.030500","reply_users":["U7MU896SE"],"subscribed":false,"reactions":[{"name":"+1","users":["U7MU896SE"],"count":1}]},{"client_msg_id":"4b24e598-c078-4313-8250-d57c0cbca1cd","type":"message","text":"Also, if I define `@parameters theta t` and say `@variables u(t)` and `D = Differential(t)` and then have in my equation `D(u) ~ conv(kernel(theta), u)` , will it cleverly notice that `kernel(theta)` is always the same for given parameterization and precompute it, or do I need to make that a separate parameter?","user":"U7MU896SE","ts":"1616092833.030300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"J0jL0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also, if I define "},{"type":"text","text":"@parameters theta t","style":{"code":true}},{"type":"text","text":" and say "},{"type":"text","text":"@variables u(t)","style":{"code":true}},{"type":"text","text":" and "},{"type":"text","text":"D = Differential(t)","style":{"code":true}},{"type":"text","text":" and then have in my equation "},{"type":"text","text":"D(u) ~ conv(kernel(theta), u)","style":{"code":true}},{"type":"text","text":" , will it cleverly notice that "},{"type":"text","text":"kernel(theta)","style":{"code":true}},{"type":"text","text":" is always the same for given parameterization and precompute it, or do I need to make that a separate parameter?"}]}]}]},{"client_msg_id":"f88083d2-59d7-4a9e-83f8-fb1b0b019b5e","type":"message","text":"Is there any spatial Gillespie simulation implementation in the diffeq ecosystem?","user":"U01J62981NK","ts":"1616103160.035400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tlCvi","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there any spatial Gillespie simulation implementation in the diffeq ecosystem?"}]}]}],"thread_ts":"1616103160.035400","reply_count":5,"reply_users_count":3,"latest_reply":"1616105757.045300","reply_users":["U69BL50BF","UFTJ2UDEW","U01J62981NK"],"subscribed":false},{"client_msg_id":"4097be87-5b62-4f88-9107-f7015455a8d4","type":"message","text":"<@U69BL50BF> I'm using a BatchFastDense layer, which is basically just FastDense but with K independant channels. Is it something useful I should just upstream ?\n\nAlso, why is there\n\n```if !isgpu(p)\n    W = @view p[reshape(1:(f.out*f.in),f.out,f.in)]\n  else\n    W = reshape(@view(p[1:(f.out*f.in)]),f.out,f.in)\n  end```\nin the current code ? I don't understand why the order matters on GPU vs CPU","user":"UKJSNT1QR","ts":"1616103426.037200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"9vNyI","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U69BL50BF"},{"type":"text","text":" I'm using a BatchFastDense layer, which is basically just FastDense but with K independant channels. Is it something useful I should just upstream ?\n\nAlso, why is there\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"if !isgpu(p)\n    W = @view p[reshape(1:(f.out*f.in),f.out,f.in)]\n  else\n    W = reshape(@view(p[1:(f.out*f.in)]),f.out,f.in)\n  end"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"in the current code ? I don't understand why the order matters on GPU vs CPU"}]}]}],"thread_ts":"1616103426.037200","reply_count":1,"reply_users_count":1,"latest_reply":"1616103985.037300","reply_users":["U69BL50BF"],"subscribed":false},{"client_msg_id":"bd24cf7c-326f-4598-a7e4-8414656abe10","type":"message","text":"I'm trying to improve type stability in `DiffEqUncertainty.expectation()` and saw that `QuadratureProblem()`  was type unstable.  It is unclear to me why.\n```@code_warntype QuadratureProblem((x,p)-&gt;sin(x[1]), -1.0, 1.0)```","user":"UP95S4864","ts":"1616179641.051500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"g1cf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm trying to improve type stability in "},{"type":"text","text":"DiffEqUncertainty.expectation()","style":{"code":true}},{"type":"text","text":" and saw that "},{"type":"text","text":"QuadratureProblem()","style":{"code":true}},{"type":"text","text":"  was type unstable.  It is unclear to me why.\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"@code_warntype QuadratureProblem((x,p)->sin(x[1]), -1.0, 1.0)"}]}]}],"thread_ts":"1616179641.051500","reply_count":7,"reply_users_count":3,"latest_reply":"1616180067.052800","reply_users":["UP95S4864","U69BL50BF","U8T9JUA5R"],"subscribed":false},{"client_msg_id":"bd107717-ff0f-436a-9a13-b8568834af64","type":"message","text":"I’m starting to play with ODE solvers, but as I’m a Julia newbie I’m struggling with some basic errors.\n\nI’d like to solve the following super simple ODE:\n```function MB!(∂MB, params, t)\n    T_melt = 0.0\n    α, μ, P, T  = params\n    ∂MB = α*P - μ*max(T-T_melt, 0.0)\nend```\nThen I’m defining the parameters and trying to solve the ODE:\n```tspan = (0.0f0,10.0f0)\nMB₀ = 0.0f0\np = Float32[1.3, 3.5, 10.0, 8.0]\nprob = ODEProblem(MB!, MB₀, tspan, p)\n\nsolution = solve(prob, Vern7())```\nBut I’m getting the following error:\n```ERROR: LoadError: MethodError: no method matching similar(::Float32, ::Type{Float32})```\nWhat’s actually going on here? Moreover, function MB! appears as a “generic function with 2 methods”. Why are there two methods?\n\nThanks a lot in advance!","user":"U01QV28FEHL","ts":"1616183175.055900","team":"T68168MUP","edited":{"user":"U01QV28FEHL","ts":"1616183315.000000"},"blocks":[{"type":"rich_text","block_id":"Otqm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I’m starting to play with ODE solvers, but as I’m a Julia newbie I’m struggling with some basic errors.\n\nI’d like to solve the following super simple ODE:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function MB!(∂MB, params, t)\n    T_melt = 0.0\n    α, μ, P, T  = params\n    ∂MB = α*P - μ*max(T-T_melt, 0.0)\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Then I’m defining the parameters and trying to solve the ODE:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"tspan = (0.0f0,10.0f0)\nMB₀ = 0.0f0\np = Float32[1.3, 3.5, 10.0, 8.0]\nprob = ODEProblem(MB!, MB₀, tspan, p)\n\nsolution = solve(prob, Vern7())"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"But I’m getting the following error:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: LoadError: MethodError: no method matching similar(::Float32, ::Type{Float32})"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nWhat’s actually going on here? Moreover, function MB! appears as a “generic function with 2 methods”. Why are there two methods?\n\nThanks a lot in advance!"}]}]}],"thread_ts":"1616183175.055900","reply_count":20,"reply_users_count":3,"latest_reply":"1616185012.071800","reply_users":["UM8JUNJG7","US4A6G6B0","U01QV28FEHL"],"subscribed":false},{"client_msg_id":"f918887b-a575-4e42-b911-e4ce1a0ed934","type":"message","text":"I'm not sure what your ODE is supposed to be?","user":"U69BL50BF","ts":"1616183262.056200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7gD","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm not sure what your ODE is supposed to be?"}]}]}]},{"client_msg_id":"155c3c25-cf9c-4a0f-bf71-c2199181cae8","type":"message","text":"See <https://diffeq.sciml.ai/stable/tutorials/ode_example/#Example-2:-Solving-Systems-of-Equations> as an example","user":"U69BL50BF","ts":"1616183279.056600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"iBh","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"See "},{"type":"link","url":"https://diffeq.sciml.ai/stable/tutorials/ode_example/#Example-2:-Solving-Systems-of-Equations"},{"type":"text","text":" as an example"}]}]}]},{"client_msg_id":"d3a3eebf-79bf-4c7d-92d4-90fbc68119f7","type":"message","text":"Btw, <@U69BL50BF>, in case you find yourself in need of some examples of UDEs being used \"in the wild\":\n<https://meetingorganizer.copernicus.org/EGU21/EGU21-13409.html>","user":"U01H36BUDJB","ts":"1616261246.072700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"P4kN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Btw, "},{"type":"user","user_id":"U69BL50BF"},{"type":"text","text":", in case you find yourself in need of some examples of UDEs being used \"in the wild\":\n"},{"type":"link","url":"https://meetingorganizer.copernicus.org/EGU21/EGU21-13409.html"}]}]}],"thread_ts":"1616261246.072700","reply_count":1,"reply_users_count":1,"latest_reply":"1616261342.072900","reply_users":["U69BL50BF"],"subscribed":false},{"client_msg_id":"f404c25c-95a0-4932-b19c-d52fb5488146","type":"message","text":"Is there any off-the-shelf quasi-newton solver with a sparse jacobian? Or more general when jacobian is sparse is there any value added for a quasi-newton method compared to full newton?","user":"USTUBS9ED","ts":"1616278346.075500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qE6","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there any off-the-shelf quasi-newton solver with a sparse jacobian? Or more general when jacobian is sparse is there any value added for a quasi-newton method compared to full newton?"}]}]}]},{"type":"message","subtype":"bot_message","text":"Hello all, I would like to develop a discrete element method (DEM) framework for granular media simulation that’s as well integrated with the SciML stack as possible - granular media being anything from pharma powders to rocks to galaxies (but mainly the former). Though DEM is very closely related to rigid body dynamics and molecular dynamics, it focuses on contact forces between “soft particles” with complex shapes. Fundamentally, it is just a huge system of ODEs or DAEs, but “huge” is the key word - with granular media, you need at least a million particles to capture complex dynamics. So using collision detection acceleration structures (octrees or bounding volume hierarchies / BVH) and multi-node parallelism is necessary. Having close integration with packages such as `ModellingToolkit.jl` would of course be amazing, but I wonder how well they would play with e.g. BVHs or non-standard DE values computations (computing the contact force between two particles involves finding their intersection distance, which would be done in an external C library) - things like sparsity detection or simplifications would not be possible, would they? ","ts":"1616293059.084500","username":"[gitter] <anicusan>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"Hello all, I would like to develop a discrete element method (DEM) framework for granular media simulation that’s as well integrated with the SciML stack as possible - granular media being anything from pharma powders to rocks to galaxies (but mainly the former). Though DEM is very closely related to rigid body dynamics and molecular dynamics, it focuses on contact forces between “soft particles” with complex shapes. Fundamentally, it is just a huge system of ODEs or DAEs, but “huge” is the key word - with granular media, you need at least a million particles to capture complex dynamics. So using collision detection acceleration structures (octrees or bounding volume hierarchies / BVH) and multi-node parallelism is necessary. Having close integration with packages such as `ModellingToolkit.jl` would of course be amazing, but I wonder how well they would play with e.g. BVHs or non-standard DE values computations (computing the contact force between two particles involves finding their intersection distance, which would be done in an external C library) - things like sparsity detection or simplifications would not be possible, would they? ","verbatim":false}}]},{"type":"message","subtype":"bot_message","text":"This is a rather broad / open-ended question, but any pointers from more experienced SciML developers on how such a specialised simulator might be integrated with the rest of the stack would be greatly appreciated!","ts":"1616293177.084600","username":"[gitter] <anicusan>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"This is a rather broad / open-ended question, but any pointers from more experienced SciML developers on how such a specialised simulator might be integrated with the rest of the stack would be greatly appreciated!","verbatim":false}}]},{"client_msg_id":"2d3950cc-eca0-4180-94e4-c9ea5e27a608","type":"message","text":"@anicusan for the C calls you would need to register a few things, define derivatives, etc. And then it should play nicely","user":"U69BL50BF","ts":"1616297523.086000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Mq6d/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"@anicusan for the C calls you would need to register a few things, define derivatives, etc. And then it should play nicely"}]}]}]},{"client_msg_id":"19decd2d-c99e-43f3-aedf-81bbdaa52312","type":"message","text":"For the system you describe we may need to have state selection in MTK, which will be there but isn't right now. About a month or so.","user":"U69BL50BF","ts":"1616297558.087200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dCu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"For the system you describe we may need to have state selection in MTK, which will be there but isn't right now. About a month or so."}]}]}]},{"type":"message","subtype":"bot_message","text":"What exactly does “state selection” in ModellingToolkit refer to? If you have any resource I could read on it, it might be useful","ts":"1616336266.087300","username":"[gitter] <anicusan>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"What exactly does “state selection” in ModellingToolkit refer to? If you have any resource I could read on it, it might be useful","verbatim":false}}]},{"client_msg_id":"b88a4ffe-2aa6-45be-88be-5db7e6c955bf","type":"message","text":"See Dymola symbolics articles. It has to do with nonlinear tearing and choosing variables to get nonsingular systems. It shows up in rigid body dynamics if you want to make it robust","user":"U69BL50BF","ts":"1616337940.088900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OXUEO","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"See Dymola symbolics articles. It has to do with nonlinear tearing and choosing variables to get nonsingular systems. It shows up in rigid body dynamics if you want to make it robust"}]}]}]},{"client_msg_id":"1ddd161e-184f-4ad8-89f4-94050acf1c7d","type":"message","text":"Hey folks, I just wanted to check, but for `DiscreteProblem`, the timestep is expected to be 1 right. Meaning if I have a problem like\n```prob = DiscreteProblem(modelfunc!, u0, tspan, params)```\nand `tspan = [0, 20]`, then that should represent 2 timesteps right. It will not discretize that range into something smaller? For some reason I am getting so relatively large numbers even with low probabilities. So I was just going through each possible source where I might me messing things up.","user":"UDDSTBX19","ts":"1616348593.092500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"PcW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Hey folks, I just wanted to check, but for "},{"type":"text","text":"DiscreteProblem","style":{"code":true}},{"type":"text","text":", the timestep is expected to be 1 right. Meaning if I have a problem like\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"prob = DiscreteProblem(modelfunc!, u0, tspan, params)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"and "},{"type":"text","text":"tspan = [0, 20]","style":{"code":true}},{"type":"text","text":", then that should represent 2 timesteps right. It will not discretize that range into something smaller? For some reason I am getting so relatively large numbers even with low probabilities. So I was just going through each possible source where I might me messing things up."}]}]}]},{"client_msg_id":"05b52f82-3ce0-4b2e-a862-2e463e7c28b6","type":"message","text":"you can choose a dt but it defaults to 1","user":"U69BL50BF","ts":"1616348827.092800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fKRm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"you can choose a dt but it defaults to 1"}]}]}]},{"client_msg_id":"db9abf41-60ab-41f0-87cf-4570e3594d6b","type":"message","text":"Yeah, that is what I thought. I am wondering if I am falling afoul of any of those passing a reference issues.  Here is a very simple toy example. I don't want to pull you into debugging too much here, but the julia references stuff is still a little ambiguous to me. I am using `du` as a preallocated array. But then I use it as a parameter for my binomial distribution--in that number represents the number of trials, with a given rate. It does not seem like this should be an issue, but I am just trying to cover my bases.\n\n```function original_model!(du, u0::ComponentArray, p::ModelParams, t)\n    #step1\n    du[1] = u0.group1 - rand(Binomial(u0.group1, p.rag1))\n    du[2] = u0.group2 - rand(Binomial(u0.group2, p.rag2))\n\n    # step2\n    du[1] += rand(Binomial(du[1], p.rhag1))   &lt;--- is using du[1] here okay, or does it mess up the references?\n    du[2] += rand(Binomial(du[2], p.rhag2))\n    du```","user":"UDDSTBX19","ts":"1616349531.097000","team":"T68168MUP","edited":{"user":"UDDSTBX19","ts":"1616349549.000000"},"blocks":[{"type":"rich_text","block_id":"y5TnV","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah, that is what I thought. I am wondering if I am falling afoul of any of those passing a reference issues.  Here is a very simple toy example. I don't want to pull you into debugging too much here, but the julia references stuff is still a little ambiguous to me. I am using "},{"type":"text","text":"du","style":{"code":true}},{"type":"text","text":" as a preallocated array. But then I use it as a parameter for my binomial distribution--in that number represents the number of trials, with a given rate. It does not seem like this should be an issue, but I am just trying to cover my bases.\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function original_model!(du, u0::ComponentArray, p::ModelParams, t)\n    #step1\n    du[1] = u0.group1 - rand(Binomial(u0.group1, p.rag1))\n    du[2] = u0.group2 - rand(Binomial(u0.group2, p.rag2))\n\n    # step2\n    du[1] += rand(Binomial(du[1], p.rhag1))   <--- is using du[1] here okay, or does it mess up the references?\n    du[2] += rand(Binomial(du[2], p.rhag2))\n    du"}]}]}]},{"client_msg_id":"9af46cd4-80fd-4eb2-8c70-895619986de1","type":"message","text":"looks fine","user":"U69BL50BF","ts":"1616349664.097400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Uzu","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"looks fine"}]}]}]},{"client_msg_id":"5c200ed5-e040-41b3-a4bb-954e1e9efa38","type":"message","text":"Okay that is good to know. I was worried about having `du[1]` on both sides. I mean it would normally be fine in python, but I was a bit less certain in julia. But all good. I commence to step through my code :slightly_smiling_face:.","user":"UDDSTBX19","ts":"1616349748.098700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bRw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Okay that is good to know. I was worried about having "},{"type":"text","text":"du[1]","style":{"code":true}},{"type":"text","text":" on both sides. I mean it would normally be fine in python, but I was a bit less certain in julia. But all good. I commence to step through my code "},{"type":"emoji","name":"slightly_smiling_face"},{"type":"text","text":"."}]}]}]},{"type":"message","subtype":"bot_message","text":"For an ODE system like the following ``` function rhs!(dQ,Q,p,t)     u = @view Q[:,1]     v = @view Q[:,2]     dQ[:,1] .= u     dQ[:,2] .= v     return nothing end ``` I'm finding that storing `Q` as a VectorOfArray with underlying array of arrays storage works ``` Q = VectorOfArray([randn(5),randn(5)]) ``` but using an underlying `SVector` format doesn't. ``` Q = VectorOfArray(SVector{2}(randn(5),randn(5))) ``` Is this expected?  The `SVector` gives an error `ERROR: LoadError: MethodError: no method matching OrdinaryDiffEq.Tsit5Cache(::VectorOfArray{Float64,2,SArray{Tuple{2},Array{Float64,1},1,2}}, ...`","ts":"1616356351.098800","username":"[gitter] <jlchan>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"For an ODE system like the following\n```\nfunction rhs!(dQ,Q,p,t)\n    u = @view Q[:,1]\n    v = @view Q[:,2]\n    dQ[:,1] .= u\n    dQ[:,2] .= v\n    return nothing\nend\n```\nI'm finding that storing `Q` as a VectorOfArray with underlying array of arrays storage works\n```\nQ = VectorOfArray([randn(5),randn(5)])\n```\nbut using an underlying `SVector` format doesn't.\n```\nQ = VectorOfArray(SVector{2}(randn(5),randn(5)))\n```\nIs this expected?\n\nThe `SVector` gives an error `ERROR: LoadError: MethodError: no method matching OrdinaryDiffEq.Tsit5Cache(::VectorOfArray{Float64,2,SArray{Tuple{2},Array{Float64,1},1,2}}, ...`","verbatim":false}}]},{"client_msg_id":"9430ba92-ea7b-4bd9-ad97-0f1774dd0bf4","type":"message","text":"share a full example as an issue in OrdinaryDiffEq.","user":"U69BL50BF","ts":"1616356714.099100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GXLn=","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"share a full example as an issue in OrdinaryDiffEq."}]}]}]},{"type":"message","subtype":"bot_message","text":"will do - thanks","ts":"1616356736.099200","username":"[gitter] <jlchan>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"will do - thanks","verbatim":false}}]},{"type":"message","subtype":"bot_message","text":"done - at <https://github.com/SciML/OrdinaryDiffEq.jl/issues/1365>","ts":"1616356889.099300","username":"[gitter] <jlchan>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"done - at <https://github.com/SciML/OrdinaryDiffEq.jl/issues/1365>","verbatim":false}}]},{"client_msg_id":"6e03ca18-cd2b-4e25-a2e3-c1f2584a7cd5","type":"message","text":"A quick question about average lifetimes of subsequent population. I have looked for the answer but couldn't find anything thus far. Any pointers appreciated. The question can one calculate the average lifetime over both population combine for the following equations:\n```function _model_pdc_1(du,u,p,t, U_func, R)\n    LpDCm, LpDCb = u\n    R_pDC = R\n    p_pDCbm, δ_pDCbm, δ_pDCb, λ_pDC = p[1:(end-4)]\n    fr, delta, frac, tau = p[(end-3):end]\n\n    U = U_func(t, fr, delta, frac, tau)\n\n    du[1] = p_pDCbm * U - (δ_pDCbm + λ_pDC) * LpDCm ##pDCm\n\n    du[2] = λ_pDC * R_pDC * LpDCm - δ_pDCb * LpDCb ##pDCb\nend```\nwhere the average lifetime for the two population are defined as `τ1 = 1/(δ_pDCbm + λ_pDC)` and  `τ2 = 1/δ_pDCb` . So my question can one calculate the average lifetime a cell spends in the two states combined before \"dying\"?","user":"UGFMDAMC3","ts":"1616371813.104200","team":"T68168MUP","edited":{"user":"UGFMDAMC3","ts":"1616372086.000000"},"blocks":[{"type":"rich_text","block_id":"O8Gt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"A quick question about average lifetimes of subsequent population. I have looked for the answer but couldn't find anything thus far. Any pointers appreciated. The question can one calculate the average lifetime over both population combine for the following equations:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"function _model_pdc_1(du,u,p,t, U_func, R)\n    LpDCm, LpDCb = u\n    R_pDC = R\n    p_pDCbm, δ_pDCbm, δ_pDCb, λ_pDC = p[1:(end-4)]\n    fr, delta, frac, tau = p[(end-3):end]\n\n    U = U_func(t, fr, delta, frac, tau)\n\n    du[1] = p_pDCbm * U - (δ_pDCbm + λ_pDC) * LpDCm ##pDCm\n\n    du[2] = λ_pDC * R_pDC * LpDCm - δ_pDCb * LpDCb ##pDCb\nend"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"where the average lifetime for the two population are defined as "},{"type":"text","text":"τ1 = 1/(δ_pDCbm + λ_pDC)","style":{"code":true}},{"type":"text","text":" and  "},{"type":"text","text":"τ2 = 1/δ_pDCb","style":{"code":true}},{"type":"text","text":" . So my question can one calculate the average lifetime a cell spends in the two states combined before \"dying\"?"}]}]}]},{"type":"message","subtype":"bot_message","text":"Hello, I'm looking at using Julia for some simulation work, as soon I will not be able to use MATLAB . In MATLAB there is a function called [equationsToMatrix()](<https://www.mathworks.com/help/symbolic/sym.equationstomatrix.html>) and was wondering if there is an equivalent in the SciML ecosystem? I didn't see one in a look through some documentation. I've found it pretty useful for evaluating coupled ODEs in the past by converting to a mass matrix Ax=B form.","ts":"1616392737.104500","username":"[gitter] <RossSmyth>","bot_id":"B795XHD0X","attachments":[{"title":"Convert linear equations to matrix form - MATLAB equationsToMatrix","title_link":"https://www.mathworks.com/help/symbolic/sym.equationstomatrix.html","text":"This MATLAB function converts equations eqns to matrix form.","fallback":"Convert linear equations to matrix form - MATLAB equationsToMatrix","from_url":"https://www.mathworks.com/help/symbolic/sym.equationstomatrix.html","service_icon":"https://www.mathworks.com/favicon.ico","service_name":"mathworks.com","id":1,"original_url":"https://www.mathworks.com/help/symbolic/sym.equationstomatrix.html"}],"blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"Hello, I'm looking at using Julia for some simulation work, as soon I will not be able to use MATLAB . In MATLAB there is a function called [equationsToMatrix()](<https://www.mathworks.com/help/symbolic/sym.equationstomatrix.html>) and was wondering if there is an equivalent in the SciML ecosystem? I didn't see one in a look through some documentation. I've found it pretty useful for evaluating coupled ODEs in the past by converting to a mass matrix Ax=B form.","verbatim":false}}],"edited":{"user":"B795XHD0X","ts":"1616392737.000000"}},{"client_msg_id":"54a24c18-52a6-409a-8986-7a233ec7a871","type":"message","text":"@RossSmyth Just use ModelingToolkit.jl or Symbolics.jl directly and calculate the Jacobian.","user":"U69BL50BF","ts":"1616409332.105300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"FNH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"@RossSmyth Just use ModelingToolkit.jl or Symbolics.jl directly and calculate the Jacobian."}]}]}]},{"type":"message","subtype":"bot_message","text":"Quick question: is it possible to use callbacks for a DDEProblem? I ask because I get error messages, likely my own fault, but if it isn't possible I can stop looking ;-) ","ts":"1616409976.105400","username":"[gitter] <HenriLaurie>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"Quick question: is it possible to use callbacks for a DDEProblem? I ask because I get error messages, likely my own fault, but if it isn't possible I can stop looking ;-) ","verbatim":false}}]},{"client_msg_id":"1b3ff290-1484-45f3-91b2-b9743b2b0ee3","type":"message","text":"yes, they work on DDEs","user":"U69BL50BF","ts":"1616410355.105600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8FOy","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yes, they work on DDEs"}]}]}]},{"type":"message","subtype":"bot_message","text":"Great! ... and bugs found (red face icon here)","ts":"1616410520.105700","username":"[gitter] <HenriLaurie>","bot_id":"B795XHD0X","blocks":[{"type":"section","block_id":"matterbridge_c175804g27iaek8aehs0","text":{"type":"mrkdwn","text":"Great! ... and bugs found (red face icon here)","verbatim":false}}]},{"client_msg_id":"b7127a92-b548-41b1-bced-dd557dfc171d","type":"message","text":":rage:","user":"U69BL50BF","ts":"1616410621.106000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NTfn","elements":[{"type":"rich_text_section","elements":[{"type":"emoji","name":"rage"}]}]}]},{"client_msg_id":"3868c1c4-2a45-4a75-b55e-f930551db83f","type":"message","text":"Is there a convenient way to determine the type of an `ODESolution`  prior to solve, e.g. to make an empty array to push into?","user":"UP95S4864","ts":"1616419799.107400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"0pqxb","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there a convenient way to determine the type of an "},{"type":"text","text":"ODESolution","style":{"code":true}},{"type":"text","text":"  prior to solve, e.g. to make an empty array to push into?"}]}]}]},{"client_msg_id":"0835c524-1398-4587-88d5-f074b13b3ce1","type":"message","text":"`Core.return_type`","user":"U69BL50BF","ts":"1616419882.107600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"48eZQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Core.return_type","style":{"code":true}}]}]}]},{"client_msg_id":"9629853c-ace4-491d-96c8-6cbda96e9292","type":"message","text":"`Core.Compiler.return_type` ??","user":"UP95S4864","ts":"1616420169.107900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bUJKz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Core.Compiler.return_type","style":{"code":true}},{"type":"text","text":" ??"}]}]}]},{"client_msg_id":"6c8c0834-5f0c-4725-8980-d6cd305b330c","type":"message","text":"Do kwargs ever come into play for the solution type? There is no docs for `return_type` , so I'm unsure how you would use it with kwargs","user":"UP95S4864","ts":"1616420735.108900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZWhJ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Do kwargs ever come into play for the solution type? There is no docs for "},{"type":"text","text":"return_type","style":{"code":true}},{"type":"text","text":" , so I'm unsure how you would use it with kwargs"}]}]}]},{"client_msg_id":"261f575c-d5b5-4974-8d71-89b5904266fd","type":"message","text":"You can do something like\n```julia&gt; f(x; y, z) = x + y * z\nf (generic function with 1 method)\n\njulia&gt; Core.Compiler.return_type(Core.kwfunc(f), Tuple{typeof((y=2, z=3)), typeof(f), Float64})\nFloat64```\nNote that `return_type` is not a stable API though, so results are allowed to become less precise in future Julia versions.","user":"UM30MT6RF","ts":"1616421451.110800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8cEW","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"You can do something like\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> f(x; y, z) = x + y * z\nf (generic function with 1 method)\n\njulia> Core.Compiler.return_type(Core.kwfunc(f), Tuple{typeof((y=2, z=3)), typeof(f), Float64})\nFloat64"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"Note that "},{"type":"text","text":"return_type","style":{"code":true}},{"type":"text","text":" is not a stable API though, so results are allowed to become less precise in future Julia versions."}]}]}]},{"client_msg_id":"258d02fb-e8ee-448c-a074-9331256237c1","type":"message","text":"<@U69BL50BF> I'd like to add the option to return an `EnsembleSolution`  for all trajectories used in `expectation` . My thought was simply to `push!`  the DE Solution in the integrand and then construct the `EnsembleSolution` .  Hence the Q Re: `return_type`. Any thoughts on a cleaner approach?","user":"UP95S4864","ts":"1616423081.115300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5M8Zn","elements":[{"type":"rich_text_section","elements":[{"type":"user","user_id":"U69BL50BF"},{"type":"text","text":" I'd like to add the option to return an "},{"type":"text","text":"EnsembleSolution","style":{"code":true}},{"type":"text","text":"  for all trajectories used in "},{"type":"text","text":"expectation","style":{"code":true}},{"type":"text","text":" . My thought was simply to "},{"type":"text","text":"push!","style":{"code":true}},{"type":"text","text":"  the DE Solution in the integrand and then construct the "},{"type":"text","text":"EnsembleSolution","style":{"code":true}},{"type":"text","text":" .  Hence the Q Re: "},{"type":"text","text":"return_type","style":{"code":true}},{"type":"text","text":". Any thoughts on a cleaner approach?"}]}]}]},{"client_msg_id":"213c6580-543b-4e0c-926b-d73b8d6fc5d9","type":"message","text":"`return_type` is fine","user":"U69BL50BF","ts":"1616423111.115600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"l96z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"return_type","style":{"code":true}},{"type":"text","text":" is fine"}]}]}]},{"client_msg_id":"4344f041-3637-4866-84c3-7243128852da","type":"message","text":"It's not going to break in DiffEq: we'll just open issues and say inference is broken to block the next Julia release if it doesn't work :wink:","user":"U69BL50BF","ts":"1616423130.116100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"pixg7","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It's not going to break in DiffEq: we'll just open issues and say inference is broken to block the next Julia release if it doesn't work "},{"type":"emoji","name":"wink"}]}]}],"reactions":[{"name":"laughing","users":["UM30MT6RF","UP95S4864"],"count":2},{"name":"+1","users":["UP95S4864"],"count":1}]},{"client_msg_id":"31039e85-cb24-48de-95b3-3614c73b8c43","type":"message","text":"I also hope to clean up a lot of the type instability and make it more general wrt types, but am hitting a lot of box issues w/ captured variables in the integrand. Any general advice?","user":"UP95S4864","ts":"1616423388.117600","team":"T68168MUP","edited":{"user":"UP95S4864","ts":"1616423412.000000"},"blocks":[{"type":"rich_text","block_id":"6NH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I also hope to clean up a lot of the type instability and make it more general wrt types, but am hitting a lot of box issues w/ captured variables in the integrand. Any general advice?"}]}]}],"thread_ts":"1616423388.117600","reply_count":12,"reply_users_count":2,"latest_reply":"1616426024.131700","reply_users":["UM30MT6RF","UP95S4864"],"subscribed":false},{"client_msg_id":"0f81184e-70d3-44cd-afd6-c000f9e1b1ac","type":"message","text":"hi, I saw this <https://mtk.sciml.ai/stable/tutorials/acausal_components/> and the comparison with other tools here <https://mtk.sciml.ai/dev/comparison/>. I wonder if it is possible to model acausal components with modal behaviour and transition conditions in MTK ?","user":"URPFQPSEQ","ts":"1616423808.121100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"1Jb4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"hi, I saw this "},{"type":"link","url":"https://mtk.sciml.ai/stable/tutorials/acausal_components/"},{"type":"text","text":" and the comparison with other tools here "},{"type":"link","url":"https://mtk.sciml.ai/dev/comparison/"},{"type":"text","text":". I wonder if it is possible to model acausal components with modal behaviour and transition conditions in MTK ?"}]}]}]},{"client_msg_id":"2d436830-30b7-428f-ae37-d7baa1716bc6","type":"message","text":"in simscape for example they call it mode charts <https://de.mathworks.com/help/physmod/simscape/lang/mode-chart-modeling.html>","user":"URPFQPSEQ","ts":"1616423956.121900","team":"T68168MUP","attachments":[{"title":"Mode Chart Modeling - MATLAB &amp; Simulink - MathWorks Deutschland","title_link":"https://de.mathworks.com/help/physmod/simscape/lang/mode-chart-modeling.html","text":"Model components characterized by discrete set of distinct operating modes.","fallback":"Mode Chart Modeling - MATLAB &amp; Simulink - MathWorks Deutschland","from_url":"https://de.mathworks.com/help/physmod/simscape/lang/mode-chart-modeling.html","service_icon":"https://de.mathworks.com/favicon.ico","service_name":"de.mathworks.com","id":1,"original_url":"https://de.mathworks.com/help/physmod/simscape/lang/mode-chart-modeling.html"}],"blocks":[{"type":"rich_text","block_id":"Jaq","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"in simscape for example they call it mode charts "},{"type":"link","url":"https://de.mathworks.com/help/physmod/simscape/lang/mode-chart-modeling.html"}]}]}]},{"client_msg_id":"d110cadc-60f7-47a5-b568-e351a6226d7f","type":"message","text":"you get to the same place using IfElse.ifelse","user":"U69BL50BF","ts":"1616424322.123600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4Y1r","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"you get to the same place using IfElse.ifelse"}]}]}]},{"client_msg_id":"0f79dc7b-e370-4445-a211-4ff52f2af6a8","type":"message","text":"thank you...i think it would be helpful to have as an example a rectifier circuit: sin voltage source--Resistor---ideal diode-- gnd... how would you implement the component equaiton for the ideal diode. In modelica they have a curve parameter which either has the meaning of voltage or current depending if the diode is off or on..","user":"URPFQPSEQ","ts":"1616425033.127900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"bC1l","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"thank you...i think it would be helpful to have as an example a rectifier circuit: sin voltage source--Resistor---ideal diode-- gnd... how would you implement the component equaiton for the ideal diode. In modelica they have a curve parameter which either has the meaning of voltage or current depending if the diode is off or on.."}]}]}],"thread_ts":"1616425033.127900","reply_count":1,"reply_users_count":1,"latest_reply":"1616425660.131300","reply_users":["UM8JUNJG7"],"subscribed":false},{"client_msg_id":"2ba58313-8078-4ac8-a8f9-f4b8bde6be7e","type":"message","text":"ideal diode:  when it is off current is 0 (voltage arbitrary negative), when it is on voltage is 0 (current arbitrary positive)","user":"URPFQPSEQ","ts":"1616425116.129100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GyJLK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"ideal diode:  when it is off current is 0 (voltage arbitrary negative), when it is on voltage is 0 (current arbitrary positive)"}]}]}]},{"client_msg_id":"5e3871ce-4d53-4308-97b7-8a017108dfeb","type":"message","text":"and the variable off is a boolean variable in modelica","user":"URPFQPSEQ","ts":"1616425222.129600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VWN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and the variable off is a boolean variable in modelica"}]}]}]},{"client_msg_id":"62b98dd1-69af-4b08-859b-b7e4c8466487","type":"message","text":"I'm trying to make FastChain twice differentiable (it somehow mutates arrays)\n\nI rewrote FastChain as:\n\n```split_at(p, idx) = view(p, 1:idx), view(p, (idx+1):lastindex(p))\n\nfunction ChainRulesCore.rrule(\n  ::typeof(split_at),\n  p::AbstractVector{S},\n  idx::Int,\n  ) where S\n\n  function split_at_pullback(Δ)\n    return (\n      ChainRulesCore.NO_FIELDS,\n      ChainRulesCore.@thunk(vcat(Δ...)),\n      ChainRulesCore.NO_FIELDS,\n    )\n  end\n  split_at(p, idx), split_at_pullback\nend\n\napplychain(::Tuple{}, x, p) = x\n# applychain(fs::Tuple, x, p) = applychain(Base.tail(fs), first(fs)(x,p[1:paramlength(first(fs))]), p[(paramlength(first(fs))+1):end])\nfunction DiffEqFlux.applychain(fs::Tuple, x, p)\n  p₁, p₂ = split_at(p, DiffEqFlux.paramlength(first(fs)))\n  DiffEqFlux.applychain(Base.tail(fs), first(fs)(x, p₁), p₂)\nend\n(c::FastChain)(x,p) = applychain(c.layers, x, p)```\nYes it's ugly :slightly_smiling_face:\n\nIf I run:\n\n```nn = FastChain(\n    FastDense(1,2, selu),\n    FastDense(2,1),\n    )\np = initial_params(nnb)\n\nfunction ftest(p)\n    gz, back = Zygote.pullback(z -&gt; nn(z, p), rand(1, 100))\n    back(gz)[1]\nend\n\ny, back = Zygote.pullback(ftest, p)\nback(y)[1]```\nI get a stray `Zero()` . Any ideas ?\n\n```8-element Array{Any,1}:\n -4.961157245626697\n  4.776112584950887\n -3.0912947608064307\n  3.257924132096858\n -3.3781788944196873\n -2.207525737666333\n  3.504429379232563\n   Zero()```\n","user":"UKJSNT1QR","ts":"1616451914.144000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"mWX+","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm trying to make FastChain twice differentiable (it somehow mutates arrays)\n\nI rewrote FastChain as:\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"split_at(p, idx) = view(p, 1:idx), view(p, (idx+1):lastindex(p))\n\nfunction ChainRulesCore.rrule(\n  ::typeof(split_at),\n  p::AbstractVector{S},\n  idx::Int,\n  ) where S\n\n  function split_at_pullback(Δ)\n    return (\n      ChainRulesCore.NO_FIELDS,\n      ChainRulesCore.@thunk(vcat(Δ...)),\n      ChainRulesCore.NO_FIELDS,\n    )\n  end\n  split_at(p, idx), split_at_pullback\nend\n\napplychain(::Tuple{}, x, p) = x\n# applychain(fs::Tuple, x, p) = applychain(Base.tail(fs), first(fs)(x,p[1:paramlength(first(fs))]), p[(paramlength(first(fs))+1):end])\nfunction DiffEqFlux.applychain(fs::Tuple, x, p)\n  p₁, p₂ = split_at(p, DiffEqFlux.paramlength(first(fs)))\n  DiffEqFlux.applychain(Base.tail(fs), first(fs)(x, p₁), p₂)\nend\n(c::FastChain)(x,p) = applychain(c.layers, x, p)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nYes it's ugly "},{"type":"emoji","name":"slightly_smiling_face"},{"type":"text","text":"\n\nIf I run:\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"nn = FastChain(\n    FastDense(1,2, selu),\n    FastDense(2,1),\n    )\np = initial_params(nnb)\n\nfunction ftest(p)\n    gz, back = Zygote.pullback(z -> nn(z, p), rand(1, 100))\n    back(gz)[1]\nend\n\ny, back = Zygote.pullback(ftest, p)\nback(y)[1]"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"\nI get a stray "},{"type":"text","text":"Zero()","style":{"code":true}},{"type":"text","text":" . Any ideas ?\n\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"8-element Array{Any,1}:\n -4.961157245626697\n  4.776112584950887\n -3.0912947608064307\n  3.257924132096858\n -3.3781788944196873\n -2.207525737666333\n  3.504429379232563\n   Zero()"}]},{"type":"rich_text_section","elements":[]}]}]},{"client_msg_id":"8e8d182f-ed7c-4b91-8d73-fd6048460fe8","type":"message","text":"I'm struggling to try and reduce allocations made when using `GhostDerivativeOperator`s from `DiffEqOperators` . Example:\n```d2x = CenteredDifference{1}(2, 2, 1.0, 5);\nbcx = Neumann0BC(1.0, 1)\nop = d2x * bcx\n\nu = zeros(5,5)\nu[3,3] = 1.0\n@btime du = op * u # 99.501 μs (1155 allocations: 95.17 KiB)\n\ndu = zeros(5,5)\n@btime mul!(du, op, u) # 97.665 μs (1154 allocations: 94.89 KiB)```\nI was hoping for a bigger improvement from the inplace multiplication. Is this a necessary limitation of the operators being driven by convolutions?","user":"U01J62981NK","ts":"1616453240.152700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"07T","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm struggling to try and reduce allocations made when using "},{"type":"text","text":"GhostDerivativeOperator","style":{"code":true}},{"type":"text","text":"s from "},{"type":"text","text":"DiffEqOperators","style":{"code":true}},{"type":"text","text":" . Example:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"d2x = CenteredDifference{1}(2, 2, 1.0, 5);\nbcx = Neumann0BC(1.0, 1)\nop = d2x * bcx\n\nu = zeros(5,5)\nu[3,3] = 1.0\n@btime du = op * u # 99.501 μs (1155 allocations: 95.17 KiB)\n\ndu = zeros(5,5)\n@btime mul!(du, op, u) # 97.665 μs (1154 allocations: 94.89 KiB)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"I was hoping for a bigger improvement from the inplace multiplication. Is this a necessary limitation of the operators being driven by convolutions?"}]}]}]},{"client_msg_id":"9db27345-85f9-481c-8a6c-6680dc167ab0","type":"message","text":"this <https://www.lifl.fr/~sedoglav/Load/Sedoglavic2002.pdf> algorithm is efficient for local identifiability analysis, I started putting together some draft code for it, this is not ready yet, but any feedback is welcome: <https://github.com/iliailmer/local-identifiability>\ni wonder how Symbolics/MTK will work with AbtractAlgebra and modular arithmetic for power series.","user":"U01K1S5RZB9","ts":"1616468800.153900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"/vCx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"this "},{"type":"link","url":"https://www.lifl.fr/~sedoglav/Load/Sedoglavic2002.pdf"},{"type":"text","text":" algorithm is efficient for local identifiability analysis, I started putting together some draft code for it, this is not ready yet, but any feedback is welcome: "},{"type":"link","url":"https://github.com/iliailmer/local-identifiability"},{"type":"text","text":"\ni wonder how Symbolics/MTK will work with AbtractAlgebra and modular arithmetic for power series."}]}]}]},{"client_msg_id":"695b07cc-72d1-4d0c-bb1a-01934ef679a2","type":"message","text":"```julia&gt; ReverseDiffVJP(compile=false)\nERROR: MethodError: no method matching ReverseDiffVJP(; compile=false)\nClosest candidates are:\n  ReverseDiffVJP() at /home/arno/.julia/packages/DiffEqSensitivity/JqbFp/src/sensitivity_algorithms.jl:134 got unsupported keyword argument \"compile\"\n  ReverseDiffVJP(::Any) at /home/arno/.julia/packages/DiffEqSensitivity/JqbFp/src/sensitivity_algorithms.jl:134 got unsupported keyword argument \"compile\"\nStacktrace:\n [1] top-level scope at REPL[27]:1\n\njulia&gt; ReverseDiffVJP(compile=true)\nERROR: MethodError: no method matching ReverseDiffVJP(; compile=true)\n...\n\njulia&gt; ReverseDiffVJP(true)\nReverseDiffVJP{true}()\n\njulia&gt; ReverseDiffVJP(false)\nReverseDiffVJP{false}()```\ncompile does not seem to be a keyword like the docs suggest. I would fix this myself but I don't know in which direction, change the docs or actually make it a keyword argument.","user":"UQEDP1Q5V","ts":"1616505529.156100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KAvU2","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> ReverseDiffVJP(compile=false)\nERROR: MethodError: no method matching ReverseDiffVJP(; compile=false)\nClosest candidates are:\n  ReverseDiffVJP() at /home/arno/.julia/packages/DiffEqSensitivity/JqbFp/src/sensitivity_algorithms.jl:134 got unsupported keyword argument \"compile\"\n  ReverseDiffVJP(::Any) at /home/arno/.julia/packages/DiffEqSensitivity/JqbFp/src/sensitivity_algorithms.jl:134 got unsupported keyword argument \"compile\"\nStacktrace:\n [1] top-level scope at REPL[27]:1\n\njulia> ReverseDiffVJP(compile=true)\nERROR: MethodError: no method matching ReverseDiffVJP(; compile=true)\n...\n\njulia> ReverseDiffVJP(true)\nReverseDiffVJP{true}()\n\njulia> ReverseDiffVJP(false)\nReverseDiffVJP{false}()"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"compile does not seem to be a keyword like the docs suggest. I would fix this myself but I don't know in which direction, change the docs or actually make it a keyword argument."}]}]}]},{"client_msg_id":"fcae6f68-95d8-4c7d-bd25-654be6c86ec6","type":"message","text":"It's a default argument IIRC","user":"U69BL50BF","ts":"1616506395.156300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"WmN","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"It's a default argument IIRC"}]}]}]},{"client_msg_id":"a2216f53-5027-4a22-9e4a-8b2013a5bf65","type":"message","text":"In the codebase yes, but the docs use it as kw I think.","user":"UQEDP1Q5V","ts":"1616506815.157000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"TcjHK","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In the codebase yes, but the docs use it as kw I think."}]}]}]},{"client_msg_id":"8df4d5fd-6e21-4b54-a083-02269fe0c8f7","type":"message","text":"oh interesting","user":"U69BL50BF","ts":"1616508732.157200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"jbw","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh interesting"}]}]}]},{"client_msg_id":"7c3511b2-3552-48ee-b475-e81075dd7fef","type":"message","text":"the docs should get updated then","user":"U69BL50BF","ts":"1616508736.157500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Q0F=z","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"the docs should get updated then"}]}]}]},{"client_msg_id":"5d1d1947-184a-4584-bdd7-0fcc1df75032","type":"message","text":"I'm like 99% sure that I have done `ReverseDiffVJP(compile=true)` and it worked fine. So either something changed or maybe you have an old version?","user":"U01H36BUDJB","ts":"1616509007.158100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"GAX","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm like 99% sure that I have done "},{"type":"text","text":"ReverseDiffVJP(compile=true)","style":{"code":true}},{"type":"text","text":" and it worked fine. So either something changed or maybe you have an old version?"}]}]}]},{"client_msg_id":"d60deb37-1870-47fa-8c8b-93d2d3d7ed03","type":"message","text":"How do I diagnose a slow GPU solve ? It's currently very slow but GPU usage is also very low. I'd expect the GPU usage to at least be high. CPU usage is also surprisingly high, while I would expect nothing to happen on the CPU. :/","user":"UKJSNT1QR","ts":"1616514229.161800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Hn0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"How do I diagnose a slow GPU solve ? It's currently very slow but GPU usage is also very low. I'd expect the GPU usage to at least be high. CPU usage is also surprisingly high, while I would expect nothing to happen on the CPU. :/"}]}]}],"thread_ts":"1616514229.161800","reply_count":3,"reply_users_count":2,"latest_reply":"1616514717.162900","reply_users":["UM8JUNJG7","UKJSNT1QR"],"subscribed":false},{"client_msg_id":"00308304-942c-4347-b8db-a66b3b356bfc","type":"message","text":"Is there an easy way to do mixed GPU / CPU profiling and see where the time is spent ?","user":"UKJSNT1QR","ts":"1616514260.162300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"MKBJl","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Is there an easy way to do mixed GPU / CPU profiling and see where the time is spent ?"}]}]}]},{"client_msg_id":"9f322368-f6c7-4f91-a6e8-78cade39cdc4","type":"message","text":"is the jacobian generation faster for a model that's been written in modeling toolkit rather than for a model I used modelingtoolkitize for?","user":"U01G3BG7AFR","ts":"1616537559.164900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Qu9KG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"is the jacobian generation faster for a model that's been written in modeling toolkit rather than for a model I used modelingtoolkitize for?"}]}]}]},{"client_msg_id":"e06aa491-f140-4ea5-960f-bd870c0629d8","type":"message","text":"it should be about the same, sans the tracing time.","user":"U69BL50BF","ts":"1616537696.165200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"xwc","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"it should be about the same, sans the tracing time."}]}]}]},{"client_msg_id":"11ed621a-8811-430c-9546-7276e5b4f4dd","type":"message","text":"I came across a paper entitled “Geometric Algebra Levenberg-Marquardt”, that uses projective geometric algebra (PGA) for automatic differentiation. To the experts on autodiff, how widely used are PGA techniques for autodiff? Are there limitations to such techniques?","user":"ULSFQ48UQ","ts":"1616594374.168800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"XXQP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I came across a paper entitled “Geometric Algebra Levenberg-Marquardt”, that uses projective geometric algebra (PGA) for automatic differentiation. To the experts on autodiff, how widely used are PGA techniques for autodiff? Are there limitations to such techniques?"}]}]}]},{"client_msg_id":"65d129f5-71bc-48ad-b3e1-b4a1012f83f9","type":"message","text":"I mean, the method of <https://link.springer.com/chapter/10.1007/978-3-030-22514-8_51> isn't surprising. It's using forward-mode AD to compute matrix-free Hessian-vector products and then noting that CG converges within N iterations on positive definite matrices.","user":"U69BL50BF","ts":"1616596286.169800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"RXe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I mean, the method of "},{"type":"link","url":"https://link.springer.com/chapter/10.1007/978-3-030-22514-8_51"},{"type":"text","text":" isn't surprising. It's using forward-mode AD to compute matrix-free Hessian-vector products and then noting that CG converges within N iterations on positive definite matrices."}]}]}]},{"client_msg_id":"fdf6defa-5dab-41fd-bd65-58eab1282a54","type":"message","text":"Not only is it not optimal (forward-over-reverse would be better), but it's an overly complicated way of computing something that is well-known in other terms. It reminds me of category theory :shrug:","user":"U69BL50BF","ts":"1616596334.170600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oFdal","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Not only is it not optimal (forward-over-reverse would be better), but it's an overly complicated way of computing something that is well-known in other terms. It reminds me of category theory "},{"type":"emoji","name":"shrug"}]}]}],"thread_ts":"1616596334.170600","reply_count":3,"reply_users_count":2,"latest_reply":"1616599086.179700","reply_users":["U6788D83U","UM8JUNJG7"],"is_locked":false,"subscribed":false,"reactions":[{"name":"rolling_on_the_floor_laughing","users":["U6788D83U","UP95S4864","UM8JUNJG7"],"count":3}]},{"client_msg_id":"688a64a2-3009-4f82-9afa-3d5ce5788433","type":"message","text":"Geometric algebra isn't bad though since it gives a nice algebraic way to compute and derive a ton of things, but most of what it's used for generally doesn't end up being too surprising.","user":"U69BL50BF","ts":"1616596365.171200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Mo7VH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Geometric algebra isn't bad though since it gives a nice algebraic way to compute and derive a ton of things, but most of what it's used for generally doesn't end up being too surprising."}]}]}]},{"client_msg_id":"dbf5c416-8dca-4437-8174-8f6ef9949d66","type":"message","text":"Also, it’s worth noting that CG doesn’t quite do that in practice, because the loss of orthogonality in finite precision arithmetic.","user":"U6788D83U","ts":"1616596735.171800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"=OC98","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Also, it’s worth noting that CG doesn’t quite do that in practice, because the loss of orthogonality in finite precision arithmetic."}]}]}]},{"client_msg_id":"4648e950-017c-4873-ad99-156ae1fc4ac3","type":"message","text":"Note that PGA has some nice successes in computer graphics, particularly in computing intersections of points, lines, and spheres, if you include conformal GA. I find geometric algebra preferable to complex algebra, it’s not as restrictive, and makes it easier to combine different spaces in a single model.","user":"ULSFQ48UQ","ts":"1616597948.179100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8UU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Note that PGA has some nice successes in computer graphics, particularly in computing intersections of points, lines, and spheres, if you include conformal GA. I find geometric algebra preferable to complex algebra, it’s not as restrictive, and makes it easier to combine different spaces in a single model."}]}]}]}]}