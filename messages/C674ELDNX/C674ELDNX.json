{"cursor": 27, "messages": [{"client_msg_id":"6b4a3aff-ec2f-4cd5-9a22-f47fe6905600","type":"message","text":"and also a fake `LazyArtifacts` package for Julia v1.3-1.5?","user":"UDB26738Q","ts":"1609179295.208600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KQF","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and also a fake "},{"type":"text","text":"LazyArtifacts","style":{"code":true}},{"type":"text","text":" package for Julia v1.3-1.5?"}]}]}],"thread_ts":"1609179295.208600","reply_count":3,"reply_users_count":2,"latest_reply":"1609185109.211400","reply_users":["UDB26738Q","U012FH66MFW"],"subscribed":false},{"client_msg_id":"080e7588-0056-4138-b765-dff9b61d3d12","type":"message","text":"```ERROR: LoadError: LoadError: InitError: Artifact \"MKL\" is a lazy artifact; package developers must call `using LazyArtifacts` in MKL_jll before using lazy artifacts.```\ndoes this need we need to add `LazyArtifacts` to `MKL_jll`?","user":"UDB26738Q","ts":"1609177840.208100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"se/r5","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: LoadError: LoadError: InitError: Artifact \"MKL\" is a lazy artifact; package developers must call `using LazyArtifacts` in MKL_jll before using lazy artifacts."}]},{"type":"rich_text_section","elements":[{"type":"text","text":"does this need we need to add "},{"type":"text","text":"LazyArtifacts","style":{"code":true}},{"type":"text","text":" to "},{"type":"text","text":"MKL_jll","style":{"code":true}},{"type":"text","text":"?"}]}]}]},{"client_msg_id":"e8c0e773-bbc7-4cf5-ae9e-3cf26a2eb152","type":"message","text":"```(tmp) pkg&gt; gc --verbose\n     [...]\n     Deleted 197 package installations (224.561 MiB)\n     Deleted 2 repos (46.556 MiB)\n     Deleted 768 artifact installations (14.170 GiB)\n     Deleted 3 scratchspaces (396.000 byte)```\n768 artifacts? :sweat_smile:","user":"UDB26738Q","ts":"1608907064.206800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"fxPG","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"(tmp) pkg> gc --verbose\n     [...]\n     Deleted 197 package installations (224.561 MiB)\n     Deleted 2 repos (46.556 MiB)\n     Deleted 768 artifact installations (14.170 GiB)\n     Deleted 3 scratchspaces (396.000 byte)"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"768 artifacts? "},{"type":"emoji","name":"sweat_smile"}]}]}],"reactions":[{"name":"scream","users":["U82RE6STE","U6QGE7S86","U6DN7UPJ7","UE76KFRFX","UGU761DU2"],"count":5},{"name":"two","users":["U66GD0880","U01BCQW92V8"],"count":2}]},{"client_msg_id":"13a3d264-8d6c-4193-88f4-243c57f674f8","type":"message","text":"So the answer should be in the private libdir of Julia","user":"U67BJLYCS","ts":"1608873000.204200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"blUUm","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So the answer should be in the private libdir of Julia"}]}]}],"thread_ts":"1608873000.204200","reply_count":7,"reply_users_count":2,"latest_reply":"1608877812.206100","reply_users":["U6DN7UPJ7","U67BJLYCS"],"subscribed":false},{"client_msg_id":"dba13410-0487-44f5-86dc-fc07bdda5d9d","type":"message","text":"In 1.6? It's a fake artifact","user":"U67BJLYCS","ts":"1608872982.203700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"tg/t","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"In 1.6? It's a fake artifact"}]}]}]},{"client_msg_id":"15b989b7-6546-4d2d-a1b9-e225831c5032","type":"message","text":"Does `libLLVM_jll.find_artifact_dir()` do it?","user":"U6788D83U","ts":"1608872845.203100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"6Qc2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Does "},{"type":"text","text":"libLLVM_jll.find_artifact_dir()","style":{"code":true}},{"type":"text","text":" do it?"}]}]}],"thread_ts":"1608872845.203100","reply_count":1,"reply_users_count":1,"latest_reply":"1608874468.204700","reply_users":["U6DN7UPJ7"],"subscribed":false,"reactions":[{"name":"+1","users":["U6DN7UPJ7"],"count":1},{"name":"heart","users":["U6DN7UPJ7"],"count":1}]},{"client_msg_id":"646c2279-c1ba-43f9-bc07-be64cf9ee460","type":"message","text":"where is `libLLVM_jll` ’s artifacts folder located in Julia 1.6+?  I tried to `Pkg.Artifacts.artifact_path`  those SHAs in the `StdlibArtifacts.toml` but all gave me wrong paths.","user":"U6DN7UPJ7","ts":"1608871667.202700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NQf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"where is "},{"type":"text","text":"libLLVM_jll","style":{"code":true}},{"type":"text","text":" ’s artifacts folder located in Julia 1.6+?  I tried to "},{"type":"text","text":"Pkg.Artifacts.artifact_path","style":{"code":true}},{"type":"text","text":"  those SHAs in the "},{"type":"text","text":"StdlibArtifacts.toml","style":{"code":true}},{"type":"text","text":" but all gave me wrong paths."}]}]}]},{"client_msg_id":"f7dab383-43b1-45d1-9761-f1b968cd4488","type":"message","text":"this happens only on windows + julia nightly","user":"UDB26738Q","ts":"1608855768.200500","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"F2cL0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"this happens only on windows + julia nightly"}]}]}]},{"client_msg_id":"6e37b10b-f123-414f-ab31-cd7dfebecb32","type":"message","text":"```ERROR: LoadError: LoadError: InitError: could not load library \"C:\\Users\\runneradmin\\.julia\\artifacts\\6de083f4770c1a6b49d179e2aa0f30c4bffde4a4\\bin\\mkl_core.dll\"\nAccess is denied. \nStacktrace:\n  [1] dlopen(s::String, flags::UInt32; throw_error::Bool)\n    @ Base.Libc.Libdl .\\libdl.jl:114\n  [2] dlopen\n    @ .\\libdl.jl:114 [inlined]\n  [3] __init__()\n    @ MKL_jll ~\\.julia\\packages\\MKL_jll\\ZCoyO\\src\\wrappers\\x86_64-w64-mingw32.jl:56\n  [4] _include_from_serialized(path::String, depmods::Vector{Any})\n    @ Base .\\loading.jl:670\n  [5] _require_search_from_serialized(pkg::Base.PkgId, sourcepath::String)\n    @ Base .\\loading.jl:756\n  [6] _require(pkg::Base.PkgId)\n    @ Base .\\loading.jl:994\n  [7] require(uuidkey::Base.PkgId)\n    @ Base .\\loading.jl:910\n  [8] require(into::Module, mod::Symbol)\n    @ Base .\\loading.jl:897\n  [9] include(mod::Module, _path::String)\n    @ Base .\\Base.jl:386\n [10] include(x::String)\n    @ FFTW D:\\a\\FFTW.jl\\FFTW.jl\\src\\FFTW.jl:1\n [11] top-level scope\n    @ D:\\a\\FFTW.jl\\FFTW.jl\\src\\FFTW.jl:20\n [12] include\n    @ .\\Base.jl:386 [inlined]\n [13] include_package_for_output(pkg::Base.PkgId, input::String, depot_path::Vector{String}, dl_load_path::Vector{String}, load_path::Vector{String}, concrete_deps::Vector{Pair{Base.PkgId, UInt64}}, source::String)\n    @ Base .\\loading.jl:1209\n [14] top-level scope\n    @ none:1\n [15] eval\n    @ .\\boot.jl:369 [inlined]\n [16] eval(x::Expr)\n    @ Base.MainInclude .\\client.jl:453\n [17] top-level scope\n    @ none:1\nduring initialization of module MKL_jll\nin expression starting at D:\\a\\FFTW.jl\\FFTW.jl\\deps\\deps.jl:1\nin expression starting at D:\\a\\FFTW.jl\\FFTW.jl\\src\\FFTW.jl:1\nERROR: LoadError: Failed to precompile FFTW [7a1cc6ca-52ef-59f5-83cd-3a7055c09341] to C:\\Users\\runneradmin\\.julia\\compiled\\v1.7\\FFTW\\jl_6DF4.tmp.\nStacktrace:\n [1] error(s::String)\n   @ Base .\\error.jl:33\n [2] compilecache(pkg::Base.PkgId, path::String, internal_stderr::IOContext{Base.PipeEndpoint}, internal_stdout::IOContext{Base.PipeEndpoint})\n   @ Base .\\loading.jl:1356\n [3] compilecache(pkg::Base.PkgId, path::String)\n   @ Base .\\loading.jl:1302\n [4] _require(pkg::Base.PkgId)\n   @ Base .\\loading.jl:1017\n [5] require(uuidkey::Base.PkgId)\n   @ Base .\\loading.jl:910\n [6] require(into::Module, mod::Symbol)\n   @ Base .\\loading.jl:897\n [7] include(fname::String)\n   @ Base.MainInclude .\\client.jl:451\n [8] top-level scope\n   @ none:6\nin expression starting at D:\\a\\FFTW.jl\\FFTW.jl\\test\\runtests.jl:2```\naccess denied?!?!","user":"UDB26738Q","ts":"1608855736.200200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"NiYa","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"ERROR: LoadError: LoadError: InitError: could not load library \"C:\\Users\\runneradmin\\.julia\\artifacts\\6de083f4770c1a6b49d179e2aa0f30c4bffde4a4\\bin\\mkl_core.dll\"\nAccess is denied. \nStacktrace:\n  [1] dlopen(s::String, flags::UInt32; throw_error::Bool)\n    @ Base.Libc.Libdl .\\libdl.jl:114\n  [2] dlopen\n    @ .\\libdl.jl:114 [inlined]\n  [3] __init__()\n    @ MKL_jll ~\\.julia\\packages\\MKL_jll\\ZCoyO\\src\\wrappers\\x86_64-w64-mingw32.jl:56\n  [4] _include_from_serialized(path::String, depmods::Vector{Any})\n    @ Base .\\loading.jl:670\n  [5] _require_search_from_serialized(pkg::Base.PkgId, sourcepath::String)\n    @ Base .\\loading.jl:756\n  [6] _require(pkg::Base.PkgId)\n    @ Base .\\loading.jl:994\n  [7] require(uuidkey::Base.PkgId)\n    @ Base .\\loading.jl:910\n  [8] require(into::Module, mod::Symbol)\n    @ Base .\\loading.jl:897\n  [9] include(mod::Module, _path::String)\n    @ Base .\\Base.jl:386\n [10] include(x::String)\n    @ FFTW D:\\a\\FFTW.jl\\FFTW.jl\\src\\FFTW.jl:1\n [11] top-level scope\n    @ D:\\a\\FFTW.jl\\FFTW.jl\\src\\FFTW.jl:20\n [12] include\n    @ .\\Base.jl:386 [inlined]\n [13] include_package_for_output(pkg::Base.PkgId, input::String, depot_path::Vector{String}, dl_load_path::Vector{String}, load_path::Vector{String}, concrete_deps::Vector{Pair{Base.PkgId, UInt64}}, source::String)\n    @ Base .\\loading.jl:1209\n [14] top-level scope\n    @ none:1\n [15] eval\n    @ .\\boot.jl:369 [inlined]\n [16] eval(x::Expr)\n    @ Base.MainInclude .\\client.jl:453\n [17] top-level scope\n    @ none:1\nduring initialization of module MKL_jll\nin expression starting at D:\\a\\FFTW.jl\\FFTW.jl\\deps\\deps.jl:1\nin expression starting at D:\\a\\FFTW.jl\\FFTW.jl\\src\\FFTW.jl:1\nERROR: LoadError: Failed to precompile FFTW [7a1cc6ca-52ef-59f5-83cd-3a7055c09341] to C:\\Users\\runneradmin\\.julia\\compiled\\v1.7\\FFTW\\jl_6DF4.tmp.\nStacktrace:\n [1] error(s::String)\n   @ Base .\\error.jl:33\n [2] compilecache(pkg::Base.PkgId, path::String, internal_stderr::IOContext{Base.PipeEndpoint}, internal_stdout::IOContext{Base.PipeEndpoint})\n   @ Base .\\loading.jl:1356\n [3] compilecache(pkg::Base.PkgId, path::String)\n   @ Base .\\loading.jl:1302\n [4] _require(pkg::Base.PkgId)\n   @ Base .\\loading.jl:1017\n [5] require(uuidkey::Base.PkgId)\n   @ Base .\\loading.jl:910\n [6] require(into::Module, mod::Symbol)\n   @ Base .\\loading.jl:897\n [7] include(fname::String)\n   @ Base.MainInclude .\\client.jl:451\n [8] top-level scope\n   @ none:6\nin expression starting at D:\\a\\FFTW.jl\\FFTW.jl\\test\\runtests.jl:2"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"access denied?!?!"}]}]}]},{"client_msg_id":"c39ed30f-0090-4783-8c2d-923b535cfbd4","type":"message","text":"but now at least `install_name_tool` does a real thing.","user":"U67BJLYCS","ts":"1608840109.197100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SAfk","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"but now at least "},{"type":"text","text":"install_name_tool","style":{"code":true}},{"type":"text","text":" does a real thing."}]}]}]},{"client_msg_id":"7b66a28c-daf1-4776-8b2f-d602059af21e","type":"message","text":"we’re close but have same issue from @rpath","user":"UN3KKRCRJ","ts":"1608840016.196600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"LB4","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"we’re close but have same issue from @rpath"}]}]}]},{"client_msg_id":"b0377477-cc2d-4576-8aa0-d292e9440d52","type":"message","text":"does binary builder fix this for us:\n```otool -D Enzyme/libEnzyme-9.dylib \nEnzyme/libEnzyme-9.dylib:\n@rpath/libEnzyme-9.dylib```","user":"UN3KKRCRJ","ts":"1608840002.196300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"oWx","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"does binary builder fix this for us:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"otool -D Enzyme/libEnzyme-9.dylib \nEnzyme/libEnzyme-9.dylib:\n@rpath/libEnzyme-9.dylib"}]}]}],"thread_ts":"1608840002.196300","reply_count":2,"reply_users_count":1,"latest_reply":"1608843131.197900","reply_users":["UDB26738Q"],"subscribed":false},{"client_msg_id":"85197451-a22c-4e06-9b69-f4e89e1f40cc","type":"message","text":"which is how LLVM plugins are build normally","user":"U67BJLYCS","ts":"1608838248.195900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"n7d","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"which is how LLVM plugins are build normally"}]}]}]},{"client_msg_id":"4ff2ac50-bf50-49bc-9109-299a79c453e4","type":"message","text":"<https://cmake.org/cmake/help/latest/command/add_library.html>","user":"U67BJLYCS","ts":"1608838164.195300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"DdY","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://cmake.org/cmake/help/latest/command/add_library.html"}]}]}]},{"client_msg_id":"49ea1e8f-5f40-42bd-8a67-3768dcf5efae","type":"message","text":"So CMake does since because we `MODULE` for `add_library`","user":"U67BJLYCS","ts":"1608838163.195100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"AanS","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So CMake does since because we "},{"type":"text","text":"MODULE","style":{"code":true}},{"type":"text","text":" for "},{"type":"text","text":"add_library","style":{"code":true}}]}]}]},{"client_msg_id":"944f4121-5a0c-4d02-823d-423faed277e5","type":"message","text":"yay :cry:","user":"UN3KKRCRJ","ts":"1608837702.194600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Ccxf","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yay "},{"type":"emoji","name":"cry"}]}]}]},{"client_msg_id":"d0ba0049-7f47-4cec-b74c-331b4edfb135","type":"message","text":"```wmoses@Billys-MBP16:/usr/local/opt/llvm/lib $ file LLVMPolly.so \nLLVMPolly.so: Mach-O 64-bit bundle x86_64\nwmoses@Billys-MBP16:/usr/local/opt/llvm/lib $ otool -D LLVMPolly.so \nLLVMPolly.so:```","user":"UN3KKRCRJ","ts":"1608837699.194400","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gZT","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"wmoses@Billys-MBP16:/usr/local/opt/llvm/lib $ file LLVMPolly.so \nLLVMPolly.so: Mach-O 64-bit bundle x86_64\nwmoses@Billys-MBP16:/usr/local/opt/llvm/lib $ otool -D LLVMPolly.so \nLLVMPolly.so:"}]}]}]},{"client_msg_id":"9239d8a8-70c2-4bf8-9dea-80be02a99dfe","type":"message","text":"jolly great","user":"U67BJLYCS","ts":"1608837684.194100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"l+oH","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"jolly great"}]}]}]},{"client_msg_id":"02a37649-19dc-45b8-9ade-e159d5c94157","type":"message","text":"So LLVM plugins... are bundles and not dylibs","user":"U67BJLYCS","ts":"1608837680.193900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"k=nd","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"So LLVM plugins... are bundles and not dylibs"}]}]}]},{"client_msg_id":"743edf84-983c-4775-8b40-7b6f4a4d3eaa","type":"message","text":"taking a step back what is a “Enzyme/LLVMEnzyme-11.dylib: Mach-O 64-bit bundle x86_64” as opposed to a “liba.dylib: Mach-O 64-bit dynamically linked shared library x86_64\"","user":"UN3KKRCRJ","ts":"1608837524.193300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KBr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"taking a step back what is a “Enzyme/LLVMEnzyme-11.dylib: Mach-O 64-bit bundle x86_64” as opposed to a “liba.dylib: Mach-O 64-bit dynamically linked shared library x86_64\""}]}]}]},{"client_msg_id":"3abd5e8f-1b05-4781-a3f1-fd09eb27f6f7","type":"message","text":"and not a `liba.dylib: Mach-O 64-bit dynamically linked shared library x86_64`","user":"U67BJLYCS","ts":"1608837444.192900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"SMz","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and not a "},{"type":"text","text":"liba.dylib: Mach-O 64-bit dynamically linked shared library x86_64","style":{"code":true}}]}]}],"thread_ts":"1608837444.192900","reply_count":1,"reply_users_count":1,"latest_reply":"1608837643.193400","reply_users":["UDB26738Q"],"subscribed":false},{"client_msg_id":"00abeca1-e8a4-4889-bdf7-42f346e0526d","type":"message","text":"our suspicion is that we have\n``` $ file ClangEnzyme-9.dylib\nClangEnzyme-9.dylib: Mach-O 64-bit bundle x86_64```","user":"U67BJLYCS","ts":"1608837389.192300","team":"T68168MUP","edited":{"user":"U67BJLYCS","ts":"1608837414.000000"},"blocks":[{"type":"rich_text","block_id":"cZIVI","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"our suspicion is that we have\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":" $ file ClangEnzyme-9.dylib\nClangEnzyme-9.dylib: Mach-O 64-bit bundle x86_64"}]}]}]},{"client_msg_id":"a4242ac5-623f-4c02-ac97-fb08841ed1c8","type":"message","text":"and using `install_name_tool` manually doesn't let me change it","user":"U67BJLYCS","ts":"1608837378.192000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VTtH/","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and using "},{"type":"text","text":"install_name_tool","style":{"code":true}},{"type":"text","text":" manually doesn't let me change it"}]}]}]},{"client_msg_id":"68e6ba74-8591-44bf-ac2e-ba5c13fb9587","type":"message","text":"everywhere else it does","user":"U67BJLYCS","ts":"1608837330.191200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"7Fzt","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"everywhere else it does"}]}]}]},{"client_msg_id":"766d96c6-e65f-43a6-8f26-aa793bc6db44","type":"message","text":"on MacOs","user":"U67BJLYCS","ts":"1608837325.191000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OGY","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"on MacOs"}]}]}]},{"client_msg_id":"f8ade688-c8de-4931-9629-b50cdead8603","type":"message","text":"No the lib in the JLL package does not have the soname set correctly","user":"U67BJLYCS","ts":"1608837320.190800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"8hXR","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"No the lib in the JLL package does not have the soname set correctly"}]}]}]},{"client_msg_id":"49277ca1-8ab3-4bbb-b047-811b83c29b57","type":"message","text":"does the lib in the JLL package have the soname set correctly?  this is the command run by the audit, according to the log:\n```/opt/bin/x86_64-apple-darwin14-libgfortran3-cxx03/install_name_tool -id LLVMEnzyme-9.dylib lib/LLVMEnzyme-9.dylib```\nand just to confirm, this is what the audit does: <https://github.com/JuliaPackaging/BinaryBuilder.jl/blob/f47a234ffafdf39c93950c6232b9ba07cfd0e986/src/auditor/soname_matching.jl#L69-L75>","user":"UDB26738Q","ts":"1608836875.190300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"cthG","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"does the lib in the JLL package have the soname set correctly?  this is the command run by the audit, according to the log:\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"/opt/bin/x86_64-apple-darwin14-libgfortran3-cxx03/install_name_tool -id LLVMEnzyme-9.dylib lib/LLVMEnzyme-9.dylib"}]},{"type":"rich_text_section","elements":[{"type":"text","text":"and just to confirm, this is what the audit does: "},{"type":"link","url":"https://github.com/JuliaPackaging/BinaryBuilder.jl/blob/f47a234ffafdf39c93950c6232b9ba07cfd0e986/src/auditor/soname_matching.jl#L69-L75"}]}]}]},{"client_msg_id":"5cd5b2cb-bc8b-495f-b416-f3c7b417f40c","type":"message","text":"```wmoses@Billys-MBP16:~/git/Enzyme/enzyme/build/Enzyme ((HEAD detached at ebed6bfa798)) $ otool -D /usr/local/opt/llvm/lib/libLLVM.dylib \n/usr/local/opt/llvm/lib/libLLVM.dylib:\n/usr/local/opt/llvm/lib/libLLVM.dylib```","user":"U67BJLYCS","ts":"1608836517.189200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"10q","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"wmoses@Billys-MBP16:~/git/Enzyme/enzyme/build/Enzyme ((HEAD detached at ebed6bfa798)) $ otool -D /usr/local/opt/llvm/lib/libLLVM.dylib \n/usr/local/opt/llvm/lib/libLLVM.dylib:\n/usr/local/opt/llvm/lib/libLLVM.dylib"}]}]}]},{"client_msg_id":"5e67b83c-292f-456c-af3c-a7ada247fee7","type":"message","text":"oh, I see now","user":"UDB26738Q","ts":"1608836515.189100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"5nTe","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh, I see now"}]}]}]},{"client_msg_id":"39c3ab0c-83b9-4180-b5da-b7a76ea6ec0f","type":"message","text":"theres two paths there, one for the command line arg, and one saying this file has soname (and following colon, the empty string)","user":"UN3KKRCRJ","ts":"1608836514.189000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Unj3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"theres two paths there, one for the command line arg, and one saying this file has soname (and following colon, the empty string)"}]}]}]},{"client_msg_id":"35f3f3b7-3aef-419b-bb80-662a91220a4b","type":"message","text":"yeah that's saying its empty","user":"U67BJLYCS","ts":"1608836490.188200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"VB=d0","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"yeah that's saying its empty"}]}]}]},{"client_msg_id":"30129d5e-9de5-4504-827d-d8e473413476","type":"message","text":"<https://julialang.slack.com/archives/C674ELDNX/p1608835802183200> this one doesn't seem empty though","user":"UDB26738Q","ts":"1608836472.187900","team":"T68168MUP","attachments":[{"from_url":"https://julialang.slack.com/archives/C674ELDNX/p1608835802183200","fallback":"[December 24th, 2020 10:50 AM] vchuravy: ```shell&gt; otool -D /Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib\n/Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib:```","ts":"1608835802.183200","author_id":"U67BJLYCS","author_subname":"Valentin Churavy","channel_id":"C674ELDNX","channel_name":"binarybuilder","is_msg_unfurl":true,"text":"```shell&gt; otool -D /Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib\n/Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib:```","author_name":"Valentin Churavy","author_link":"https://julialang.slack.com/team/U67BJLYCS","author_icon":"https://secure.gravatar.com/avatar/1cdd019b591282ce27f057fdab2ee80e.jpg?s=48&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-48.png","mrkdwn_in":["text"],"id":1,"original_url":"https://julialang.slack.com/archives/C674ELDNX/p1608835802183200","footer":"Posted in #binarybuilder"}],"blocks":[{"type":"rich_text","block_id":"SDJ","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://julialang.slack.com/archives/C674ELDNX/p1608835802183200"},{"type":"text","text":" this one doesn't seem empty though"}]}]}]},{"client_msg_id":"98361a6a-99c4-4d9e-9221-b64f20a29770","type":"message","text":"to the soname from cmake is empty","user":"UN3KKRCRJ","ts":"1608836452.187600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"l+FC","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"to the soname from cmake is empty"}]}]}]},{"client_msg_id":"64f25562-ef45-4c40-82f5-4954b43d02ef","type":"message","text":"I'm having a hard time understanding what are you trying to change in the soname of the macOS lib","user":"UDB26738Q","ts":"1608836433.187300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Ql3of","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I'm having a hard time understanding what are you trying to change in the soname of the macOS lib"}]}]}]},{"client_msg_id":"456e1325-cd42-421f-8bf2-396eed14b1e2","type":"message","text":"why do you expect cmake to do something reasonable? :stuck_out_tongue:","user":"UDB26738Q","ts":"1608836055.186100","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"qbvkU","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"why do you expect cmake to do something reasonable? "},{"type":"emoji","name":"stuck_out_tongue"}]}]}],"reactions":[{"name":"expressionless","users":["UN3KKRCRJ","U6QGE7S86"],"count":2},{"name":"pensive","users":["U67BJLYCS","UN3KKRCRJ","U6QGE7S86"],"count":3},{"name":"cry","users":["U67BJLYCS","U6QGE7S86"],"count":2},{"name":"anguished","users":["U67BJLYCS","U6QGE7S86"],"count":2},{"name":"face_with_monocle","users":["U67BJLYCS","U6QGE7S86"],"count":2}]},{"client_msg_id":"5ae6f809-5fa4-49ca-b529-d547377cbc3c","type":"message","text":"Separately I’m still confused why CMake isn’t doing this by default","user":"UN3KKRCRJ","ts":"1608836034.185800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"N=0pr","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Separately I’m still confused why CMake isn’t doing this by default"}]}]}]},{"client_msg_id":"506a90ae-0c82-4c2d-95a5-6d52e6f4df69","type":"message","text":"that was a long line :sweat_smile:","user":"UDB26738Q","ts":"1608836007.185000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"gqCjj","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"that was a long line "},{"type":"emoji","name":"sweat_smile"}]}]}]},{"client_msg_id":"f9f84373-2a69-4dcd-8aec-21742af97edc","type":"message","text":"where the second one is the path right?","user":"U67BJLYCS","ts":"1608836002.184900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Iu1eP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"where the second one is the path right?"}]}]}]},{"client_msg_id":"c7939e80-ef47-49ea-abae-92d7eae5d5eb","type":"message","text":"oh, wait","user":"UDB26738Q","ts":"1608835999.184600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"j8U","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oh, wait"}]}]}]},{"client_msg_id":"1ccd6db4-c12d-4dc2-8f42-7d6db6d574f0","type":"message","text":"should be\n```install_name_tool -id LLVMEnzyme-9.dylib LLVMEnzyme-9.dylib```","user":"UDB26738Q","ts":"1608835979.184300","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"+cddP","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"should be\n"}]},{"type":"rich_text_preformatted","elements":[{"type":"text","text":"install_name_tool -id LLVMEnzyme-9.dylib LLVMEnzyme-9.dylib"}]}]}]},{"client_msg_id":"e3151f0d-5848-4904-9b83-e113cb86cb04","type":"message","text":"there are two arguments","user":"UDB26738Q","ts":"1608835959.184000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"dLw7t","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"there are two arguments"}]}]}]},{"client_msg_id":"0cf97e8b-67c4-4e29-9c01-a2b08cf77d88","type":"message","text":"oddly doesn't suffice","user":"U67BJLYCS","ts":"1608835935.183800","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"ZAuM","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"oddly doesn't suffice"}]}]}]},{"client_msg_id":"ef0df319-4b57-4428-ae3d-4d60114a4da7","type":"message","text":"```shell&gt; install_name_tool -id LLVMEnzyme-9.dylib /Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib\n\nshell&gt; otool -D /Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib\n/Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib:```","user":"U67BJLYCS","ts":"1608835930.183600","team":"T68168MUP","edited":{"user":"U67BJLYCS","ts":"1608836554.000000"},"blocks":[{"type":"rich_text","block_id":"D5SWl","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"shell> install_name_tool -id LLVMEnzyme-9.dylib /Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib\n\nshell> otool -D /Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib\n/Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib:"}]}]}]},{"client_msg_id":"233990cb-d292-4977-8752-341792048a7a","type":"message","text":"```shell&gt; otool -D /Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib\n/Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib:```","user":"U67BJLYCS","ts":"1608835802.183200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"v=R","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"shell> otool -D /Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib\n/Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib:"}]}]}]},{"client_msg_id":"bc777a5c-ab13-40b9-9cf5-567e9c7c9da7","type":"message","text":"Yeah","user":"U67BJLYCS","ts":"1608835798.183000","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"Yme","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"Yeah"}]}]}]},{"client_msg_id":"fceaeb86-7cad-4bdb-9be3-de422e68169d","type":"message","text":"<https://github.com/JuliaPackaging/Yggdrasil/blob/029965f93f1fe28fd9f3f6fe62cc4e04464dbfc1/O/OpenBLAS/common.jl#L156-L163>","user":"UDB26738Q","ts":"1608835798.182900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"KNUI","elements":[{"type":"rich_text_section","elements":[{"type":"link","url":"https://github.com/JuliaPackaging/Yggdrasil/blob/029965f93f1fe28fd9f3f6fe62cc4e04464dbfc1/O/OpenBLAS/common.jl#L156-L163"}]}]}]},{"client_msg_id":"8e03830b-0428-4942-bffc-c8334b2c0a35","type":"message","text":"I think `install_name_tool -id soname.dylib lib.dylib`","user":"UDB26738Q","ts":"1608835697.182600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"kE3","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I think "},{"type":"text","text":"install_name_tool -id soname.dylib lib.dylib","style":{"code":true}}]}]}]},{"type":"message","subtype":"channel_join","ts":"1608835483.182100","user":"UN3KKRCRJ","text":"<@UN3KKRCRJ> has joined the channel","inviter":"U67BJLYCS"},{"client_msg_id":"429ac533-3e90-4bda-8e26-5672e569f36f","type":"message","text":"cc <@UN3KKRCRJ>","user":"U67BJLYCS","ts":"1608835480.181900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"B8h88","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"cc "},{"type":"user","user_id":"UN3KKRCRJ"}]}]}]},{"client_msg_id":"5d4f8543-30c3-4a77-8f45-cabbdf815301","type":"message","text":"and Elliot told me to do ` patchelf --set-soname LLVMEnzyme-9.so Enzyme/LLVMEnzyme-9.so`","user":"U67BJLYCS","ts":"1608835465.181600","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"IQRd2","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"and Elliot told me to do ` patchelf --set-soname LLVMEnzyme-9.so Enzyme/LLVMEnzyme-9.so`"}]}]}]},{"client_msg_id":"2b190fe4-2774-4b37-a3d8-8779e90b56d6","type":"message","text":"I had a similar issue before","user":"U67BJLYCS","ts":"1608835375.181200","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"W5dQ","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"I had a similar issue before"}]}]}]},{"client_msg_id":"a5abcf1c-f504-42ec-8337-7231af774afd","type":"message","text":"```julia&gt; Enzyme.autodiff(f, 1.0)\nERROR: could not load library \"LLVMEnzyme-9.dylib\"\ndlopen(LLVMEnzyme-9.dylib, 1): image not found\nStacktrace:```","user":"U67BJLYCS","ts":"1608835366.180900","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"4Bp","elements":[{"type":"rich_text_preformatted","elements":[{"type":"text","text":"julia> Enzyme.autodiff(f, 1.0)\nERROR: could not load library \"LLVMEnzyme-9.dylib\"\ndlopen(LLVMEnzyme-9.dylib, 1): image not found\nStacktrace:"}]}]}]},{"client_msg_id":"d99993d7-11a8-43fd-a45f-ad97efc22362","type":"message","text":"`/Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib`","user":"U67BJLYCS","ts":"1608835338.180700","team":"T68168MUP","blocks":[{"type":"rich_text","block_id":"OL/f","elements":[{"type":"rich_text_section","elements":[{"type":"text","text":"/Users/wmoses/.julia/artifacts/de8f157b7e6ac2a9d0ce542f7fb41a47024cfc96/lib/LLVMEnzyme-9.dylib","style":{"code":true}}]}]}]}]}